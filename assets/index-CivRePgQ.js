var W_=r=>{throw TypeError(r)};var Ip=(r,e,t)=>e.has(r)||W_("Cannot "+t);var Qt=(r,e,t)=>(Ip(r,e,"read from private field"),t?t.call(r):e.get(r)),Ws=(r,e,t)=>e.has(r)?W_("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),ka=(r,e,t,a)=>(Ip(r,e,"write to private field"),a?a.call(r,t):e.set(r,t),t),Xs=(r,e,t)=>(Ip(r,e,"access private method"),t);var X_=(r,e,t,a)=>({set _(s){ka(r,e,s,t)},get _(){return Qt(r,e,a)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();var jp={exports:{}},jc={};var Y_;function yT(){if(Y_)return jc;Y_=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(a,s,i){var o=null;if(i!==void 0&&(o=""+i),s.key!==void 0&&(o=""+s.key),"key"in s){i={};for(var c in s)c!=="key"&&(i[c]=s[c])}else i=s;return s=i.ref,{$$typeof:r,type:a,key:o,ref:s!==void 0?s:null,props:i}}return jc.Fragment=e,jc.jsx=t,jc.jsxs=t,jc}var K_;function bT(){return K_||(K_=1,jp.exports=yT()),jp.exports}var m=bT(),Pp={exports:{}},Je={};var J_;function wT(){if(J_)return Je;J_=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),v=Symbol.iterator;function x(q){return q===null||typeof q!="object"?null:(q=v&&q[v]||q["@@iterator"],typeof q=="function"?q:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,w={};function A(q,F,J){this.props=q,this.context=F,this.refs=w,this.updater=J||y}A.prototype.isReactComponent={},A.prototype.setState=function(q,F){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,F,"setState")},A.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function T(){}T.prototype=A.prototype;function S(q,F,J){this.props=q,this.context=F,this.refs=w,this.updater=J||y}var N=S.prototype=new T;N.constructor=S,_(N,A.prototype),N.isPureReactComponent=!0;var R=Array.isArray;function O(){}var C={H:null,A:null,T:null,S:null},j=Object.prototype.hasOwnProperty;function I(q,F,J){var K=J.ref;return{$$typeof:r,type:q,key:F,ref:K!==void 0?K:null,props:J}}function W(q,F){return I(q.type,F,q.props)}function H(q){return typeof q=="object"&&q!==null&&q.$$typeof===r}function D(q){var F={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(J){return F[J]})}var z=/\/+/g;function ne(q,F){return typeof q=="object"&&q!==null&&q.key!=null?D(""+q.key):F.toString(36)}function re(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(O,O):(q.status="pending",q.then(function(F){q.status==="pending"&&(q.status="fulfilled",q.value=F)},function(F){q.status==="pending"&&(q.status="rejected",q.reason=F)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function U(q,F,J,K,Y){var oe=typeof q;(oe==="undefined"||oe==="boolean")&&(q=null);var ve=!1;if(q===null)ve=!0;else switch(oe){case"bigint":case"string":case"number":ve=!0;break;case"object":switch(q.$$typeof){case r:case e:ve=!0;break;case f:return ve=q._init,U(ve(q._payload),F,J,K,Y)}}if(ve)return Y=Y(q),ve=K===""?"."+ne(q,0):K,R(Y)?(J="",ve!=null&&(J=ve.replace(z,"$&/")+"/"),U(Y,F,J,"",function(Ae){return Ae})):Y!=null&&(H(Y)&&(Y=W(Y,J+(Y.key==null||q&&q.key===Y.key?"":(""+Y.key).replace(z,"$&/")+"/")+ve)),F.push(Y)),1;ve=0;var Ne=K===""?".":K+":";if(R(q))for(var Ee=0;Ee<q.length;Ee++)K=q[Ee],oe=Ne+ne(K,Ee),ve+=U(K,F,J,oe,Y);else if(Ee=x(q),typeof Ee=="function")for(q=Ee.call(q),Ee=0;!(K=q.next()).done;)K=K.value,oe=Ne+ne(K,Ee++),ve+=U(K,F,J,oe,Y);else if(oe==="object"){if(typeof q.then=="function")return U(re(q),F,J,K,Y);throw F=String(q),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.")}return ve}function te(q,F,J){if(q==null)return q;var K=[],Y=0;return U(q,K,"","",function(oe){return F.call(J,oe,Y++)}),K}function be(q){if(q._status===-1){var F=q._result;F=F(),F.then(function(J){(q._status===0||q._status===-1)&&(q._status=1,q._result=J)},function(J){(q._status===0||q._status===-1)&&(q._status=2,q._result=J)}),q._status===-1&&(q._status=0,q._result=F)}if(q._status===1)return q._result.default;throw q._result}var se=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var F=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(F))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)},ke={map:te,forEach:function(q,F,J){te(q,function(){F.apply(this,arguments)},J)},count:function(q){var F=0;return te(q,function(){F++}),F},toArray:function(q){return te(q,function(F){return F})||[]},only:function(q){if(!H(q))throw Error("React.Children.only expected to receive a single React element child.");return q}};return Je.Activity=g,Je.Children=ke,Je.Component=A,Je.Fragment=t,Je.Profiler=s,Je.PureComponent=S,Je.StrictMode=a,Je.Suspense=u,Je.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,Je.__COMPILER_RUNTIME={__proto__:null,c:function(q){return C.H.useMemoCache(q)}},Je.cache=function(q){return function(){return q.apply(null,arguments)}},Je.cacheSignal=function(){return null},Je.cloneElement=function(q,F,J){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var K=_({},q.props),Y=q.key;if(F!=null)for(oe in F.key!==void 0&&(Y=""+F.key),F)!j.call(F,oe)||oe==="key"||oe==="__self"||oe==="__source"||oe==="ref"&&F.ref===void 0||(K[oe]=F[oe]);var oe=arguments.length-2;if(oe===1)K.children=J;else if(1<oe){for(var ve=Array(oe),Ne=0;Ne<oe;Ne++)ve[Ne]=arguments[Ne+2];K.children=ve}return I(q.type,Y,K)},Je.createContext=function(q){return q={$$typeof:o,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:i,_context:q},q},Je.createElement=function(q,F,J){var K,Y={},oe=null;if(F!=null)for(K in F.key!==void 0&&(oe=""+F.key),F)j.call(F,K)&&K!=="key"&&K!=="__self"&&K!=="__source"&&(Y[K]=F[K]);var ve=arguments.length-2;if(ve===1)Y.children=J;else if(1<ve){for(var Ne=Array(ve),Ee=0;Ee<ve;Ee++)Ne[Ee]=arguments[Ee+2];Y.children=Ne}if(q&&q.defaultProps)for(K in ve=q.defaultProps,ve)Y[K]===void 0&&(Y[K]=ve[K]);return I(q,oe,Y)},Je.createRef=function(){return{current:null}},Je.forwardRef=function(q){return{$$typeof:c,render:q}},Je.isValidElement=H,Je.lazy=function(q){return{$$typeof:f,_payload:{_status:-1,_result:q},_init:be}},Je.memo=function(q,F){return{$$typeof:d,type:q,compare:F===void 0?null:F}},Je.startTransition=function(q){var F=C.T,J={};C.T=J;try{var K=q(),Y=C.S;Y!==null&&Y(J,K),typeof K=="object"&&K!==null&&typeof K.then=="function"&&K.then(O,se)}catch(oe){se(oe)}finally{F!==null&&J.types!==null&&(F.types=J.types),C.T=F}},Je.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},Je.use=function(q){return C.H.use(q)},Je.useActionState=function(q,F,J){return C.H.useActionState(q,F,J)},Je.useCallback=function(q,F){return C.H.useCallback(q,F)},Je.useContext=function(q){return C.H.useContext(q)},Je.useDebugValue=function(){},Je.useDeferredValue=function(q,F){return C.H.useDeferredValue(q,F)},Je.useEffect=function(q,F){return C.H.useEffect(q,F)},Je.useEffectEvent=function(q){return C.H.useEffectEvent(q)},Je.useId=function(){return C.H.useId()},Je.useImperativeHandle=function(q,F,J){return C.H.useImperativeHandle(q,F,J)},Je.useInsertionEffect=function(q,F){return C.H.useInsertionEffect(q,F)},Je.useLayoutEffect=function(q,F){return C.H.useLayoutEffect(q,F)},Je.useMemo=function(q,F){return C.H.useMemo(q,F)},Je.useOptimistic=function(q,F){return C.H.useOptimistic(q,F)},Je.useReducer=function(q,F,J){return C.H.useReducer(q,F,J)},Je.useRef=function(q){return C.H.useRef(q)},Je.useState=function(q){return C.H.useState(q)},Je.useSyncExternalStore=function(q,F,J){return C.H.useSyncExternalStore(q,F,J)},Je.useTransition=function(){return C.H.useTransition()},Je.version="19.2.3",Je}var Q_;function sm(){return Q_||(Q_=1,Pp.exports=wT()),Pp.exports}var Q=sm(),Bp={exports:{}},Pc={},Up={exports:{}},zp={};var Z_;function ET(){return Z_||(Z_=1,(function(r){function e(U,te){var be=U.length;U.push(te);e:for(;0<be;){var se=be-1>>>1,ke=U[se];if(0<s(ke,te))U[se]=te,U[be]=ke,be=se;else break e}}function t(U){return U.length===0?null:U[0]}function a(U){if(U.length===0)return null;var te=U[0],be=U.pop();if(be!==te){U[0]=be;e:for(var se=0,ke=U.length,q=ke>>>1;se<q;){var F=2*(se+1)-1,J=U[F],K=F+1,Y=U[K];if(0>s(J,be))K<ke&&0>s(Y,J)?(U[se]=Y,U[K]=be,se=K):(U[se]=J,U[F]=be,se=F);else if(K<ke&&0>s(Y,be))U[se]=Y,U[K]=be,se=K;else break e}}return te}function s(U,te){var be=U.sortIndex-te.sortIndex;return be!==0?be:U.id-te.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();r.unstable_now=function(){return o.now()-c}}var u=[],d=[],f=1,g=null,v=3,x=!1,y=!1,_=!1,w=!1,A=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function N(U){for(var te=t(d);te!==null;){if(te.callback===null)a(d);else if(te.startTime<=U)a(d),te.sortIndex=te.expirationTime,e(u,te);else break;te=t(d)}}function R(U){if(_=!1,N(U),!y)if(t(u)!==null)y=!0,O||(O=!0,D());else{var te=t(d);te!==null&&re(R,te.startTime-U)}}var O=!1,C=-1,j=5,I=-1;function W(){return w?!0:!(r.unstable_now()-I<j)}function H(){if(w=!1,O){var U=r.unstable_now();I=U;var te=!0;try{e:{y=!1,_&&(_=!1,T(C),C=-1),x=!0;var be=v;try{t:{for(N(U),g=t(u);g!==null&&!(g.expirationTime>U&&W());){var se=g.callback;if(typeof se=="function"){g.callback=null,v=g.priorityLevel;var ke=se(g.expirationTime<=U);if(U=r.unstable_now(),typeof ke=="function"){g.callback=ke,N(U),te=!0;break t}g===t(u)&&a(u),N(U)}else a(u);g=t(u)}if(g!==null)te=!0;else{var q=t(d);q!==null&&re(R,q.startTime-U),te=!1}}break e}finally{g=null,v=be,x=!1}te=void 0}}finally{te?D():O=!1}}}var D;if(typeof S=="function")D=function(){S(H)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,ne=z.port2;z.port1.onmessage=H,D=function(){ne.postMessage(null)}}else D=function(){A(H,0)};function re(U,te){C=A(function(){U(r.unstable_now())},te)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(U){U.callback=null},r.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<U?Math.floor(1e3/U):5},r.unstable_getCurrentPriorityLevel=function(){return v},r.unstable_next=function(U){switch(v){case 1:case 2:case 3:var te=3;break;default:te=v}var be=v;v=te;try{return U()}finally{v=be}},r.unstable_requestPaint=function(){w=!0},r.unstable_runWithPriority=function(U,te){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var be=v;v=U;try{return te()}finally{v=be}},r.unstable_scheduleCallback=function(U,te,be){var se=r.unstable_now();switch(typeof be=="object"&&be!==null?(be=be.delay,be=typeof be=="number"&&0<be?se+be:se):be=se,U){case 1:var ke=-1;break;case 2:ke=250;break;case 5:ke=1073741823;break;case 4:ke=1e4;break;default:ke=5e3}return ke=be+ke,U={id:f++,callback:te,priorityLevel:U,startTime:be,expirationTime:ke,sortIndex:-1},be>se?(U.sortIndex=be,e(d,U),t(u)===null&&U===t(d)&&(_?(T(C),C=-1):_=!0,re(R,be-se))):(U.sortIndex=ke,e(u,U),y||x||(y=!0,O||(O=!0,D()))),U},r.unstable_shouldYield=W,r.unstable_wrapCallback=function(U){var te=v;return function(){var be=v;v=te;try{return U.apply(this,arguments)}finally{v=be}}}})(zp)),zp}var ey;function AT(){return ey||(ey=1,Up.exports=ET()),Up.exports}var Hp={exports:{}},ta={};var ty;function ST(){if(ty)return ta;ty=1;var r=sm();function e(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)d+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var a={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function i(u,d,f){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:g==null?null:""+g,children:u,containerInfo:d,implementation:f}}var o=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return ta.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,ta.createPortal=function(u,d){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return i(u,d,null,f)},ta.flushSync=function(u){var d=o.T,f=a.p;try{if(o.T=null,a.p=2,u)return u()}finally{o.T=d,a.p=f,a.d.f()}},ta.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,a.d.C(u,d))},ta.prefetchDNS=function(u){typeof u=="string"&&a.d.D(u)},ta.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var f=d.as,g=c(f,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,x=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;f==="style"?a.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:g,integrity:v,fetchPriority:x}):f==="script"&&a.d.X(u,{crossOrigin:g,integrity:v,fetchPriority:x,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},ta.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var f=c(d.as,d.crossOrigin);a.d.M(u,{crossOrigin:f,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&a.d.M(u)},ta.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var f=d.as,g=c(f,d.crossOrigin);a.d.L(u,f,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},ta.preloadModule=function(u,d){if(typeof u=="string")if(d){var f=c(d.as,d.crossOrigin);a.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:f,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else a.d.m(u)},ta.requestFormReset=function(u){a.d.r(u)},ta.unstable_batchedUpdates=function(u,d){return u(d)},ta.useFormState=function(u,d,f){return o.H.useFormState(u,d,f)},ta.useFormStatus=function(){return o.H.useHostTransitionStatus()},ta.version="19.2.3",ta}var ry;function TT(){if(ry)return Hp.exports;ry=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Hp.exports=ST(),Hp.exports}var ay;function CT(){if(ay)return Pc;ay=1;var r=AT(),e=sm(),t=TT();function a(n){var l="https://react.dev/errors/"+n;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)l+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+n+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function i(n){var l=n,h=n;if(n.alternate)for(;l.return;)l=l.return;else{n=l;do l=n,(l.flags&4098)!==0&&(h=l.return),n=l.return;while(n)}return l.tag===3?h:null}function o(n){if(n.tag===13){var l=n.memoizedState;if(l===null&&(n=n.alternate,n!==null&&(l=n.memoizedState)),l!==null)return l.dehydrated}return null}function c(n){if(n.tag===31){var l=n.memoizedState;if(l===null&&(n=n.alternate,n!==null&&(l=n.memoizedState)),l!==null)return l.dehydrated}return null}function u(n){if(i(n)!==n)throw Error(a(188))}function d(n){var l=n.alternate;if(!l){if(l=i(n),l===null)throw Error(a(188));return l!==n?null:n}for(var h=n,p=l;;){var b=h.return;if(b===null)break;var E=b.alternate;if(E===null){if(p=b.return,p!==null){h=p;continue}break}if(b.child===E.child){for(E=b.child;E;){if(E===h)return u(b),n;if(E===p)return u(b),l;E=E.sibling}throw Error(a(188))}if(h.return!==p.return)h=b,p=E;else{for(var k=!1,L=b.child;L;){if(L===h){k=!0,h=b,p=E;break}if(L===p){k=!0,p=b,h=E;break}L=L.sibling}if(!k){for(L=E.child;L;){if(L===h){k=!0,h=E,p=b;break}if(L===p){k=!0,p=E,h=b;break}L=L.sibling}if(!k)throw Error(a(189))}}if(h.alternate!==p)throw Error(a(190))}if(h.tag!==3)throw Error(a(188));return h.stateNode.current===h?n:l}function f(n){var l=n.tag;if(l===5||l===26||l===27||l===6)return n;for(n=n.child;n!==null;){if(l=f(n),l!==null)return l;n=n.sibling}return null}var g=Object.assign,v=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),T=Symbol.for("react.consumer"),S=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),W=Symbol.for("react.memo_cache_sentinel"),H=Symbol.iterator;function D(n){return n===null||typeof n!="object"?null:(n=H&&n[H]||n["@@iterator"],typeof n=="function"?n:null)}var z=Symbol.for("react.client.reference");function ne(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===z?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case _:return"Fragment";case A:return"Profiler";case w:return"StrictMode";case R:return"Suspense";case O:return"SuspenseList";case I:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case y:return"Portal";case S:return n.displayName||"Context";case T:return(n._context.displayName||"Context")+".Consumer";case N:var l=n.render;return n=n.displayName,n||(n=l.displayName||l.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case C:return l=n.displayName||null,l!==null?l:ne(n.type)||"Memo";case j:l=n._payload,n=n._init;try{return ne(n(l))}catch{}}return null}var re=Array.isArray,U=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,te=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,be={pending:!1,data:null,method:null,action:null},se=[],ke=-1;function q(n){return{current:n}}function F(n){0>ke||(n.current=se[ke],se[ke]=null,ke--)}function J(n,l){ke++,se[ke]=n.current,n.current=l}var K=q(null),Y=q(null),oe=q(null),ve=q(null);function Ne(n,l){switch(J(oe,l),J(Y,n),J(K,null),l.nodeType){case 9:case 11:n=(n=l.documentElement)&&(n=n.namespaceURI)?m_(n):0;break;default:if(n=l.tagName,l=l.namespaceURI)l=m_(l),n=v_(l,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}F(K),J(K,n)}function Ee(){F(K),F(Y),F(oe)}function Ae(n){n.memoizedState!==null&&J(ve,n);var l=K.current,h=v_(l,n.type);l!==h&&(J(Y,n),J(K,h))}function rt(n){Y.current===n&&(F(K),F(Y)),ve.current===n&&(F(ve),Fc._currentValue=be)}var Z,Mt;function at(n){if(Z===void 0)try{throw Error()}catch(h){var l=h.stack.trim().match(/\n( *(at )?)/);Z=l&&l[1]||"",Mt=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Z+n+Mt}var At=!1;function ot(n,l){if(!n||At)return"";At=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(l){var we=function(){throw Error()};if(Object.defineProperty(we.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(we,[])}catch(me){var fe=me}Reflect.construct(n,[],we)}else{try{we.call()}catch(me){fe=me}n.call(we.prototype)}}else{try{throw Error()}catch(me){fe=me}(we=n())&&typeof we.catch=="function"&&we.catch(function(){})}}catch(me){if(me&&fe&&typeof me.stack=="string")return[me.stack,fe.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=p.DetermineComponentFrameRoot(),k=E[0],L=E[1];if(k&&L){var ee=k.split(`
`),ce=L.split(`
`);for(b=p=0;p<ee.length&&!ee[p].includes("DetermineComponentFrameRoot");)p++;for(;b<ce.length&&!ce[b].includes("DetermineComponentFrameRoot");)b++;if(p===ee.length||b===ce.length)for(p=ee.length-1,b=ce.length-1;1<=p&&0<=b&&ee[p]!==ce[b];)b--;for(;1<=p&&0<=b;p--,b--)if(ee[p]!==ce[b]){if(p!==1||b!==1)do if(p--,b--,0>b||ee[p]!==ce[b]){var xe=`
`+ee[p].replace(" at new "," at ");return n.displayName&&xe.includes("<anonymous>")&&(xe=xe.replace("<anonymous>",n.displayName)),xe}while(1<=p&&0<=b);break}}}finally{At=!1,Error.prepareStackTrace=h}return(h=n?n.displayName||n.name:"")?at(h):""}function De(n,l){switch(n.tag){case 26:case 27:case 5:return at(n.type);case 16:return at("Lazy");case 13:return n.child!==l&&l!==null?at("Suspense Fallback"):at("Suspense");case 19:return at("SuspenseList");case 0:case 15:return ot(n.type,!1);case 11:return ot(n.type.render,!1);case 1:return ot(n.type,!0);case 31:return at("Activity");default:return""}}function Yt(n){try{var l="",h=null;do l+=De(n,h),h=n,n=n.return;while(n);return l}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var ea=Object.prototype.hasOwnProperty,_a=r.unstable_scheduleCallback,Fa=r.unstable_cancelCallback,Ai=r.unstable_shouldYield,zs=r.unstable_requestPaint,Lt=r.unstable_now,ws=r.unstable_getCurrentPriorityLevel,Es=r.unstable_ImmediatePriority,jn=r.unstable_UserBlockingPriority,yr=r.unstable_NormalPriority,Qa=r.unstable_LowPriority,lt=r.unstable_IdlePriority,sr=r.log,ya=r.unstable_setDisableYieldValue,Gt=null,gr=null;function As(n){if(typeof sr=="function"&&ya(n),gr&&typeof gr.setStrictMode=="function")try{gr.setStrictMode(Gt,n)}catch{}}var ca=Math.clz32?Math.clz32:Zu,Tf=Math.log,Qu=Math.LN2;function Zu(n){return n>>>=0,n===0?32:31-(Tf(n)/Qu|0)|0}var Si=256,bo=262144,wo=4194304;function Za(n){var l=n&42;if(l!==0)return l;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Eo(n,l,h){var p=n.pendingLanes;if(p===0)return 0;var b=0,E=n.suspendedLanes,k=n.pingedLanes;n=n.warmLanes;var L=p&134217727;return L!==0?(p=L&~E,p!==0?b=Za(p):(k&=L,k!==0?b=Za(k):h||(h=L&~n,h!==0&&(b=Za(h))))):(L=p&~E,L!==0?b=Za(L):k!==0?b=Za(k):h||(h=p&~n,h!==0&&(b=Za(h)))),b===0?0:l!==0&&l!==b&&(l&E)===0&&(E=b&-b,h=l&-l,E>=h||E===32&&(h&4194048)!==0)?l:b}function Ti(n,l){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&l)===0}function Cf(n,l){switch(n){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function eh(){var n=wo;return wo<<=1,(wo&62914560)===0&&(wo=4194304),n}function ql(n){for(var l=[],h=0;31>h;h++)l.push(n);return l}function Ci(n,l){n.pendingLanes|=l,l!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function kf(n,l,h,p,b,E){var k=n.pendingLanes;n.pendingLanes=h,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=h,n.entangledLanes&=h,n.errorRecoveryDisabledLanes&=h,n.shellSuspendCounter=0;var L=n.entanglements,ee=n.expirationTimes,ce=n.hiddenUpdates;for(h=k&~h;0<h;){var xe=31-ca(h),we=1<<xe;L[xe]=0,ee[xe]=-1;var fe=ce[xe];if(fe!==null)for(ce[xe]=null,xe=0;xe<fe.length;xe++){var me=fe[xe];me!==null&&(me.lane&=-536870913)}h&=~we}p!==0&&th(n,p,0),E!==0&&b===0&&n.tag!==0&&(n.suspendedLanes|=E&~(k&~l))}function th(n,l,h){n.pendingLanes|=l,n.suspendedLanes&=~l;var p=31-ca(l);n.entangledLanes|=l,n.entanglements[p]=n.entanglements[p]|1073741824|h&261930}function Ao(n,l){var h=n.entangledLanes|=l;for(n=n.entanglements;h;){var p=31-ca(h),b=1<<p;b&l|n[p]&l&&(n[p]|=l),h&=~b}}function rh(n,l){var h=l&-l;return h=(h&42)!==0?1:Wl(h),(h&(n.suspendedLanes|l))!==0?0:h}function Wl(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Xl(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function M(){var n=te.p;return n!==0?n:(n=window.event,n===void 0?32:U_(n.type))}function V(n,l){var h=te.p;try{return te.p=n,l()}finally{te.p=h}}var P=Math.random().toString(36).slice(2),B="__reactFiber$"+P,G="__reactProps$"+P,X="__reactContainer$"+P,ue="__reactEvents$"+P,_e="__reactListeners$"+P,he="__reactHandles$"+P,de="__reactResources$"+P,pe="__reactMarker$"+P;function Se(n){delete n[B],delete n[G],delete n[ue],delete n[_e],delete n[he]}function Re(n){var l=n[B];if(l)return l;for(var h=n.parentNode;h;){if(l=h[X]||h[B]){if(h=l.alternate,l.child!==null||h!==null&&h.child!==null)for(n=A_(n);n!==null;){if(h=n[B])return h;n=A_(n)}return l}n=h,h=n.parentNode}return null}function Fe(n){if(n=n[B]||n[X]){var l=n.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return n}return null}function Ce(n){var l=n.tag;if(l===5||l===26||l===27||l===6)return n.stateNode;throw Error(a(33))}function Oe(n){var l=n[de];return l||(l=n[de]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Pe(n){n[pe]=!0}var Ut=new Set,zt={};function Kt(n,l){es(n,l),es(n+"Capture",l)}function es(n,l){for(zt[n]=l,n=0;n<l.length;n++)Ut.add(l[n])}var ki=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Pn={},Hs={};function Yl(n){return ea.call(Hs,n)?!0:ea.call(Pn,n)?!1:ki.test(n)?Hs[n]=!0:(Pn[n]=!0,!1)}function ba(n,l,h){if(Yl(l))if(h===null)n.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":n.removeAttribute(l);return;case"boolean":var p=l.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){n.removeAttribute(l);return}}n.setAttribute(l,""+h)}}function ah(n,l,h){if(h===null)n.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(l);return}n.setAttribute(l,""+h)}}function nn(n,l,h,p){if(p===null)n.removeAttribute(h);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(h);return}n.setAttributeNS(l,h,""+p)}}function ts(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function lv(n){var l=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function f2(n,l,h){var p=Object.getOwnPropertyDescriptor(n.constructor.prototype,l);if(!n.hasOwnProperty(l)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var b=p.get,E=p.set;return Object.defineProperty(n,l,{configurable:!0,get:function(){return b.call(this)},set:function(k){h=""+k,E.call(this,k)}}),Object.defineProperty(n,l,{enumerable:p.enumerable}),{getValue:function(){return h},setValue:function(k){h=""+k},stopTracking:function(){n._valueTracker=null,delete n[l]}}}}function Nf(n){if(!n._valueTracker){var l=lv(n)?"checked":"value";n._valueTracker=f2(n,l,""+n[l])}}function cv(n){if(!n)return!1;var l=n._valueTracker;if(!l)return!0;var h=l.getValue(),p="";return n&&(p=lv(n)?n.checked?"true":"false":n.value),n=p,n!==h?(l.setValue(n),!0):!1}function sh(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var p2=/[\n"\\]/g;function rs(n){return n.replace(p2,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Rf(n,l,h,p,b,E,k,L){n.name="",k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?n.type=k:n.removeAttribute("type"),l!=null?k==="number"?(l===0&&n.value===""||n.value!=l)&&(n.value=""+ts(l)):n.value!==""+ts(l)&&(n.value=""+ts(l)):k!=="submit"&&k!=="reset"||n.removeAttribute("value"),l!=null?Of(n,k,ts(l)):h!=null?Of(n,k,ts(h)):p!=null&&n.removeAttribute("value"),b==null&&E!=null&&(n.defaultChecked=!!E),b!=null&&(n.checked=b&&typeof b!="function"&&typeof b!="symbol"),L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?n.name=""+ts(L):n.removeAttribute("name")}function uv(n,l,h,p,b,E,k,L){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(n.type=E),l!=null||h!=null){if(!(E!=="submit"&&E!=="reset"||l!=null)){Nf(n);return}h=h!=null?""+ts(h):"",l=l!=null?""+ts(l):h,L||l===n.value||(n.value=l),n.defaultValue=l}p=p??b,p=typeof p!="function"&&typeof p!="symbol"&&!!p,n.checked=L?n.checked:!!p,n.defaultChecked=!!p,k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(n.name=k),Nf(n)}function Of(n,l,h){l==="number"&&sh(n.ownerDocument)===n||n.defaultValue===""+h||(n.defaultValue=""+h)}function So(n,l,h,p){if(n=n.options,l){l={};for(var b=0;b<h.length;b++)l["$"+h[b]]=!0;for(h=0;h<n.length;h++)b=l.hasOwnProperty("$"+n[h].value),n[h].selected!==b&&(n[h].selected=b),b&&p&&(n[h].defaultSelected=!0)}else{for(h=""+ts(h),l=null,b=0;b<n.length;b++){if(n[b].value===h){n[b].selected=!0,p&&(n[b].defaultSelected=!0);return}l!==null||n[b].disabled||(l=n[b])}l!==null&&(l.selected=!0)}}function hv(n,l,h){if(l!=null&&(l=""+ts(l),l!==n.value&&(n.value=l),h==null)){n.defaultValue!==l&&(n.defaultValue=l);return}n.defaultValue=h!=null?""+ts(h):""}function dv(n,l,h,p){if(l==null){if(p!=null){if(h!=null)throw Error(a(92));if(re(p)){if(1<p.length)throw Error(a(93));p=p[0]}h=p}h==null&&(h=""),l=h}h=ts(l),n.defaultValue=h,p=n.textContent,p===h&&p!==""&&p!==null&&(n.value=p),Nf(n)}function To(n,l){if(l){var h=n.firstChild;if(h&&h===n.lastChild&&h.nodeType===3){h.nodeValue=l;return}}n.textContent=l}var g2=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function fv(n,l,h){var p=l.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?p?n.setProperty(l,""):l==="float"?n.cssFloat="":n[l]="":p?n.setProperty(l,h):typeof h!="number"||h===0||g2.has(l)?l==="float"?n.cssFloat=h:n[l]=(""+h).trim():n[l]=h+"px"}function pv(n,l,h){if(l!=null&&typeof l!="object")throw Error(a(62));if(n=n.style,h!=null){for(var p in h)!h.hasOwnProperty(p)||l!=null&&l.hasOwnProperty(p)||(p.indexOf("--")===0?n.setProperty(p,""):p==="float"?n.cssFloat="":n[p]="");for(var b in l)p=l[b],l.hasOwnProperty(b)&&h[b]!==p&&fv(n,b,p)}else for(var E in l)l.hasOwnProperty(E)&&fv(n,E,l[E])}function Df(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var m2=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),v2=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function nh(n){return v2.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function on(){}var Ff=null;function Mf(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Co=null,ko=null;function gv(n){var l=Fe(n);if(l&&(n=l.stateNode)){var h=n[G]||null;e:switch(n=l.stateNode,l.type){case"input":if(Rf(n,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),l=h.name,h.type==="radio"&&l!=null){for(h=n;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+rs(""+l)+'"][type="radio"]'),l=0;l<h.length;l++){var p=h[l];if(p!==n&&p.form===n.form){var b=p[G]||null;if(!b)throw Error(a(90));Rf(p,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(l=0;l<h.length;l++)p=h[l],p.form===n.form&&cv(p)}break e;case"textarea":hv(n,h.value,h.defaultValue);break e;case"select":l=h.value,l!=null&&So(n,!!h.multiple,l,!1)}}}var Lf=!1;function mv(n,l,h){if(Lf)return n(l,h);Lf=!0;try{var p=n(l);return p}finally{if(Lf=!1,(Co!==null||ko!==null)&&(qh(),Co&&(l=Co,n=ko,ko=Co=null,gv(l),n)))for(l=0;l<n.length;l++)gv(n[l])}}function Kl(n,l){var h=n.stateNode;if(h===null)return null;var p=h[G]||null;if(p===null)return null;h=p[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(n=n.type,p=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!p;break e;default:n=!1}if(n)return null;if(h&&typeof h!="function")throw Error(a(231,l,typeof h));return h}var ln=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),If=!1;if(ln)try{var Jl={};Object.defineProperty(Jl,"passive",{get:function(){If=!0}}),window.addEventListener("test",Jl,Jl),window.removeEventListener("test",Jl,Jl)}catch{If=!1}var Bn=null,jf=null,ih=null;function vv(){if(ih)return ih;var n,l=jf,h=l.length,p,b="value"in Bn?Bn.value:Bn.textContent,E=b.length;for(n=0;n<h&&l[n]===b[n];n++);var k=h-n;for(p=1;p<=k&&l[h-p]===b[E-p];p++);return ih=b.slice(n,1<p?1-p:void 0)}function oh(n){var l=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&l===13&&(n=13)):n=l,n===10&&(n=13),32<=n||n===13?n:0}function lh(){return!0}function xv(){return!1}function wa(n){function l(h,p,b,E,k){this._reactName=h,this._targetInst=b,this.type=p,this.nativeEvent=E,this.target=k,this.currentTarget=null;for(var L in n)n.hasOwnProperty(L)&&(h=n[L],this[L]=h?h(E):E[L]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?lh:xv,this.isPropagationStopped=xv,this}return g(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=lh)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=lh)},persist:function(){},isPersistent:lh}),l}var Ni={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ch=wa(Ni),Ql=g({},Ni,{view:0,detail:0}),x2=wa(Ql),Pf,Bf,Zl,uh=g({},Ql,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zf,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Zl&&(Zl&&n.type==="mousemove"?(Pf=n.screenX-Zl.screenX,Bf=n.screenY-Zl.screenY):Bf=Pf=0,Zl=n),Pf)},movementY:function(n){return"movementY"in n?n.movementY:Bf}}),_v=wa(uh),_2=g({},uh,{dataTransfer:0}),y2=wa(_2),b2=g({},Ql,{relatedTarget:0}),Uf=wa(b2),w2=g({},Ni,{animationName:0,elapsedTime:0,pseudoElement:0}),E2=wa(w2),A2=g({},Ni,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),S2=wa(A2),T2=g({},Ni,{data:0}),yv=wa(T2),C2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},k2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},N2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function R2(n){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(n):(n=N2[n])?!!l[n]:!1}function zf(){return R2}var O2=g({},Ql,{key:function(n){if(n.key){var l=C2[n.key]||n.key;if(l!=="Unidentified")return l}return n.type==="keypress"?(n=oh(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?k2[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zf,charCode:function(n){return n.type==="keypress"?oh(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?oh(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),D2=wa(O2),F2=g({},uh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bv=wa(F2),M2=g({},Ql,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zf}),L2=wa(M2),I2=g({},Ni,{propertyName:0,elapsedTime:0,pseudoElement:0}),j2=wa(I2),P2=g({},uh,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),B2=wa(P2),U2=g({},Ni,{newState:0,oldState:0}),z2=wa(U2),H2=[9,13,27,32],Hf=ln&&"CompositionEvent"in window,ec=null;ln&&"documentMode"in document&&(ec=document.documentMode);var $2=ln&&"TextEvent"in window&&!ec,wv=ln&&(!Hf||ec&&8<ec&&11>=ec),Ev=" ",Av=!1;function Sv(n,l){switch(n){case"keyup":return H2.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tv(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var No=!1;function G2(n,l){switch(n){case"compositionend":return Tv(l);case"keypress":return l.which!==32?null:(Av=!0,Ev);case"textInput":return n=l.data,n===Ev&&Av?null:n;default:return null}}function V2(n,l){if(No)return n==="compositionend"||!Hf&&Sv(n,l)?(n=vv(),ih=jf=Bn=null,No=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return wv&&l.locale!=="ko"?null:l.data;default:return null}}var q2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cv(n){var l=n&&n.nodeName&&n.nodeName.toLowerCase();return l==="input"?!!q2[n.type]:l==="textarea"}function kv(n,l,h,p){Co?ko?ko.push(p):ko=[p]:Co=p,l=Zh(l,"onChange"),0<l.length&&(h=new ch("onChange","change",null,h,p),n.push({event:h,listeners:l}))}var tc=null,rc=null;function W2(n){u_(n,0)}function hh(n){var l=Ce(n);if(cv(l))return n}function Nv(n,l){if(n==="change")return l}var Rv=!1;if(ln){var $f;if(ln){var Gf="oninput"in document;if(!Gf){var Ov=document.createElement("div");Ov.setAttribute("oninput","return;"),Gf=typeof Ov.oninput=="function"}$f=Gf}else $f=!1;Rv=$f&&(!document.documentMode||9<document.documentMode)}function Dv(){tc&&(tc.detachEvent("onpropertychange",Fv),rc=tc=null)}function Fv(n){if(n.propertyName==="value"&&hh(rc)){var l=[];kv(l,rc,n,Mf(n)),mv(W2,l)}}function X2(n,l,h){n==="focusin"?(Dv(),tc=l,rc=h,tc.attachEvent("onpropertychange",Fv)):n==="focusout"&&Dv()}function Y2(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return hh(rc)}function K2(n,l){if(n==="click")return hh(l)}function J2(n,l){if(n==="input"||n==="change")return hh(l)}function Q2(n,l){return n===l&&(n!==0||1/n===1/l)||n!==n&&l!==l}var Ma=typeof Object.is=="function"?Object.is:Q2;function ac(n,l){if(Ma(n,l))return!0;if(typeof n!="object"||n===null||typeof l!="object"||l===null)return!1;var h=Object.keys(n),p=Object.keys(l);if(h.length!==p.length)return!1;for(p=0;p<h.length;p++){var b=h[p];if(!ea.call(l,b)||!Ma(n[b],l[b]))return!1}return!0}function Mv(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Lv(n,l){var h=Mv(n);n=0;for(var p;h;){if(h.nodeType===3){if(p=n+h.textContent.length,n<=l&&p>=l)return{node:h,offset:l-n};n=p}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Mv(h)}}function Iv(n,l){return n&&l?n===l?!0:n&&n.nodeType===3?!1:l&&l.nodeType===3?Iv(n,l.parentNode):"contains"in n?n.contains(l):n.compareDocumentPosition?!!(n.compareDocumentPosition(l)&16):!1:!1}function jv(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var l=sh(n.document);l instanceof n.HTMLIFrameElement;){try{var h=typeof l.contentWindow.location.href=="string"}catch{h=!1}if(h)n=l.contentWindow;else break;l=sh(n.document)}return l}function Vf(n){var l=n&&n.nodeName&&n.nodeName.toLowerCase();return l&&(l==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||l==="textarea"||n.contentEditable==="true")}var Z2=ln&&"documentMode"in document&&11>=document.documentMode,Ro=null,qf=null,sc=null,Wf=!1;function Pv(n,l,h){var p=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Wf||Ro==null||Ro!==sh(p)||(p=Ro,"selectionStart"in p&&Vf(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),sc&&ac(sc,p)||(sc=p,p=Zh(qf,"onSelect"),0<p.length&&(l=new ch("onSelect","select",null,l,h),n.push({event:l,listeners:p}),l.target=Ro)))}function Ri(n,l){var h={};return h[n.toLowerCase()]=l.toLowerCase(),h["Webkit"+n]="webkit"+l,h["Moz"+n]="moz"+l,h}var Oo={animationend:Ri("Animation","AnimationEnd"),animationiteration:Ri("Animation","AnimationIteration"),animationstart:Ri("Animation","AnimationStart"),transitionrun:Ri("Transition","TransitionRun"),transitionstart:Ri("Transition","TransitionStart"),transitioncancel:Ri("Transition","TransitionCancel"),transitionend:Ri("Transition","TransitionEnd")},Xf={},Bv={};ln&&(Bv=document.createElement("div").style,"AnimationEvent"in window||(delete Oo.animationend.animation,delete Oo.animationiteration.animation,delete Oo.animationstart.animation),"TransitionEvent"in window||delete Oo.transitionend.transition);function Oi(n){if(Xf[n])return Xf[n];if(!Oo[n])return n;var l=Oo[n],h;for(h in l)if(l.hasOwnProperty(h)&&h in Bv)return Xf[n]=l[h];return n}var Uv=Oi("animationend"),zv=Oi("animationiteration"),Hv=Oi("animationstart"),eS=Oi("transitionrun"),tS=Oi("transitionstart"),rS=Oi("transitioncancel"),$v=Oi("transitionend"),Gv=new Map,Yf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Yf.push("scrollEnd");function Ss(n,l){Gv.set(n,l),Kt(l,[n])}var dh=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},as=[],Do=0,Kf=0;function fh(){for(var n=Do,l=Kf=Do=0;l<n;){var h=as[l];as[l++]=null;var p=as[l];as[l++]=null;var b=as[l];as[l++]=null;var E=as[l];if(as[l++]=null,p!==null&&b!==null){var k=p.pending;k===null?b.next=b:(b.next=k.next,k.next=b),p.pending=b}E!==0&&Vv(h,b,E)}}function ph(n,l,h,p){as[Do++]=n,as[Do++]=l,as[Do++]=h,as[Do++]=p,Kf|=p,n.lanes|=p,n=n.alternate,n!==null&&(n.lanes|=p)}function Jf(n,l,h,p){return ph(n,l,h,p),gh(n)}function Di(n,l){return ph(n,null,null,l),gh(n)}function Vv(n,l,h){n.lanes|=h;var p=n.alternate;p!==null&&(p.lanes|=h);for(var b=!1,E=n.return;E!==null;)E.childLanes|=h,p=E.alternate,p!==null&&(p.childLanes|=h),E.tag===22&&(n=E.stateNode,n===null||n._visibility&1||(b=!0)),n=E,E=E.return;return n.tag===3?(E=n.stateNode,b&&l!==null&&(b=31-ca(h),n=E.hiddenUpdates,p=n[b],p===null?n[b]=[l]:p.push(l),l.lane=h|536870912),E):null}function gh(n){if(50<Tc)throw Tc=0,ip=null,Error(a(185));for(var l=n.return;l!==null;)n=l,l=n.return;return n.tag===3?n.stateNode:null}var Fo={};function aS(n,l,h,p){this.tag=n,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function La(n,l,h,p){return new aS(n,l,h,p)}function Qf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function cn(n,l){var h=n.alternate;return h===null?(h=La(n.tag,l,n.key,n.mode),h.elementType=n.elementType,h.type=n.type,h.stateNode=n.stateNode,h.alternate=n,n.alternate=h):(h.pendingProps=l,h.type=n.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=n.flags&65011712,h.childLanes=n.childLanes,h.lanes=n.lanes,h.child=n.child,h.memoizedProps=n.memoizedProps,h.memoizedState=n.memoizedState,h.updateQueue=n.updateQueue,l=n.dependencies,h.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},h.sibling=n.sibling,h.index=n.index,h.ref=n.ref,h.refCleanup=n.refCleanup,h}function qv(n,l){n.flags&=65011714;var h=n.alternate;return h===null?(n.childLanes=0,n.lanes=l,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=h.childLanes,n.lanes=h.lanes,n.child=h.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=h.memoizedProps,n.memoizedState=h.memoizedState,n.updateQueue=h.updateQueue,n.type=h.type,l=h.dependencies,n.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),n}function mh(n,l,h,p,b,E){var k=0;if(p=n,typeof n=="function")Qf(n)&&(k=1);else if(typeof n=="string")k=lT(n,h,K.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case I:return n=La(31,h,l,b),n.elementType=I,n.lanes=E,n;case _:return Fi(h.children,b,E,l);case w:k=8,b|=24;break;case A:return n=La(12,h,l,b|2),n.elementType=A,n.lanes=E,n;case R:return n=La(13,h,l,b),n.elementType=R,n.lanes=E,n;case O:return n=La(19,h,l,b),n.elementType=O,n.lanes=E,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case S:k=10;break e;case T:k=9;break e;case N:k=11;break e;case C:k=14;break e;case j:k=16,p=null;break e}k=29,h=Error(a(130,n===null?"null":typeof n,"")),p=null}return l=La(k,h,l,b),l.elementType=n,l.type=p,l.lanes=E,l}function Fi(n,l,h,p){return n=La(7,n,p,l),n.lanes=h,n}function Zf(n,l,h){return n=La(6,n,null,l),n.lanes=h,n}function Wv(n){var l=La(18,null,null,0);return l.stateNode=n,l}function e0(n,l,h){return l=La(4,n.children!==null?n.children:[],n.key,l),l.lanes=h,l.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},l}var Xv=new WeakMap;function ss(n,l){if(typeof n=="object"&&n!==null){var h=Xv.get(n);return h!==void 0?h:(l={value:n,source:l,stack:Yt(l)},Xv.set(n,l),l)}return{value:n,source:l,stack:Yt(l)}}var Mo=[],Lo=0,vh=null,nc=0,ns=[],is=0,Un=null,$s=1,Gs="";function un(n,l){Mo[Lo++]=nc,Mo[Lo++]=vh,vh=n,nc=l}function Yv(n,l,h){ns[is++]=$s,ns[is++]=Gs,ns[is++]=Un,Un=n;var p=$s;n=Gs;var b=32-ca(p)-1;p&=~(1<<b),h+=1;var E=32-ca(l)+b;if(30<E){var k=b-b%5;E=(p&(1<<k)-1).toString(32),p>>=k,b-=k,$s=1<<32-ca(l)+b|h<<b|p,Gs=E+n}else $s=1<<E|h<<b|p,Gs=n}function t0(n){n.return!==null&&(un(n,1),Yv(n,1,0))}function r0(n){for(;n===vh;)vh=Mo[--Lo],Mo[Lo]=null,nc=Mo[--Lo],Mo[Lo]=null;for(;n===Un;)Un=ns[--is],ns[is]=null,Gs=ns[--is],ns[is]=null,$s=ns[--is],ns[is]=null}function Kv(n,l){ns[is++]=$s,ns[is++]=Gs,ns[is++]=Un,$s=l.id,Gs=l.overflow,Un=n}var $r=null,Vt=null,pt=!1,zn=null,os=!1,a0=Error(a(519));function Hn(n){var l=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ic(ss(l,n)),a0}function Jv(n){var l=n.stateNode,h=n.type,p=n.memoizedProps;switch(l[B]=n,l[G]=p,h){case"dialog":ht("cancel",l),ht("close",l);break;case"iframe":case"object":case"embed":ht("load",l);break;case"video":case"audio":for(h=0;h<kc.length;h++)ht(kc[h],l);break;case"source":ht("error",l);break;case"img":case"image":case"link":ht("error",l),ht("load",l);break;case"details":ht("toggle",l);break;case"input":ht("invalid",l),uv(l,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":ht("invalid",l);break;case"textarea":ht("invalid",l),dv(l,p.value,p.defaultValue,p.children)}h=p.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||l.textContent===""+h||p.suppressHydrationWarning===!0||p_(l.textContent,h)?(p.popover!=null&&(ht("beforetoggle",l),ht("toggle",l)),p.onScroll!=null&&ht("scroll",l),p.onScrollEnd!=null&&ht("scrollend",l),p.onClick!=null&&(l.onclick=on),l=!0):l=!1,l||Hn(n,!0)}function Qv(n){for($r=n.return;$r;)switch($r.tag){case 5:case 31:case 13:os=!1;return;case 27:case 3:os=!0;return;default:$r=$r.return}}function Io(n){if(n!==$r)return!1;if(!pt)return Qv(n),pt=!0,!1;var l=n.tag,h;if((h=l!==3&&l!==27)&&((h=l===5)&&(h=n.type,h=!(h!=="form"&&h!=="button")||bp(n.type,n.memoizedProps)),h=!h),h&&Vt&&Hn(n),Qv(n),l===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));Vt=E_(n)}else if(l===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));Vt=E_(n)}else l===27?(l=Vt,ri(n.type)?(n=Tp,Tp=null,Vt=n):Vt=l):Vt=$r?cs(n.stateNode.nextSibling):null;return!0}function Mi(){Vt=$r=null,pt=!1}function s0(){var n=zn;return n!==null&&(Ta===null?Ta=n:Ta.push.apply(Ta,n),zn=null),n}function ic(n){zn===null?zn=[n]:zn.push(n)}var n0=q(null),Li=null,hn=null;function $n(n,l,h){J(n0,l._currentValue),l._currentValue=h}function dn(n){n._currentValue=n0.current,F(n0)}function i0(n,l,h){for(;n!==null;){var p=n.alternate;if((n.childLanes&l)!==l?(n.childLanes|=l,p!==null&&(p.childLanes|=l)):p!==null&&(p.childLanes&l)!==l&&(p.childLanes|=l),n===h)break;n=n.return}}function o0(n,l,h,p){var b=n.child;for(b!==null&&(b.return=n);b!==null;){var E=b.dependencies;if(E!==null){var k=b.child;E=E.firstContext;e:for(;E!==null;){var L=E;E=b;for(var ee=0;ee<l.length;ee++)if(L.context===l[ee]){E.lanes|=h,L=E.alternate,L!==null&&(L.lanes|=h),i0(E.return,h,n),p||(k=null);break e}E=L.next}}else if(b.tag===18){if(k=b.return,k===null)throw Error(a(341));k.lanes|=h,E=k.alternate,E!==null&&(E.lanes|=h),i0(k,h,n),k=null}else k=b.child;if(k!==null)k.return=b;else for(k=b;k!==null;){if(k===n){k=null;break}if(b=k.sibling,b!==null){b.return=k.return,k=b;break}k=k.return}b=k}}function jo(n,l,h,p){n=null;for(var b=l,E=!1;b!==null;){if(!E){if((b.flags&524288)!==0)E=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var k=b.alternate;if(k===null)throw Error(a(387));if(k=k.memoizedProps,k!==null){var L=b.type;Ma(b.pendingProps.value,k.value)||(n!==null?n.push(L):n=[L])}}else if(b===ve.current){if(k=b.alternate,k===null)throw Error(a(387));k.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(n!==null?n.push(Fc):n=[Fc])}b=b.return}n!==null&&o0(l,n,h,p),l.flags|=262144}function xh(n){for(n=n.firstContext;n!==null;){if(!Ma(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Ii(n){Li=n,hn=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Gr(n){return Zv(Li,n)}function _h(n,l){return Li===null&&Ii(n),Zv(n,l)}function Zv(n,l){var h=l._currentValue;if(l={context:l,memoizedValue:h,next:null},hn===null){if(n===null)throw Error(a(308));hn=l,n.dependencies={lanes:0,firstContext:l},n.flags|=524288}else hn=hn.next=l;return h}var sS=typeof AbortController<"u"?AbortController:function(){var n=[],l=this.signal={aborted:!1,addEventListener:function(h,p){n.push(p)}};this.abort=function(){l.aborted=!0,n.forEach(function(h){return h()})}},nS=r.unstable_scheduleCallback,iS=r.unstable_NormalPriority,br={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function l0(){return{controller:new sS,data:new Map,refCount:0}}function oc(n){n.refCount--,n.refCount===0&&nS(iS,function(){n.controller.abort()})}var lc=null,c0=0,Po=0,Bo=null;function oS(n,l){if(lc===null){var h=lc=[];c0=0,Po=dp(),Bo={status:"pending",value:void 0,then:function(p){h.push(p)}}}return c0++,l.then(e1,e1),l}function e1(){if(--c0===0&&lc!==null){Bo!==null&&(Bo.status="fulfilled");var n=lc;lc=null,Po=0,Bo=null;for(var l=0;l<n.length;l++)(0,n[l])()}}function lS(n,l){var h=[],p={status:"pending",value:null,reason:null,then:function(b){h.push(b)}};return n.then(function(){p.status="fulfilled",p.value=l;for(var b=0;b<h.length;b++)(0,h[b])(l)},function(b){for(p.status="rejected",p.reason=b,b=0;b<h.length;b++)(0,h[b])(void 0)}),p}var t1=U.S;U.S=function(n,l){Px=Lt(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&oS(n,l),t1!==null&&t1(n,l)};var ji=q(null);function u0(){var n=ji.current;return n!==null?n:It.pooledCache}function yh(n,l){l===null?J(ji,ji.current):J(ji,l.pool)}function r1(){var n=u0();return n===null?null:{parent:br._currentValue,pool:n}}var Uo=Error(a(460)),h0=Error(a(474)),bh=Error(a(542)),wh={then:function(){}};function a1(n){return n=n.status,n==="fulfilled"||n==="rejected"}function s1(n,l,h){switch(h=n[h],h===void 0?n.push(l):h!==l&&(l.then(on,on),l=h),l.status){case"fulfilled":return l.value;case"rejected":throw n=l.reason,i1(n),n;default:if(typeof l.status=="string")l.then(on,on);else{if(n=It,n!==null&&100<n.shellSuspendCounter)throw Error(a(482));n=l,n.status="pending",n.then(function(p){if(l.status==="pending"){var b=l;b.status="fulfilled",b.value=p}},function(p){if(l.status==="pending"){var b=l;b.status="rejected",b.reason=p}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw n=l.reason,i1(n),n}throw Bi=l,Uo}}function Pi(n){try{var l=n._init;return l(n._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?(Bi=h,Uo):h}}var Bi=null;function n1(){if(Bi===null)throw Error(a(459));var n=Bi;return Bi=null,n}function i1(n){if(n===Uo||n===bh)throw Error(a(483))}var zo=null,cc=0;function Eh(n){var l=cc;return cc+=1,zo===null&&(zo=[]),s1(zo,n,l)}function uc(n,l){l=l.props.ref,n.ref=l!==void 0?l:null}function Ah(n,l){throw l.$$typeof===v?Error(a(525)):(n=Object.prototype.toString.call(l),Error(a(31,n==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":n)))}function o1(n){function l(ie,ae){if(n){var le=ie.deletions;le===null?(ie.deletions=[ae],ie.flags|=16):le.push(ae)}}function h(ie,ae){if(!n)return null;for(;ae!==null;)l(ie,ae),ae=ae.sibling;return null}function p(ie){for(var ae=new Map;ie!==null;)ie.key!==null?ae.set(ie.key,ie):ae.set(ie.index,ie),ie=ie.sibling;return ae}function b(ie,ae){return ie=cn(ie,ae),ie.index=0,ie.sibling=null,ie}function E(ie,ae,le){return ie.index=le,n?(le=ie.alternate,le!==null?(le=le.index,le<ae?(ie.flags|=67108866,ae):le):(ie.flags|=67108866,ae)):(ie.flags|=1048576,ae)}function k(ie){return n&&ie.alternate===null&&(ie.flags|=67108866),ie}function L(ie,ae,le,ye){return ae===null||ae.tag!==6?(ae=Zf(le,ie.mode,ye),ae.return=ie,ae):(ae=b(ae,le),ae.return=ie,ae)}function ee(ie,ae,le,ye){var $e=le.type;return $e===_?xe(ie,ae,le.props.children,ye,le.key):ae!==null&&(ae.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===j&&Pi($e)===ae.type)?(ae=b(ae,le.props),uc(ae,le),ae.return=ie,ae):(ae=mh(le.type,le.key,le.props,null,ie.mode,ye),uc(ae,le),ae.return=ie,ae)}function ce(ie,ae,le,ye){return ae===null||ae.tag!==4||ae.stateNode.containerInfo!==le.containerInfo||ae.stateNode.implementation!==le.implementation?(ae=e0(le,ie.mode,ye),ae.return=ie,ae):(ae=b(ae,le.children||[]),ae.return=ie,ae)}function xe(ie,ae,le,ye,$e){return ae===null||ae.tag!==7?(ae=Fi(le,ie.mode,ye,$e),ae.return=ie,ae):(ae=b(ae,le),ae.return=ie,ae)}function we(ie,ae,le){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return ae=Zf(""+ae,ie.mode,le),ae.return=ie,ae;if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case x:return le=mh(ae.type,ae.key,ae.props,null,ie.mode,le),uc(le,ae),le.return=ie,le;case y:return ae=e0(ae,ie.mode,le),ae.return=ie,ae;case j:return ae=Pi(ae),we(ie,ae,le)}if(re(ae)||D(ae))return ae=Fi(ae,ie.mode,le,null),ae.return=ie,ae;if(typeof ae.then=="function")return we(ie,Eh(ae),le);if(ae.$$typeof===S)return we(ie,_h(ie,ae),le);Ah(ie,ae)}return null}function fe(ie,ae,le,ye){var $e=ae!==null?ae.key:null;if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return $e!==null?null:L(ie,ae,""+le,ye);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case x:return le.key===$e?ee(ie,ae,le,ye):null;case y:return le.key===$e?ce(ie,ae,le,ye):null;case j:return le=Pi(le),fe(ie,ae,le,ye)}if(re(le)||D(le))return $e!==null?null:xe(ie,ae,le,ye,null);if(typeof le.then=="function")return fe(ie,ae,Eh(le),ye);if(le.$$typeof===S)return fe(ie,ae,_h(ie,le),ye);Ah(ie,le)}return null}function me(ie,ae,le,ye,$e){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return ie=ie.get(le)||null,L(ae,ie,""+ye,$e);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case x:return ie=ie.get(ye.key===null?le:ye.key)||null,ee(ae,ie,ye,$e);case y:return ie=ie.get(ye.key===null?le:ye.key)||null,ce(ae,ie,ye,$e);case j:return ye=Pi(ye),me(ie,ae,le,ye,$e)}if(re(ye)||D(ye))return ie=ie.get(le)||null,xe(ae,ie,ye,$e,null);if(typeof ye.then=="function")return me(ie,ae,le,Eh(ye),$e);if(ye.$$typeof===S)return me(ie,ae,le,_h(ae,ye),$e);Ah(ae,ye)}return null}function je(ie,ae,le,ye){for(var $e=null,bt=null,Be=ae,ct=ae=0,ft=null;Be!==null&&ct<le.length;ct++){Be.index>ct?(ft=Be,Be=null):ft=Be.sibling;var wt=fe(ie,Be,le[ct],ye);if(wt===null){Be===null&&(Be=ft);break}n&&Be&&wt.alternate===null&&l(ie,Be),ae=E(wt,ae,ct),bt===null?$e=wt:bt.sibling=wt,bt=wt,Be=ft}if(ct===le.length)return h(ie,Be),pt&&un(ie,ct),$e;if(Be===null){for(;ct<le.length;ct++)Be=we(ie,le[ct],ye),Be!==null&&(ae=E(Be,ae,ct),bt===null?$e=Be:bt.sibling=Be,bt=Be);return pt&&un(ie,ct),$e}for(Be=p(Be);ct<le.length;ct++)ft=me(Be,ie,ct,le[ct],ye),ft!==null&&(n&&ft.alternate!==null&&Be.delete(ft.key===null?ct:ft.key),ae=E(ft,ae,ct),bt===null?$e=ft:bt.sibling=ft,bt=ft);return n&&Be.forEach(function(oi){return l(ie,oi)}),pt&&un(ie,ct),$e}function We(ie,ae,le,ye){if(le==null)throw Error(a(151));for(var $e=null,bt=null,Be=ae,ct=ae=0,ft=null,wt=le.next();Be!==null&&!wt.done;ct++,wt=le.next()){Be.index>ct?(ft=Be,Be=null):ft=Be.sibling;var oi=fe(ie,Be,wt.value,ye);if(oi===null){Be===null&&(Be=ft);break}n&&Be&&oi.alternate===null&&l(ie,Be),ae=E(oi,ae,ct),bt===null?$e=oi:bt.sibling=oi,bt=oi,Be=ft}if(wt.done)return h(ie,Be),pt&&un(ie,ct),$e;if(Be===null){for(;!wt.done;ct++,wt=le.next())wt=we(ie,wt.value,ye),wt!==null&&(ae=E(wt,ae,ct),bt===null?$e=wt:bt.sibling=wt,bt=wt);return pt&&un(ie,ct),$e}for(Be=p(Be);!wt.done;ct++,wt=le.next())wt=me(Be,ie,ct,wt.value,ye),wt!==null&&(n&&wt.alternate!==null&&Be.delete(wt.key===null?ct:wt.key),ae=E(wt,ae,ct),bt===null?$e=wt:bt.sibling=wt,bt=wt);return n&&Be.forEach(function(_T){return l(ie,_T)}),pt&&un(ie,ct),$e}function Dt(ie,ae,le,ye){if(typeof le=="object"&&le!==null&&le.type===_&&le.key===null&&(le=le.props.children),typeof le=="object"&&le!==null){switch(le.$$typeof){case x:e:{for(var $e=le.key;ae!==null;){if(ae.key===$e){if($e=le.type,$e===_){if(ae.tag===7){h(ie,ae.sibling),ye=b(ae,le.props.children),ye.return=ie,ie=ye;break e}}else if(ae.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===j&&Pi($e)===ae.type){h(ie,ae.sibling),ye=b(ae,le.props),uc(ye,le),ye.return=ie,ie=ye;break e}h(ie,ae);break}else l(ie,ae);ae=ae.sibling}le.type===_?(ye=Fi(le.props.children,ie.mode,ye,le.key),ye.return=ie,ie=ye):(ye=mh(le.type,le.key,le.props,null,ie.mode,ye),uc(ye,le),ye.return=ie,ie=ye)}return k(ie);case y:e:{for($e=le.key;ae!==null;){if(ae.key===$e)if(ae.tag===4&&ae.stateNode.containerInfo===le.containerInfo&&ae.stateNode.implementation===le.implementation){h(ie,ae.sibling),ye=b(ae,le.children||[]),ye.return=ie,ie=ye;break e}else{h(ie,ae);break}else l(ie,ae);ae=ae.sibling}ye=e0(le,ie.mode,ye),ye.return=ie,ie=ye}return k(ie);case j:return le=Pi(le),Dt(ie,ae,le,ye)}if(re(le))return je(ie,ae,le,ye);if(D(le)){if($e=D(le),typeof $e!="function")throw Error(a(150));return le=$e.call(le),We(ie,ae,le,ye)}if(typeof le.then=="function")return Dt(ie,ae,Eh(le),ye);if(le.$$typeof===S)return Dt(ie,ae,_h(ie,le),ye);Ah(ie,le)}return typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint"?(le=""+le,ae!==null&&ae.tag===6?(h(ie,ae.sibling),ye=b(ae,le),ye.return=ie,ie=ye):(h(ie,ae),ye=Zf(le,ie.mode,ye),ye.return=ie,ie=ye),k(ie)):h(ie,ae)}return function(ie,ae,le,ye){try{cc=0;var $e=Dt(ie,ae,le,ye);return zo=null,$e}catch(Be){if(Be===Uo||Be===bh)throw Be;var bt=La(29,Be,null,ie.mode);return bt.lanes=ye,bt.return=ie,bt}}}var Ui=o1(!0),l1=o1(!1),Gn=!1;function d0(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function f0(n,l){n=n.updateQueue,l.updateQueue===n&&(l.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Vn(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function qn(n,l,h){var p=n.updateQueue;if(p===null)return null;if(p=p.shared,(St&2)!==0){var b=p.pending;return b===null?l.next=l:(l.next=b.next,b.next=l),p.pending=l,l=gh(n),Vv(n,null,h),l}return ph(n,p,l,h),gh(n)}function hc(n,l,h){if(l=l.updateQueue,l!==null&&(l=l.shared,(h&4194048)!==0)){var p=l.lanes;p&=n.pendingLanes,h|=p,l.lanes=h,Ao(n,h)}}function p0(n,l){var h=n.updateQueue,p=n.alternate;if(p!==null&&(p=p.updateQueue,h===p)){var b=null,E=null;if(h=h.firstBaseUpdate,h!==null){do{var k={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};E===null?b=E=k:E=E.next=k,h=h.next}while(h!==null);E===null?b=E=l:E=E.next=l}else b=E=l;h={baseState:p.baseState,firstBaseUpdate:b,lastBaseUpdate:E,shared:p.shared,callbacks:p.callbacks},n.updateQueue=h;return}n=h.lastBaseUpdate,n===null?h.firstBaseUpdate=l:n.next=l,h.lastBaseUpdate=l}var g0=!1;function dc(){if(g0){var n=Bo;if(n!==null)throw n}}function fc(n,l,h,p){g0=!1;var b=n.updateQueue;Gn=!1;var E=b.firstBaseUpdate,k=b.lastBaseUpdate,L=b.shared.pending;if(L!==null){b.shared.pending=null;var ee=L,ce=ee.next;ee.next=null,k===null?E=ce:k.next=ce,k=ee;var xe=n.alternate;xe!==null&&(xe=xe.updateQueue,L=xe.lastBaseUpdate,L!==k&&(L===null?xe.firstBaseUpdate=ce:L.next=ce,xe.lastBaseUpdate=ee))}if(E!==null){var we=b.baseState;k=0,xe=ce=ee=null,L=E;do{var fe=L.lane&-536870913,me=fe!==L.lane;if(me?(dt&fe)===fe:(p&fe)===fe){fe!==0&&fe===Po&&(g0=!0),xe!==null&&(xe=xe.next={lane:0,tag:L.tag,payload:L.payload,callback:null,next:null});e:{var je=n,We=L;fe=l;var Dt=h;switch(We.tag){case 1:if(je=We.payload,typeof je=="function"){we=je.call(Dt,we,fe);break e}we=je;break e;case 3:je.flags=je.flags&-65537|128;case 0:if(je=We.payload,fe=typeof je=="function"?je.call(Dt,we,fe):je,fe==null)break e;we=g({},we,fe);break e;case 2:Gn=!0}}fe=L.callback,fe!==null&&(n.flags|=64,me&&(n.flags|=8192),me=b.callbacks,me===null?b.callbacks=[fe]:me.push(fe))}else me={lane:fe,tag:L.tag,payload:L.payload,callback:L.callback,next:null},xe===null?(ce=xe=me,ee=we):xe=xe.next=me,k|=fe;if(L=L.next,L===null){if(L=b.shared.pending,L===null)break;me=L,L=me.next,me.next=null,b.lastBaseUpdate=me,b.shared.pending=null}}while(!0);xe===null&&(ee=we),b.baseState=ee,b.firstBaseUpdate=ce,b.lastBaseUpdate=xe,E===null&&(b.shared.lanes=0),Jn|=k,n.lanes=k,n.memoizedState=we}}function c1(n,l){if(typeof n!="function")throw Error(a(191,n));n.call(l)}function u1(n,l){var h=n.callbacks;if(h!==null)for(n.callbacks=null,n=0;n<h.length;n++)c1(h[n],l)}var Ho=q(null),Sh=q(0);function h1(n,l){n=bn,J(Sh,n),J(Ho,l),bn=n|l.baseLanes}function m0(){J(Sh,bn),J(Ho,Ho.current)}function v0(){bn=Sh.current,F(Ho),F(Sh)}var Ia=q(null),ls=null;function Wn(n){var l=n.alternate;J(mr,mr.current&1),J(Ia,n),ls===null&&(l===null||Ho.current!==null||l.memoizedState!==null)&&(ls=n)}function x0(n){J(mr,mr.current),J(Ia,n),ls===null&&(ls=n)}function d1(n){n.tag===22?(J(mr,mr.current),J(Ia,n),ls===null&&(ls=n)):Xn()}function Xn(){J(mr,mr.current),J(Ia,Ia.current)}function ja(n){F(Ia),ls===n&&(ls=null),F(mr)}var mr=q(0);function Th(n){for(var l=n;l!==null;){if(l.tag===13){var h=l.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||Ap(h)||Sp(h)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===n)break;for(;l.sibling===null;){if(l.return===null||l.return===n)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var fn=0,st=null,Rt=null,wr=null,Ch=!1,$o=!1,zi=!1,kh=0,pc=0,Go=null,cS=0;function cr(){throw Error(a(321))}function _0(n,l){if(l===null)return!1;for(var h=0;h<l.length&&h<n.length;h++)if(!Ma(n[h],l[h]))return!1;return!0}function y0(n,l,h,p,b,E){return fn=E,st=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,U.H=n===null||n.memoizedState===null?Y1:L0,zi=!1,E=h(p,b),zi=!1,$o&&(E=p1(l,h,p,b)),f1(n),E}function f1(n){U.H=vc;var l=Rt!==null&&Rt.next!==null;if(fn=0,wr=Rt=st=null,Ch=!1,pc=0,Go=null,l)throw Error(a(300));n===null||Er||(n=n.dependencies,n!==null&&xh(n)&&(Er=!0))}function p1(n,l,h,p){st=n;var b=0;do{if($o&&(Go=null),pc=0,$o=!1,25<=b)throw Error(a(301));if(b+=1,wr=Rt=null,n.updateQueue!=null){var E=n.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}U.H=K1,E=l(h,p)}while($o);return E}function uS(){var n=U.H,l=n.useState()[0];return l=typeof l.then=="function"?gc(l):l,n=n.useState()[0],(Rt!==null?Rt.memoizedState:null)!==n&&(st.flags|=1024),l}function b0(){var n=kh!==0;return kh=0,n}function w0(n,l,h){l.updateQueue=n.updateQueue,l.flags&=-2053,n.lanes&=~h}function E0(n){if(Ch){for(n=n.memoizedState;n!==null;){var l=n.queue;l!==null&&(l.pending=null),n=n.next}Ch=!1}fn=0,wr=Rt=st=null,$o=!1,pc=kh=0,Go=null}function ua(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wr===null?st.memoizedState=wr=n:wr=wr.next=n,wr}function vr(){if(Rt===null){var n=st.alternate;n=n!==null?n.memoizedState:null}else n=Rt.next;var l=wr===null?st.memoizedState:wr.next;if(l!==null)wr=l,Rt=n;else{if(n===null)throw st.alternate===null?Error(a(467)):Error(a(310));Rt=n,n={memoizedState:Rt.memoizedState,baseState:Rt.baseState,baseQueue:Rt.baseQueue,queue:Rt.queue,next:null},wr===null?st.memoizedState=wr=n:wr=wr.next=n}return wr}function Nh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function gc(n){var l=pc;return pc+=1,Go===null&&(Go=[]),n=s1(Go,n,l),l=st,(wr===null?l.memoizedState:wr.next)===null&&(l=l.alternate,U.H=l===null||l.memoizedState===null?Y1:L0),n}function Rh(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return gc(n);if(n.$$typeof===S)return Gr(n)}throw Error(a(438,String(n)))}function A0(n){var l=null,h=st.updateQueue;if(h!==null&&(l=h.memoCache),l==null){var p=st.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(l={data:p.data.map(function(b){return b.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),h===null&&(h=Nh(),st.updateQueue=h),h.memoCache=l,h=l.data[l.index],h===void 0)for(h=l.data[l.index]=Array(n),p=0;p<n;p++)h[p]=W;return l.index++,h}function pn(n,l){return typeof l=="function"?l(n):l}function Oh(n){var l=vr();return S0(l,Rt,n)}function S0(n,l,h){var p=n.queue;if(p===null)throw Error(a(311));p.lastRenderedReducer=h;var b=n.baseQueue,E=p.pending;if(E!==null){if(b!==null){var k=b.next;b.next=E.next,E.next=k}l.baseQueue=b=E,p.pending=null}if(E=n.baseState,b===null)n.memoizedState=E;else{l=b.next;var L=k=null,ee=null,ce=l,xe=!1;do{var we=ce.lane&-536870913;if(we!==ce.lane?(dt&we)===we:(fn&we)===we){var fe=ce.revertLane;if(fe===0)ee!==null&&(ee=ee.next={lane:0,revertLane:0,gesture:null,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null}),we===Po&&(xe=!0);else if((fn&fe)===fe){ce=ce.next,fe===Po&&(xe=!0);continue}else we={lane:0,revertLane:ce.revertLane,gesture:null,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},ee===null?(L=ee=we,k=E):ee=ee.next=we,st.lanes|=fe,Jn|=fe;we=ce.action,zi&&h(E,we),E=ce.hasEagerState?ce.eagerState:h(E,we)}else fe={lane:we,revertLane:ce.revertLane,gesture:ce.gesture,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},ee===null?(L=ee=fe,k=E):ee=ee.next=fe,st.lanes|=we,Jn|=we;ce=ce.next}while(ce!==null&&ce!==l);if(ee===null?k=E:ee.next=L,!Ma(E,n.memoizedState)&&(Er=!0,xe&&(h=Bo,h!==null)))throw h;n.memoizedState=E,n.baseState=k,n.baseQueue=ee,p.lastRenderedState=E}return b===null&&(p.lanes=0),[n.memoizedState,p.dispatch]}function T0(n){var l=vr(),h=l.queue;if(h===null)throw Error(a(311));h.lastRenderedReducer=n;var p=h.dispatch,b=h.pending,E=l.memoizedState;if(b!==null){h.pending=null;var k=b=b.next;do E=n(E,k.action),k=k.next;while(k!==b);Ma(E,l.memoizedState)||(Er=!0),l.memoizedState=E,l.baseQueue===null&&(l.baseState=E),h.lastRenderedState=E}return[E,p]}function g1(n,l,h){var p=st,b=vr(),E=pt;if(E){if(h===void 0)throw Error(a(407));h=h()}else h=l();var k=!Ma((Rt||b).memoizedState,h);if(k&&(b.memoizedState=h,Er=!0),b=b.queue,N0(x1.bind(null,p,b,n),[n]),b.getSnapshot!==l||k||wr!==null&&wr.memoizedState.tag&1){if(p.flags|=2048,Vo(9,{destroy:void 0},v1.bind(null,p,b,h,l),null),It===null)throw Error(a(349));E||(fn&127)!==0||m1(p,l,h)}return h}function m1(n,l,h){n.flags|=16384,n={getSnapshot:l,value:h},l=st.updateQueue,l===null?(l=Nh(),st.updateQueue=l,l.stores=[n]):(h=l.stores,h===null?l.stores=[n]:h.push(n))}function v1(n,l,h,p){l.value=h,l.getSnapshot=p,_1(l)&&y1(n)}function x1(n,l,h){return h(function(){_1(l)&&y1(n)})}function _1(n){var l=n.getSnapshot;n=n.value;try{var h=l();return!Ma(n,h)}catch{return!0}}function y1(n){var l=Di(n,2);l!==null&&Ca(l,n,2)}function C0(n){var l=ua();if(typeof n=="function"){var h=n;if(n=h(),zi){As(!0);try{h()}finally{As(!1)}}}return l.memoizedState=l.baseState=n,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:pn,lastRenderedState:n},l}function b1(n,l,h,p){return n.baseState=h,S0(n,Rt,typeof p=="function"?p:pn)}function hS(n,l,h,p,b){if(Mh(n))throw Error(a(485));if(n=l.action,n!==null){var E={payload:b,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(k){E.listeners.push(k)}};U.T!==null?h(!0):E.isTransition=!1,p(E),h=l.pending,h===null?(E.next=l.pending=E,w1(l,E)):(E.next=h.next,l.pending=h.next=E)}}function w1(n,l){var h=l.action,p=l.payload,b=n.state;if(l.isTransition){var E=U.T,k={};U.T=k;try{var L=h(b,p),ee=U.S;ee!==null&&ee(k,L),E1(n,l,L)}catch(ce){k0(n,l,ce)}finally{E!==null&&k.types!==null&&(E.types=k.types),U.T=E}}else try{E=h(b,p),E1(n,l,E)}catch(ce){k0(n,l,ce)}}function E1(n,l,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(p){A1(n,l,p)},function(p){return k0(n,l,p)}):A1(n,l,h)}function A1(n,l,h){l.status="fulfilled",l.value=h,S1(l),n.state=h,l=n.pending,l!==null&&(h=l.next,h===l?n.pending=null:(h=h.next,l.next=h,w1(n,h)))}function k0(n,l,h){var p=n.pending;if(n.pending=null,p!==null){p=p.next;do l.status="rejected",l.reason=h,S1(l),l=l.next;while(l!==p)}n.action=null}function S1(n){n=n.listeners;for(var l=0;l<n.length;l++)(0,n[l])()}function T1(n,l){return l}function C1(n,l){if(pt){var h=It.formState;if(h!==null){e:{var p=st;if(pt){if(Vt){t:{for(var b=Vt,E=os;b.nodeType!==8;){if(!E){b=null;break t}if(b=cs(b.nextSibling),b===null){b=null;break t}}E=b.data,b=E==="F!"||E==="F"?b:null}if(b){Vt=cs(b.nextSibling),p=b.data==="F!";break e}}Hn(p)}p=!1}p&&(l=h[0])}}return h=ua(),h.memoizedState=h.baseState=l,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:T1,lastRenderedState:l},h.queue=p,h=q1.bind(null,st,p),p.dispatch=h,p=C0(!1),E=M0.bind(null,st,!1,p.queue),p=ua(),b={state:l,dispatch:null,action:n,pending:null},p.queue=b,h=hS.bind(null,st,b,E,h),b.dispatch=h,p.memoizedState=n,[l,h,!1]}function k1(n){var l=vr();return N1(l,Rt,n)}function N1(n,l,h){if(l=S0(n,l,T1)[0],n=Oh(pn)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var p=gc(l)}catch(k){throw k===Uo?bh:k}else p=l;l=vr();var b=l.queue,E=b.dispatch;return h!==l.memoizedState&&(st.flags|=2048,Vo(9,{destroy:void 0},dS.bind(null,b,h),null)),[p,E,n]}function dS(n,l){n.action=l}function R1(n){var l=vr(),h=Rt;if(h!==null)return N1(l,h,n);vr(),l=l.memoizedState,h=vr();var p=h.queue.dispatch;return h.memoizedState=n,[l,p,!1]}function Vo(n,l,h,p){return n={tag:n,create:h,deps:p,inst:l,next:null},l=st.updateQueue,l===null&&(l=Nh(),st.updateQueue=l),h=l.lastEffect,h===null?l.lastEffect=n.next=n:(p=h.next,h.next=n,n.next=p,l.lastEffect=n),n}function O1(){return vr().memoizedState}function Dh(n,l,h,p){var b=ua();st.flags|=n,b.memoizedState=Vo(1|l,{destroy:void 0},h,p===void 0?null:p)}function Fh(n,l,h,p){var b=vr();p=p===void 0?null:p;var E=b.memoizedState.inst;Rt!==null&&p!==null&&_0(p,Rt.memoizedState.deps)?b.memoizedState=Vo(l,E,h,p):(st.flags|=n,b.memoizedState=Vo(1|l,E,h,p))}function D1(n,l){Dh(8390656,8,n,l)}function N0(n,l){Fh(2048,8,n,l)}function fS(n){st.flags|=4;var l=st.updateQueue;if(l===null)l=Nh(),st.updateQueue=l,l.events=[n];else{var h=l.events;h===null?l.events=[n]:h.push(n)}}function F1(n){var l=vr().memoizedState;return fS({ref:l,nextImpl:n}),function(){if((St&2)!==0)throw Error(a(440));return l.impl.apply(void 0,arguments)}}function M1(n,l){return Fh(4,2,n,l)}function L1(n,l){return Fh(4,4,n,l)}function I1(n,l){if(typeof l=="function"){n=n();var h=l(n);return function(){typeof h=="function"?h():l(null)}}if(l!=null)return n=n(),l.current=n,function(){l.current=null}}function j1(n,l,h){h=h!=null?h.concat([n]):null,Fh(4,4,I1.bind(null,l,n),h)}function R0(){}function P1(n,l){var h=vr();l=l===void 0?null:l;var p=h.memoizedState;return l!==null&&_0(l,p[1])?p[0]:(h.memoizedState=[n,l],n)}function B1(n,l){var h=vr();l=l===void 0?null:l;var p=h.memoizedState;if(l!==null&&_0(l,p[1]))return p[0];if(p=n(),zi){As(!0);try{n()}finally{As(!1)}}return h.memoizedState=[p,l],p}function O0(n,l,h){return h===void 0||(fn&1073741824)!==0&&(dt&261930)===0?n.memoizedState=l:(n.memoizedState=h,n=Ux(),st.lanes|=n,Jn|=n,h)}function U1(n,l,h,p){return Ma(h,l)?h:Ho.current!==null?(n=O0(n,h,p),Ma(n,l)||(Er=!0),n):(fn&42)===0||(fn&1073741824)!==0&&(dt&261930)===0?(Er=!0,n.memoizedState=h):(n=Ux(),st.lanes|=n,Jn|=n,l)}function z1(n,l,h,p,b){var E=te.p;te.p=E!==0&&8>E?E:8;var k=U.T,L={};U.T=L,M0(n,!1,l,h);try{var ee=b(),ce=U.S;if(ce!==null&&ce(L,ee),ee!==null&&typeof ee=="object"&&typeof ee.then=="function"){var xe=lS(ee,p);mc(n,l,xe,Ua(n))}else mc(n,l,p,Ua(n))}catch(we){mc(n,l,{then:function(){},status:"rejected",reason:we},Ua())}finally{te.p=E,k!==null&&L.types!==null&&(k.types=L.types),U.T=k}}function pS(){}function D0(n,l,h,p){if(n.tag!==5)throw Error(a(476));var b=H1(n).queue;z1(n,b,l,be,h===null?pS:function(){return $1(n),h(p)})}function H1(n){var l=n.memoizedState;if(l!==null)return l;l={memoizedState:be,baseState:be,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:pn,lastRenderedState:be},next:null};var h={};return l.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:pn,lastRenderedState:h},next:null},n.memoizedState=l,n=n.alternate,n!==null&&(n.memoizedState=l),l}function $1(n){var l=H1(n);l.next===null&&(l=n.alternate.memoizedState),mc(n,l.next.queue,{},Ua())}function F0(){return Gr(Fc)}function G1(){return vr().memoizedState}function V1(){return vr().memoizedState}function gS(n){for(var l=n.return;l!==null;){switch(l.tag){case 24:case 3:var h=Ua();n=Vn(h);var p=qn(l,n,h);p!==null&&(Ca(p,l,h),hc(p,l,h)),l={cache:l0()},n.payload=l;return}l=l.return}}function mS(n,l,h){var p=Ua();h={lane:p,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Mh(n)?W1(l,h):(h=Jf(n,l,h,p),h!==null&&(Ca(h,n,p),X1(h,l,p)))}function q1(n,l,h){var p=Ua();mc(n,l,h,p)}function mc(n,l,h,p){var b={lane:p,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(Mh(n))W1(l,b);else{var E=n.alternate;if(n.lanes===0&&(E===null||E.lanes===0)&&(E=l.lastRenderedReducer,E!==null))try{var k=l.lastRenderedState,L=E(k,h);if(b.hasEagerState=!0,b.eagerState=L,Ma(L,k))return ph(n,l,b,0),It===null&&fh(),!1}catch{}if(h=Jf(n,l,b,p),h!==null)return Ca(h,n,p),X1(h,l,p),!0}return!1}function M0(n,l,h,p){if(p={lane:2,revertLane:dp(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Mh(n)){if(l)throw Error(a(479))}else l=Jf(n,h,p,2),l!==null&&Ca(l,n,2)}function Mh(n){var l=n.alternate;return n===st||l!==null&&l===st}function W1(n,l){$o=Ch=!0;var h=n.pending;h===null?l.next=l:(l.next=h.next,h.next=l),n.pending=l}function X1(n,l,h){if((h&4194048)!==0){var p=l.lanes;p&=n.pendingLanes,h|=p,l.lanes=h,Ao(n,h)}}var vc={readContext:Gr,use:Rh,useCallback:cr,useContext:cr,useEffect:cr,useImperativeHandle:cr,useLayoutEffect:cr,useInsertionEffect:cr,useMemo:cr,useReducer:cr,useRef:cr,useState:cr,useDebugValue:cr,useDeferredValue:cr,useTransition:cr,useSyncExternalStore:cr,useId:cr,useHostTransitionStatus:cr,useFormState:cr,useActionState:cr,useOptimistic:cr,useMemoCache:cr,useCacheRefresh:cr};vc.useEffectEvent=cr;var Y1={readContext:Gr,use:Rh,useCallback:function(n,l){return ua().memoizedState=[n,l===void 0?null:l],n},useContext:Gr,useEffect:D1,useImperativeHandle:function(n,l,h){h=h!=null?h.concat([n]):null,Dh(4194308,4,I1.bind(null,l,n),h)},useLayoutEffect:function(n,l){return Dh(4194308,4,n,l)},useInsertionEffect:function(n,l){Dh(4,2,n,l)},useMemo:function(n,l){var h=ua();l=l===void 0?null:l;var p=n();if(zi){As(!0);try{n()}finally{As(!1)}}return h.memoizedState=[p,l],p},useReducer:function(n,l,h){var p=ua();if(h!==void 0){var b=h(l);if(zi){As(!0);try{h(l)}finally{As(!1)}}}else b=l;return p.memoizedState=p.baseState=b,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:b},p.queue=n,n=n.dispatch=mS.bind(null,st,n),[p.memoizedState,n]},useRef:function(n){var l=ua();return n={current:n},l.memoizedState=n},useState:function(n){n=C0(n);var l=n.queue,h=q1.bind(null,st,l);return l.dispatch=h,[n.memoizedState,h]},useDebugValue:R0,useDeferredValue:function(n,l){var h=ua();return O0(h,n,l)},useTransition:function(){var n=C0(!1);return n=z1.bind(null,st,n.queue,!0,!1),ua().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,l,h){var p=st,b=ua();if(pt){if(h===void 0)throw Error(a(407));h=h()}else{if(h=l(),It===null)throw Error(a(349));(dt&127)!==0||m1(p,l,h)}b.memoizedState=h;var E={value:h,getSnapshot:l};return b.queue=E,D1(x1.bind(null,p,E,n),[n]),p.flags|=2048,Vo(9,{destroy:void 0},v1.bind(null,p,E,h,l),null),h},useId:function(){var n=ua(),l=It.identifierPrefix;if(pt){var h=Gs,p=$s;h=(p&~(1<<32-ca(p)-1)).toString(32)+h,l="_"+l+"R_"+h,h=kh++,0<h&&(l+="H"+h.toString(32)),l+="_"}else h=cS++,l="_"+l+"r_"+h.toString(32)+"_";return n.memoizedState=l},useHostTransitionStatus:F0,useFormState:C1,useActionState:C1,useOptimistic:function(n){var l=ua();l.memoizedState=l.baseState=n;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=h,l=M0.bind(null,st,!0,h),h.dispatch=l,[n,l]},useMemoCache:A0,useCacheRefresh:function(){return ua().memoizedState=gS.bind(null,st)},useEffectEvent:function(n){var l=ua(),h={impl:n};return l.memoizedState=h,function(){if((St&2)!==0)throw Error(a(440));return h.impl.apply(void 0,arguments)}}},L0={readContext:Gr,use:Rh,useCallback:P1,useContext:Gr,useEffect:N0,useImperativeHandle:j1,useInsertionEffect:M1,useLayoutEffect:L1,useMemo:B1,useReducer:Oh,useRef:O1,useState:function(){return Oh(pn)},useDebugValue:R0,useDeferredValue:function(n,l){var h=vr();return U1(h,Rt.memoizedState,n,l)},useTransition:function(){var n=Oh(pn)[0],l=vr().memoizedState;return[typeof n=="boolean"?n:gc(n),l]},useSyncExternalStore:g1,useId:G1,useHostTransitionStatus:F0,useFormState:k1,useActionState:k1,useOptimistic:function(n,l){var h=vr();return b1(h,Rt,n,l)},useMemoCache:A0,useCacheRefresh:V1};L0.useEffectEvent=F1;var K1={readContext:Gr,use:Rh,useCallback:P1,useContext:Gr,useEffect:N0,useImperativeHandle:j1,useInsertionEffect:M1,useLayoutEffect:L1,useMemo:B1,useReducer:T0,useRef:O1,useState:function(){return T0(pn)},useDebugValue:R0,useDeferredValue:function(n,l){var h=vr();return Rt===null?O0(h,n,l):U1(h,Rt.memoizedState,n,l)},useTransition:function(){var n=T0(pn)[0],l=vr().memoizedState;return[typeof n=="boolean"?n:gc(n),l]},useSyncExternalStore:g1,useId:G1,useHostTransitionStatus:F0,useFormState:R1,useActionState:R1,useOptimistic:function(n,l){var h=vr();return Rt!==null?b1(h,Rt,n,l):(h.baseState=n,[n,h.queue.dispatch])},useMemoCache:A0,useCacheRefresh:V1};K1.useEffectEvent=F1;function I0(n,l,h,p){l=n.memoizedState,h=h(p,l),h=h==null?l:g({},l,h),n.memoizedState=h,n.lanes===0&&(n.updateQueue.baseState=h)}var j0={enqueueSetState:function(n,l,h){n=n._reactInternals;var p=Ua(),b=Vn(p);b.payload=l,h!=null&&(b.callback=h),l=qn(n,b,p),l!==null&&(Ca(l,n,p),hc(l,n,p))},enqueueReplaceState:function(n,l,h){n=n._reactInternals;var p=Ua(),b=Vn(p);b.tag=1,b.payload=l,h!=null&&(b.callback=h),l=qn(n,b,p),l!==null&&(Ca(l,n,p),hc(l,n,p))},enqueueForceUpdate:function(n,l){n=n._reactInternals;var h=Ua(),p=Vn(h);p.tag=2,l!=null&&(p.callback=l),l=qn(n,p,h),l!==null&&(Ca(l,n,h),hc(l,n,h))}};function J1(n,l,h,p,b,E,k){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(p,E,k):l.prototype&&l.prototype.isPureReactComponent?!ac(h,p)||!ac(b,E):!0}function Q1(n,l,h,p){n=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(h,p),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(h,p),l.state!==n&&j0.enqueueReplaceState(l,l.state,null)}function Hi(n,l){var h=l;if("ref"in l){h={};for(var p in l)p!=="ref"&&(h[p]=l[p])}if(n=n.defaultProps){h===l&&(h=g({},h));for(var b in n)h[b]===void 0&&(h[b]=n[b])}return h}function Z1(n){dh(n)}function ex(n){console.error(n)}function tx(n){dh(n)}function Lh(n,l){try{var h=n.onUncaughtError;h(l.value,{componentStack:l.stack})}catch(p){setTimeout(function(){throw p})}}function rx(n,l,h){try{var p=n.onCaughtError;p(h.value,{componentStack:h.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function P0(n,l,h){return h=Vn(h),h.tag=3,h.payload={element:null},h.callback=function(){Lh(n,l)},h}function ax(n){return n=Vn(n),n.tag=3,n}function sx(n,l,h,p){var b=h.type.getDerivedStateFromError;if(typeof b=="function"){var E=p.value;n.payload=function(){return b(E)},n.callback=function(){rx(l,h,p)}}var k=h.stateNode;k!==null&&typeof k.componentDidCatch=="function"&&(n.callback=function(){rx(l,h,p),typeof b!="function"&&(Qn===null?Qn=new Set([this]):Qn.add(this));var L=p.stack;this.componentDidCatch(p.value,{componentStack:L!==null?L:""})})}function vS(n,l,h,p,b){if(h.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(l=h.alternate,l!==null&&jo(l,h,b,!0),h=Ia.current,h!==null){switch(h.tag){case 31:case 13:return ls===null?Wh():h.alternate===null&&ur===0&&(ur=3),h.flags&=-257,h.flags|=65536,h.lanes=b,p===wh?h.flags|=16384:(l=h.updateQueue,l===null?h.updateQueue=new Set([p]):l.add(p),cp(n,p,b)),!1;case 22:return h.flags|=65536,p===wh?h.flags|=16384:(l=h.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([p])},h.updateQueue=l):(h=l.retryQueue,h===null?l.retryQueue=new Set([p]):h.add(p)),cp(n,p,b)),!1}throw Error(a(435,h.tag))}return cp(n,p,b),Wh(),!1}if(pt)return l=Ia.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=b,p!==a0&&(n=Error(a(422),{cause:p}),ic(ss(n,h)))):(p!==a0&&(l=Error(a(423),{cause:p}),ic(ss(l,h))),n=n.current.alternate,n.flags|=65536,b&=-b,n.lanes|=b,p=ss(p,h),b=P0(n.stateNode,p,b),p0(n,b),ur!==4&&(ur=2)),!1;var E=Error(a(520),{cause:p});if(E=ss(E,h),Sc===null?Sc=[E]:Sc.push(E),ur!==4&&(ur=2),l===null)return!0;p=ss(p,h),h=l;do{switch(h.tag){case 3:return h.flags|=65536,n=b&-b,h.lanes|=n,n=P0(h.stateNode,p,n),p0(h,n),!1;case 1:if(l=h.type,E=h.stateNode,(h.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Qn===null||!Qn.has(E))))return h.flags|=65536,b&=-b,h.lanes|=b,b=ax(b),sx(b,n,h,p),p0(h,b),!1}h=h.return}while(h!==null);return!1}var B0=Error(a(461)),Er=!1;function Vr(n,l,h,p){l.child=n===null?l1(l,null,h,p):Ui(l,n.child,h,p)}function nx(n,l,h,p,b){h=h.render;var E=l.ref;if("ref"in p){var k={};for(var L in p)L!=="ref"&&(k[L]=p[L])}else k=p;return Ii(l),p=y0(n,l,h,k,E,b),L=b0(),n!==null&&!Er?(w0(n,l,b),gn(n,l,b)):(pt&&L&&t0(l),l.flags|=1,Vr(n,l,p,b),l.child)}function ix(n,l,h,p,b){if(n===null){var E=h.type;return typeof E=="function"&&!Qf(E)&&E.defaultProps===void 0&&h.compare===null?(l.tag=15,l.type=E,ox(n,l,E,p,b)):(n=mh(h.type,null,p,l,l.mode,b),n.ref=l.ref,n.return=l,l.child=n)}if(E=n.child,!W0(n,b)){var k=E.memoizedProps;if(h=h.compare,h=h!==null?h:ac,h(k,p)&&n.ref===l.ref)return gn(n,l,b)}return l.flags|=1,n=cn(E,p),n.ref=l.ref,n.return=l,l.child=n}function ox(n,l,h,p,b){if(n!==null){var E=n.memoizedProps;if(ac(E,p)&&n.ref===l.ref)if(Er=!1,l.pendingProps=p=E,W0(n,b))(n.flags&131072)!==0&&(Er=!0);else return l.lanes=n.lanes,gn(n,l,b)}return U0(n,l,h,p,b)}function lx(n,l,h,p){var b=p.children,E=n!==null?n.memoizedState:null;if(n===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((l.flags&128)!==0){if(E=E!==null?E.baseLanes|h:h,n!==null){for(p=l.child=n.child,b=0;p!==null;)b=b|p.lanes|p.childLanes,p=p.sibling;p=b&~E}else p=0,l.child=null;return cx(n,l,E,h,p)}if((h&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},n!==null&&yh(l,E!==null?E.cachePool:null),E!==null?h1(l,E):m0(),d1(l);else return p=l.lanes=536870912,cx(n,l,E!==null?E.baseLanes|h:h,h,p)}else E!==null?(yh(l,E.cachePool),h1(l,E),Xn(),l.memoizedState=null):(n!==null&&yh(l,null),m0(),Xn());return Vr(n,l,b,h),l.child}function xc(n,l){return n!==null&&n.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function cx(n,l,h,p,b){var E=u0();return E=E===null?null:{parent:br._currentValue,pool:E},l.memoizedState={baseLanes:h,cachePool:E},n!==null&&yh(l,null),m0(),d1(l),n!==null&&jo(n,l,p,!0),l.childLanes=b,null}function Ih(n,l){return l=Ph({mode:l.mode,children:l.children},n.mode),l.ref=n.ref,n.child=l,l.return=n,l}function ux(n,l,h){return Ui(l,n.child,null,h),n=Ih(l,l.pendingProps),n.flags|=2,ja(l),l.memoizedState=null,n}function xS(n,l,h){var p=l.pendingProps,b=(l.flags&128)!==0;if(l.flags&=-129,n===null){if(pt){if(p.mode==="hidden")return n=Ih(l,p),l.lanes=536870912,xc(null,n);if(x0(l),(n=Vt)?(n=w_(n,os),n=n!==null&&n.data==="&"?n:null,n!==null&&(l.memoizedState={dehydrated:n,treeContext:Un!==null?{id:$s,overflow:Gs}:null,retryLane:536870912,hydrationErrors:null},h=Wv(n),h.return=l,l.child=h,$r=l,Vt=null)):n=null,n===null)throw Hn(l);return l.lanes=536870912,null}return Ih(l,p)}var E=n.memoizedState;if(E!==null){var k=E.dehydrated;if(x0(l),b)if(l.flags&256)l.flags&=-257,l=ux(n,l,h);else if(l.memoizedState!==null)l.child=n.child,l.flags|=128,l=null;else throw Error(a(558));else if(Er||jo(n,l,h,!1),b=(h&n.childLanes)!==0,Er||b){if(p=It,p!==null&&(k=rh(p,h),k!==0&&k!==E.retryLane))throw E.retryLane=k,Di(n,k),Ca(p,n,k),B0;Wh(),l=ux(n,l,h)}else n=E.treeContext,Vt=cs(k.nextSibling),$r=l,pt=!0,zn=null,os=!1,n!==null&&Kv(l,n),l=Ih(l,p),l.flags|=4096;return l}return n=cn(n.child,{mode:p.mode,children:p.children}),n.ref=l.ref,l.child=n,n.return=l,n}function jh(n,l){var h=l.ref;if(h===null)n!==null&&n.ref!==null&&(l.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(a(284));(n===null||n.ref!==h)&&(l.flags|=4194816)}}function U0(n,l,h,p,b){return Ii(l),h=y0(n,l,h,p,void 0,b),p=b0(),n!==null&&!Er?(w0(n,l,b),gn(n,l,b)):(pt&&p&&t0(l),l.flags|=1,Vr(n,l,h,b),l.child)}function hx(n,l,h,p,b,E){return Ii(l),l.updateQueue=null,h=p1(l,p,h,b),f1(n),p=b0(),n!==null&&!Er?(w0(n,l,E),gn(n,l,E)):(pt&&p&&t0(l),l.flags|=1,Vr(n,l,h,E),l.child)}function dx(n,l,h,p,b){if(Ii(l),l.stateNode===null){var E=Fo,k=h.contextType;typeof k=="object"&&k!==null&&(E=Gr(k)),E=new h(p,E),l.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=j0,l.stateNode=E,E._reactInternals=l,E=l.stateNode,E.props=p,E.state=l.memoizedState,E.refs={},d0(l),k=h.contextType,E.context=typeof k=="object"&&k!==null?Gr(k):Fo,E.state=l.memoizedState,k=h.getDerivedStateFromProps,typeof k=="function"&&(I0(l,h,k,p),E.state=l.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(k=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),k!==E.state&&j0.enqueueReplaceState(E,E.state,null),fc(l,p,E,b),dc(),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308),p=!0}else if(n===null){E=l.stateNode;var L=l.memoizedProps,ee=Hi(h,L);E.props=ee;var ce=E.context,xe=h.contextType;k=Fo,typeof xe=="object"&&xe!==null&&(k=Gr(xe));var we=h.getDerivedStateFromProps;xe=typeof we=="function"||typeof E.getSnapshotBeforeUpdate=="function",L=l.pendingProps!==L,xe||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(L||ce!==k)&&Q1(l,E,p,k),Gn=!1;var fe=l.memoizedState;E.state=fe,fc(l,p,E,b),dc(),ce=l.memoizedState,L||fe!==ce||Gn?(typeof we=="function"&&(I0(l,h,we,p),ce=l.memoizedState),(ee=Gn||J1(l,h,ee,p,fe,ce,k))?(xe||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(l.flags|=4194308)):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=p,l.memoizedState=ce),E.props=p,E.state=ce,E.context=k,p=ee):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),p=!1)}else{E=l.stateNode,f0(n,l),k=l.memoizedProps,xe=Hi(h,k),E.props=xe,we=l.pendingProps,fe=E.context,ce=h.contextType,ee=Fo,typeof ce=="object"&&ce!==null&&(ee=Gr(ce)),L=h.getDerivedStateFromProps,(ce=typeof L=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(k!==we||fe!==ee)&&Q1(l,E,p,ee),Gn=!1,fe=l.memoizedState,E.state=fe,fc(l,p,E,b),dc();var me=l.memoizedState;k!==we||fe!==me||Gn||n!==null&&n.dependencies!==null&&xh(n.dependencies)?(typeof L=="function"&&(I0(l,h,L,p),me=l.memoizedState),(xe=Gn||J1(l,h,xe,p,fe,me,ee)||n!==null&&n.dependencies!==null&&xh(n.dependencies))?(ce||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(p,me,ee),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(p,me,ee)),typeof E.componentDidUpdate=="function"&&(l.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof E.componentDidUpdate!="function"||k===n.memoizedProps&&fe===n.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||k===n.memoizedProps&&fe===n.memoizedState||(l.flags|=1024),l.memoizedProps=p,l.memoizedState=me),E.props=p,E.state=me,E.context=ee,p=xe):(typeof E.componentDidUpdate!="function"||k===n.memoizedProps&&fe===n.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||k===n.memoizedProps&&fe===n.memoizedState||(l.flags|=1024),p=!1)}return E=p,jh(n,l),p=(l.flags&128)!==0,E||p?(E=l.stateNode,h=p&&typeof h.getDerivedStateFromError!="function"?null:E.render(),l.flags|=1,n!==null&&p?(l.child=Ui(l,n.child,null,b),l.child=Ui(l,null,h,b)):Vr(n,l,h,b),l.memoizedState=E.state,n=l.child):n=gn(n,l,b),n}function fx(n,l,h,p){return Mi(),l.flags|=256,Vr(n,l,h,p),l.child}var z0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function H0(n){return{baseLanes:n,cachePool:r1()}}function $0(n,l,h){return n=n!==null?n.childLanes&~h:0,l&&(n|=Ba),n}function px(n,l,h){var p=l.pendingProps,b=!1,E=(l.flags&128)!==0,k;if((k=E)||(k=n!==null&&n.memoizedState===null?!1:(mr.current&2)!==0),k&&(b=!0,l.flags&=-129),k=(l.flags&32)!==0,l.flags&=-33,n===null){if(pt){if(b?Wn(l):Xn(),(n=Vt)?(n=w_(n,os),n=n!==null&&n.data!=="&"?n:null,n!==null&&(l.memoizedState={dehydrated:n,treeContext:Un!==null?{id:$s,overflow:Gs}:null,retryLane:536870912,hydrationErrors:null},h=Wv(n),h.return=l,l.child=h,$r=l,Vt=null)):n=null,n===null)throw Hn(l);return Sp(n)?l.lanes=32:l.lanes=536870912,null}var L=p.children;return p=p.fallback,b?(Xn(),b=l.mode,L=Ph({mode:"hidden",children:L},b),p=Fi(p,b,h,null),L.return=l,p.return=l,L.sibling=p,l.child=L,p=l.child,p.memoizedState=H0(h),p.childLanes=$0(n,k,h),l.memoizedState=z0,xc(null,p)):(Wn(l),G0(l,L))}var ee=n.memoizedState;if(ee!==null&&(L=ee.dehydrated,L!==null)){if(E)l.flags&256?(Wn(l),l.flags&=-257,l=V0(n,l,h)):l.memoizedState!==null?(Xn(),l.child=n.child,l.flags|=128,l=null):(Xn(),L=p.fallback,b=l.mode,p=Ph({mode:"visible",children:p.children},b),L=Fi(L,b,h,null),L.flags|=2,p.return=l,L.return=l,p.sibling=L,l.child=p,Ui(l,n.child,null,h),p=l.child,p.memoizedState=H0(h),p.childLanes=$0(n,k,h),l.memoizedState=z0,l=xc(null,p));else if(Wn(l),Sp(L)){if(k=L.nextSibling&&L.nextSibling.dataset,k)var ce=k.dgst;k=ce,p=Error(a(419)),p.stack="",p.digest=k,ic({value:p,source:null,stack:null}),l=V0(n,l,h)}else if(Er||jo(n,l,h,!1),k=(h&n.childLanes)!==0,Er||k){if(k=It,k!==null&&(p=rh(k,h),p!==0&&p!==ee.retryLane))throw ee.retryLane=p,Di(n,p),Ca(k,n,p),B0;Ap(L)||Wh(),l=V0(n,l,h)}else Ap(L)?(l.flags|=192,l.child=n.child,l=null):(n=ee.treeContext,Vt=cs(L.nextSibling),$r=l,pt=!0,zn=null,os=!1,n!==null&&Kv(l,n),l=G0(l,p.children),l.flags|=4096);return l}return b?(Xn(),L=p.fallback,b=l.mode,ee=n.child,ce=ee.sibling,p=cn(ee,{mode:"hidden",children:p.children}),p.subtreeFlags=ee.subtreeFlags&65011712,ce!==null?L=cn(ce,L):(L=Fi(L,b,h,null),L.flags|=2),L.return=l,p.return=l,p.sibling=L,l.child=p,xc(null,p),p=l.child,L=n.child.memoizedState,L===null?L=H0(h):(b=L.cachePool,b!==null?(ee=br._currentValue,b=b.parent!==ee?{parent:ee,pool:ee}:b):b=r1(),L={baseLanes:L.baseLanes|h,cachePool:b}),p.memoizedState=L,p.childLanes=$0(n,k,h),l.memoizedState=z0,xc(n.child,p)):(Wn(l),h=n.child,n=h.sibling,h=cn(h,{mode:"visible",children:p.children}),h.return=l,h.sibling=null,n!==null&&(k=l.deletions,k===null?(l.deletions=[n],l.flags|=16):k.push(n)),l.child=h,l.memoizedState=null,h)}function G0(n,l){return l=Ph({mode:"visible",children:l},n.mode),l.return=n,n.child=l}function Ph(n,l){return n=La(22,n,null,l),n.lanes=0,n}function V0(n,l,h){return Ui(l,n.child,null,h),n=G0(l,l.pendingProps.children),n.flags|=2,l.memoizedState=null,n}function gx(n,l,h){n.lanes|=l;var p=n.alternate;p!==null&&(p.lanes|=l),i0(n.return,l,h)}function q0(n,l,h,p,b,E){var k=n.memoizedState;k===null?n.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:p,tail:h,tailMode:b,treeForkCount:E}:(k.isBackwards=l,k.rendering=null,k.renderingStartTime=0,k.last=p,k.tail=h,k.tailMode=b,k.treeForkCount=E)}function mx(n,l,h){var p=l.pendingProps,b=p.revealOrder,E=p.tail;p=p.children;var k=mr.current,L=(k&2)!==0;if(L?(k=k&1|2,l.flags|=128):k&=1,J(mr,k),Vr(n,l,p,h),p=pt?nc:0,!L&&n!==null&&(n.flags&128)!==0)e:for(n=l.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&gx(n,h,l);else if(n.tag===19)gx(n,h,l);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===l)break e;for(;n.sibling===null;){if(n.return===null||n.return===l)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(b){case"forwards":for(h=l.child,b=null;h!==null;)n=h.alternate,n!==null&&Th(n)===null&&(b=h),h=h.sibling;h=b,h===null?(b=l.child,l.child=null):(b=h.sibling,h.sibling=null),q0(l,!1,b,h,E,p);break;case"backwards":case"unstable_legacy-backwards":for(h=null,b=l.child,l.child=null;b!==null;){if(n=b.alternate,n!==null&&Th(n)===null){l.child=b;break}n=b.sibling,b.sibling=h,h=b,b=n}q0(l,!0,h,null,E,p);break;case"together":q0(l,!1,null,null,void 0,p);break;default:l.memoizedState=null}return l.child}function gn(n,l,h){if(n!==null&&(l.dependencies=n.dependencies),Jn|=l.lanes,(h&l.childLanes)===0)if(n!==null){if(jo(n,l,h,!1),(h&l.childLanes)===0)return null}else return null;if(n!==null&&l.child!==n.child)throw Error(a(153));if(l.child!==null){for(n=l.child,h=cn(n,n.pendingProps),l.child=h,h.return=l;n.sibling!==null;)n=n.sibling,h=h.sibling=cn(n,n.pendingProps),h.return=l;h.sibling=null}return l.child}function W0(n,l){return(n.lanes&l)!==0?!0:(n=n.dependencies,!!(n!==null&&xh(n)))}function _S(n,l,h){switch(l.tag){case 3:Ne(l,l.stateNode.containerInfo),$n(l,br,n.memoizedState.cache),Mi();break;case 27:case 5:Ae(l);break;case 4:Ne(l,l.stateNode.containerInfo);break;case 10:$n(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,x0(l),null;break;case 13:var p=l.memoizedState;if(p!==null)return p.dehydrated!==null?(Wn(l),l.flags|=128,null):(h&l.child.childLanes)!==0?px(n,l,h):(Wn(l),n=gn(n,l,h),n!==null?n.sibling:null);Wn(l);break;case 19:var b=(n.flags&128)!==0;if(p=(h&l.childLanes)!==0,p||(jo(n,l,h,!1),p=(h&l.childLanes)!==0),b){if(p)return mx(n,l,h);l.flags|=128}if(b=l.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),J(mr,mr.current),p)break;return null;case 22:return l.lanes=0,lx(n,l,h,l.pendingProps);case 24:$n(l,br,n.memoizedState.cache)}return gn(n,l,h)}function vx(n,l,h){if(n!==null)if(n.memoizedProps!==l.pendingProps)Er=!0;else{if(!W0(n,h)&&(l.flags&128)===0)return Er=!1,_S(n,l,h);Er=(n.flags&131072)!==0}else Er=!1,pt&&(l.flags&1048576)!==0&&Yv(l,nc,l.index);switch(l.lanes=0,l.tag){case 16:e:{var p=l.pendingProps;if(n=Pi(l.elementType),l.type=n,typeof n=="function")Qf(n)?(p=Hi(n,p),l.tag=1,l=dx(null,l,n,p,h)):(l.tag=0,l=U0(null,l,n,p,h));else{if(n!=null){var b=n.$$typeof;if(b===N){l.tag=11,l=nx(null,l,n,p,h);break e}else if(b===C){l.tag=14,l=ix(null,l,n,p,h);break e}}throw l=ne(n)||n,Error(a(306,l,""))}}return l;case 0:return U0(n,l,l.type,l.pendingProps,h);case 1:return p=l.type,b=Hi(p,l.pendingProps),dx(n,l,p,b,h);case 3:e:{if(Ne(l,l.stateNode.containerInfo),n===null)throw Error(a(387));p=l.pendingProps;var E=l.memoizedState;b=E.element,f0(n,l),fc(l,p,null,h);var k=l.memoizedState;if(p=k.cache,$n(l,br,p),p!==E.cache&&o0(l,[br],h,!0),dc(),p=k.element,E.isDehydrated)if(E={element:p,isDehydrated:!1,cache:k.cache},l.updateQueue.baseState=E,l.memoizedState=E,l.flags&256){l=fx(n,l,p,h);break e}else if(p!==b){b=ss(Error(a(424)),l),ic(b),l=fx(n,l,p,h);break e}else for(n=l.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Vt=cs(n.firstChild),$r=l,pt=!0,zn=null,os=!0,h=l1(l,null,p,h),l.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Mi(),p===b){l=gn(n,l,h);break e}Vr(n,l,p,h)}l=l.child}return l;case 26:return jh(n,l),n===null?(h=k_(l.type,null,l.pendingProps,null))?l.memoizedState=h:pt||(h=l.type,n=l.pendingProps,p=ed(oe.current).createElement(h),p[B]=l,p[G]=n,qr(p,h,n),Pe(p),l.stateNode=p):l.memoizedState=k_(l.type,n.memoizedProps,l.pendingProps,n.memoizedState),null;case 27:return Ae(l),n===null&&pt&&(p=l.stateNode=S_(l.type,l.pendingProps,oe.current),$r=l,os=!0,b=Vt,ri(l.type)?(Tp=b,Vt=cs(p.firstChild)):Vt=b),Vr(n,l,l.pendingProps.children,h),jh(n,l),n===null&&(l.flags|=4194304),l.child;case 5:return n===null&&pt&&((b=p=Vt)&&(p=YS(p,l.type,l.pendingProps,os),p!==null?(l.stateNode=p,$r=l,Vt=cs(p.firstChild),os=!1,b=!0):b=!1),b||Hn(l)),Ae(l),b=l.type,E=l.pendingProps,k=n!==null?n.memoizedProps:null,p=E.children,bp(b,E)?p=null:k!==null&&bp(b,k)&&(l.flags|=32),l.memoizedState!==null&&(b=y0(n,l,uS,null,null,h),Fc._currentValue=b),jh(n,l),Vr(n,l,p,h),l.child;case 6:return n===null&&pt&&((n=h=Vt)&&(h=KS(h,l.pendingProps,os),h!==null?(l.stateNode=h,$r=l,Vt=null,n=!0):n=!1),n||Hn(l)),null;case 13:return px(n,l,h);case 4:return Ne(l,l.stateNode.containerInfo),p=l.pendingProps,n===null?l.child=Ui(l,null,p,h):Vr(n,l,p,h),l.child;case 11:return nx(n,l,l.type,l.pendingProps,h);case 7:return Vr(n,l,l.pendingProps,h),l.child;case 8:return Vr(n,l,l.pendingProps.children,h),l.child;case 12:return Vr(n,l,l.pendingProps.children,h),l.child;case 10:return p=l.pendingProps,$n(l,l.type,p.value),Vr(n,l,p.children,h),l.child;case 9:return b=l.type._context,p=l.pendingProps.children,Ii(l),b=Gr(b),p=p(b),l.flags|=1,Vr(n,l,p,h),l.child;case 14:return ix(n,l,l.type,l.pendingProps,h);case 15:return ox(n,l,l.type,l.pendingProps,h);case 19:return mx(n,l,h);case 31:return xS(n,l,h);case 22:return lx(n,l,h,l.pendingProps);case 24:return Ii(l),p=Gr(br),n===null?(b=u0(),b===null&&(b=It,E=l0(),b.pooledCache=E,E.refCount++,E!==null&&(b.pooledCacheLanes|=h),b=E),l.memoizedState={parent:p,cache:b},d0(l),$n(l,br,b)):((n.lanes&h)!==0&&(f0(n,l),fc(l,null,null,h),dc()),b=n.memoizedState,E=l.memoizedState,b.parent!==p?(b={parent:p,cache:p},l.memoizedState=b,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=b),$n(l,br,p)):(p=E.cache,$n(l,br,p),p!==b.cache&&o0(l,[br],h,!0))),Vr(n,l,l.pendingProps.children,h),l.child;case 29:throw l.pendingProps}throw Error(a(156,l.tag))}function mn(n){n.flags|=4}function X0(n,l,h,p,b){if((l=(n.mode&32)!==0)&&(l=!1),l){if(n.flags|=16777216,(b&335544128)===b)if(n.stateNode.complete)n.flags|=8192;else if(Gx())n.flags|=8192;else throw Bi=wh,h0}else n.flags&=-16777217}function xx(n,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!F_(l))if(Gx())n.flags|=8192;else throw Bi=wh,h0}function Bh(n,l){l!==null&&(n.flags|=4),n.flags&16384&&(l=n.tag!==22?eh():536870912,n.lanes|=l,Yo|=l)}function _c(n,l){if(!pt)switch(n.tailMode){case"hidden":l=n.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?n.tail=null:h.sibling=null;break;case"collapsed":h=n.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?l||n.tail===null?n.tail=null:n.tail.sibling=null:p.sibling=null}}function qt(n){var l=n.alternate!==null&&n.alternate.child===n.child,h=0,p=0;if(l)for(var b=n.child;b!==null;)h|=b.lanes|b.childLanes,p|=b.subtreeFlags&65011712,p|=b.flags&65011712,b.return=n,b=b.sibling;else for(b=n.child;b!==null;)h|=b.lanes|b.childLanes,p|=b.subtreeFlags,p|=b.flags,b.return=n,b=b.sibling;return n.subtreeFlags|=p,n.childLanes=h,l}function yS(n,l,h){var p=l.pendingProps;switch(r0(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qt(l),null;case 1:return qt(l),null;case 3:return h=l.stateNode,p=null,n!==null&&(p=n.memoizedState.cache),l.memoizedState.cache!==p&&(l.flags|=2048),dn(br),Ee(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(n===null||n.child===null)&&(Io(l)?mn(l):n===null||n.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,s0())),qt(l),null;case 26:var b=l.type,E=l.memoizedState;return n===null?(mn(l),E!==null?(qt(l),xx(l,E)):(qt(l),X0(l,b,null,p,h))):E?E!==n.memoizedState?(mn(l),qt(l),xx(l,E)):(qt(l),l.flags&=-16777217):(n=n.memoizedProps,n!==p&&mn(l),qt(l),X0(l,b,n,p,h)),null;case 27:if(rt(l),h=oe.current,b=l.type,n!==null&&l.stateNode!=null)n.memoizedProps!==p&&mn(l);else{if(!p){if(l.stateNode===null)throw Error(a(166));return qt(l),null}n=K.current,Io(l)?Jv(l):(n=S_(b,p,h),l.stateNode=n,mn(l))}return qt(l),null;case 5:if(rt(l),b=l.type,n!==null&&l.stateNode!=null)n.memoizedProps!==p&&mn(l);else{if(!p){if(l.stateNode===null)throw Error(a(166));return qt(l),null}if(E=K.current,Io(l))Jv(l);else{var k=ed(oe.current);switch(E){case 1:E=k.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:E=k.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":E=k.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":E=k.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":E=k.createElement("div"),E.innerHTML="<script><\/script>",E=E.removeChild(E.firstChild);break;case"select":E=typeof p.is=="string"?k.createElement("select",{is:p.is}):k.createElement("select"),p.multiple?E.multiple=!0:p.size&&(E.size=p.size);break;default:E=typeof p.is=="string"?k.createElement(b,{is:p.is}):k.createElement(b)}}E[B]=l,E[G]=p;e:for(k=l.child;k!==null;){if(k.tag===5||k.tag===6)E.appendChild(k.stateNode);else if(k.tag!==4&&k.tag!==27&&k.child!==null){k.child.return=k,k=k.child;continue}if(k===l)break e;for(;k.sibling===null;){if(k.return===null||k.return===l)break e;k=k.return}k.sibling.return=k.return,k=k.sibling}l.stateNode=E;e:switch(qr(E,b,p),b){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&mn(l)}}return qt(l),X0(l,l.type,n===null?null:n.memoizedProps,l.pendingProps,h),null;case 6:if(n&&l.stateNode!=null)n.memoizedProps!==p&&mn(l);else{if(typeof p!="string"&&l.stateNode===null)throw Error(a(166));if(n=oe.current,Io(l)){if(n=l.stateNode,h=l.memoizedProps,p=null,b=$r,b!==null)switch(b.tag){case 27:case 5:p=b.memoizedProps}n[B]=l,n=!!(n.nodeValue===h||p!==null&&p.suppressHydrationWarning===!0||p_(n.nodeValue,h)),n||Hn(l,!0)}else n=ed(n).createTextNode(p),n[B]=l,l.stateNode=n}return qt(l),null;case 31:if(h=l.memoizedState,n===null||n.memoizedState!==null){if(p=Io(l),h!==null){if(n===null){if(!p)throw Error(a(318));if(n=l.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(557));n[B]=l}else Mi(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;qt(l),n=!1}else h=s0(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=h),n=!0;if(!n)return l.flags&256?(ja(l),l):(ja(l),null);if((l.flags&128)!==0)throw Error(a(558))}return qt(l),null;case 13:if(p=l.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(b=Io(l),p!==null&&p.dehydrated!==null){if(n===null){if(!b)throw Error(a(318));if(b=l.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(a(317));b[B]=l}else Mi(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;qt(l),b=!1}else b=s0(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=b),b=!0;if(!b)return l.flags&256?(ja(l),l):(ja(l),null)}return ja(l),(l.flags&128)!==0?(l.lanes=h,l):(h=p!==null,n=n!==null&&n.memoizedState!==null,h&&(p=l.child,b=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(b=p.alternate.memoizedState.cachePool.pool),E=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(E=p.memoizedState.cachePool.pool),E!==b&&(p.flags|=2048)),h!==n&&h&&(l.child.flags|=8192),Bh(l,l.updateQueue),qt(l),null);case 4:return Ee(),n===null&&mp(l.stateNode.containerInfo),qt(l),null;case 10:return dn(l.type),qt(l),null;case 19:if(F(mr),p=l.memoizedState,p===null)return qt(l),null;if(b=(l.flags&128)!==0,E=p.rendering,E===null)if(b)_c(p,!1);else{if(ur!==0||n!==null&&(n.flags&128)!==0)for(n=l.child;n!==null;){if(E=Th(n),E!==null){for(l.flags|=128,_c(p,!1),n=E.updateQueue,l.updateQueue=n,Bh(l,n),l.subtreeFlags=0,n=h,h=l.child;h!==null;)qv(h,n),h=h.sibling;return J(mr,mr.current&1|2),pt&&un(l,p.treeForkCount),l.child}n=n.sibling}p.tail!==null&&Lt()>Gh&&(l.flags|=128,b=!0,_c(p,!1),l.lanes=4194304)}else{if(!b)if(n=Th(E),n!==null){if(l.flags|=128,b=!0,n=n.updateQueue,l.updateQueue=n,Bh(l,n),_c(p,!0),p.tail===null&&p.tailMode==="hidden"&&!E.alternate&&!pt)return qt(l),null}else 2*Lt()-p.renderingStartTime>Gh&&h!==536870912&&(l.flags|=128,b=!0,_c(p,!1),l.lanes=4194304);p.isBackwards?(E.sibling=l.child,l.child=E):(n=p.last,n!==null?n.sibling=E:l.child=E,p.last=E)}return p.tail!==null?(n=p.tail,p.rendering=n,p.tail=n.sibling,p.renderingStartTime=Lt(),n.sibling=null,h=mr.current,J(mr,b?h&1|2:h&1),pt&&un(l,p.treeForkCount),n):(qt(l),null);case 22:case 23:return ja(l),v0(),p=l.memoizedState!==null,n!==null?n.memoizedState!==null!==p&&(l.flags|=8192):p&&(l.flags|=8192),p?(h&536870912)!==0&&(l.flags&128)===0&&(qt(l),l.subtreeFlags&6&&(l.flags|=8192)):qt(l),h=l.updateQueue,h!==null&&Bh(l,h.retryQueue),h=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(h=n.memoizedState.cachePool.pool),p=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(p=l.memoizedState.cachePool.pool),p!==h&&(l.flags|=2048),n!==null&&F(ji),null;case 24:return h=null,n!==null&&(h=n.memoizedState.cache),l.memoizedState.cache!==h&&(l.flags|=2048),dn(br),qt(l),null;case 25:return null;case 30:return null}throw Error(a(156,l.tag))}function bS(n,l){switch(r0(l),l.tag){case 1:return n=l.flags,n&65536?(l.flags=n&-65537|128,l):null;case 3:return dn(br),Ee(),n=l.flags,(n&65536)!==0&&(n&128)===0?(l.flags=n&-65537|128,l):null;case 26:case 27:case 5:return rt(l),null;case 31:if(l.memoizedState!==null){if(ja(l),l.alternate===null)throw Error(a(340));Mi()}return n=l.flags,n&65536?(l.flags=n&-65537|128,l):null;case 13:if(ja(l),n=l.memoizedState,n!==null&&n.dehydrated!==null){if(l.alternate===null)throw Error(a(340));Mi()}return n=l.flags,n&65536?(l.flags=n&-65537|128,l):null;case 19:return F(mr),null;case 4:return Ee(),null;case 10:return dn(l.type),null;case 22:case 23:return ja(l),v0(),n!==null&&F(ji),n=l.flags,n&65536?(l.flags=n&-65537|128,l):null;case 24:return dn(br),null;case 25:return null;default:return null}}function _x(n,l){switch(r0(l),l.tag){case 3:dn(br),Ee();break;case 26:case 27:case 5:rt(l);break;case 4:Ee();break;case 31:l.memoizedState!==null&&ja(l);break;case 13:ja(l);break;case 19:F(mr);break;case 10:dn(l.type);break;case 22:case 23:ja(l),v0(),n!==null&&F(ji);break;case 24:dn(br)}}function yc(n,l){try{var h=l.updateQueue,p=h!==null?h.lastEffect:null;if(p!==null){var b=p.next;h=b;do{if((h.tag&n)===n){p=void 0;var E=h.create,k=h.inst;p=E(),k.destroy=p}h=h.next}while(h!==b)}}catch(L){Nt(l,l.return,L)}}function Yn(n,l,h){try{var p=l.updateQueue,b=p!==null?p.lastEffect:null;if(b!==null){var E=b.next;p=E;do{if((p.tag&n)===n){var k=p.inst,L=k.destroy;if(L!==void 0){k.destroy=void 0,b=l;var ee=h,ce=L;try{ce()}catch(xe){Nt(b,ee,xe)}}}p=p.next}while(p!==E)}}catch(xe){Nt(l,l.return,xe)}}function yx(n){var l=n.updateQueue;if(l!==null){var h=n.stateNode;try{u1(l,h)}catch(p){Nt(n,n.return,p)}}}function bx(n,l,h){h.props=Hi(n.type,n.memoizedProps),h.state=n.memoizedState;try{h.componentWillUnmount()}catch(p){Nt(n,l,p)}}function bc(n,l){try{var h=n.ref;if(h!==null){switch(n.tag){case 26:case 27:case 5:var p=n.stateNode;break;case 30:p=n.stateNode;break;default:p=n.stateNode}typeof h=="function"?n.refCleanup=h(p):h.current=p}}catch(b){Nt(n,l,b)}}function Vs(n,l){var h=n.ref,p=n.refCleanup;if(h!==null)if(typeof p=="function")try{p()}catch(b){Nt(n,l,b)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(b){Nt(n,l,b)}else h.current=null}function wx(n){var l=n.type,h=n.memoizedProps,p=n.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":h.autoFocus&&p.focus();break e;case"img":h.src?p.src=h.src:h.srcSet&&(p.srcset=h.srcSet)}}catch(b){Nt(n,n.return,b)}}function Y0(n,l,h){try{var p=n.stateNode;$S(p,n.type,h,l),p[G]=l}catch(b){Nt(n,n.return,b)}}function Ex(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&ri(n.type)||n.tag===4}function K0(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Ex(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&ri(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function J0(n,l,h){var p=n.tag;if(p===5||p===6)n=n.stateNode,l?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(n,l):(l=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,l.appendChild(n),h=h._reactRootContainer,h!=null||l.onclick!==null||(l.onclick=on));else if(p!==4&&(p===27&&ri(n.type)&&(h=n.stateNode,l=null),n=n.child,n!==null))for(J0(n,l,h),n=n.sibling;n!==null;)J0(n,l,h),n=n.sibling}function Uh(n,l,h){var p=n.tag;if(p===5||p===6)n=n.stateNode,l?h.insertBefore(n,l):h.appendChild(n);else if(p!==4&&(p===27&&ri(n.type)&&(h=n.stateNode),n=n.child,n!==null))for(Uh(n,l,h),n=n.sibling;n!==null;)Uh(n,l,h),n=n.sibling}function Ax(n){var l=n.stateNode,h=n.memoizedProps;try{for(var p=n.type,b=l.attributes;b.length;)l.removeAttributeNode(b[0]);qr(l,p,h),l[B]=n,l[G]=h}catch(E){Nt(n,n.return,E)}}var vn=!1,Ar=!1,Q0=!1,Sx=typeof WeakSet=="function"?WeakSet:Set,Pr=null;function wS(n,l){if(n=n.containerInfo,_p=od,n=jv(n),Vf(n)){if("selectionStart"in n)var h={start:n.selectionStart,end:n.selectionEnd};else e:{h=(h=n.ownerDocument)&&h.defaultView||window;var p=h.getSelection&&h.getSelection();if(p&&p.rangeCount!==0){h=p.anchorNode;var b=p.anchorOffset,E=p.focusNode;p=p.focusOffset;try{h.nodeType,E.nodeType}catch{h=null;break e}var k=0,L=-1,ee=-1,ce=0,xe=0,we=n,fe=null;t:for(;;){for(var me;we!==h||b!==0&&we.nodeType!==3||(L=k+b),we!==E||p!==0&&we.nodeType!==3||(ee=k+p),we.nodeType===3&&(k+=we.nodeValue.length),(me=we.firstChild)!==null;)fe=we,we=me;for(;;){if(we===n)break t;if(fe===h&&++ce===b&&(L=k),fe===E&&++xe===p&&(ee=k),(me=we.nextSibling)!==null)break;we=fe,fe=we.parentNode}we=me}h=L===-1||ee===-1?null:{start:L,end:ee}}else h=null}h=h||{start:0,end:0}}else h=null;for(yp={focusedElem:n,selectionRange:h},od=!1,Pr=l;Pr!==null;)if(l=Pr,n=l.child,(l.subtreeFlags&1028)!==0&&n!==null)n.return=l,Pr=n;else for(;Pr!==null;){switch(l=Pr,E=l.alternate,n=l.flags,l.tag){case 0:if((n&4)!==0&&(n=l.updateQueue,n=n!==null?n.events:null,n!==null))for(h=0;h<n.length;h++)b=n[h],b.ref.impl=b.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&E!==null){n=void 0,h=l,b=E.memoizedProps,E=E.memoizedState,p=h.stateNode;try{var je=Hi(h.type,b);n=p.getSnapshotBeforeUpdate(je,E),p.__reactInternalSnapshotBeforeUpdate=n}catch(We){Nt(h,h.return,We)}}break;case 3:if((n&1024)!==0){if(n=l.stateNode.containerInfo,h=n.nodeType,h===9)Ep(n);else if(h===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Ep(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(a(163))}if(n=l.sibling,n!==null){n.return=l.return,Pr=n;break}Pr=l.return}}function Tx(n,l,h){var p=h.flags;switch(h.tag){case 0:case 11:case 15:_n(n,h),p&4&&yc(5,h);break;case 1:if(_n(n,h),p&4)if(n=h.stateNode,l===null)try{n.componentDidMount()}catch(k){Nt(h,h.return,k)}else{var b=Hi(h.type,l.memoizedProps);l=l.memoizedState;try{n.componentDidUpdate(b,l,n.__reactInternalSnapshotBeforeUpdate)}catch(k){Nt(h,h.return,k)}}p&64&&yx(h),p&512&&bc(h,h.return);break;case 3:if(_n(n,h),p&64&&(n=h.updateQueue,n!==null)){if(l=null,h.child!==null)switch(h.child.tag){case 27:case 5:l=h.child.stateNode;break;case 1:l=h.child.stateNode}try{u1(n,l)}catch(k){Nt(h,h.return,k)}}break;case 27:l===null&&p&4&&Ax(h);case 26:case 5:_n(n,h),l===null&&p&4&&wx(h),p&512&&bc(h,h.return);break;case 12:_n(n,h);break;case 31:_n(n,h),p&4&&Nx(n,h);break;case 13:_n(n,h),p&4&&Rx(n,h),p&64&&(n=h.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(h=OS.bind(null,h),JS(n,h))));break;case 22:if(p=h.memoizedState!==null||vn,!p){l=l!==null&&l.memoizedState!==null||Ar,b=vn;var E=Ar;vn=p,(Ar=l)&&!E?yn(n,h,(h.subtreeFlags&8772)!==0):_n(n,h),vn=b,Ar=E}break;case 30:break;default:_n(n,h)}}function Cx(n){var l=n.alternate;l!==null&&(n.alternate=null,Cx(l)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(l=n.stateNode,l!==null&&Se(l)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Jt=null,Ea=!1;function xn(n,l,h){for(h=h.child;h!==null;)kx(n,l,h),h=h.sibling}function kx(n,l,h){if(gr&&typeof gr.onCommitFiberUnmount=="function")try{gr.onCommitFiberUnmount(Gt,h)}catch{}switch(h.tag){case 26:Ar||Vs(h,l),xn(n,l,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Ar||Vs(h,l);var p=Jt,b=Ea;ri(h.type)&&(Jt=h.stateNode,Ea=!1),xn(n,l,h),Rc(h.stateNode),Jt=p,Ea=b;break;case 5:Ar||Vs(h,l);case 6:if(p=Jt,b=Ea,Jt=null,xn(n,l,h),Jt=p,Ea=b,Jt!==null)if(Ea)try{(Jt.nodeType===9?Jt.body:Jt.nodeName==="HTML"?Jt.ownerDocument.body:Jt).removeChild(h.stateNode)}catch(E){Nt(h,l,E)}else try{Jt.removeChild(h.stateNode)}catch(E){Nt(h,l,E)}break;case 18:Jt!==null&&(Ea?(n=Jt,y_(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,h.stateNode),al(n)):y_(Jt,h.stateNode));break;case 4:p=Jt,b=Ea,Jt=h.stateNode.containerInfo,Ea=!0,xn(n,l,h),Jt=p,Ea=b;break;case 0:case 11:case 14:case 15:Yn(2,h,l),Ar||Yn(4,h,l),xn(n,l,h);break;case 1:Ar||(Vs(h,l),p=h.stateNode,typeof p.componentWillUnmount=="function"&&bx(h,l,p)),xn(n,l,h);break;case 21:xn(n,l,h);break;case 22:Ar=(p=Ar)||h.memoizedState!==null,xn(n,l,h),Ar=p;break;default:xn(n,l,h)}}function Nx(n,l){if(l.memoizedState===null&&(n=l.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{al(n)}catch(h){Nt(l,l.return,h)}}}function Rx(n,l){if(l.memoizedState===null&&(n=l.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{al(n)}catch(h){Nt(l,l.return,h)}}function ES(n){switch(n.tag){case 31:case 13:case 19:var l=n.stateNode;return l===null&&(l=n.stateNode=new Sx),l;case 22:return n=n.stateNode,l=n._retryCache,l===null&&(l=n._retryCache=new Sx),l;default:throw Error(a(435,n.tag))}}function zh(n,l){var h=ES(n);l.forEach(function(p){if(!h.has(p)){h.add(p);var b=DS.bind(null,n,p);p.then(b,b)}})}function Aa(n,l){var h=l.deletions;if(h!==null)for(var p=0;p<h.length;p++){var b=h[p],E=n,k=l,L=k;e:for(;L!==null;){switch(L.tag){case 27:if(ri(L.type)){Jt=L.stateNode,Ea=!1;break e}break;case 5:Jt=L.stateNode,Ea=!1;break e;case 3:case 4:Jt=L.stateNode.containerInfo,Ea=!0;break e}L=L.return}if(Jt===null)throw Error(a(160));kx(E,k,b),Jt=null,Ea=!1,E=b.alternate,E!==null&&(E.return=null),b.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)Ox(l,n),l=l.sibling}var Ts=null;function Ox(n,l){var h=n.alternate,p=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Aa(l,n),Sa(n),p&4&&(Yn(3,n,n.return),yc(3,n),Yn(5,n,n.return));break;case 1:Aa(l,n),Sa(n),p&512&&(Ar||h===null||Vs(h,h.return)),p&64&&vn&&(n=n.updateQueue,n!==null&&(p=n.callbacks,p!==null&&(h=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=h===null?p:h.concat(p))));break;case 26:var b=Ts;if(Aa(l,n),Sa(n),p&512&&(Ar||h===null||Vs(h,h.return)),p&4){var E=h!==null?h.memoizedState:null;if(p=n.memoizedState,h===null)if(p===null)if(n.stateNode===null){e:{p=n.type,h=n.memoizedProps,b=b.ownerDocument||b;t:switch(p){case"title":E=b.getElementsByTagName("title")[0],(!E||E[pe]||E[B]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=b.createElement(p),b.head.insertBefore(E,b.querySelector("head > title"))),qr(E,p,h),E[B]=n,Pe(E),p=E;break e;case"link":var k=O_("link","href",b).get(p+(h.href||""));if(k){for(var L=0;L<k.length;L++)if(E=k[L],E.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&E.getAttribute("rel")===(h.rel==null?null:h.rel)&&E.getAttribute("title")===(h.title==null?null:h.title)&&E.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){k.splice(L,1);break t}}E=b.createElement(p),qr(E,p,h),b.head.appendChild(E);break;case"meta":if(k=O_("meta","content",b).get(p+(h.content||""))){for(L=0;L<k.length;L++)if(E=k[L],E.getAttribute("content")===(h.content==null?null:""+h.content)&&E.getAttribute("name")===(h.name==null?null:h.name)&&E.getAttribute("property")===(h.property==null?null:h.property)&&E.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&E.getAttribute("charset")===(h.charSet==null?null:h.charSet)){k.splice(L,1);break t}}E=b.createElement(p),qr(E,p,h),b.head.appendChild(E);break;default:throw Error(a(468,p))}E[B]=n,Pe(E),p=E}n.stateNode=p}else D_(b,n.type,n.stateNode);else n.stateNode=R_(b,p,n.memoizedProps);else E!==p?(E===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):E.count--,p===null?D_(b,n.type,n.stateNode):R_(b,p,n.memoizedProps)):p===null&&n.stateNode!==null&&Y0(n,n.memoizedProps,h.memoizedProps)}break;case 27:Aa(l,n),Sa(n),p&512&&(Ar||h===null||Vs(h,h.return)),h!==null&&p&4&&Y0(n,n.memoizedProps,h.memoizedProps);break;case 5:if(Aa(l,n),Sa(n),p&512&&(Ar||h===null||Vs(h,h.return)),n.flags&32){b=n.stateNode;try{To(b,"")}catch(je){Nt(n,n.return,je)}}p&4&&n.stateNode!=null&&(b=n.memoizedProps,Y0(n,b,h!==null?h.memoizedProps:b)),p&1024&&(Q0=!0);break;case 6:if(Aa(l,n),Sa(n),p&4){if(n.stateNode===null)throw Error(a(162));p=n.memoizedProps,h=n.stateNode;try{h.nodeValue=p}catch(je){Nt(n,n.return,je)}}break;case 3:if(ad=null,b=Ts,Ts=td(l.containerInfo),Aa(l,n),Ts=b,Sa(n),p&4&&h!==null&&h.memoizedState.isDehydrated)try{al(l.containerInfo)}catch(je){Nt(n,n.return,je)}Q0&&(Q0=!1,Dx(n));break;case 4:p=Ts,Ts=td(n.stateNode.containerInfo),Aa(l,n),Sa(n),Ts=p;break;case 12:Aa(l,n),Sa(n);break;case 31:Aa(l,n),Sa(n),p&4&&(p=n.updateQueue,p!==null&&(n.updateQueue=null,zh(n,p)));break;case 13:Aa(l,n),Sa(n),n.child.flags&8192&&n.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&($h=Lt()),p&4&&(p=n.updateQueue,p!==null&&(n.updateQueue=null,zh(n,p)));break;case 22:b=n.memoizedState!==null;var ee=h!==null&&h.memoizedState!==null,ce=vn,xe=Ar;if(vn=ce||b,Ar=xe||ee,Aa(l,n),Ar=xe,vn=ce,Sa(n),p&8192)e:for(l=n.stateNode,l._visibility=b?l._visibility&-2:l._visibility|1,b&&(h===null||ee||vn||Ar||$i(n)),h=null,l=n;;){if(l.tag===5||l.tag===26){if(h===null){ee=h=l;try{if(E=ee.stateNode,b)k=E.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none";else{L=ee.stateNode;var we=ee.memoizedProps.style,fe=we!=null&&we.hasOwnProperty("display")?we.display:null;L.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(je){Nt(ee,ee.return,je)}}}else if(l.tag===6){if(h===null){ee=l;try{ee.stateNode.nodeValue=b?"":ee.memoizedProps}catch(je){Nt(ee,ee.return,je)}}}else if(l.tag===18){if(h===null){ee=l;try{var me=ee.stateNode;b?b_(me,!0):b_(ee.stateNode,!1)}catch(je){Nt(ee,ee.return,je)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===n)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===n)break e;for(;l.sibling===null;){if(l.return===null||l.return===n)break e;h===l&&(h=null),l=l.return}h===l&&(h=null),l.sibling.return=l.return,l=l.sibling}p&4&&(p=n.updateQueue,p!==null&&(h=p.retryQueue,h!==null&&(p.retryQueue=null,zh(n,h))));break;case 19:Aa(l,n),Sa(n),p&4&&(p=n.updateQueue,p!==null&&(n.updateQueue=null,zh(n,p)));break;case 30:break;case 21:break;default:Aa(l,n),Sa(n)}}function Sa(n){var l=n.flags;if(l&2){try{for(var h,p=n.return;p!==null;){if(Ex(p)){h=p;break}p=p.return}if(h==null)throw Error(a(160));switch(h.tag){case 27:var b=h.stateNode,E=K0(n);Uh(n,E,b);break;case 5:var k=h.stateNode;h.flags&32&&(To(k,""),h.flags&=-33);var L=K0(n);Uh(n,L,k);break;case 3:case 4:var ee=h.stateNode.containerInfo,ce=K0(n);J0(n,ce,ee);break;default:throw Error(a(161))}}catch(xe){Nt(n,n.return,xe)}n.flags&=-3}l&4096&&(n.flags&=-4097)}function Dx(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var l=n;Dx(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),n=n.sibling}}function _n(n,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)Tx(n,l.alternate,l),l=l.sibling}function $i(n){for(n=n.child;n!==null;){var l=n;switch(l.tag){case 0:case 11:case 14:case 15:Yn(4,l,l.return),$i(l);break;case 1:Vs(l,l.return);var h=l.stateNode;typeof h.componentWillUnmount=="function"&&bx(l,l.return,h),$i(l);break;case 27:Rc(l.stateNode);case 26:case 5:Vs(l,l.return),$i(l);break;case 22:l.memoizedState===null&&$i(l);break;case 30:$i(l);break;default:$i(l)}n=n.sibling}}function yn(n,l,h){for(h=h&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var p=l.alternate,b=n,E=l,k=E.flags;switch(E.tag){case 0:case 11:case 15:yn(b,E,h),yc(4,E);break;case 1:if(yn(b,E,h),p=E,b=p.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(ce){Nt(p,p.return,ce)}if(p=E,b=p.updateQueue,b!==null){var L=p.stateNode;try{var ee=b.shared.hiddenCallbacks;if(ee!==null)for(b.shared.hiddenCallbacks=null,b=0;b<ee.length;b++)c1(ee[b],L)}catch(ce){Nt(p,p.return,ce)}}h&&k&64&&yx(E),bc(E,E.return);break;case 27:Ax(E);case 26:case 5:yn(b,E,h),h&&p===null&&k&4&&wx(E),bc(E,E.return);break;case 12:yn(b,E,h);break;case 31:yn(b,E,h),h&&k&4&&Nx(b,E);break;case 13:yn(b,E,h),h&&k&4&&Rx(b,E);break;case 22:E.memoizedState===null&&yn(b,E,h),bc(E,E.return);break;case 30:break;default:yn(b,E,h)}l=l.sibling}}function Z0(n,l){var h=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(h=n.memoizedState.cachePool.pool),n=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(n=l.memoizedState.cachePool.pool),n!==h&&(n!=null&&n.refCount++,h!=null&&oc(h))}function ep(n,l){n=null,l.alternate!==null&&(n=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==n&&(l.refCount++,n!=null&&oc(n))}function Cs(n,l,h,p){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)Fx(n,l,h,p),l=l.sibling}function Fx(n,l,h,p){var b=l.flags;switch(l.tag){case 0:case 11:case 15:Cs(n,l,h,p),b&2048&&yc(9,l);break;case 1:Cs(n,l,h,p);break;case 3:Cs(n,l,h,p),b&2048&&(n=null,l.alternate!==null&&(n=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==n&&(l.refCount++,n!=null&&oc(n)));break;case 12:if(b&2048){Cs(n,l,h,p),n=l.stateNode;try{var E=l.memoizedProps,k=E.id,L=E.onPostCommit;typeof L=="function"&&L(k,l.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(ee){Nt(l,l.return,ee)}}else Cs(n,l,h,p);break;case 31:Cs(n,l,h,p);break;case 13:Cs(n,l,h,p);break;case 23:break;case 22:E=l.stateNode,k=l.alternate,l.memoizedState!==null?E._visibility&2?Cs(n,l,h,p):wc(n,l):E._visibility&2?Cs(n,l,h,p):(E._visibility|=2,qo(n,l,h,p,(l.subtreeFlags&10256)!==0||!1)),b&2048&&Z0(k,l);break;case 24:Cs(n,l,h,p),b&2048&&ep(l.alternate,l);break;default:Cs(n,l,h,p)}}function qo(n,l,h,p,b){for(b=b&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var E=n,k=l,L=h,ee=p,ce=k.flags;switch(k.tag){case 0:case 11:case 15:qo(E,k,L,ee,b),yc(8,k);break;case 23:break;case 22:var xe=k.stateNode;k.memoizedState!==null?xe._visibility&2?qo(E,k,L,ee,b):wc(E,k):(xe._visibility|=2,qo(E,k,L,ee,b)),b&&ce&2048&&Z0(k.alternate,k);break;case 24:qo(E,k,L,ee,b),b&&ce&2048&&ep(k.alternate,k);break;default:qo(E,k,L,ee,b)}l=l.sibling}}function wc(n,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var h=n,p=l,b=p.flags;switch(p.tag){case 22:wc(h,p),b&2048&&Z0(p.alternate,p);break;case 24:wc(h,p),b&2048&&ep(p.alternate,p);break;default:wc(h,p)}l=l.sibling}}var Ec=8192;function Wo(n,l,h){if(n.subtreeFlags&Ec)for(n=n.child;n!==null;)Mx(n,l,h),n=n.sibling}function Mx(n,l,h){switch(n.tag){case 26:Wo(n,l,h),n.flags&Ec&&n.memoizedState!==null&&cT(h,Ts,n.memoizedState,n.memoizedProps);break;case 5:Wo(n,l,h);break;case 3:case 4:var p=Ts;Ts=td(n.stateNode.containerInfo),Wo(n,l,h),Ts=p;break;case 22:n.memoizedState===null&&(p=n.alternate,p!==null&&p.memoizedState!==null?(p=Ec,Ec=16777216,Wo(n,l,h),Ec=p):Wo(n,l,h));break;default:Wo(n,l,h)}}function Lx(n){var l=n.alternate;if(l!==null&&(n=l.child,n!==null)){l.child=null;do l=n.sibling,n.sibling=null,n=l;while(n!==null)}}function Ac(n){var l=n.deletions;if((n.flags&16)!==0){if(l!==null)for(var h=0;h<l.length;h++){var p=l[h];Pr=p,jx(p,n)}Lx(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Ix(n),n=n.sibling}function Ix(n){switch(n.tag){case 0:case 11:case 15:Ac(n),n.flags&2048&&Yn(9,n,n.return);break;case 3:Ac(n);break;case 12:Ac(n);break;case 22:var l=n.stateNode;n.memoizedState!==null&&l._visibility&2&&(n.return===null||n.return.tag!==13)?(l._visibility&=-3,Hh(n)):Ac(n);break;default:Ac(n)}}function Hh(n){var l=n.deletions;if((n.flags&16)!==0){if(l!==null)for(var h=0;h<l.length;h++){var p=l[h];Pr=p,jx(p,n)}Lx(n)}for(n=n.child;n!==null;){switch(l=n,l.tag){case 0:case 11:case 15:Yn(8,l,l.return),Hh(l);break;case 22:h=l.stateNode,h._visibility&2&&(h._visibility&=-3,Hh(l));break;default:Hh(l)}n=n.sibling}}function jx(n,l){for(;Pr!==null;){var h=Pr;switch(h.tag){case 0:case 11:case 15:Yn(8,h,l);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var p=h.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:oc(h.memoizedState.cache)}if(p=h.child,p!==null)p.return=h,Pr=p;else e:for(h=n;Pr!==null;){p=Pr;var b=p.sibling,E=p.return;if(Cx(p),p===h){Pr=null;break e}if(b!==null){b.return=E,Pr=b;break e}Pr=E}}}var AS={getCacheForType:function(n){var l=Gr(br),h=l.data.get(n);return h===void 0&&(h=n(),l.data.set(n,h)),h},cacheSignal:function(){return Gr(br).controller.signal}},SS=typeof WeakMap=="function"?WeakMap:Map,St=0,It=null,ut=null,dt=0,kt=0,Pa=null,Kn=!1,Xo=!1,tp=!1,bn=0,ur=0,Jn=0,Gi=0,rp=0,Ba=0,Yo=0,Sc=null,Ta=null,ap=!1,$h=0,Px=0,Gh=1/0,Vh=null,Qn=null,Or=0,Zn=null,Ko=null,wn=0,sp=0,np=null,Bx=null,Tc=0,ip=null;function Ua(){return(St&2)!==0&&dt!==0?dt&-dt:U.T!==null?dp():M()}function Ux(){if(Ba===0)if((dt&536870912)===0||pt){var n=bo;bo<<=1,(bo&3932160)===0&&(bo=262144),Ba=n}else Ba=536870912;return n=Ia.current,n!==null&&(n.flags|=32),Ba}function Ca(n,l,h){(n===It&&(kt===2||kt===9)||n.cancelPendingCommit!==null)&&(Jo(n,0),ei(n,dt,Ba,!1)),Ci(n,h),((St&2)===0||n!==It)&&(n===It&&((St&2)===0&&(Gi|=h),ur===4&&ei(n,dt,Ba,!1)),qs(n))}function zx(n,l,h){if((St&6)!==0)throw Error(a(327));var p=!h&&(l&127)===0&&(l&n.expiredLanes)===0||Ti(n,l),b=p?kS(n,l):lp(n,l,!0),E=p;do{if(b===0){Xo&&!p&&ei(n,l,0,!1);break}else{if(h=n.current.alternate,E&&!TS(h)){b=lp(n,l,!1),E=!1;continue}if(b===2){if(E=l,n.errorRecoveryDisabledLanes&E)var k=0;else k=n.pendingLanes&-536870913,k=k!==0?k:k&536870912?536870912:0;if(k!==0){l=k;e:{var L=n;b=Sc;var ee=L.current.memoizedState.isDehydrated;if(ee&&(Jo(L,k).flags|=256),k=lp(L,k,!1),k!==2){if(tp&&!ee){L.errorRecoveryDisabledLanes|=E,Gi|=E,b=4;break e}E=Ta,Ta=b,E!==null&&(Ta===null?Ta=E:Ta.push.apply(Ta,E))}b=k}if(E=!1,b!==2)continue}}if(b===1){Jo(n,0),ei(n,l,0,!0);break}e:{switch(p=n,E=b,E){case 0:case 1:throw Error(a(345));case 4:if((l&4194048)!==l)break;case 6:ei(p,l,Ba,!Kn);break e;case 2:Ta=null;break;case 3:case 5:break;default:throw Error(a(329))}if((l&62914560)===l&&(b=$h+300-Lt(),10<b)){if(ei(p,l,Ba,!Kn),Eo(p,0,!0)!==0)break e;wn=l,p.timeoutHandle=x_(Hx.bind(null,p,h,Ta,Vh,ap,l,Ba,Gi,Yo,Kn,E,"Throttled",-0,0),b);break e}Hx(p,h,Ta,Vh,ap,l,Ba,Gi,Yo,Kn,E,null,-0,0)}}break}while(!0);qs(n)}function Hx(n,l,h,p,b,E,k,L,ee,ce,xe,we,fe,me){if(n.timeoutHandle=-1,we=l.subtreeFlags,we&8192||(we&16785408)===16785408){we={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:on},Mx(l,E,we);var je=(E&62914560)===E?$h-Lt():(E&4194048)===E?Px-Lt():0;if(je=uT(we,je),je!==null){wn=E,n.cancelPendingCommit=je(Kx.bind(null,n,l,E,h,p,b,k,L,ee,xe,we,null,fe,me)),ei(n,E,k,!ce);return}}Kx(n,l,E,h,p,b,k,L,ee)}function TS(n){for(var l=n;;){var h=l.tag;if((h===0||h===11||h===15)&&l.flags&16384&&(h=l.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var p=0;p<h.length;p++){var b=h[p],E=b.getSnapshot;b=b.value;try{if(!Ma(E(),b))return!1}catch{return!1}}if(h=l.child,l.subtreeFlags&16384&&h!==null)h.return=l,l=h;else{if(l===n)break;for(;l.sibling===null;){if(l.return===null||l.return===n)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function ei(n,l,h,p){l&=~rp,l&=~Gi,n.suspendedLanes|=l,n.pingedLanes&=~l,p&&(n.warmLanes|=l),p=n.expirationTimes;for(var b=l;0<b;){var E=31-ca(b),k=1<<E;p[E]=-1,b&=~k}h!==0&&th(n,h,l)}function qh(){return(St&6)===0?(Cc(0),!1):!0}function op(){if(ut!==null){if(kt===0)var n=ut.return;else n=ut,hn=Li=null,E0(n),zo=null,cc=0,n=ut;for(;n!==null;)_x(n.alternate,n),n=n.return;ut=null}}function Jo(n,l){var h=n.timeoutHandle;h!==-1&&(n.timeoutHandle=-1,qS(h)),h=n.cancelPendingCommit,h!==null&&(n.cancelPendingCommit=null,h()),wn=0,op(),It=n,ut=h=cn(n.current,null),dt=l,kt=0,Pa=null,Kn=!1,Xo=Ti(n,l),tp=!1,Yo=Ba=rp=Gi=Jn=ur=0,Ta=Sc=null,ap=!1,(l&8)!==0&&(l|=l&32);var p=n.entangledLanes;if(p!==0)for(n=n.entanglements,p&=l;0<p;){var b=31-ca(p),E=1<<b;l|=n[b],p&=~E}return bn=l,fh(),h}function $x(n,l){st=null,U.H=vc,l===Uo||l===bh?(l=n1(),kt=3):l===h0?(l=n1(),kt=4):kt=l===B0?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Pa=l,ut===null&&(ur=1,Lh(n,ss(l,n.current)))}function Gx(){var n=Ia.current;return n===null?!0:(dt&4194048)===dt?ls===null:(dt&62914560)===dt||(dt&536870912)!==0?n===ls:!1}function Vx(){var n=U.H;return U.H=vc,n===null?vc:n}function qx(){var n=U.A;return U.A=AS,n}function Wh(){ur=4,Kn||(dt&4194048)!==dt&&Ia.current!==null||(Xo=!0),(Jn&134217727)===0&&(Gi&134217727)===0||It===null||ei(It,dt,Ba,!1)}function lp(n,l,h){var p=St;St|=2;var b=Vx(),E=qx();(It!==n||dt!==l)&&(Vh=null,Jo(n,l)),l=!1;var k=ur;e:do try{if(kt!==0&&ut!==null){var L=ut,ee=Pa;switch(kt){case 8:op(),k=6;break e;case 3:case 2:case 9:case 6:Ia.current===null&&(l=!0);var ce=kt;if(kt=0,Pa=null,Qo(n,L,ee,ce),h&&Xo){k=0;break e}break;default:ce=kt,kt=0,Pa=null,Qo(n,L,ee,ce)}}CS(),k=ur;break}catch(xe){$x(n,xe)}while(!0);return l&&n.shellSuspendCounter++,hn=Li=null,St=p,U.H=b,U.A=E,ut===null&&(It=null,dt=0,fh()),k}function CS(){for(;ut!==null;)Wx(ut)}function kS(n,l){var h=St;St|=2;var p=Vx(),b=qx();It!==n||dt!==l?(Vh=null,Gh=Lt()+500,Jo(n,l)):Xo=Ti(n,l);e:do try{if(kt!==0&&ut!==null){l=ut;var E=Pa;t:switch(kt){case 1:kt=0,Pa=null,Qo(n,l,E,1);break;case 2:case 9:if(a1(E)){kt=0,Pa=null,Xx(l);break}l=function(){kt!==2&&kt!==9||It!==n||(kt=7),qs(n)},E.then(l,l);break e;case 3:kt=7;break e;case 4:kt=5;break e;case 7:a1(E)?(kt=0,Pa=null,Xx(l)):(kt=0,Pa=null,Qo(n,l,E,7));break;case 5:var k=null;switch(ut.tag){case 26:k=ut.memoizedState;case 5:case 27:var L=ut;if(k?F_(k):L.stateNode.complete){kt=0,Pa=null;var ee=L.sibling;if(ee!==null)ut=ee;else{var ce=L.return;ce!==null?(ut=ce,Xh(ce)):ut=null}break t}}kt=0,Pa=null,Qo(n,l,E,5);break;case 6:kt=0,Pa=null,Qo(n,l,E,6);break;case 8:op(),ur=6;break e;default:throw Error(a(462))}}NS();break}catch(xe){$x(n,xe)}while(!0);return hn=Li=null,U.H=p,U.A=b,St=h,ut!==null?0:(It=null,dt=0,fh(),ur)}function NS(){for(;ut!==null&&!Ai();)Wx(ut)}function Wx(n){var l=vx(n.alternate,n,bn);n.memoizedProps=n.pendingProps,l===null?Xh(n):ut=l}function Xx(n){var l=n,h=l.alternate;switch(l.tag){case 15:case 0:l=hx(h,l,l.pendingProps,l.type,void 0,dt);break;case 11:l=hx(h,l,l.pendingProps,l.type.render,l.ref,dt);break;case 5:E0(l);default:_x(h,l),l=ut=qv(l,bn),l=vx(h,l,bn)}n.memoizedProps=n.pendingProps,l===null?Xh(n):ut=l}function Qo(n,l,h,p){hn=Li=null,E0(l),zo=null,cc=0;var b=l.return;try{if(vS(n,b,l,h,dt)){ur=1,Lh(n,ss(h,n.current)),ut=null;return}}catch(E){if(b!==null)throw ut=b,E;ur=1,Lh(n,ss(h,n.current)),ut=null;return}l.flags&32768?(pt||p===1?n=!0:Xo||(dt&536870912)!==0?n=!1:(Kn=n=!0,(p===2||p===9||p===3||p===6)&&(p=Ia.current,p!==null&&p.tag===13&&(p.flags|=16384))),Yx(l,n)):Xh(l)}function Xh(n){var l=n;do{if((l.flags&32768)!==0){Yx(l,Kn);return}n=l.return;var h=yS(l.alternate,l,bn);if(h!==null){ut=h;return}if(l=l.sibling,l!==null){ut=l;return}ut=l=n}while(l!==null);ur===0&&(ur=5)}function Yx(n,l){do{var h=bS(n.alternate,n);if(h!==null){h.flags&=32767,ut=h;return}if(h=n.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!l&&(n=n.sibling,n!==null)){ut=n;return}ut=n=h}while(n!==null);ur=6,ut=null}function Kx(n,l,h,p,b,E,k,L,ee){n.cancelPendingCommit=null;do Yh();while(Or!==0);if((St&6)!==0)throw Error(a(327));if(l!==null){if(l===n.current)throw Error(a(177));if(E=l.lanes|l.childLanes,E|=Kf,kf(n,h,E,k,L,ee),n===It&&(ut=It=null,dt=0),Ko=l,Zn=n,wn=h,sp=E,np=b,Bx=p,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,FS(yr,function(){return t_(),null})):(n.callbackNode=null,n.callbackPriority=0),p=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||p){p=U.T,U.T=null,b=te.p,te.p=2,k=St,St|=4;try{wS(n,l,h)}finally{St=k,te.p=b,U.T=p}}Or=1,Jx(),Qx(),Zx()}}function Jx(){if(Or===1){Or=0;var n=Zn,l=Ko,h=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||h){h=U.T,U.T=null;var p=te.p;te.p=2;var b=St;St|=4;try{Ox(l,n);var E=yp,k=jv(n.containerInfo),L=E.focusedElem,ee=E.selectionRange;if(k!==L&&L&&L.ownerDocument&&Iv(L.ownerDocument.documentElement,L)){if(ee!==null&&Vf(L)){var ce=ee.start,xe=ee.end;if(xe===void 0&&(xe=ce),"selectionStart"in L)L.selectionStart=ce,L.selectionEnd=Math.min(xe,L.value.length);else{var we=L.ownerDocument||document,fe=we&&we.defaultView||window;if(fe.getSelection){var me=fe.getSelection(),je=L.textContent.length,We=Math.min(ee.start,je),Dt=ee.end===void 0?We:Math.min(ee.end,je);!me.extend&&We>Dt&&(k=Dt,Dt=We,We=k);var ie=Lv(L,We),ae=Lv(L,Dt);if(ie&&ae&&(me.rangeCount!==1||me.anchorNode!==ie.node||me.anchorOffset!==ie.offset||me.focusNode!==ae.node||me.focusOffset!==ae.offset)){var le=we.createRange();le.setStart(ie.node,ie.offset),me.removeAllRanges(),We>Dt?(me.addRange(le),me.extend(ae.node,ae.offset)):(le.setEnd(ae.node,ae.offset),me.addRange(le))}}}}for(we=[],me=L;me=me.parentNode;)me.nodeType===1&&we.push({element:me,left:me.scrollLeft,top:me.scrollTop});for(typeof L.focus=="function"&&L.focus(),L=0;L<we.length;L++){var ye=we[L];ye.element.scrollLeft=ye.left,ye.element.scrollTop=ye.top}}od=!!_p,yp=_p=null}finally{St=b,te.p=p,U.T=h}}n.current=l,Or=2}}function Qx(){if(Or===2){Or=0;var n=Zn,l=Ko,h=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||h){h=U.T,U.T=null;var p=te.p;te.p=2;var b=St;St|=4;try{Tx(n,l.alternate,l)}finally{St=b,te.p=p,U.T=h}}Or=3}}function Zx(){if(Or===4||Or===3){Or=0,zs();var n=Zn,l=Ko,h=wn,p=Bx;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Or=5:(Or=0,Ko=Zn=null,e_(n,n.pendingLanes));var b=n.pendingLanes;if(b===0&&(Qn=null),Xl(h),l=l.stateNode,gr&&typeof gr.onCommitFiberRoot=="function")try{gr.onCommitFiberRoot(Gt,l,void 0,(l.current.flags&128)===128)}catch{}if(p!==null){l=U.T,b=te.p,te.p=2,U.T=null;try{for(var E=n.onRecoverableError,k=0;k<p.length;k++){var L=p[k];E(L.value,{componentStack:L.stack})}}finally{U.T=l,te.p=b}}(wn&3)!==0&&Yh(),qs(n),b=n.pendingLanes,(h&261930)!==0&&(b&42)!==0?n===ip?Tc++:(Tc=0,ip=n):Tc=0,Cc(0)}}function e_(n,l){(n.pooledCacheLanes&=l)===0&&(l=n.pooledCache,l!=null&&(n.pooledCache=null,oc(l)))}function Yh(){return Jx(),Qx(),Zx(),t_()}function t_(){if(Or!==5)return!1;var n=Zn,l=sp;sp=0;var h=Xl(wn),p=U.T,b=te.p;try{te.p=32>h?32:h,U.T=null,h=np,np=null;var E=Zn,k=wn;if(Or=0,Ko=Zn=null,wn=0,(St&6)!==0)throw Error(a(331));var L=St;if(St|=4,Ix(E.current),Fx(E,E.current,k,h),St=L,Cc(0,!1),gr&&typeof gr.onPostCommitFiberRoot=="function")try{gr.onPostCommitFiberRoot(Gt,E)}catch{}return!0}finally{te.p=b,U.T=p,e_(n,l)}}function r_(n,l,h){l=ss(h,l),l=P0(n.stateNode,l,2),n=qn(n,l,2),n!==null&&(Ci(n,2),qs(n))}function Nt(n,l,h){if(n.tag===3)r_(n,n,h);else for(;l!==null;){if(l.tag===3){r_(l,n,h);break}else if(l.tag===1){var p=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Qn===null||!Qn.has(p))){n=ss(h,n),h=ax(2),p=qn(l,h,2),p!==null&&(sx(h,p,l,n),Ci(p,2),qs(p));break}}l=l.return}}function cp(n,l,h){var p=n.pingCache;if(p===null){p=n.pingCache=new SS;var b=new Set;p.set(l,b)}else b=p.get(l),b===void 0&&(b=new Set,p.set(l,b));b.has(h)||(tp=!0,b.add(h),n=RS.bind(null,n,l,h),l.then(n,n))}function RS(n,l,h){var p=n.pingCache;p!==null&&p.delete(l),n.pingedLanes|=n.suspendedLanes&h,n.warmLanes&=~h,It===n&&(dt&h)===h&&(ur===4||ur===3&&(dt&62914560)===dt&&300>Lt()-$h?(St&2)===0&&Jo(n,0):rp|=h,Yo===dt&&(Yo=0)),qs(n)}function a_(n,l){l===0&&(l=eh()),n=Di(n,l),n!==null&&(Ci(n,l),qs(n))}function OS(n){var l=n.memoizedState,h=0;l!==null&&(h=l.retryLane),a_(n,h)}function DS(n,l){var h=0;switch(n.tag){case 31:case 13:var p=n.stateNode,b=n.memoizedState;b!==null&&(h=b.retryLane);break;case 19:p=n.stateNode;break;case 22:p=n.stateNode._retryCache;break;default:throw Error(a(314))}p!==null&&p.delete(l),a_(n,h)}function FS(n,l){return _a(n,l)}var Kh=null,Zo=null,up=!1,Jh=!1,hp=!1,ti=0;function qs(n){n!==Zo&&n.next===null&&(Zo===null?Kh=Zo=n:Zo=Zo.next=n),Jh=!0,up||(up=!0,LS())}function Cc(n,l){if(!hp&&Jh){hp=!0;do for(var h=!1,p=Kh;p!==null;){if(n!==0){var b=p.pendingLanes;if(b===0)var E=0;else{var k=p.suspendedLanes,L=p.pingedLanes;E=(1<<31-ca(42|n)+1)-1,E&=b&~(k&~L),E=E&201326741?E&201326741|1:E?E|2:0}E!==0&&(h=!0,o_(p,E))}else E=dt,E=Eo(p,p===It?E:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(E&3)===0||Ti(p,E)||(h=!0,o_(p,E));p=p.next}while(h);hp=!1}}function MS(){s_()}function s_(){Jh=up=!1;var n=0;ti!==0&&VS()&&(n=ti);for(var l=Lt(),h=null,p=Kh;p!==null;){var b=p.next,E=n_(p,l);E===0?(p.next=null,h===null?Kh=b:h.next=b,b===null&&(Zo=h)):(h=p,(n!==0||(E&3)!==0)&&(Jh=!0)),p=b}Or!==0&&Or!==5||Cc(n),ti!==0&&(ti=0)}function n_(n,l){for(var h=n.suspendedLanes,p=n.pingedLanes,b=n.expirationTimes,E=n.pendingLanes&-62914561;0<E;){var k=31-ca(E),L=1<<k,ee=b[k];ee===-1?((L&h)===0||(L&p)!==0)&&(b[k]=Cf(L,l)):ee<=l&&(n.expiredLanes|=L),E&=~L}if(l=It,h=dt,h=Eo(n,n===l?h:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),p=n.callbackNode,h===0||n===l&&(kt===2||kt===9)||n.cancelPendingCommit!==null)return p!==null&&p!==null&&Fa(p),n.callbackNode=null,n.callbackPriority=0;if((h&3)===0||Ti(n,h)){if(l=h&-h,l===n.callbackPriority)return l;switch(p!==null&&Fa(p),Xl(h)){case 2:case 8:h=jn;break;case 32:h=yr;break;case 268435456:h=lt;break;default:h=yr}return p=i_.bind(null,n),h=_a(h,p),n.callbackPriority=l,n.callbackNode=h,l}return p!==null&&p!==null&&Fa(p),n.callbackPriority=2,n.callbackNode=null,2}function i_(n,l){if(Or!==0&&Or!==5)return n.callbackNode=null,n.callbackPriority=0,null;var h=n.callbackNode;if(Yh()&&n.callbackNode!==h)return null;var p=dt;return p=Eo(n,n===It?p:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),p===0?null:(zx(n,p,l),n_(n,Lt()),n.callbackNode!=null&&n.callbackNode===h?i_.bind(null,n):null)}function o_(n,l){if(Yh())return null;zx(n,l,!0)}function LS(){WS(function(){(St&6)!==0?_a(Es,MS):s_()})}function dp(){if(ti===0){var n=Po;n===0&&(n=Si,Si<<=1,(Si&261888)===0&&(Si=256)),ti=n}return ti}function l_(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:nh(""+n)}function c_(n,l){var h=l.ownerDocument.createElement("input");return h.name=l.name,h.value=l.value,n.id&&h.setAttribute("form",n.id),l.parentNode.insertBefore(h,l),n=new FormData(n),h.parentNode.removeChild(h),n}function IS(n,l,h,p,b){if(l==="submit"&&h&&h.stateNode===b){var E=l_((b[G]||null).action),k=p.submitter;k&&(l=(l=k[G]||null)?l_(l.formAction):k.getAttribute("formAction"),l!==null&&(E=l,k=null));var L=new ch("action","action",null,p,b);n.push({event:L,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(ti!==0){var ee=k?c_(b,k):new FormData(b);D0(h,{pending:!0,data:ee,method:b.method,action:E},null,ee)}}else typeof E=="function"&&(L.preventDefault(),ee=k?c_(b,k):new FormData(b),D0(h,{pending:!0,data:ee,method:b.method,action:E},E,ee))},currentTarget:b}]})}}for(var fp=0;fp<Yf.length;fp++){var pp=Yf[fp],jS=pp.toLowerCase(),PS=pp[0].toUpperCase()+pp.slice(1);Ss(jS,"on"+PS)}Ss(Uv,"onAnimationEnd"),Ss(zv,"onAnimationIteration"),Ss(Hv,"onAnimationStart"),Ss("dblclick","onDoubleClick"),Ss("focusin","onFocus"),Ss("focusout","onBlur"),Ss(eS,"onTransitionRun"),Ss(tS,"onTransitionStart"),Ss(rS,"onTransitionCancel"),Ss($v,"onTransitionEnd"),es("onMouseEnter",["mouseout","mouseover"]),es("onMouseLeave",["mouseout","mouseover"]),es("onPointerEnter",["pointerout","pointerover"]),es("onPointerLeave",["pointerout","pointerover"]),Kt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Kt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Kt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Kt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Kt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Kt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),BS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(kc));function u_(n,l){l=(l&4)!==0;for(var h=0;h<n.length;h++){var p=n[h],b=p.event;p=p.listeners;e:{var E=void 0;if(l)for(var k=p.length-1;0<=k;k--){var L=p[k],ee=L.instance,ce=L.currentTarget;if(L=L.listener,ee!==E&&b.isPropagationStopped())break e;E=L,b.currentTarget=ce;try{E(b)}catch(xe){dh(xe)}b.currentTarget=null,E=ee}else for(k=0;k<p.length;k++){if(L=p[k],ee=L.instance,ce=L.currentTarget,L=L.listener,ee!==E&&b.isPropagationStopped())break e;E=L,b.currentTarget=ce;try{E(b)}catch(xe){dh(xe)}b.currentTarget=null,E=ee}}}}function ht(n,l){var h=l[ue];h===void 0&&(h=l[ue]=new Set);var p=n+"__bubble";h.has(p)||(h_(l,n,2,!1),h.add(p))}function gp(n,l,h){var p=0;l&&(p|=4),h_(h,n,p,l)}var Qh="_reactListening"+Math.random().toString(36).slice(2);function mp(n){if(!n[Qh]){n[Qh]=!0,Ut.forEach(function(h){h!=="selectionchange"&&(BS.has(h)||gp(h,!1,n),gp(h,!0,n))});var l=n.nodeType===9?n:n.ownerDocument;l===null||l[Qh]||(l[Qh]=!0,gp("selectionchange",!1,l))}}function h_(n,l,h,p){switch(U_(l)){case 2:var b=fT;break;case 8:b=pT;break;default:b=Op}h=b.bind(null,l,h,n),b=void 0,!If||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(b=!0),p?b!==void 0?n.addEventListener(l,h,{capture:!0,passive:b}):n.addEventListener(l,h,!0):b!==void 0?n.addEventListener(l,h,{passive:b}):n.addEventListener(l,h,!1)}function vp(n,l,h,p,b){var E=p;if((l&1)===0&&(l&2)===0&&p!==null)e:for(;;){if(p===null)return;var k=p.tag;if(k===3||k===4){var L=p.stateNode.containerInfo;if(L===b)break;if(k===4)for(k=p.return;k!==null;){var ee=k.tag;if((ee===3||ee===4)&&k.stateNode.containerInfo===b)return;k=k.return}for(;L!==null;){if(k=Re(L),k===null)return;if(ee=k.tag,ee===5||ee===6||ee===26||ee===27){p=E=k;continue e}L=L.parentNode}}p=p.return}mv(function(){var ce=E,xe=Mf(h),we=[];e:{var fe=Gv.get(n);if(fe!==void 0){var me=ch,je=n;switch(n){case"keypress":if(oh(h)===0)break e;case"keydown":case"keyup":me=D2;break;case"focusin":je="focus",me=Uf;break;case"focusout":je="blur",me=Uf;break;case"beforeblur":case"afterblur":me=Uf;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=_v;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=y2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=L2;break;case Uv:case zv:case Hv:me=E2;break;case $v:me=j2;break;case"scroll":case"scrollend":me=x2;break;case"wheel":me=B2;break;case"copy":case"cut":case"paste":me=S2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=bv;break;case"toggle":case"beforetoggle":me=z2}var We=(l&4)!==0,Dt=!We&&(n==="scroll"||n==="scrollend"),ie=We?fe!==null?fe+"Capture":null:fe;We=[];for(var ae=ce,le;ae!==null;){var ye=ae;if(le=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||le===null||ie===null||(ye=Kl(ae,ie),ye!=null&&We.push(Nc(ae,ye,le))),Dt)break;ae=ae.return}0<We.length&&(fe=new me(fe,je,null,h,xe),we.push({event:fe,listeners:We}))}}if((l&7)===0){e:{if(fe=n==="mouseover"||n==="pointerover",me=n==="mouseout"||n==="pointerout",fe&&h!==Ff&&(je=h.relatedTarget||h.fromElement)&&(Re(je)||je[X]))break e;if((me||fe)&&(fe=xe.window===xe?xe:(fe=xe.ownerDocument)?fe.defaultView||fe.parentWindow:window,me?(je=h.relatedTarget||h.toElement,me=ce,je=je?Re(je):null,je!==null&&(Dt=i(je),We=je.tag,je!==Dt||We!==5&&We!==27&&We!==6)&&(je=null)):(me=null,je=ce),me!==je)){if(We=_v,ye="onMouseLeave",ie="onMouseEnter",ae="mouse",(n==="pointerout"||n==="pointerover")&&(We=bv,ye="onPointerLeave",ie="onPointerEnter",ae="pointer"),Dt=me==null?fe:Ce(me),le=je==null?fe:Ce(je),fe=new We(ye,ae+"leave",me,h,xe),fe.target=Dt,fe.relatedTarget=le,ye=null,Re(xe)===ce&&(We=new We(ie,ae+"enter",je,h,xe),We.target=le,We.relatedTarget=Dt,ye=We),Dt=ye,me&&je)t:{for(We=US,ie=me,ae=je,le=0,ye=ie;ye;ye=We(ye))le++;ye=0;for(var $e=ae;$e;$e=We($e))ye++;for(;0<le-ye;)ie=We(ie),le--;for(;0<ye-le;)ae=We(ae),ye--;for(;le--;){if(ie===ae||ae!==null&&ie===ae.alternate){We=ie;break t}ie=We(ie),ae=We(ae)}We=null}else We=null;me!==null&&d_(we,fe,me,We,!1),je!==null&&Dt!==null&&d_(we,Dt,je,We,!0)}}e:{if(fe=ce?Ce(ce):window,me=fe.nodeName&&fe.nodeName.toLowerCase(),me==="select"||me==="input"&&fe.type==="file")var bt=Nv;else if(Cv(fe))if(Rv)bt=J2;else{bt=Y2;var Be=X2}else me=fe.nodeName,!me||me.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?ce&&Df(ce.elementType)&&(bt=Nv):bt=K2;if(bt&&(bt=bt(n,ce))){kv(we,bt,h,xe);break e}Be&&Be(n,fe,ce),n==="focusout"&&ce&&fe.type==="number"&&ce.memoizedProps.value!=null&&Of(fe,"number",fe.value)}switch(Be=ce?Ce(ce):window,n){case"focusin":(Cv(Be)||Be.contentEditable==="true")&&(Ro=Be,qf=ce,sc=null);break;case"focusout":sc=qf=Ro=null;break;case"mousedown":Wf=!0;break;case"contextmenu":case"mouseup":case"dragend":Wf=!1,Pv(we,h,xe);break;case"selectionchange":if(Z2)break;case"keydown":case"keyup":Pv(we,h,xe)}var ct;if(Hf)e:{switch(n){case"compositionstart":var ft="onCompositionStart";break e;case"compositionend":ft="onCompositionEnd";break e;case"compositionupdate":ft="onCompositionUpdate";break e}ft=void 0}else No?Sv(n,h)&&(ft="onCompositionEnd"):n==="keydown"&&h.keyCode===229&&(ft="onCompositionStart");ft&&(wv&&h.locale!=="ko"&&(No||ft!=="onCompositionStart"?ft==="onCompositionEnd"&&No&&(ct=vv()):(Bn=xe,jf="value"in Bn?Bn.value:Bn.textContent,No=!0)),Be=Zh(ce,ft),0<Be.length&&(ft=new yv(ft,n,null,h,xe),we.push({event:ft,listeners:Be}),ct?ft.data=ct:(ct=Tv(h),ct!==null&&(ft.data=ct)))),(ct=$2?G2(n,h):V2(n,h))&&(ft=Zh(ce,"onBeforeInput"),0<ft.length&&(Be=new yv("onBeforeInput","beforeinput",null,h,xe),we.push({event:Be,listeners:ft}),Be.data=ct)),IS(we,n,ce,h,xe)}u_(we,l)})}function Nc(n,l,h){return{instance:n,listener:l,currentTarget:h}}function Zh(n,l){for(var h=l+"Capture",p=[];n!==null;){var b=n,E=b.stateNode;if(b=b.tag,b!==5&&b!==26&&b!==27||E===null||(b=Kl(n,h),b!=null&&p.unshift(Nc(n,b,E)),b=Kl(n,l),b!=null&&p.push(Nc(n,b,E))),n.tag===3)return p;n=n.return}return[]}function US(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function d_(n,l,h,p,b){for(var E=l._reactName,k=[];h!==null&&h!==p;){var L=h,ee=L.alternate,ce=L.stateNode;if(L=L.tag,ee!==null&&ee===p)break;L!==5&&L!==26&&L!==27||ce===null||(ee=ce,b?(ce=Kl(h,E),ce!=null&&k.unshift(Nc(h,ce,ee))):b||(ce=Kl(h,E),ce!=null&&k.push(Nc(h,ce,ee)))),h=h.return}k.length!==0&&n.push({event:l,listeners:k})}var zS=/\r\n?/g,HS=/\u0000|\uFFFD/g;function f_(n){return(typeof n=="string"?n:""+n).replace(zS,`
`).replace(HS,"")}function p_(n,l){return l=f_(l),f_(n)===l}function Ot(n,l,h,p,b,E){switch(h){case"children":typeof p=="string"?l==="body"||l==="textarea"&&p===""||To(n,p):(typeof p=="number"||typeof p=="bigint")&&l!=="body"&&To(n,""+p);break;case"className":ah(n,"class",p);break;case"tabIndex":ah(n,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":ah(n,h,p);break;case"style":pv(n,p,E);break;case"data":if(l!=="object"){ah(n,"data",p);break}case"src":case"href":if(p===""&&(l!=="a"||h!=="href")){n.removeAttribute(h);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){n.removeAttribute(h);break}p=nh(""+p),n.setAttribute(h,p);break;case"action":case"formAction":if(typeof p=="function"){n.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(h==="formAction"?(l!=="input"&&Ot(n,l,"name",b.name,b,null),Ot(n,l,"formEncType",b.formEncType,b,null),Ot(n,l,"formMethod",b.formMethod,b,null),Ot(n,l,"formTarget",b.formTarget,b,null)):(Ot(n,l,"encType",b.encType,b,null),Ot(n,l,"method",b.method,b,null),Ot(n,l,"target",b.target,b,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){n.removeAttribute(h);break}p=nh(""+p),n.setAttribute(h,p);break;case"onClick":p!=null&&(n.onclick=on);break;case"onScroll":p!=null&&ht("scroll",n);break;case"onScrollEnd":p!=null&&ht("scrollend",n);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(a(61));if(h=p.__html,h!=null){if(b.children!=null)throw Error(a(60));n.innerHTML=h}}break;case"multiple":n.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":n.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){n.removeAttribute("xlink:href");break}h=nh(""+p),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?n.setAttribute(h,""+p):n.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?n.setAttribute(h,""):n.removeAttribute(h);break;case"capture":case"download":p===!0?n.setAttribute(h,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?n.setAttribute(h,p):n.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?n.setAttribute(h,p):n.removeAttribute(h);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?n.removeAttribute(h):n.setAttribute(h,p);break;case"popover":ht("beforetoggle",n),ht("toggle",n),ba(n,"popover",p);break;case"xlinkActuate":nn(n,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":nn(n,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":nn(n,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":nn(n,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":nn(n,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":nn(n,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":nn(n,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":nn(n,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":nn(n,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":ba(n,"is",p);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=m2.get(h)||h,ba(n,h,p))}}function xp(n,l,h,p,b,E){switch(h){case"style":pv(n,p,E);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(a(61));if(h=p.__html,h!=null){if(b.children!=null)throw Error(a(60));n.innerHTML=h}}break;case"children":typeof p=="string"?To(n,p):(typeof p=="number"||typeof p=="bigint")&&To(n,""+p);break;case"onScroll":p!=null&&ht("scroll",n);break;case"onScrollEnd":p!=null&&ht("scrollend",n);break;case"onClick":p!=null&&(n.onclick=on);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!zt.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(b=h.endsWith("Capture"),l=h.slice(2,b?h.length-7:void 0),E=n[G]||null,E=E!=null?E[h]:null,typeof E=="function"&&n.removeEventListener(l,E,b),typeof p=="function")){typeof E!="function"&&E!==null&&(h in n?n[h]=null:n.hasAttribute(h)&&n.removeAttribute(h)),n.addEventListener(l,p,b);break e}h in n?n[h]=p:p===!0?n.setAttribute(h,""):ba(n,h,p)}}}function qr(n,l,h){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ht("error",n),ht("load",n);var p=!1,b=!1,E;for(E in h)if(h.hasOwnProperty(E)){var k=h[E];if(k!=null)switch(E){case"src":p=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,l));default:Ot(n,l,E,k,h,null)}}b&&Ot(n,l,"srcSet",h.srcSet,h,null),p&&Ot(n,l,"src",h.src,h,null);return;case"input":ht("invalid",n);var L=E=k=b=null,ee=null,ce=null;for(p in h)if(h.hasOwnProperty(p)){var xe=h[p];if(xe!=null)switch(p){case"name":b=xe;break;case"type":k=xe;break;case"checked":ee=xe;break;case"defaultChecked":ce=xe;break;case"value":E=xe;break;case"defaultValue":L=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(a(137,l));break;default:Ot(n,l,p,xe,h,null)}}uv(n,E,L,ee,ce,k,b,!1);return;case"select":ht("invalid",n),p=k=E=null;for(b in h)if(h.hasOwnProperty(b)&&(L=h[b],L!=null))switch(b){case"value":E=L;break;case"defaultValue":k=L;break;case"multiple":p=L;default:Ot(n,l,b,L,h,null)}l=E,h=k,n.multiple=!!p,l!=null?So(n,!!p,l,!1):h!=null&&So(n,!!p,h,!0);return;case"textarea":ht("invalid",n),E=b=p=null;for(k in h)if(h.hasOwnProperty(k)&&(L=h[k],L!=null))switch(k){case"value":p=L;break;case"defaultValue":b=L;break;case"children":E=L;break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(a(91));break;default:Ot(n,l,k,L,h,null)}dv(n,p,b,E);return;case"option":for(ee in h)h.hasOwnProperty(ee)&&(p=h[ee],p!=null)&&(ee==="selected"?n.selected=p&&typeof p!="function"&&typeof p!="symbol":Ot(n,l,ee,p,h,null));return;case"dialog":ht("beforetoggle",n),ht("toggle",n),ht("cancel",n),ht("close",n);break;case"iframe":case"object":ht("load",n);break;case"video":case"audio":for(p=0;p<kc.length;p++)ht(kc[p],n);break;case"image":ht("error",n),ht("load",n);break;case"details":ht("toggle",n);break;case"embed":case"source":case"link":ht("error",n),ht("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ce in h)if(h.hasOwnProperty(ce)&&(p=h[ce],p!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,l));default:Ot(n,l,ce,p,h,null)}return;default:if(Df(l)){for(xe in h)h.hasOwnProperty(xe)&&(p=h[xe],p!==void 0&&xp(n,l,xe,p,h,void 0));return}}for(L in h)h.hasOwnProperty(L)&&(p=h[L],p!=null&&Ot(n,l,L,p,h,null))}function $S(n,l,h,p){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,E=null,k=null,L=null,ee=null,ce=null,xe=null;for(me in h){var we=h[me];if(h.hasOwnProperty(me)&&we!=null)switch(me){case"checked":break;case"value":break;case"defaultValue":ee=we;default:p.hasOwnProperty(me)||Ot(n,l,me,null,p,we)}}for(var fe in p){var me=p[fe];if(we=h[fe],p.hasOwnProperty(fe)&&(me!=null||we!=null))switch(fe){case"type":E=me;break;case"name":b=me;break;case"checked":ce=me;break;case"defaultChecked":xe=me;break;case"value":k=me;break;case"defaultValue":L=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(a(137,l));break;default:me!==we&&Ot(n,l,fe,me,p,we)}}Rf(n,k,L,ee,ce,xe,E,b);return;case"select":me=k=L=fe=null;for(E in h)if(ee=h[E],h.hasOwnProperty(E)&&ee!=null)switch(E){case"value":break;case"multiple":me=ee;default:p.hasOwnProperty(E)||Ot(n,l,E,null,p,ee)}for(b in p)if(E=p[b],ee=h[b],p.hasOwnProperty(b)&&(E!=null||ee!=null))switch(b){case"value":fe=E;break;case"defaultValue":L=E;break;case"multiple":k=E;default:E!==ee&&Ot(n,l,b,E,p,ee)}l=L,h=k,p=me,fe!=null?So(n,!!h,fe,!1):!!p!=!!h&&(l!=null?So(n,!!h,l,!0):So(n,!!h,h?[]:"",!1));return;case"textarea":me=fe=null;for(L in h)if(b=h[L],h.hasOwnProperty(L)&&b!=null&&!p.hasOwnProperty(L))switch(L){case"value":break;case"children":break;default:Ot(n,l,L,null,p,b)}for(k in p)if(b=p[k],E=h[k],p.hasOwnProperty(k)&&(b!=null||E!=null))switch(k){case"value":fe=b;break;case"defaultValue":me=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(a(91));break;default:b!==E&&Ot(n,l,k,b,p,E)}hv(n,fe,me);return;case"option":for(var je in h)fe=h[je],h.hasOwnProperty(je)&&fe!=null&&!p.hasOwnProperty(je)&&(je==="selected"?n.selected=!1:Ot(n,l,je,null,p,fe));for(ee in p)fe=p[ee],me=h[ee],p.hasOwnProperty(ee)&&fe!==me&&(fe!=null||me!=null)&&(ee==="selected"?n.selected=fe&&typeof fe!="function"&&typeof fe!="symbol":Ot(n,l,ee,fe,p,me));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var We in h)fe=h[We],h.hasOwnProperty(We)&&fe!=null&&!p.hasOwnProperty(We)&&Ot(n,l,We,null,p,fe);for(ce in p)if(fe=p[ce],me=h[ce],p.hasOwnProperty(ce)&&fe!==me&&(fe!=null||me!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(a(137,l));break;default:Ot(n,l,ce,fe,p,me)}return;default:if(Df(l)){for(var Dt in h)fe=h[Dt],h.hasOwnProperty(Dt)&&fe!==void 0&&!p.hasOwnProperty(Dt)&&xp(n,l,Dt,void 0,p,fe);for(xe in p)fe=p[xe],me=h[xe],!p.hasOwnProperty(xe)||fe===me||fe===void 0&&me===void 0||xp(n,l,xe,fe,p,me);return}}for(var ie in h)fe=h[ie],h.hasOwnProperty(ie)&&fe!=null&&!p.hasOwnProperty(ie)&&Ot(n,l,ie,null,p,fe);for(we in p)fe=p[we],me=h[we],!p.hasOwnProperty(we)||fe===me||fe==null&&me==null||Ot(n,l,we,fe,p,me)}function g_(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function GS(){if(typeof performance.getEntriesByType=="function"){for(var n=0,l=0,h=performance.getEntriesByType("resource"),p=0;p<h.length;p++){var b=h[p],E=b.transferSize,k=b.initiatorType,L=b.duration;if(E&&L&&g_(k)){for(k=0,L=b.responseEnd,p+=1;p<h.length;p++){var ee=h[p],ce=ee.startTime;if(ce>L)break;var xe=ee.transferSize,we=ee.initiatorType;xe&&g_(we)&&(ee=ee.responseEnd,k+=xe*(ee<L?1:(L-ce)/(ee-ce)))}if(--p,l+=8*(E+k)/(b.duration/1e3),n++,10<n)break}}if(0<n)return l/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var _p=null,yp=null;function ed(n){return n.nodeType===9?n:n.ownerDocument}function m_(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function v_(n,l){if(n===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&l==="foreignObject"?0:n}function bp(n,l){return n==="textarea"||n==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var wp=null;function VS(){var n=window.event;return n&&n.type==="popstate"?n===wp?!1:(wp=n,!0):(wp=null,!1)}var x_=typeof setTimeout=="function"?setTimeout:void 0,qS=typeof clearTimeout=="function"?clearTimeout:void 0,__=typeof Promise=="function"?Promise:void 0,WS=typeof queueMicrotask=="function"?queueMicrotask:typeof __<"u"?function(n){return __.resolve(null).then(n).catch(XS)}:x_;function XS(n){setTimeout(function(){throw n})}function ri(n){return n==="head"}function y_(n,l){var h=l,p=0;do{var b=h.nextSibling;if(n.removeChild(h),b&&b.nodeType===8)if(h=b.data,h==="/$"||h==="/&"){if(p===0){n.removeChild(b),al(l);return}p--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")p++;else if(h==="html")Rc(n.ownerDocument.documentElement);else if(h==="head"){h=n.ownerDocument.head,Rc(h);for(var E=h.firstChild;E;){var k=E.nextSibling,L=E.nodeName;E[pe]||L==="SCRIPT"||L==="STYLE"||L==="LINK"&&E.rel.toLowerCase()==="stylesheet"||h.removeChild(E),E=k}}else h==="body"&&Rc(n.ownerDocument.body);h=b}while(h);al(l)}function b_(n,l){var h=n;n=0;do{var p=h.nextSibling;if(h.nodeType===1?l?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(l?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),p&&p.nodeType===8)if(h=p.data,h==="/$"){if(n===0)break;n--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||n++;h=p}while(h)}function Ep(n){var l=n.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var h=l;switch(l=l.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":Ep(h),Se(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}n.removeChild(h)}}function YS(n,l,h,p){for(;n.nodeType===1;){var b=h;if(n.nodeName.toLowerCase()!==l.toLowerCase()){if(!p&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(p){if(!n[pe])switch(l){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(E=n.getAttribute("rel"),E==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(E!==b.rel||n.getAttribute("href")!==(b.href==null||b.href===""?null:b.href)||n.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||n.getAttribute("title")!==(b.title==null?null:b.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(E=n.getAttribute("src"),(E!==(b.src==null?null:b.src)||n.getAttribute("type")!==(b.type==null?null:b.type)||n.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&E&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(l==="input"&&n.type==="hidden"){var E=b.name==null?null:""+b.name;if(b.type==="hidden"&&n.getAttribute("name")===E)return n}else return n;if(n=cs(n.nextSibling),n===null)break}return null}function KS(n,l,h){if(l==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!h||(n=cs(n.nextSibling),n===null))return null;return n}function w_(n,l){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!l||(n=cs(n.nextSibling),n===null))return null;return n}function Ap(n){return n.data==="$?"||n.data==="$~"}function Sp(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function JS(n,l){var h=n.ownerDocument;if(n.data==="$~")n._reactRetry=l;else if(n.data!=="$?"||h.readyState!=="loading")l();else{var p=function(){l(),h.removeEventListener("DOMContentLoaded",p)};h.addEventListener("DOMContentLoaded",p),n._reactRetry=p}}function cs(n){for(;n!=null;n=n.nextSibling){var l=n.nodeType;if(l===1||l===3)break;if(l===8){if(l=n.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return n}var Tp=null;function E_(n){n=n.nextSibling;for(var l=0;n;){if(n.nodeType===8){var h=n.data;if(h==="/$"||h==="/&"){if(l===0)return cs(n.nextSibling);l--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||l++}n=n.nextSibling}return null}function A_(n){n=n.previousSibling;for(var l=0;n;){if(n.nodeType===8){var h=n.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(l===0)return n;l--}else h!=="/$"&&h!=="/&"||l++}n=n.previousSibling}return null}function S_(n,l,h){switch(l=ed(h),n){case"html":if(n=l.documentElement,!n)throw Error(a(452));return n;case"head":if(n=l.head,!n)throw Error(a(453));return n;case"body":if(n=l.body,!n)throw Error(a(454));return n;default:throw Error(a(451))}}function Rc(n){for(var l=n.attributes;l.length;)n.removeAttributeNode(l[0]);Se(n)}var us=new Map,T_=new Set;function td(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var En=te.d;te.d={f:QS,r:ZS,D:eT,C:tT,L:rT,m:aT,X:nT,S:sT,M:iT};function QS(){var n=En.f(),l=qh();return n||l}function ZS(n){var l=Fe(n);l!==null&&l.tag===5&&l.type==="form"?$1(l):En.r(n)}var el=typeof document>"u"?null:document;function C_(n,l,h){var p=el;if(p&&typeof l=="string"&&l){var b=rs(l);b='link[rel="'+n+'"][href="'+b+'"]',typeof h=="string"&&(b+='[crossorigin="'+h+'"]'),T_.has(b)||(T_.add(b),n={rel:n,crossOrigin:h,href:l},p.querySelector(b)===null&&(l=p.createElement("link"),qr(l,"link",n),Pe(l),p.head.appendChild(l)))}}function eT(n){En.D(n),C_("dns-prefetch",n,null)}function tT(n,l){En.C(n,l),C_("preconnect",n,l)}function rT(n,l,h){En.L(n,l,h);var p=el;if(p&&n&&l){var b='link[rel="preload"][as="'+rs(l)+'"]';l==="image"&&h&&h.imageSrcSet?(b+='[imagesrcset="'+rs(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(b+='[imagesizes="'+rs(h.imageSizes)+'"]')):b+='[href="'+rs(n)+'"]';var E=b;switch(l){case"style":E=tl(n);break;case"script":E=rl(n)}us.has(E)||(n=g({rel:"preload",href:l==="image"&&h&&h.imageSrcSet?void 0:n,as:l},h),us.set(E,n),p.querySelector(b)!==null||l==="style"&&p.querySelector(Oc(E))||l==="script"&&p.querySelector(Dc(E))||(l=p.createElement("link"),qr(l,"link",n),Pe(l),p.head.appendChild(l)))}}function aT(n,l){En.m(n,l);var h=el;if(h&&n){var p=l&&typeof l.as=="string"?l.as:"script",b='link[rel="modulepreload"][as="'+rs(p)+'"][href="'+rs(n)+'"]',E=b;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=rl(n)}if(!us.has(E)&&(n=g({rel:"modulepreload",href:n},l),us.set(E,n),h.querySelector(b)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Dc(E)))return}p=h.createElement("link"),qr(p,"link",n),Pe(p),h.head.appendChild(p)}}}function sT(n,l,h){En.S(n,l,h);var p=el;if(p&&n){var b=Oe(p).hoistableStyles,E=tl(n);l=l||"default";var k=b.get(E);if(!k){var L={loading:0,preload:null};if(k=p.querySelector(Oc(E)))L.loading=5;else{n=g({rel:"stylesheet",href:n,"data-precedence":l},h),(h=us.get(E))&&Cp(n,h);var ee=k=p.createElement("link");Pe(ee),qr(ee,"link",n),ee._p=new Promise(function(ce,xe){ee.onload=ce,ee.onerror=xe}),ee.addEventListener("load",function(){L.loading|=1}),ee.addEventListener("error",function(){L.loading|=2}),L.loading|=4,rd(k,l,p)}k={type:"stylesheet",instance:k,count:1,state:L},b.set(E,k)}}}function nT(n,l){En.X(n,l);var h=el;if(h&&n){var p=Oe(h).hoistableScripts,b=rl(n),E=p.get(b);E||(E=h.querySelector(Dc(b)),E||(n=g({src:n,async:!0},l),(l=us.get(b))&&kp(n,l),E=h.createElement("script"),Pe(E),qr(E,"link",n),h.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},p.set(b,E))}}function iT(n,l){En.M(n,l);var h=el;if(h&&n){var p=Oe(h).hoistableScripts,b=rl(n),E=p.get(b);E||(E=h.querySelector(Dc(b)),E||(n=g({src:n,async:!0,type:"module"},l),(l=us.get(b))&&kp(n,l),E=h.createElement("script"),Pe(E),qr(E,"link",n),h.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},p.set(b,E))}}function k_(n,l,h,p){var b=(b=oe.current)?td(b):null;if(!b)throw Error(a(446));switch(n){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(l=tl(h.href),h=Oe(b).hoistableStyles,p=h.get(l),p||(p={type:"style",instance:null,count:0,state:null},h.set(l,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){n=tl(h.href);var E=Oe(b).hoistableStyles,k=E.get(n);if(k||(b=b.ownerDocument||b,k={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(n,k),(E=b.querySelector(Oc(n)))&&!E._p&&(k.instance=E,k.state.loading=5),us.has(n)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},us.set(n,h),E||oT(b,n,h,k.state))),l&&p===null)throw Error(a(528,""));return k}if(l&&p!==null)throw Error(a(529,""));return null;case"script":return l=h.async,h=h.src,typeof h=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=rl(h),h=Oe(b).hoistableScripts,p=h.get(l),p||(p={type:"script",instance:null,count:0,state:null},h.set(l,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,n))}}function tl(n){return'href="'+rs(n)+'"'}function Oc(n){return'link[rel="stylesheet"]['+n+"]"}function N_(n){return g({},n,{"data-precedence":n.precedence,precedence:null})}function oT(n,l,h,p){n.querySelector('link[rel="preload"][as="style"]['+l+"]")?p.loading=1:(l=n.createElement("link"),p.preload=l,l.addEventListener("load",function(){return p.loading|=1}),l.addEventListener("error",function(){return p.loading|=2}),qr(l,"link",h),Pe(l),n.head.appendChild(l))}function rl(n){return'[src="'+rs(n)+'"]'}function Dc(n){return"script[async]"+n}function R_(n,l,h){if(l.count++,l.instance===null)switch(l.type){case"style":var p=n.querySelector('style[data-href~="'+rs(h.href)+'"]');if(p)return l.instance=p,Pe(p),p;var b=g({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return p=(n.ownerDocument||n).createElement("style"),Pe(p),qr(p,"style",b),rd(p,h.precedence,n),l.instance=p;case"stylesheet":b=tl(h.href);var E=n.querySelector(Oc(b));if(E)return l.state.loading|=4,l.instance=E,Pe(E),E;p=N_(h),(b=us.get(b))&&Cp(p,b),E=(n.ownerDocument||n).createElement("link"),Pe(E);var k=E;return k._p=new Promise(function(L,ee){k.onload=L,k.onerror=ee}),qr(E,"link",p),l.state.loading|=4,rd(E,h.precedence,n),l.instance=E;case"script":return E=rl(h.src),(b=n.querySelector(Dc(E)))?(l.instance=b,Pe(b),b):(p=h,(b=us.get(E))&&(p=g({},h),kp(p,b)),n=n.ownerDocument||n,b=n.createElement("script"),Pe(b),qr(b,"link",p),n.head.appendChild(b),l.instance=b);case"void":return null;default:throw Error(a(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(p=l.instance,l.state.loading|=4,rd(p,h.precedence,n));return l.instance}function rd(n,l,h){for(var p=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=p.length?p[p.length-1]:null,E=b,k=0;k<p.length;k++){var L=p[k];if(L.dataset.precedence===l)E=L;else if(E!==b)break}E?E.parentNode.insertBefore(n,E.nextSibling):(l=h.nodeType===9?h.head:h,l.insertBefore(n,l.firstChild))}function Cp(n,l){n.crossOrigin==null&&(n.crossOrigin=l.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=l.referrerPolicy),n.title==null&&(n.title=l.title)}function kp(n,l){n.crossOrigin==null&&(n.crossOrigin=l.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=l.referrerPolicy),n.integrity==null&&(n.integrity=l.integrity)}var ad=null;function O_(n,l,h){if(ad===null){var p=new Map,b=ad=new Map;b.set(h,p)}else b=ad,p=b.get(h),p||(p=new Map,b.set(h,p));if(p.has(n))return p;for(p.set(n,null),h=h.getElementsByTagName(n),b=0;b<h.length;b++){var E=h[b];if(!(E[pe]||E[B]||n==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var k=E.getAttribute(l)||"";k=n+k;var L=p.get(k);L?L.push(E):p.set(k,[E])}}return p}function D_(n,l,h){n=n.ownerDocument||n,n.head.insertBefore(h,l==="title"?n.querySelector("head > title"):null)}function lT(n,l,h){if(h===1||l.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;return l.rel==="stylesheet"?(n=l.disabled,typeof l.precedence=="string"&&n==null):!0;case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function F_(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function cT(n,l,h,p){if(h.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var b=tl(p.href),E=l.querySelector(Oc(b));if(E){l=E._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(n.count++,n=sd.bind(n),l.then(n,n)),h.state.loading|=4,h.instance=E,Pe(E);return}E=l.ownerDocument||l,p=N_(p),(b=us.get(b))&&Cp(p,b),E=E.createElement("link"),Pe(E);var k=E;k._p=new Promise(function(L,ee){k.onload=L,k.onerror=ee}),qr(E,"link",p),h.instance=E}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(h,l),(l=h.state.preload)&&(h.state.loading&3)===0&&(n.count++,h=sd.bind(n),l.addEventListener("load",h),l.addEventListener("error",h))}}var Np=0;function uT(n,l){return n.stylesheets&&n.count===0&&id(n,n.stylesheets),0<n.count||0<n.imgCount?function(h){var p=setTimeout(function(){if(n.stylesheets&&id(n,n.stylesheets),n.unsuspend){var E=n.unsuspend;n.unsuspend=null,E()}},6e4+l);0<n.imgBytes&&Np===0&&(Np=62500*GS());var b=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&id(n,n.stylesheets),n.unsuspend)){var E=n.unsuspend;n.unsuspend=null,E()}},(n.imgBytes>Np?50:800)+l);return n.unsuspend=h,function(){n.unsuspend=null,clearTimeout(p),clearTimeout(b)}}:null}function sd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)id(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var nd=null;function id(n,l){n.stylesheets=null,n.unsuspend!==null&&(n.count++,nd=new Map,l.forEach(hT,n),nd=null,sd.call(n))}function hT(n,l){if(!(l.state.loading&4)){var h=nd.get(n);if(h)var p=h.get(null);else{h=new Map,nd.set(n,h);for(var b=n.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<b.length;E++){var k=b[E];(k.nodeName==="LINK"||k.getAttribute("media")!=="not all")&&(h.set(k.dataset.precedence,k),p=k)}p&&h.set(null,p)}b=l.instance,k=b.getAttribute("data-precedence"),E=h.get(k)||p,E===p&&h.set(null,b),h.set(k,b),this.count++,p=sd.bind(this),b.addEventListener("load",p),b.addEventListener("error",p),E?E.parentNode.insertBefore(b,E.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(b,n.firstChild)),l.state.loading|=4}}var Fc={$$typeof:S,Provider:null,Consumer:null,_currentValue:be,_currentValue2:be,_threadCount:0};function dT(n,l,h,p,b,E,k,L,ee){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ql(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ql(0),this.hiddenUpdates=ql(null),this.identifierPrefix=p,this.onUncaughtError=b,this.onCaughtError=E,this.onRecoverableError=k,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ee,this.incompleteTransitions=new Map}function M_(n,l,h,p,b,E,k,L,ee,ce,xe,we){return n=new dT(n,l,h,k,ee,ce,xe,we,L),l=1,E===!0&&(l|=24),E=La(3,null,null,l),n.current=E,E.stateNode=n,l=l0(),l.refCount++,n.pooledCache=l,l.refCount++,E.memoizedState={element:p,isDehydrated:h,cache:l},d0(E),n}function L_(n){return n?(n=Fo,n):Fo}function I_(n,l,h,p,b,E){b=L_(b),p.context===null?p.context=b:p.pendingContext=b,p=Vn(l),p.payload={element:h},E=E===void 0?null:E,E!==null&&(p.callback=E),h=qn(n,p,l),h!==null&&(Ca(h,n,l),hc(h,n,l))}function j_(n,l){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var h=n.retryLane;n.retryLane=h!==0&&h<l?h:l}}function Rp(n,l){j_(n,l),(n=n.alternate)&&j_(n,l)}function P_(n){if(n.tag===13||n.tag===31){var l=Di(n,67108864);l!==null&&Ca(l,n,67108864),Rp(n,67108864)}}function B_(n){if(n.tag===13||n.tag===31){var l=Ua();l=Wl(l);var h=Di(n,l);h!==null&&Ca(h,n,l),Rp(n,l)}}var od=!0;function fT(n,l,h,p){var b=U.T;U.T=null;var E=te.p;try{te.p=2,Op(n,l,h,p)}finally{te.p=E,U.T=b}}function pT(n,l,h,p){var b=U.T;U.T=null;var E=te.p;try{te.p=8,Op(n,l,h,p)}finally{te.p=E,U.T=b}}function Op(n,l,h,p){if(od){var b=Dp(p);if(b===null)vp(n,l,p,ld,h),z_(n,p);else if(mT(b,n,l,h,p))p.stopPropagation();else if(z_(n,p),l&4&&-1<gT.indexOf(n)){for(;b!==null;){var E=Fe(b);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var k=Za(E.pendingLanes);if(k!==0){var L=E;for(L.pendingLanes|=2,L.entangledLanes|=2;k;){var ee=1<<31-ca(k);L.entanglements[1]|=ee,k&=~ee}qs(E),(St&6)===0&&(Gh=Lt()+500,Cc(0))}}break;case 31:case 13:L=Di(E,2),L!==null&&Ca(L,E,2),qh(),Rp(E,2)}if(E=Dp(p),E===null&&vp(n,l,p,ld,h),E===b)break;b=E}b!==null&&p.stopPropagation()}else vp(n,l,p,null,h)}}function Dp(n){return n=Mf(n),Fp(n)}var ld=null;function Fp(n){if(ld=null,n=Re(n),n!==null){var l=i(n);if(l===null)n=null;else{var h=l.tag;if(h===13){if(n=o(l),n!==null)return n;n=null}else if(h===31){if(n=c(l),n!==null)return n;n=null}else if(h===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;n=null}else l!==n&&(n=null)}}return ld=n,null}function U_(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ws()){case Es:return 2;case jn:return 8;case yr:case Qa:return 32;case lt:return 268435456;default:return 32}default:return 32}}var Mp=!1,ai=null,si=null,ni=null,Mc=new Map,Lc=new Map,ii=[],gT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function z_(n,l){switch(n){case"focusin":case"focusout":ai=null;break;case"dragenter":case"dragleave":si=null;break;case"mouseover":case"mouseout":ni=null;break;case"pointerover":case"pointerout":Mc.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lc.delete(l.pointerId)}}function Ic(n,l,h,p,b,E){return n===null||n.nativeEvent!==E?(n={blockedOn:l,domEventName:h,eventSystemFlags:p,nativeEvent:E,targetContainers:[b]},l!==null&&(l=Fe(l),l!==null&&P_(l)),n):(n.eventSystemFlags|=p,l=n.targetContainers,b!==null&&l.indexOf(b)===-1&&l.push(b),n)}function mT(n,l,h,p,b){switch(l){case"focusin":return ai=Ic(ai,n,l,h,p,b),!0;case"dragenter":return si=Ic(si,n,l,h,p,b),!0;case"mouseover":return ni=Ic(ni,n,l,h,p,b),!0;case"pointerover":var E=b.pointerId;return Mc.set(E,Ic(Mc.get(E)||null,n,l,h,p,b)),!0;case"gotpointercapture":return E=b.pointerId,Lc.set(E,Ic(Lc.get(E)||null,n,l,h,p,b)),!0}return!1}function H_(n){var l=Re(n.target);if(l!==null){var h=i(l);if(h!==null){if(l=h.tag,l===13){if(l=o(h),l!==null){n.blockedOn=l,V(n.priority,function(){B_(h)});return}}else if(l===31){if(l=c(h),l!==null){n.blockedOn=l,V(n.priority,function(){B_(h)});return}}else if(l===3&&h.stateNode.current.memoizedState.isDehydrated){n.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}n.blockedOn=null}function cd(n){if(n.blockedOn!==null)return!1;for(var l=n.targetContainers;0<l.length;){var h=Dp(n.nativeEvent);if(h===null){h=n.nativeEvent;var p=new h.constructor(h.type,h);Ff=p,h.target.dispatchEvent(p),Ff=null}else return l=Fe(h),l!==null&&P_(l),n.blockedOn=h,!1;l.shift()}return!0}function $_(n,l,h){cd(n)&&h.delete(l)}function vT(){Mp=!1,ai!==null&&cd(ai)&&(ai=null),si!==null&&cd(si)&&(si=null),ni!==null&&cd(ni)&&(ni=null),Mc.forEach($_),Lc.forEach($_)}function ud(n,l){n.blockedOn===l&&(n.blockedOn=null,Mp||(Mp=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,vT)))}var hd=null;function G_(n){hd!==n&&(hd=n,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){hd===n&&(hd=null);for(var l=0;l<n.length;l+=3){var h=n[l],p=n[l+1],b=n[l+2];if(typeof p!="function"){if(Fp(p||h)===null)continue;break}var E=Fe(h);E!==null&&(n.splice(l,3),l-=3,D0(E,{pending:!0,data:b,method:h.method,action:p},p,b))}}))}function al(n){function l(ee){return ud(ee,n)}ai!==null&&ud(ai,n),si!==null&&ud(si,n),ni!==null&&ud(ni,n),Mc.forEach(l),Lc.forEach(l);for(var h=0;h<ii.length;h++){var p=ii[h];p.blockedOn===n&&(p.blockedOn=null)}for(;0<ii.length&&(h=ii[0],h.blockedOn===null);)H_(h),h.blockedOn===null&&ii.shift();if(h=(n.ownerDocument||n).$$reactFormReplay,h!=null)for(p=0;p<h.length;p+=3){var b=h[p],E=h[p+1],k=b[G]||null;if(typeof E=="function")k||G_(h);else if(k){var L=null;if(E&&E.hasAttribute("formAction")){if(b=E,k=E[G]||null)L=k.formAction;else if(Fp(b)!==null)continue}else L=k.action;typeof L=="function"?h[p+1]=L:(h.splice(p,3),p-=3),G_(h)}}}function V_(){function n(E){E.canIntercept&&E.info==="react-transition"&&E.intercept({handler:function(){return new Promise(function(k){return b=k})},focusReset:"manual",scroll:"manual"})}function l(){b!==null&&(b(),b=null),p||setTimeout(h,20)}function h(){if(!p&&!navigation.transition){var E=navigation.currentEntry;E&&E.url!=null&&navigation.navigate(E.url,{state:E.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,b=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(h,100),function(){p=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),b!==null&&(b(),b=null)}}}function Lp(n){this._internalRoot=n}dd.prototype.render=Lp.prototype.render=function(n){var l=this._internalRoot;if(l===null)throw Error(a(409));var h=l.current,p=Ua();I_(h,p,n,l,null,null)},dd.prototype.unmount=Lp.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var l=n.containerInfo;I_(n.current,2,null,n,null,null),qh(),l[X]=null}};function dd(n){this._internalRoot=n}dd.prototype.unstable_scheduleHydration=function(n){if(n){var l=M();n={blockedOn:null,target:n,priority:l};for(var h=0;h<ii.length&&l!==0&&l<ii[h].priority;h++);ii.splice(h,0,n),h===0&&H_(n)}};var q_=e.version;if(q_!=="19.2.3")throw Error(a(527,q_,"19.2.3"));te.findDOMNode=function(n){var l=n._reactInternals;if(l===void 0)throw typeof n.render=="function"?Error(a(188)):(n=Object.keys(n).join(","),Error(a(268,n)));return n=d(l),n=n!==null?f(n):null,n=n===null?null:n.stateNode,n};var xT={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var fd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fd.isDisabled&&fd.supportsFiber)try{Gt=fd.inject(xT),gr=fd}catch{}}return Pc.createRoot=function(n,l){if(!s(n))throw Error(a(299));var h=!1,p="",b=Z1,E=ex,k=tx;return l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onUncaughtError!==void 0&&(b=l.onUncaughtError),l.onCaughtError!==void 0&&(E=l.onCaughtError),l.onRecoverableError!==void 0&&(k=l.onRecoverableError)),l=M_(n,1,!1,null,null,h,p,null,b,E,k,V_),n[X]=l.current,mp(n),new Lp(l)},Pc.hydrateRoot=function(n,l,h){if(!s(n))throw Error(a(299));var p=!1,b="",E=Z1,k=ex,L=tx,ee=null;return h!=null&&(h.unstable_strictMode===!0&&(p=!0),h.identifierPrefix!==void 0&&(b=h.identifierPrefix),h.onUncaughtError!==void 0&&(E=h.onUncaughtError),h.onCaughtError!==void 0&&(k=h.onCaughtError),h.onRecoverableError!==void 0&&(L=h.onRecoverableError),h.formState!==void 0&&(ee=h.formState)),l=M_(n,1,!0,l,h??null,p,b,ee,E,k,L,V_),l.context=L_(null),h=l.current,p=Ua(),p=Wl(p),b=Vn(p),b.callback=null,qn(h,b,p),h=p,l.current.lanes=h,Ci(l,h),qs(l),n[X]=l.current,mp(n),new dd(l)},Pc.version="19.2.3",Pc}var sy;function kT(){if(sy)return Bp.exports;sy=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Bp.exports=CT(),Bp.exports}var NT=kT();var ny="popstate";function RT(r={}){function e(a,s){let{pathname:i,search:o,hash:c}=a.location;return yg("",{pathname:i,search:o,hash:c},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(a,s){return typeof s=="string"?s:du(s)}return DT(e,t,null,r)}function ar(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function xs(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function OT(){return Math.random().toString(36).substring(2,10)}function iy(r,e){return{usr:r.state,key:r.key,idx:e}}function yg(r,e,t=null,a){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof e=="string"?Bl(e):e,state:t,key:e&&e.key||a||OT()}}function du({pathname:r="/",search:e="",hash:t=""}){return e&&e!=="?"&&(r+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(r+=t.charAt(0)==="#"?t:"#"+t),r}function Bl(r){let e={};if(r){let t=r.indexOf("#");t>=0&&(e.hash=r.substring(t),r=r.substring(0,t));let a=r.indexOf("?");a>=0&&(e.search=r.substring(a),r=r.substring(0,a)),r&&(e.pathname=r)}return e}function DT(r,e,t,a={}){let{window:s=document.defaultView,v5Compat:i=!1}=a,o=s.history,c="POP",u=null,d=f();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function f(){return(o.state||{idx:null}).idx}function g(){c="POP";let w=f(),A=w==null?null:w-d;d=w,u&&u({action:c,location:_.location,delta:A})}function v(w,A){c="PUSH";let T=yg(_.location,w,A);d=f()+1;let S=iy(T,d),N=_.createHref(T);try{o.pushState(S,"",N)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;s.location.assign(N)}i&&u&&u({action:c,location:_.location,delta:1})}function x(w,A){c="REPLACE";let T=yg(_.location,w,A);d=f();let S=iy(T,d),N=_.createHref(T);o.replaceState(S,"",N),i&&u&&u({action:c,location:_.location,delta:0})}function y(w){return FT(w)}let _={get action(){return c},get location(){return r(s,o)},listen(w){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(ny,g),u=w,()=>{s.removeEventListener(ny,g),u=null}},createHref(w){return e(s,w)},createURL:y,encodeLocation(w){let A=y(w);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:v,replace:x,go(w){return o.go(w)}};return _}function FT(r,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),ar(t,"No window.location.(origin|href) available to create URL");let a=typeof r=="string"?r:du(r);return a=a.replace(/ $/,"%20"),!e&&a.startsWith("//")&&(a=t+a),new URL(a,t)}function hw(r,e,t="/"){return MT(r,e,t,!1)}function MT(r,e,t,a){let s=typeof e=="string"?Bl(e):e,i=Fn(s.pathname||"/",t);if(i==null)return null;let o=dw(r);LT(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let d=qT(i);c=GT(o[u],d,a)}return c}function dw(r,e=[],t=[],a="",s=!1){let i=(o,c,u=s,d)=>{let f={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};if(f.relativePath.startsWith("/")){if(!f.relativePath.startsWith(a)&&u)return;ar(f.relativePath.startsWith(a),`Absolute route path "${f.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(a.length)}let g=Nn([a,f.relativePath]),v=t.concat(f);o.children&&o.children.length>0&&(ar(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),dw(o.children,e,v,g,u)),!(o.path==null&&!o.index)&&e.push({path:g,score:HT(g,o.index),routesMeta:v})};return r.forEach((o,c)=>{if(o.path===""||!o.path?.includes("?"))i(o,c);else for(let u of fw(o.path))i(o,c,!0,u)}),e}function fw(r){let e=r.split("/");if(e.length===0)return[];let[t,...a]=e,s=t.endsWith("?"),i=t.replace(/\?$/,"");if(a.length===0)return s?[i,""]:[i];let o=fw(a.join("/")),c=[];return c.push(...o.map(u=>u===""?i:[i,u].join("/"))),s&&c.push(...o),c.map(u=>r.startsWith("/")&&u===""?"/":u)}function LT(r){r.sort((e,t)=>e.score!==t.score?t.score-e.score:$T(e.routesMeta.map(a=>a.childrenIndex),t.routesMeta.map(a=>a.childrenIndex)))}var IT=/^:[\w-]+$/,jT=3,PT=2,BT=1,UT=10,zT=-2,oy=r=>r==="*";function HT(r,e){let t=r.split("/"),a=t.length;return t.some(oy)&&(a+=zT),e&&(a+=PT),t.filter(s=>!oy(s)).reduce((s,i)=>s+(IT.test(i)?jT:i===""?BT:UT),a)}function $T(r,e){return r.length===e.length&&r.slice(0,-1).every((a,s)=>a===e[s])?r[r.length-1]-e[e.length-1]:0}function GT(r,e,t=!1){let{routesMeta:a}=r,s={},i="/",o=[];for(let c=0;c<a.length;++c){let u=a[c],d=c===a.length-1,f=i==="/"?e:e.slice(i.length)||"/",g=$d({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},f),v=u.route;if(!g&&d&&t&&!a[a.length-1].route.index&&(g=$d({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},f)),!g)return null;Object.assign(s,g.params),o.push({params:s,pathname:Nn([i,g.pathname]),pathnameBase:KT(Nn([i,g.pathnameBase])),route:v}),g.pathnameBase!=="/"&&(i=Nn([i,g.pathnameBase]))}return o}function $d(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[t,a]=VT(r.path,r.caseSensitive,r.end),s=e.match(t);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:a.reduce((d,{paramName:f,isOptional:g},v)=>{if(f==="*"){let y=c[v]||"";o=i.slice(0,i.length-y.length).replace(/(.)\/+$/,"$1")}const x=c[v];return g&&!x?d[f]=void 0:d[f]=(x||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:r}}function VT(r,e=!1,t=!0){xs(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let a=[],s="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(a.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return r.endsWith("*")?(a.push({paramName:"*"}),s+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":r!==""&&r!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),a]}function qT(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return xs(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),r}}function Fn(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,a=r.charAt(t);return a&&a!=="/"?null:r.slice(t)||"/"}var pw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,WT=r=>pw.test(r);function XT(r,e="/"){let{pathname:t,search:a="",hash:s=""}=typeof r=="string"?Bl(r):r,i;if(t)if(WT(t))i=t;else{if(t.includes("//")){let o=t;t=t.replace(/\/\/+/g,"/"),xs(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${t}`)}t.startsWith("/")?i=ly(t.substring(1),"/"):i=ly(t,e)}else i=e;return{pathname:i,search:JT(a),hash:QT(s)}}function ly(r,e){let t=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function $p(r,e,t,a){return`Cannot include a '${r}' character in a manually specified \`to.${e}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function YT(r){return r.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function nm(r){let e=YT(r);return e.map((t,a)=>a===e.length-1?t.pathname:t.pathnameBase)}function im(r,e,t,a=!1){let s;typeof r=="string"?s=Bl(r):(s={...r},ar(!s.pathname||!s.pathname.includes("?"),$p("?","pathname","search",s)),ar(!s.pathname||!s.pathname.includes("#"),$p("#","pathname","hash",s)),ar(!s.search||!s.search.includes("#"),$p("#","search","hash",s)));let i=r===""||s.pathname==="",o=i?"/":s.pathname,c;if(o==null)c=t;else{let g=e.length-1;if(!a&&o.startsWith("..")){let v=o.split("/");for(;v[0]==="..";)v.shift(),g-=1;s.pathname=v.join("/")}c=g>=0?e[g]:"/"}let u=XT(s,c),d=o&&o!=="/"&&o.endsWith("/"),f=(i||o===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(d||f)&&(u.pathname+="/"),u}var Nn=r=>r.join("/").replace(/\/\/+/g,"/"),KT=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),JT=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,QT=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r,ZT=class{constructor(r,e,t,a=!1){this.status=r,this.statusText=e||"",this.internal=a,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function eC(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}function tC(r){return r.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var gw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function mw(r,e){let t=r;if(typeof t!="string"||!pw.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let a=t,s=!1;if(gw)try{let i=new URL(window.location.href),o=t.startsWith("//")?new URL(i.protocol+t):new URL(t),c=Fn(o.pathname,e);o.origin===i.origin&&c!=null?t=c+o.search+o.hash:s=!0}catch{xs(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:a,isExternal:s,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var vw=["POST","PUT","PATCH","DELETE"];new Set(vw);var rC=["GET",...vw];new Set(rC);var Ul=Q.createContext(null);Ul.displayName="DataRouter";var uf=Q.createContext(null);uf.displayName="DataRouterState";var aC=Q.createContext(!1),xw=Q.createContext({isTransitioning:!1});xw.displayName="ViewTransition";var sC=Q.createContext(new Map);sC.displayName="Fetchers";var nC=Q.createContext(null);nC.displayName="Await";var Ja=Q.createContext(null);Ja.displayName="Navigation";var Mu=Q.createContext(null);Mu.displayName="Location";var Us=Q.createContext({outlet:null,matches:[],isDataRoute:!1});Us.displayName="Route";var om=Q.createContext(null);om.displayName="RouteError";var _w="REACT_ROUTER_ERROR",iC="REDIRECT",oC="ROUTE_ERROR_RESPONSE";function lC(r){if(r.startsWith(`${_w}:${iC}:{`))try{let e=JSON.parse(r.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function cC(r){if(r.startsWith(`${_w}:${oC}:{`))try{let e=JSON.parse(r.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new ZT(e.status,e.statusText,e.data)}catch{}}function uC(r,{relative:e}={}){ar(zl(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:a}=Q.useContext(Ja),{hash:s,pathname:i,search:o}=Lu(r,{relative:e}),c=i;return t!=="/"&&(c=i==="/"?t:Nn([t,i])),a.createHref({pathname:c,search:o,hash:s})}function zl(){return Q.useContext(Mu)!=null}function wi(){return ar(zl(),"useLocation() may be used only in the context of a <Router> component."),Q.useContext(Mu).location}var yw="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function bw(r){Q.useContext(Ja).static||Q.useLayoutEffect(r)}function ho(){let{isDataRoute:r}=Q.useContext(Us);return r?EC():hC()}function hC(){ar(zl(),"useNavigate() may be used only in the context of a <Router> component.");let r=Q.useContext(Ul),{basename:e,navigator:t}=Q.useContext(Ja),{matches:a}=Q.useContext(Us),{pathname:s}=wi(),i=JSON.stringify(nm(a)),o=Q.useRef(!1);return bw(()=>{o.current=!0}),Q.useCallback((u,d={})=>{if(xs(o.current,yw),!o.current)return;if(typeof u=="number"){t.go(u);return}let f=im(u,JSON.parse(i),s,d.relative==="path");r==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:Nn([e,f.pathname])),(d.replace?t.replace:t.push)(f,d.state,d)},[e,t,i,s,r])}Q.createContext(null);function lm(){let{matches:r}=Q.useContext(Us),e=r[r.length-1];return e?e.params:{}}function Lu(r,{relative:e}={}){let{matches:t}=Q.useContext(Us),{pathname:a}=wi(),s=JSON.stringify(nm(t));return Q.useMemo(()=>im(r,JSON.parse(s),a,e==="path"),[r,s,a,e])}function dC(r,e){return ww(r,e)}function ww(r,e,t,a,s){ar(zl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=Q.useContext(Ja),{matches:o}=Q.useContext(Us),c=o[o.length-1],u=c?c.params:{},d=c?c.pathname:"/",f=c?c.pathnameBase:"/",g=c&&c.route;{let T=g&&g.path||"";Aw(d,!g||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let v=wi(),x;if(e){let T=typeof e=="string"?Bl(e):e;ar(f==="/"||T.pathname?.startsWith(f),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${T.pathname}" was given in the \`location\` prop.`),x=T}else x=v;let y=x.pathname||"/",_=y;if(f!=="/"){let T=f.replace(/^\//,"").split("/");_="/"+y.replace(/^\//,"").split("/").slice(T.length).join("/")}let w=hw(r,{pathname:_});xs(g||w!=null,`No routes matched location "${x.pathname}${x.search}${x.hash}" `),xs(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${x.pathname}${x.search}${x.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let A=vC(w&&w.map(T=>Object.assign({},T,{params:Object.assign({},u,T.params),pathname:Nn([f,i.encodeLocation?i.encodeLocation(T.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?f:Nn([f,i.encodeLocation?i.encodeLocation(T.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathnameBase])})),o,t,a,s);return e&&A?Q.createElement(Mu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...x},navigationType:"POP"}},A):A}function fC(){let r=wC(),e=eC(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),t=r instanceof Error?r.stack:null,a="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:a},i={padding:"2px 4px",backgroundColor:a},o=null;return console.error("Error handled by React Router default ErrorBoundary:",r),o=Q.createElement(Q.Fragment,null,Q.createElement("p",null," Hey developer "),Q.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Q.createElement("code",{style:i},"ErrorBoundary")," or"," ",Q.createElement("code",{style:i},"errorElement")," prop on your route.")),Q.createElement(Q.Fragment,null,Q.createElement("h2",null,"Unexpected Application Error!"),Q.createElement("h3",{style:{fontStyle:"italic"}},e),t?Q.createElement("pre",{style:s},t):null,o)}var pC=Q.createElement(fC,null),Ew=class extends Q.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,e){return e.location!==r.location||e.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:e.error,location:e.location,revalidation:r.revalidation||e.revalidation}}componentDidCatch(r,e){this.props.onError?this.props.onError(r,e):console.error("React Router caught the following error during render",r)}render(){let r=this.state.error;if(this.context&&typeof r=="object"&&r&&"digest"in r&&typeof r.digest=="string"){const t=cC(r.digest);t&&(r=t)}let e=r!==void 0?Q.createElement(Us.Provider,{value:this.props.routeContext},Q.createElement(om.Provider,{value:r,children:this.props.component})):this.props.children;return this.context?Q.createElement(gC,{error:r},e):e}};Ew.contextType=aC;var Gp=new WeakMap;function gC({children:r,error:e}){let{basename:t}=Q.useContext(Ja);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let a=lC(e.digest);if(a){let s=Gp.get(e);if(s)throw s;let i=mw(a.location,t);if(gw&&!Gp.get(e))if(i.isExternal||a.reloadDocument)window.location.href=i.absoluteURL||i.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(i.to,{replace:a.replace}));throw Gp.set(e,o),o}return Q.createElement("meta",{httpEquiv:"refresh",content:`0;url=${i.absoluteURL||i.to}`})}}return r}function mC({routeContext:r,match:e,children:t}){let a=Q.useContext(Ul);return a&&a.static&&a.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=e.route.id),Q.createElement(Us.Provider,{value:r},t)}function vC(r,e=[],t=null,a=null,s=null){if(r==null){if(!t)return null;if(t.errors)r=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)r=t.matches;else return null}let i=r,o=t?.errors;if(o!=null){let f=i.findIndex(g=>g.route.id&&o?.[g.route.id]!==void 0);ar(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,f+1))}let c=!1,u=-1;if(t)for(let f=0;f<i.length;f++){let g=i[f];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(u=f),g.route.id){let{loaderData:v,errors:x}=t,y=g.route.loader&&!v.hasOwnProperty(g.route.id)&&(!x||x[g.route.id]===void 0);if(g.route.lazy||y){c=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}let d=t&&a?(f,g)=>{a(f,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:tC(t.matches),errorInfo:g})}:void 0;return i.reduceRight((f,g,v)=>{let x,y=!1,_=null,w=null;t&&(x=o&&g.route.id?o[g.route.id]:void 0,_=g.route.errorElement||pC,c&&(u<0&&v===0?(Aw("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,w=null):u===v&&(y=!0,w=g.route.hydrateFallbackElement||null)));let A=e.concat(i.slice(0,v+1)),T=()=>{let S;return x?S=_:y?S=w:g.route.Component?S=Q.createElement(g.route.Component,null):g.route.element?S=g.route.element:S=f,Q.createElement(mC,{match:g,routeContext:{outlet:f,matches:A,isDataRoute:t!=null},children:S})};return t&&(g.route.ErrorBoundary||g.route.errorElement||v===0)?Q.createElement(Ew,{location:t.location,revalidation:t.revalidation,component:_,error:x,children:T(),routeContext:{outlet:null,matches:A,isDataRoute:!0},onError:d}):T()},null)}function cm(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function xC(r){let e=Q.useContext(Ul);return ar(e,cm(r)),e}function _C(r){let e=Q.useContext(uf);return ar(e,cm(r)),e}function yC(r){let e=Q.useContext(Us);return ar(e,cm(r)),e}function um(r){let e=yC(r),t=e.matches[e.matches.length-1];return ar(t.route.id,`${r} can only be used on routes that contain a unique "id"`),t.route.id}function bC(){return um("useRouteId")}function wC(){let r=Q.useContext(om),e=_C("useRouteError"),t=um("useRouteError");return r!==void 0?r:e.errors?.[t]}function EC(){let{router:r}=xC("useNavigate"),e=um("useNavigate"),t=Q.useRef(!1);return bw(()=>{t.current=!0}),Q.useCallback(async(s,i={})=>{xs(t.current,yw),t.current&&(typeof s=="number"?await r.navigate(s):await r.navigate(s,{fromRouteId:e,...i}))},[r,e])}var cy={};function Aw(r,e,t){!e&&!cy[r]&&(cy[r]=!0,xs(!1,t))}Q.memo(AC);function AC({routes:r,future:e,state:t,onError:a}){return ww(r,void 0,t,a,e)}function Sw({to:r,replace:e,state:t,relative:a}){ar(zl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=Q.useContext(Ja);xs(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=Q.useContext(Us),{pathname:o}=wi(),c=ho(),u=im(r,nm(i),o,a==="path"),d=JSON.stringify(u);return Q.useEffect(()=>{c(JSON.parse(d),{replace:e,state:t,relative:a})},[c,d,a,e,t]),null}function Rs(r){ar(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function SC({basename:r="/",children:e=null,location:t,navigationType:a="POP",navigator:s,static:i=!1,unstable_useTransitions:o}){ar(!zl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=r.replace(/^\/*/,"/"),u=Q.useMemo(()=>({basename:c,navigator:s,static:i,unstable_useTransitions:o,future:{}}),[c,s,i,o]);typeof t=="string"&&(t=Bl(t));let{pathname:d="/",search:f="",hash:g="",state:v=null,key:x="default"}=t,y=Q.useMemo(()=>{let _=Fn(d,c);return _==null?null:{location:{pathname:_,search:f,hash:g,state:v,key:x},navigationType:a}},[c,d,f,g,v,x,a]);return xs(y!=null,`<Router basename="${c}"> is not able to match the URL "${d}${f}${g}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:Q.createElement(Ja.Provider,{value:u},Q.createElement(Mu.Provider,{children:e,value:y}))}function TC({children:r,location:e}){return dC(bg(r),e)}function bg(r,e=[]){let t=[];return Q.Children.forEach(r,(a,s)=>{if(!Q.isValidElement(a))return;let i=[...e,s];if(a.type===Q.Fragment){t.push.apply(t,bg(a.props.children,i));return}ar(a.type===Rs,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ar(!a.props.index||!a.props.children,"An index route cannot have child routes.");let o={id:a.props.id||i.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,middleware:a.props.middleware,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(o.children=bg(a.props.children,i)),t.push(o)}),t}var Pd="get",Bd="application/x-www-form-urlencoded";function hf(r){return typeof HTMLElement<"u"&&r instanceof HTMLElement}function CC(r){return hf(r)&&r.tagName.toLowerCase()==="button"}function kC(r){return hf(r)&&r.tagName.toLowerCase()==="form"}function NC(r){return hf(r)&&r.tagName.toLowerCase()==="input"}function RC(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function OC(r,e){return r.button===0&&(!e||e==="_self")&&!RC(r)}var pd=null;function DC(){if(pd===null)try{new FormData(document.createElement("form"),0),pd=!1}catch{pd=!0}return pd}var FC=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Vp(r){return r!=null&&!FC.has(r)?(xs(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Bd}"`),null):r}function MC(r,e){let t,a,s,i,o;if(kC(r)){let c=r.getAttribute("action");a=c?Fn(c,e):null,t=r.getAttribute("method")||Pd,s=Vp(r.getAttribute("enctype"))||Bd,i=new FormData(r)}else if(CC(r)||NC(r)&&(r.type==="submit"||r.type==="image")){let c=r.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=r.getAttribute("formaction")||c.getAttribute("action");if(a=u?Fn(u,e):null,t=r.getAttribute("formmethod")||c.getAttribute("method")||Pd,s=Vp(r.getAttribute("formenctype"))||Vp(c.getAttribute("enctype"))||Bd,i=new FormData(c,r),!DC()){let{name:d,type:f,value:g}=r;if(f==="image"){let v=d?`${d}.`:"";i.append(`${v}x`,"0"),i.append(`${v}y`,"0")}else d&&i.append(d,g)}}else{if(hf(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Pd,a=null,s=Bd,o=r}return i&&s==="text/plain"&&(o=i,i=void 0),{action:a,method:t.toLowerCase(),encType:s,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function hm(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function LC(r,e,t){let a=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return a.pathname==="/"?a.pathname=`_root.${t}`:e&&Fn(a.pathname,e)==="/"?a.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${t}`,a}async function IC(r,e){if(r.id in e)return e[r.id];try{let t=await import(r.module);return e[r.id]=t,t}catch(t){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function jC(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function PC(r,e,t){let a=await Promise.all(r.map(async s=>{let i=e.routes[s.route.id];if(i){let o=await IC(i,t);return o.links?o.links():[]}return[]}));return HC(a.flat(1).filter(jC).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function uy(r,e,t,a,s,i){let o=(u,d)=>t[d]?u.route.id!==t[d].route.id:!0,c=(u,d)=>t[d].pathname!==u.pathname||t[d].route.path?.endsWith("*")&&t[d].params["*"]!==u.params["*"];return i==="assets"?e.filter((u,d)=>o(u,d)||c(u,d)):i==="data"?e.filter((u,d)=>{let f=a.routes[u.route.id];if(!f||!f.hasLoader)return!1;if(o(u,d)||c(u,d))return!0;if(u.route.shouldRevalidate){let g=u.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(r,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function BC(r,e,{includeHydrateFallback:t}={}){return UC(r.map(a=>{let s=e.routes[a.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function UC(r){return[...new Set(r)]}function zC(r){let e={},t=Object.keys(r).sort();for(let a of t)e[a]=r[a];return e}function HC(r,e){let t=new Set;return new Set(e),r.reduce((a,s)=>{let i=JSON.stringify(zC(s));return t.has(i)||(t.add(i),a.push({key:i,link:s})),a},[])}function Tw(){let r=Q.useContext(Ul);return hm(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function $C(){let r=Q.useContext(uf);return hm(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var dm=Q.createContext(void 0);dm.displayName="FrameworkContext";function Cw(){let r=Q.useContext(dm);return hm(r,"You must render this element inside a <HydratedRouter> element"),r}function GC(r,e){let t=Q.useContext(dm),[a,s]=Q.useState(!1),[i,o]=Q.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:d,onMouseLeave:f,onTouchStart:g}=e,v=Q.useRef(null);Q.useEffect(()=>{if(r==="render"&&o(!0),r==="viewport"){let _=A=>{A.forEach(T=>{o(T.isIntersecting)})},w=new IntersectionObserver(_,{threshold:.5});return v.current&&w.observe(v.current),()=>{w.disconnect()}}},[r]),Q.useEffect(()=>{if(a){let _=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(_)}}},[a]);let x=()=>{s(!0)},y=()=>{s(!1),o(!1)};return t?r!=="intent"?[i,v,{}]:[i,v,{onFocus:Bc(c,x),onBlur:Bc(u,y),onMouseEnter:Bc(d,x),onMouseLeave:Bc(f,y),onTouchStart:Bc(g,x)}]:[!1,v,{}]}function Bc(r,e){return t=>{r&&r(t),t.defaultPrevented||e(t)}}function VC({page:r,...e}){let{router:t}=Tw(),a=Q.useMemo(()=>hw(t.routes,r,t.basename),[t.routes,r,t.basename]);return a?Q.createElement(WC,{page:r,matches:a,...e}):null}function qC(r){let{manifest:e,routeModules:t}=Cw(),[a,s]=Q.useState([]);return Q.useEffect(()=>{let i=!1;return PC(r,e,t).then(o=>{i||s(o)}),()=>{i=!0}},[r,e,t]),a}function WC({page:r,matches:e,...t}){let a=wi(),{manifest:s,routeModules:i}=Cw(),{basename:o}=Tw(),{loaderData:c,matches:u}=$C(),d=Q.useMemo(()=>uy(r,e,u,s,a,"data"),[r,e,u,s,a]),f=Q.useMemo(()=>uy(r,e,u,s,a,"assets"),[r,e,u,s,a]),g=Q.useMemo(()=>{if(r===a.pathname+a.search+a.hash)return[];let y=new Set,_=!1;if(e.forEach(A=>{let T=s.routes[A.route.id];!T||!T.hasLoader||(!d.some(S=>S.route.id===A.route.id)&&A.route.id in c&&i[A.route.id]?.shouldRevalidate||T.hasClientLoader?_=!0:y.add(A.route.id))}),y.size===0)return[];let w=LC(r,o,"data");return _&&y.size>0&&w.searchParams.set("_routes",e.filter(A=>y.has(A.route.id)).map(A=>A.route.id).join(",")),[w.pathname+w.search]},[o,c,a,s,d,e,r,i]),v=Q.useMemo(()=>BC(f,s),[f,s]),x=qC(f);return Q.createElement(Q.Fragment,null,g.map(y=>Q.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...t})),v.map(y=>Q.createElement("link",{key:y,rel:"modulepreload",href:y,...t})),x.map(({key:y,link:_})=>Q.createElement("link",{key:y,nonce:t.nonce,..._})))}function XC(...r){return e=>{r.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var YC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{YC&&(window.__reactRouterVersion="7.11.0")}catch{}function KC({basename:r,children:e,unstable_useTransitions:t,window:a}){let s=Q.useRef();s.current==null&&(s.current=RT({window:a,v5Compat:!0}));let i=s.current,[o,c]=Q.useState({action:i.action,location:i.location}),u=Q.useCallback(d=>{t===!1?c(d):Q.startTransition(()=>c(d))},[t]);return Q.useLayoutEffect(()=>i.listen(u),[i,u]),Q.createElement(SC,{basename:r,children:e,location:o.location,navigationType:o.action,navigator:i,unstable_useTransitions:t})}var kw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Iu=Q.forwardRef(function({onClick:e,discover:t="render",prefetch:a="none",relative:s,reloadDocument:i,replace:o,state:c,target:u,to:d,preventScrollReset:f,viewTransition:g,unstable_defaultShouldRevalidate:v,...x},y){let{basename:_,unstable_useTransitions:w}=Q.useContext(Ja),A=typeof d=="string"&&kw.test(d),T=mw(d,_);d=T.to;let S=uC(d,{relative:s}),[N,R,O]=GC(a,x),C=ZC(d,{replace:o,state:c,target:u,preventScrollReset:f,relative:s,viewTransition:g,unstable_defaultShouldRevalidate:v,unstable_useTransitions:w});function j(W){e&&e(W),W.defaultPrevented||C(W)}let I=Q.createElement("a",{...x,...O,href:T.absoluteURL||S,onClick:T.isExternal||i?e:j,ref:XC(y,R),target:u,"data-discover":!A&&t==="render"?"true":void 0});return N&&!A?Q.createElement(Q.Fragment,null,I,Q.createElement(VC,{page:S})):I});Iu.displayName="Link";var gl=Q.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:a="",end:s=!1,style:i,to:o,viewTransition:c,children:u,...d},f){let g=Lu(o,{relative:d.relative}),v=wi(),x=Q.useContext(uf),{navigator:y,basename:_}=Q.useContext(Ja),w=x!=null&&sk(g)&&c===!0,A=y.encodeLocation?y.encodeLocation(g).pathname:g.pathname,T=v.pathname,S=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;t||(T=T.toLowerCase(),S=S?S.toLowerCase():null,A=A.toLowerCase()),S&&_&&(S=Fn(S,_)||S);const N=A!=="/"&&A.endsWith("/")?A.length-1:A.length;let R=T===A||!s&&T.startsWith(A)&&T.charAt(N)==="/",O=S!=null&&(S===A||!s&&S.startsWith(A)&&S.charAt(A.length)==="/"),C={isActive:R,isPending:O,isTransitioning:w},j=R?e:void 0,I;typeof a=="function"?I=a(C):I=[a,R?"active":null,O?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let W=typeof i=="function"?i(C):i;return Q.createElement(Iu,{...d,"aria-current":j,className:I,ref:f,style:W,to:o,viewTransition:c},typeof u=="function"?u(C):u)});gl.displayName="NavLink";var JC=Q.forwardRef(({discover:r="render",fetcherKey:e,navigate:t,reloadDocument:a,replace:s,state:i,method:o=Pd,action:c,onSubmit:u,relative:d,preventScrollReset:f,viewTransition:g,unstable_defaultShouldRevalidate:v,...x},y)=>{let{unstable_useTransitions:_}=Q.useContext(Ja),w=rk(),A=ak(c,{relative:d}),T=o.toLowerCase()==="get"?"get":"post",S=typeof c=="string"&&kw.test(c),N=R=>{if(u&&u(R),R.defaultPrevented)return;R.preventDefault();let O=R.nativeEvent.submitter,C=O?.getAttribute("formmethod")||o,j=()=>w(O||R.currentTarget,{fetcherKey:e,method:C,navigate:t,replace:s,state:i,relative:d,preventScrollReset:f,viewTransition:g,unstable_defaultShouldRevalidate:v});_&&t!==!1?Q.startTransition(()=>j()):j()};return Q.createElement("form",{ref:y,method:T,action:A,onSubmit:a?u:N,...x,"data-discover":!S&&r==="render"?"true":void 0})});JC.displayName="Form";function QC(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Nw(r){let e=Q.useContext(Ul);return ar(e,QC(r)),e}function ZC(r,{target:e,replace:t,state:a,preventScrollReset:s,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:c,unstable_useTransitions:u}={}){let d=ho(),f=wi(),g=Lu(r,{relative:i});return Q.useCallback(v=>{if(OC(v,e)){v.preventDefault();let x=t!==void 0?t:du(f)===du(g),y=()=>d(r,{replace:x,state:a,preventScrollReset:s,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:c});u?Q.startTransition(()=>y()):y()}},[f,d,g,t,a,e,r,s,i,o,c,u])}var ek=0,tk=()=>`__${String(++ek)}__`;function rk(){let{router:r}=Nw("useSubmit"),{basename:e}=Q.useContext(Ja),t=bC(),a=r.fetch,s=r.navigate;return Q.useCallback(async(i,o={})=>{let{action:c,method:u,encType:d,formData:f,body:g}=MC(i,e);if(o.navigate===!1){let v=o.fetcherKey||tk();await a(v,t,o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:f,body:g,formMethod:o.method||u,formEncType:o.encType||d,flushSync:o.flushSync})}else await s(o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:f,body:g,formMethod:o.method||u,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[a,s,e,t])}function ak(r,{relative:e}={}){let{basename:t}=Q.useContext(Ja),a=Q.useContext(Us);ar(a,"useFormAction must be used inside a RouteContext");let[s]=a.matches.slice(-1),i={...Lu(r||".",{relative:e})},o=wi();if(r==null){i.search=o.search;let c=new URLSearchParams(i.search),u=c.getAll("index");if(u.some(f=>f==="")){c.delete("index"),u.filter(g=>g).forEach(g=>c.append("index",g));let f=c.toString();i.search=f?`?${f}`:""}}return(!r||r===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(i.pathname=i.pathname==="/"?t:Nn([t,i.pathname])),du(i)}function sk(r,{relative:e}={}){let t=Q.useContext(xw);ar(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=Nw("useViewTransitionState"),s=Lu(r,{relative:e});if(!t.isTransitioning)return!1;let i=Fn(t.currentLocation.pathname,a)||t.currentLocation.pathname,o=Fn(t.nextLocation.pathname,a)||t.nextLocation.pathname;return $d(s.pathname,o)!=null||$d(s.pathname,i)!=null}function df(r,e){var t={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&e.indexOf(a)<0&&(t[a]=r[a]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(r);s<a.length;s++)e.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(r,a[s])&&(t[a[s]]=r[a[s]]);return t}function nk(r,e,t,a){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function c(f){try{d(a.next(f))}catch(g){o(g)}}function u(f){try{d(a.throw(f))}catch(g){o(g)}}function d(f){f.done?i(f.value):s(f.value).then(c,u)}d((a=a.apply(r,e||[])).next())})}const ik=r=>r?(...e)=>r(...e):(...e)=>fetch(...e);class fm extends Error{constructor(e,t="FunctionsError",a){super(e),this.name=t,this.context=a}}class ok extends fm{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class hy extends fm{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class dy extends fm{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var wg;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(wg||(wg={}));class lk{constructor(e,{headers:t={},customFetch:a,region:s=wg.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=ik(a)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return nk(this,arguments,void 0,function*(t,a={}){var s;let i,o;try{const{headers:c,method:u,body:d,signal:f,timeout:g}=a;let v={},{region:x}=a;x||(x=this.region);const y=new URL(`${this.url}/${t}`);x&&x!=="any"&&(v["x-region"]=x,y.searchParams.set("forceFunctionRegion",x));let _;d&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(v["Content-Type"]="application/octet-stream",_=d):typeof d=="string"?(v["Content-Type"]="text/plain",_=d):typeof FormData<"u"&&d instanceof FormData?_=d:(v["Content-Type"]="application/json",_=JSON.stringify(d)):_=d;let w=f;g&&(o=new AbortController,i=setTimeout(()=>o.abort(),g),f?(w=o.signal,f.addEventListener("abort",()=>o.abort())):w=o.signal);const A=yield this.fetch(y.toString(),{method:u||"POST",headers:Object.assign(Object.assign(Object.assign({},v),this.headers),c),body:_,signal:w}).catch(R=>{throw new ok(R)}),T=A.headers.get("x-relay-error");if(T&&T==="true")throw new hy(A);if(!A.ok)throw new dy(A);let S=((s=A.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),N;return S==="application/json"?N=yield A.json():S==="application/octet-stream"||S==="application/pdf"?N=yield A.blob():S==="text/event-stream"?N=A:S==="multipart/form-data"?N=yield A.formData():N=yield A.text(),{data:N,error:null,response:A}}catch(c){return{data:null,error:c,response:c instanceof dy||c instanceof hy?c.context:void 0}}finally{i&&clearTimeout(i)}})}}var ck=class extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}},uk=class{constructor(r){var e,t;this.shouldThrowOnError=!1,this.method=r.method,this.url=r.url,this.headers=new Headers(r.headers),this.schema=r.schema,this.body=r.body,this.shouldThrowOnError=(e=r.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=r.signal,this.isMaybeSingle=(t=r.isMaybeSingle)!==null&&t!==void 0?t:!1,r.fetch?this.fetch=r.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(r,e){return this.headers=new Headers(this.headers),this.headers.set(r,e),this}then(r,e){var t=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let s=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let o=null,c=null,u=null,d=i.status,f=i.statusText;if(i.ok){var g,v;if(t.method!=="HEAD"){var x;const A=await i.text();A===""||(t.headers.get("Accept")==="text/csv"||t.headers.get("Accept")&&(!((x=t.headers.get("Accept"))===null||x===void 0)&&x.includes("application/vnd.pgrst.plan+text"))?c=A:c=JSON.parse(A))}const _=(g=t.headers.get("Prefer"))===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),w=(v=i.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");_&&w&&w.length>1&&(u=parseInt(w[1])),t.isMaybeSingle&&t.method==="GET"&&Array.isArray(c)&&(c.length>1?(o={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,u=null,d=406,f="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{var y;const _=await i.text();try{o=JSON.parse(_),Array.isArray(o)&&i.status===404&&(c=[],o=null,d=200,f="OK")}catch{i.status===404&&_===""?(d=204,f="No Content"):o={message:_}}if(o&&t.isMaybeSingle&&(!(o==null||(y=o.details)===null||y===void 0)&&y.includes("0 rows"))&&(o=null,d=200,f="OK"),o&&t.shouldThrowOnError)throw new ck(o)}return{error:o,data:c,count:u,status:d,statusText:f}});return this.shouldThrowOnError||(s=s.catch(i=>{var o;let c="";const u=i?.cause;if(u){var d,f,g,v;const y=(d=u?.message)!==null&&d!==void 0?d:"",_=(f=u?.code)!==null&&f!==void 0?f:"";c=`${(g=i?.name)!==null&&g!==void 0?g:"FetchError"}: ${i?.message}`,c+=`

Caused by: ${(v=u?.name)!==null&&v!==void 0?v:"Error"}: ${y}`,_&&(c+=` (${_})`),u?.stack&&(c+=`
${u.stack}`)}else{var x;c=(x=i?.stack)!==null&&x!==void 0?x:""}return{error:{message:`${(o=i?.name)!==null&&o!==void 0?o:"FetchError"}: ${i?.message}`,details:c,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),s.then(r,e)}returns(){return this}overrideTypes(){return this}},hk=class extends uk{select(r){let e=!1;const t=(r??"*").split("").map(a=>/\s/.test(a)&&!e?"":(a==='"'&&(e=!e),a)).join("");return this.url.searchParams.set("select",t),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:e=!0,nullsFirst:t,foreignTable:a,referencedTable:s=a}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${r}.${e?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:e,referencedTable:t=e}={}){const a=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(a,`${r}`),this}range(r,e,{foreignTable:t,referencedTable:a=t}={}){const s=typeof a>"u"?"offset":`${a}.offset`,i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${r}`),this.url.searchParams.set(i,`${e-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:e=!1,settings:t=!1,buffers:a=!1,wal:s=!1,format:i="text"}={}){var o;const c=[r?"analyze":null,e?"verbose":null,t?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${u}"; options=${c};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}};const fy=new RegExp("[,()]");var ml=class extends hk{eq(r,e){return this.url.searchParams.append(r,`eq.${e}`),this}neq(r,e){return this.url.searchParams.append(r,`neq.${e}`),this}gt(r,e){return this.url.searchParams.append(r,`gt.${e}`),this}gte(r,e){return this.url.searchParams.append(r,`gte.${e}`),this}lt(r,e){return this.url.searchParams.append(r,`lt.${e}`),this}lte(r,e){return this.url.searchParams.append(r,`lte.${e}`),this}like(r,e){return this.url.searchParams.append(r,`like.${e}`),this}likeAllOf(r,e){return this.url.searchParams.append(r,`like(all).{${e.join(",")}}`),this}likeAnyOf(r,e){return this.url.searchParams.append(r,`like(any).{${e.join(",")}}`),this}ilike(r,e){return this.url.searchParams.append(r,`ilike.${e}`),this}ilikeAllOf(r,e){return this.url.searchParams.append(r,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(r,e){return this.url.searchParams.append(r,`ilike(any).{${e.join(",")}}`),this}regexMatch(r,e){return this.url.searchParams.append(r,`match.${e}`),this}regexIMatch(r,e){return this.url.searchParams.append(r,`imatch.${e}`),this}is(r,e){return this.url.searchParams.append(r,`is.${e}`),this}isDistinct(r,e){return this.url.searchParams.append(r,`isdistinct.${e}`),this}in(r,e){const t=Array.from(new Set(e)).map(a=>typeof a=="string"&&fy.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(r,`in.(${t})`),this}notIn(r,e){const t=Array.from(new Set(e)).map(a=>typeof a=="string"&&fy.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(r,`not.in.(${t})`),this}contains(r,e){return typeof e=="string"?this.url.searchParams.append(r,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(r,`cs.{${e.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(e)}`),this}containedBy(r,e){return typeof e=="string"?this.url.searchParams.append(r,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(r,`cd.{${e.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(e)}`),this}rangeGt(r,e){return this.url.searchParams.append(r,`sr.${e}`),this}rangeGte(r,e){return this.url.searchParams.append(r,`nxl.${e}`),this}rangeLt(r,e){return this.url.searchParams.append(r,`sl.${e}`),this}rangeLte(r,e){return this.url.searchParams.append(r,`nxr.${e}`),this}rangeAdjacent(r,e){return this.url.searchParams.append(r,`adj.${e}`),this}overlaps(r,e){return typeof e=="string"?this.url.searchParams.append(r,`ov.${e}`):this.url.searchParams.append(r,`ov.{${e.join(",")}}`),this}textSearch(r,e,{config:t,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const i=t===void 0?"":`(${t})`;return this.url.searchParams.append(r,`${s}fts${i}.${e}`),this}match(r){return Object.entries(r).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(r,e,t){return this.url.searchParams.append(r,`not.${e}.${t}`),this}or(r,{foreignTable:e,referencedTable:t=e}={}){const a=t?`${t}.or`:"or";return this.url.searchParams.append(a,`(${r})`),this}filter(r,e,t){return this.url.searchParams.append(r,`${e}.${t}`),this}},dk=class{constructor(r,{headers:e={},schema:t,fetch:a}){this.url=r,this.headers=new Headers(e),this.schema=t,this.fetch=a}select(r,e){const{head:t=!1,count:a}=e??{},s=t?"HEAD":"GET";let i=!1;const o=(r??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join("");return this.url.searchParams.set("select",o),a&&this.headers.append("Prefer",`count=${a}`),new ml({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(r,{count:e,defaultToNull:t=!0}={}){var a;const s="POST";if(e&&this.headers.append("Prefer",`count=${e}`),t||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const i=r.reduce((o,c)=>o.concat(Object.keys(c)),[]);if(i.length>0){const o=[...new Set(i)].map(c=>`"${c}"`);this.url.searchParams.set("columns",o.join(","))}}return new ml({method:s,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(r,{onConflict:e,ignoreDuplicates:t=!1,count:a,defaultToNull:s=!0}={}){var i;const o="POST";if(this.headers.append("Prefer",`resolution=${t?"ignore":"merge"}-duplicates`),e!==void 0&&this.url.searchParams.set("on_conflict",e),a&&this.headers.append("Prefer",`count=${a}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const c=r.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new ml({method:o,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(r,{count:e}={}){var t;const a="PATCH";return e&&this.headers.append("Prefer",`count=${e}`),new ml({method:a,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}delete({count:r}={}){var e;const t="DELETE";return r&&this.headers.append("Prefer",`count=${r}`),new ml({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},fk=class Rw{constructor(e,{headers:t={},schema:a,fetch:s}={}){this.url=e,this.headers=new Headers(t),this.schemaName=a,this.fetch=s}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new dk(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Rw(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:a=!1,get:s=!1,count:i}={}){var o;let c;const u=new URL(`${this.url}/rpc/${e}`);let d;a||s?(c=a?"HEAD":"GET",Object.entries(t).filter(([g,v])=>v!==void 0).map(([g,v])=>[g,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([g,v])=>{u.searchParams.append(g,v)})):(c="POST",d=t);const f=new Headers(this.headers);return i&&f.set("Prefer",`count=${i}`),new ml({method:c,url:u,headers:f,schema:this.schemaName,body:d,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class pk{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const a=t.node,s=parseInt(a.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const a=this.getWebSocketConstructor();return new a(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const gk="2.89.0",mk=`realtime-js/${gk}`,Ow="1.0.0",vk="2.0.0",py=Ow,Eg=1e4,xk=1e3,_k=100;var ui;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(ui||(ui={}));var Fr;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(Fr||(Fr={}));var Ls;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(Ls||(Ls={}));var Ag;(function(r){r.websocket="websocket"})(Ag||(Ag={}));var Xi;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(Xi||(Xi={}));class yk{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let a=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,a;const s=(a=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(e){var t,a;const s=(a=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&a!==void 0?a:{},o=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,t,a){var s,i;const o=e.topic,c=(s=e.ref)!==null&&s!==void 0?s:"",u=(i=e.join_ref)!==null&&i!==void 0?i:"",d=e.payload.event,f=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},g=Object.keys(f).length===0?"":JSON.stringify(f);if(u.length>255)throw new Error(`joinRef length ${u.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(g.length>255)throw new Error(`metadata length ${g.length} exceeds maximum of 255`);const v=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+c.length+o.length+d.length+g.length,x=new ArrayBuffer(this.HEADER_LENGTH+v);let y=new DataView(x),_=0;y.setUint8(_++,this.KINDS.userBroadcastPush),y.setUint8(_++,u.length),y.setUint8(_++,c.length),y.setUint8(_++,o.length),y.setUint8(_++,d.length),y.setUint8(_++,g.length),y.setUint8(_++,t),Array.from(u,A=>y.setUint8(_++,A.charCodeAt(0))),Array.from(c,A=>y.setUint8(_++,A.charCodeAt(0))),Array.from(o,A=>y.setUint8(_++,A.charCodeAt(0))),Array.from(d,A=>y.setUint8(_++,A.charCodeAt(0))),Array.from(g,A=>y.setUint8(_++,A.charCodeAt(0)));var w=new Uint8Array(x.byteLength+a.byteLength);return w.set(new Uint8Array(x),0),w.set(new Uint8Array(a),x.byteLength),w.buffer}decode(e,t){if(this._isArrayBuffer(e)){let a=this._binaryDecode(e);return t(a)}if(typeof e=="string"){const a=JSON.parse(e),[s,i,o,c,u]=a;return t({join_ref:s,ref:i,topic:o,event:c,payload:u})}return t({})}_binaryDecode(e){const t=new DataView(e),a=t.getUint8(0),s=new TextDecoder;if(a===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,s)}_decodeUserBroadcast(e,t,a){const s=t.getUint8(1),i=t.getUint8(2),o=t.getUint8(3),c=t.getUint8(4);let u=this.HEADER_LENGTH+4;const d=a.decode(e.slice(u,u+s));u=u+s;const f=a.decode(e.slice(u,u+i));u=u+i;const g=a.decode(e.slice(u,u+o));u=u+o;const v=e.slice(u,e.byteLength),x=c===this.JSON_ENCODING?JSON.parse(a.decode(v)):v,y={type:this.BROADCAST_EVENT,event:f,payload:x};return o>0&&(y.meta=JSON.parse(g)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:y}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e?.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([a])=>t.includes(a)))}}class Dw{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ht;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(Ht||(Ht={}));const gy=(r,e,t={})=>{var a;const s=(a=t.skipTypes)!==null&&a!==void 0?a:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=bk(o,r,e,s),i),{}):{}},bk=(r,e,t,a)=>{const s=e.find(c=>c.name===r),i=s?.type,o=t[r];return i&&!a.includes(i)?Fw(i,o):Sg(o)},Fw=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return Sk(e,t)}switch(r){case Ht.bool:return wk(e);case Ht.float4:case Ht.float8:case Ht.int2:case Ht.int4:case Ht.int8:case Ht.numeric:case Ht.oid:return Ek(e);case Ht.json:case Ht.jsonb:return Ak(e);case Ht.timestamp:return Tk(e);case Ht.abstime:case Ht.date:case Ht.daterange:case Ht.int4range:case Ht.int8range:case Ht.money:case Ht.reltime:case Ht.text:case Ht.time:case Ht.timestamptz:case Ht.timetz:case Ht.tsrange:case Ht.tstzrange:return Sg(e);default:return Sg(e)}},Sg=r=>r,wk=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Ek=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},Ak=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch{return r}return r},Sk=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,a=r[t];if(r[0]==="{"&&a==="}"){let i;const o=r.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(c=>Fw(e,c))}return r},Tk=r=>typeof r=="string"?r.replace(" ","T"):r,Mw=r=>{const e=new URL(r);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class qp{constructor(e,t,a={},s=Eg){this.channel=e,this.event=t,this.payload=a,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var a;return this._hasReceived(e)&&t((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(a=>a.status===e).forEach(a=>a.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var my;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(my||(my={}));class Zc{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},s=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Zc.syncState(this.state,s,i,o),this.pendingDiffs.forEach(u=>{this.state=Zc.syncDiff(this.state,u,i,o)}),this.pendingDiffs=[],c()}),this.channel._on(a.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Zc.syncDiff(this.state,s,i,o),c())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,a,s){const i=this.cloneDeep(e),o=this.transformState(t),c={},u={};return this.map(i,(d,f)=>{o[d]||(u[d]=f)}),this.map(o,(d,f)=>{const g=i[d];if(g){const v=f.map(w=>w.presence_ref),x=g.map(w=>w.presence_ref),y=f.filter(w=>x.indexOf(w.presence_ref)<0),_=g.filter(w=>v.indexOf(w.presence_ref)<0);y.length>0&&(c[d]=y),_.length>0&&(u[d]=_)}else c[d]=f}),this.syncDiff(i,{joins:c,leaves:u},a,s)}static syncDiff(e,t,a,s){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return a||(a=()=>{}),s||(s=()=>{}),this.map(i,(c,u)=>{var d;const f=(d=e[c])!==null&&d!==void 0?d:[];if(e[c]=this.cloneDeep(u),f.length>0){const g=e[c].map(x=>x.presence_ref),v=f.filter(x=>g.indexOf(x.presence_ref)<0);e[c].unshift(...v)}a(c,f,u)}),this.map(o,(c,u)=>{let d=e[c];if(!d)return;const f=u.map(g=>g.presence_ref);d=d.filter(g=>f.indexOf(g.presence_ref)<0),e[c]=d,s(c,d,u),d.length===0&&delete e[c]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(a=>t(a,e[a]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,a)=>{const s=e[a];return"metas"in s?t[a]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[a]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var vy;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(vy||(vy={}));var eu;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(eu||(eu={}));var Sn;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Sn||(Sn={}));class El{constructor(e,t={config:{}},a){var s,i;if(this.topic=e,this.params=t,this.socket=a,this.bindings={},this.state=Fr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new qp(this,Ls.join,this.params,this.timeout),this.rejoinTimer=new Dw(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Fr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Fr.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Fr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Fr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Fr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ls.reply,{},(o,c)=>{this._trigger(this._replyEventName(c),o)}),this.presence=new Zc(this),this.broadcastEndpointURL=Mw(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var a,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Fr.closed){const{config:{broadcast:o,presence:c,private:u}}=this.params,d=(s=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(x=>x.filter))!==null&&s!==void 0?s:[],f=!!this.bindings[eu.PRESENCE]&&this.bindings[eu.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,g={},v={broadcast:o,presence:Object.assign(Object.assign({},c),{enabled:f}),postgres_changes:d,private:u};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this._onError(x=>e?.(Sn.CHANNEL_ERROR,x)),this._onClose(()=>e?.(Sn.CLOSED)),this.updateJoinPayload(Object.assign({config:v},g)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:x})=>{var y;if(this.socket._isManualToken()||this.socket.setAuth(),x===void 0){e?.(Sn.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,w=(y=_?.length)!==null&&y!==void 0?y:0,A=[];for(let T=0;T<w;T++){const S=_[T],{filter:{event:N,schema:R,table:O,filter:C}}=S,j=x&&x[T];if(j&&j.event===N&&El.isFilterValueEqual(j.schema,R)&&El.isFilterValueEqual(j.table,O)&&El.isFilterValueEqual(j.filter,C))A.push(Object.assign(Object.assign({},S),{id:j.id}));else{this.unsubscribe(),this.state=Fr.errored,e?.(Sn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=A,e&&e(Sn.SUBSCRIBED);return}}).receive("error",x=>{this.state=Fr.errored,e?.(Sn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(x).join(", ")||"error")))}).receive("timeout",()=>{e?.(Sn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,a){return this.state===Fr.joined&&e===eu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,a)}async httpSend(e,t,a={}){var s;if(t==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=a.timeout)!==null&&s!==void 0?s:this.timeout);if(c.status===202)return{success:!0};let u=c.statusText;try{const d=await c.json();u=d.error||d.message||u}catch{}return Promise.reject(new Error(u))}async send(e,t={}){var a,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=e,c={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(c.Authorization=`Bearer ${this.socket.accessTokenValue}`);const u={method:"POST",headers:c,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(a=t.timeout)!==null&&a!==void 0?a:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,c,u;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((u=(c=(o=this.params)===null||o===void 0?void 0:o.config)===null||c===void 0?void 0:c.broadcast)===null||u===void 0)&&u.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Fr.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ls.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(s=>{a=new qp(this,Ls.leave,{},e),a.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Fr.closed,this.bindings={}}async _fetchWithTimeout(e,t,a){const s=new AbortController,i=setTimeout(()=>s.abort(),a),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),o}_push(e,t,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new qp(this,e,t,a);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>_k){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,a){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,a){var s,i;const o=e.toLocaleLowerCase(),{close:c,error:u,leave:d,join:f}=Ls;if(a&&[c,u,d,f].indexOf(o)>=0&&a!==this._joinRef())return;let v=this._onMessage(o,t,a);if(t&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(x=>{var y,_,w;return((y=x.filter)===null||y===void 0?void 0:y.event)==="*"||((w=(_=x.filter)===null||_===void 0?void 0:_.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===o}).map(x=>x.callback(v,a)):(i=this.bindings[o])===null||i===void 0||i.filter(x=>{var y,_,w,A,T,S;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in x){const N=x.id,R=(y=x.filter)===null||y===void 0?void 0:y.event;return N&&((_=t.ids)===null||_===void 0?void 0:_.includes(N))&&(R==="*"||R?.toLocaleLowerCase()===((w=t.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const N=(T=(A=x?.filter)===null||A===void 0?void 0:A.event)===null||T===void 0?void 0:T.toLocaleLowerCase();return N==="*"||N===((S=t?.event)===null||S===void 0?void 0:S.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===o}).map(x=>{if(typeof v=="object"&&"ids"in v){const y=v.data,{schema:_,table:w,commit_timestamp:A,type:T,errors:S}=y;v=Object.assign(Object.assign({},{schema:_,table:w,commit_timestamp:A,eventType:T,new:{},old:{},errors:S}),this._getPayloadRecords(y))}x.callback(v,a)})}_isClosed(){return this.state===Fr.closed}_isJoined(){return this.state===Fr.joined}_isJoining(){return this.state===Fr.joining}_isLeaving(){return this.state===Fr.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,a){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:a};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const a=e.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===a&&El.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const a in e)if(e[a]!==t[a])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ls.close,{},e)}_onError(e){this._on(Ls.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Fr.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=gy(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=gy(e.columns,e.old_record)),t}}const Wp=()=>{},gd={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Ck=[1e3,2e3,5e3,1e4],kk=1e4,Nk=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Rk{constructor(e,t){var a;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Eg,this.transport=null,this.heartbeatIntervalMs=gd.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Wp,this.ref=0,this.reconnectTimer=null,this.vsn=py,this.logger=Wp,this.conn=null,this.sendBuffer=[],this.serializer=new yk,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...i)=>s(...i):(...i)=>fetch(...i),!(!((a=t?.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Ag.websocket}`,this.httpEndpoint=Mw(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=pk.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,a){this.logger(e,t,a)}connectionState(){switch(this.conn&&this.conn.readyState){case ui.connecting:return Xi.Connecting;case ui.open:return Xi.Open;case ui.closing:return Xi.Closing;default:return Xi.Closed}}isConnected(){return this.connectionState()===Xi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const a=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===a);if(s)return s;{const i=new El(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:a,payload:s,ref:i}=e,o=()=>{this.encode(e,c=>{var u;(u=this.conn)===null||u===void 0||u.send(c)})};this.log("push",`${t} ${a} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(xk,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},gd.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(a=>a.topic===e&&(a._isJoined()||a._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:s,payload:i,ref:o}=t,c=o?`(${o})`:"",u=i.status||"";this.log("receive",`${u} ${a} ${s} ${c}`.trim(),i),this.channels.filter(d=>d._isMember(a)).forEach(d=>d._trigger(s,i,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===ui.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===ui.open||this.conn.readyState===ui.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ls.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const a=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${a}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const a=new Blob([Nk],{type:"application/javascript"});t=URL.createObjectURL(a)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,a=!1;if(e)t=e,a=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),t=this.accessTokenValue}else t=this.accessTokenValue;a?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{const i={access_token:t,version:mk};t&&s.updateJoinPayload(i),s.joinedOnce&&s._isJoined()&&s._push(Ls.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(a=>{try{a(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(a){this.log("error",`error triggering ${e} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new Dw(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},gd.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,a,s,i,o,c,u,d,f,g,v,x;switch(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(a=e?.timeout)!==null&&a!==void 0?a:Eg,this.heartbeatIntervalMs=(s=e?.heartbeatIntervalMs)!==null&&s!==void 0?s:gd.HEARTBEAT_INTERVAL,this.worker=(i=e?.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(c=e?.heartbeatCallback)!==null&&c!==void 0?c:Wp,this.vsn=(u=e?.vsn)!==null&&u!==void 0?u:py,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e?.reconnectAfterMs)!==null&&d!==void 0?d:(y=>Ck[y-1]||kk),this.vsn){case Ow:this.encode=(f=e?.encode)!==null&&f!==void 0?f:((y,_)=>_(JSON.stringify(y))),this.decode=(g=e?.decode)!==null&&g!==void 0?g:((y,_)=>_(JSON.parse(y)));break;case vk:this.encode=(v=e?.encode)!==null&&v!==void 0?v:this.serializer.encode.bind(this.serializer),this.decode=(x=e?.decode)!==null&&x!==void 0?x:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}var fu=class extends Error{constructor(r,e){super(r),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Ok(r,e,t){const a=new URL(e,r);if(t)for(const[s,i]of Object.entries(t))i!==void 0&&a.searchParams.set(s,i);return a.toString()}async function Dk(r){return!r||r.type==="none"?{}:r.type==="bearer"?{Authorization:`Bearer ${r.token}`}:r.type==="header"?{[r.name]:r.value}:r.type==="custom"?await r.getHeaders():{}}function Fk(r){const e=r.fetchImpl??globalThis.fetch;return{async request({method:t,path:a,query:s,body:i,headers:o}){const c=Ok(r.baseUrl,a,s),u=await Dk(r.auth),d=await e(c,{method:t,headers:{...i?{"Content-Type":"application/json"}:{},...u,...o},body:i?JSON.stringify(i):void 0}),f=await d.text(),g=(d.headers.get("content-type")||"").includes("application/json"),v=g&&f?JSON.parse(f):f;if(!d.ok){const x=g?v:void 0,y=x?.error;throw new fu(y?.message??`Request failed with status ${d.status}`,{status:d.status,icebergType:y?.type,icebergCode:y?.code,details:x})}return{status:d.status,headers:d.headers,data:v}}}}function md(r){return r.join("")}var Mk=class{constructor(r,e=""){this.client=r,this.prefix=e}async listNamespaces(r){const e=r?{parent:md(r.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(r,e){const t={namespace:r.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(r){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${md(r.namespace)}`})}async loadNamespaceMetadata(r){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${md(r.namespace)}`})).data.properties}}async namespaceExists(r){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${md(r.namespace)}`}),!0}catch(e){if(e instanceof fu&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(r,e){try{return await this.createNamespace(r,e)}catch(t){if(t instanceof fu&&t.status===409)return;throw t}}};function sl(r){return r.join("")}var Lk=class{constructor(r,e="",t){this.client=r,this.prefix=e,this.accessDelegation=t}async listTables(r){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${sl(r.namespace)}/tables`})).data.identifiers}async createTable(r,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${sl(r.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(r,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${sl(r.namespace)}/tables/${r.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(r,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${sl(r.namespace)}/tables/${r.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(r){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${sl(r.namespace)}/tables/${r.name}`,headers:e})).data.metadata}async tableExists(r){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${sl(r.namespace)}/tables/${r.name}`,headers:e}),!0}catch(t){if(t instanceof fu&&t.status===404)return!1;throw t}}async createTableIfNotExists(r,e){try{return await this.createTable(r,e)}catch(t){if(t instanceof fu&&t.status===409)return await this.loadTable({namespace:r.namespace,name:e.name});throw t}}},Ik=class{constructor(r){let e="v1";r.catalogName&&(e+=`/${r.catalogName}`);const t=r.baseUrl.endsWith("/")?r.baseUrl:`${r.baseUrl}/`;this.client=Fk({baseUrl:t,auth:r.auth,fetchImpl:r.fetch}),this.accessDelegation=r.accessDelegation?.join(","),this.namespaceOps=new Mk(this.client,e),this.tableOps=new Lk(this.client,e,this.accessDelegation)}async listNamespaces(r){return this.namespaceOps.listNamespaces(r)}async createNamespace(r,e){return this.namespaceOps.createNamespace(r,e)}async dropNamespace(r){await this.namespaceOps.dropNamespace(r)}async loadNamespaceMetadata(r){return this.namespaceOps.loadNamespaceMetadata(r)}async listTables(r){return this.tableOps.listTables(r)}async createTable(r,e){return this.tableOps.createTable(r,e)}async updateTable(r,e){return this.tableOps.updateTable(r,e)}async dropTable(r,e){await this.tableOps.dropTable(r,e)}async loadTable(r){return this.tableOps.loadTable(r)}async namespaceExists(r){return this.namespaceOps.namespaceExists(r)}async tableExists(r){return this.tableOps.tableExists(r)}async createNamespaceIfNotExists(r,e){return this.namespaceOps.createNamespaceIfNotExists(r,e)}async createTableIfNotExists(r,e){return this.tableOps.createTableIfNotExists(r,e)}},ff=class extends Error{constructor(r){super(r),this.__isStorageError=!0,this.name="StorageError"}};function or(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}var jk=class extends ff{constructor(r,e,t){super(r),this.name="StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Tg=class extends ff{constructor(r,e){super(r),this.name="StorageUnknownError",this.originalError=e}};const pm=r=>r?(...e)=>r(...e):(...e)=>fetch(...e),Pk=()=>Response,Cg=r=>{if(Array.isArray(r))return r.map(t=>Cg(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,a])=>{const s=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=Cg(a)}),e},Bk=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},Uk=r=>!r||typeof r!="string"||r.length===0||r.length>100||r.trim()!==r||r.includes("/")||r.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(r);function pu(r){"@babel/helpers - typeof";return pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pu(r)}function zk(r,e){if(pu(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var a=t.call(r,e);if(pu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Hk(r){var e=zk(r,"string");return pu(e)=="symbol"?e:e+""}function $k(r,e,t){return(e=Hk(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function xy(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);e&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,a)}return t}function Ye(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?xy(Object(t),!0).forEach(function(a){$k(r,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):xy(Object(t)).forEach(function(a){Object.defineProperty(r,a,Object.getOwnPropertyDescriptor(t,a))})}return r}const Xp=r=>{var e;return r.msg||r.message||r.error_description||(typeof r.error=="string"?r.error:(e=r.error)===null||e===void 0?void 0:e.message)||JSON.stringify(r)},Gk=async(r,e,t)=>{r instanceof await Pk()&&!t?.noResolveJson?r.json().then(a=>{const s=r.status||500,i=a?.statusCode||s+"";e(new jk(Xp(a),s,i))}).catch(a=>{e(new Tg(Xp(a),a))}):e(new Tg(Xp(r),r))},Vk=(r,e,t,a)=>{const s={method:r,headers:e?.headers||{}};return r==="GET"||!a?s:(Bk(a)?(s.headers=Ye({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(a)):s.body=a,e?.duplex&&(s.duplex=e.duplex),Ye(Ye({},s),t))};async function ju(r,e,t,a,s,i){return new Promise((o,c)=>{r(t,Vk(e,a,s,i)).then(u=>{if(!u.ok)throw u;return a?.noResolveJson?u:u.json()}).then(u=>o(u)).catch(u=>Gk(u,c,a))})}async function gu(r,e,t,a){return ju(r,"GET",e,t,a)}async function Ds(r,e,t,a,s){return ju(r,"POST",e,a,s,t)}async function kg(r,e,t,a,s){return ju(r,"PUT",e,a,s,t)}async function qk(r,e,t,a){return ju(r,"HEAD",e,Ye(Ye({},t),{},{noResolveJson:!0}),a)}async function gm(r,e,t,a,s){return ju(r,"DELETE",e,a,s,t)}var Wk=class{constructor(r,e){this.downloadFn=r,this.shouldThrowOnError=e}then(r,e){return this.execute().then(r,e)}async execute(){var r=this;try{return{data:(await r.downloadFn()).body,error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(or(e))return{data:null,error:e};throw e}}};let Lw;Lw=Symbol.toStringTag;var Xk=class{constructor(r,e){this.downloadFn=r,this.shouldThrowOnError=e,this[Lw]="BlobDownloadBuilder",this.promise=null}asStream(){return new Wk(this.downloadFn,this.shouldThrowOnError)}then(r,e){return this.getPromise().then(r,e)}catch(r){return this.getPromise().catch(r)}finally(r){return this.getPromise().finally(r)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var r=this;try{return{data:await(await r.downloadFn()).blob(),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(or(e))return{data:null,error:e};throw e}}};const Yk={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},_y={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Kk=class{constructor(r,e={},t,a){this.shouldThrowOnError=!1,this.url=r,this.headers=e,this.bucketId=t,this.fetch=pm(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(r,e,t,a){var s=this;try{let i;const o=Ye(Ye({},_y),a);let c=Ye(Ye({},s.headers),r==="POST"&&{"x-upsert":String(o.upsert)});const u=o.metadata;typeof Blob<"u"&&t instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),u&&i.append("metadata",s.encodeMetadata(u)),i.append("",t)):typeof FormData<"u"&&t instanceof FormData?(i=t,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),u&&!i.has("metadata")&&i.append("metadata",s.encodeMetadata(u))):(i=t,c["cache-control"]=`max-age=${o.cacheControl}`,c["content-type"]=o.contentType,u&&(c["x-metadata"]=s.toBase64(s.encodeMetadata(u))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),a?.headers&&(c=Ye(Ye({},c),a.headers));const d=s._removeEmptyFolders(e),f=s._getFinalPath(d),g=await(r=="PUT"?kg:Ds)(s.fetch,`${s.url}/object/${f}`,i,Ye({headers:c},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:g.Id,fullPath:g.Key},error:null}}catch(i){if(s.shouldThrowOnError)throw i;if(or(i))return{data:null,error:i};throw i}}async upload(r,e,t){return this.uploadOrUpdate("POST",r,e,t)}async uploadToSignedUrl(r,e,t,a){var s=this;const i=s._removeEmptyFolders(r),o=s._getFinalPath(i),c=new URL(s.url+`/object/upload/sign/${o}`);c.searchParams.set("token",e);try{let u;const d=Ye({upsert:_y.upsert},a),f=Ye(Ye({},s.headers),{"x-upsert":String(d.upsert)});return typeof Blob<"u"&&t instanceof Blob?(u=new FormData,u.append("cacheControl",d.cacheControl),u.append("",t)):typeof FormData<"u"&&t instanceof FormData?(u=t,u.append("cacheControl",d.cacheControl)):(u=t,f["cache-control"]=`max-age=${d.cacheControl}`,f["content-type"]=d.contentType),{data:{path:i,fullPath:(await kg(s.fetch,c.toString(),u,{headers:f})).Key},error:null}}catch(u){if(s.shouldThrowOnError)throw u;if(or(u))return{data:null,error:u};throw u}}async createSignedUploadUrl(r,e){var t=this;try{let a=t._getFinalPath(r);const s=Ye({},t.headers);e?.upsert&&(s["x-upsert"]="true");const i=await Ds(t.fetch,`${t.url}/object/upload/sign/${a}`,{},{headers:s}),o=new URL(t.url+i.url),c=o.searchParams.get("token");if(!c)throw new ff("No token returned by API");return{data:{signedUrl:o.toString(),path:r,token:c},error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(or(a))return{data:null,error:a};throw a}}async update(r,e,t){return this.uploadOrUpdate("PUT",r,e,t)}async move(r,e,t){var a=this;try{return{data:await Ds(a.fetch,`${a.url}/object/move`,{bucketId:a.bucketId,sourceKey:r,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:a.headers}),error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(or(s))return{data:null,error:s};throw s}}async copy(r,e,t){var a=this;try{return{data:{path:(await Ds(a.fetch,`${a.url}/object/copy`,{bucketId:a.bucketId,sourceKey:r,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:a.headers})).Key},error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(or(s))return{data:null,error:s};throw s}}async createSignedUrl(r,e,t){var a=this;try{let s=a._getFinalPath(r),i=await Ds(a.fetch,`${a.url}/object/sign/${s}`,Ye({expiresIn:e},t?.transform?{transform:t.transform}:{}),{headers:a.headers});const o=t?.download?`&download=${t.download===!0?"":t.download}`:"";return i={signedUrl:encodeURI(`${a.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(or(s))return{data:null,error:s};throw s}}async createSignedUrls(r,e,t){var a=this;try{const s=await Ds(a.fetch,`${a.url}/object/sign/${a.bucketId}`,{expiresIn:e,paths:r},{headers:a.headers}),i=t?.download?`&download=${t.download===!0?"":t.download}`:"";return{data:s.map(o=>Ye(Ye({},o),{},{signedUrl:o.signedURL?encodeURI(`${a.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(or(s))return{data:null,error:s};throw s}}download(r,e){const t=typeof e?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(e?.transform||{}),s=a?`?${a}`:"",i=this._getFinalPath(r),o=()=>gu(this.fetch,`${this.url}/${t}/${i}${s}`,{headers:this.headers,noResolveJson:!0});return new Xk(o,this.shouldThrowOnError)}async info(r){var e=this;const t=e._getFinalPath(r);try{return{data:Cg(await gu(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})),error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(or(a))return{data:null,error:a};throw a}}async exists(r){var e=this;const t=e._getFinalPath(r);try{return await qk(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(or(a)&&a instanceof Tg){const s=a.originalError;if([400,404].includes(s?.status))return{data:!1,error:a}}throw a}}getPublicUrl(r,e){const t=this._getFinalPath(r),a=[],s=e?.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&a.push(s);const i=typeof e?.transform<"u"?"render/image":"object",o=this.transformOptsToQueryString(e?.transform||{});o!==""&&a.push(o);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${t}${c}`)}}}async remove(r){var e=this;try{return{data:await gm(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:r},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(or(t))return{data:null,error:t};throw t}}async list(r,e,t){var a=this;try{const s=Ye(Ye(Ye({},Yk),e),{},{prefix:r||""});return{data:await Ds(a.fetch,`${a.url}/object/list/${a.bucketId}`,s,{headers:a.headers},t),error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(or(s))return{data:null,error:s};throw s}}async listV2(r,e){var t=this;try{const a=Ye({},r);return{data:await Ds(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,a,{headers:t.headers},e),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(or(a))return{data:null,error:a};throw a}}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r.replace(/^\/+/,"")}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const e=[];return r.width&&e.push(`width=${r.width}`),r.height&&e.push(`height=${r.height}`),r.resize&&e.push(`resize=${r.resize}`),r.format&&e.push(`format=${r.format}`),r.quality&&e.push(`quality=${r.quality}`),e.join("&")}};const Iw="2.89.0",jw={"X-Client-Info":`storage-js/${Iw}`};var Jk=class{constructor(r,e={},t,a){this.shouldThrowOnError=!1;const s=new URL(r);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Ye(Ye({},jw),e),this.fetch=pm(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(r){var e=this;try{const t=e.listBucketOptionsToQueryString(r);return{data:await gu(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(or(t))return{data:null,error:t};throw t}}async getBucket(r){var e=this;try{return{data:await gu(e.fetch,`${e.url}/bucket/${r}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(or(t))return{data:null,error:t};throw t}}async createBucket(r,e={public:!1}){var t=this;try{return{data:await Ds(t.fetch,`${t.url}/bucket`,{id:r,name:r,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(or(a))return{data:null,error:a};throw a}}async updateBucket(r,e){var t=this;try{return{data:await kg(t.fetch,`${t.url}/bucket/${r}`,{id:r,name:r,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(or(a))return{data:null,error:a};throw a}}async emptyBucket(r){var e=this;try{return{data:await Ds(e.fetch,`${e.url}/bucket/${r}/empty`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(or(t))return{data:null,error:t};throw t}}async deleteBucket(r){var e=this;try{return{data:await gm(e.fetch,`${e.url}/bucket/${r}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(or(t))return{data:null,error:t};throw t}}listBucketOptionsToQueryString(r){const e={};return r&&("limit"in r&&(e.limit=String(r.limit)),"offset"in r&&(e.offset=String(r.offset)),r.search&&(e.search=r.search),r.sortColumn&&(e.sortColumn=r.sortColumn),r.sortOrder&&(e.sortOrder=r.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},Qk=class{constructor(r,e={},t){this.shouldThrowOnError=!1,this.url=r.replace(/\/$/,""),this.headers=Ye(Ye({},jw),e),this.fetch=pm(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(r){var e=this;try{return{data:await Ds(e.fetch,`${e.url}/bucket`,{name:r},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(or(t))return{data:null,error:t};throw t}}async listBuckets(r){var e=this;try{const t=new URLSearchParams;r?.limit!==void 0&&t.set("limit",r.limit.toString()),r?.offset!==void 0&&t.set("offset",r.offset.toString()),r?.sortColumn&&t.set("sortColumn",r.sortColumn),r?.sortOrder&&t.set("sortOrder",r.sortOrder),r?.search&&t.set("search",r.search);const a=t.toString(),s=a?`${e.url}/bucket?${a}`:`${e.url}/bucket`;return{data:await gu(e.fetch,s,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(or(t))return{data:null,error:t};throw t}}async deleteBucket(r){var e=this;try{return{data:await gm(e.fetch,`${e.url}/bucket/${r}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(or(t))return{data:null,error:t};throw t}}from(r){var e=this;if(!Uk(r))throw new ff("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new Ik({baseUrl:this.url,catalogName:r,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(t,{get(s,i){const o=s[i];return typeof o!="function"?o:async(...c)=>{try{return{data:await o.apply(s,c),error:null}}catch(u){if(a)throw u;return{data:null,error:u}}}}})}};const mm={"X-Client-Info":`storage-js/${Iw}`,"Content-Type":"application/json"};var Pw=class extends Error{constructor(r){super(r),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Wa(r){return typeof r=="object"&&r!==null&&"__isStorageVectorsError"in r}var Yp=class extends Pw{constructor(r,e,t){super(r),this.name="StorageVectorsApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Zk=class extends Pw{constructor(r,e){super(r),this.name="StorageVectorsUnknownError",this.originalError=e}};const vm=r=>r?(...e)=>r(...e):(...e)=>fetch(...e),eN=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},yy=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),tN=async(r,e,t)=>{if(r&&typeof r=="object"&&"status"in r&&"ok"in r&&typeof r.status=="number"&&!t?.noResolveJson){const a=r.status||500,s=r;if(typeof s.json=="function")s.json().then(i=>{const o=i?.statusCode||i?.code||a+"";e(new Yp(yy(i),a,o))}).catch(()=>{const i=a+"";e(new Yp(s.statusText||`HTTP ${a} error`,a,i))});else{const i=a+"";e(new Yp(s.statusText||`HTTP ${a} error`,a,i))}}else e(new Zk(yy(r),r))},rN=(r,e,t,a)=>{const s={method:r,headers:e?.headers||{}};return a?(eN(a)?(s.headers=Ye({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(a)):s.body=a,Ye(Ye({},s),t)):s};async function aN(r,e,t,a,s,i){return new Promise((o,c)=>{r(t,rN(e,a,s,i)).then(u=>{if(!u.ok)throw u;if(a?.noResolveJson)return u;const d=u.headers.get("content-type");return!d||!d.includes("application/json")?{}:u.json()}).then(u=>o(u)).catch(u=>tN(u,c,a))})}async function Xa(r,e,t,a,s){return aN(r,"POST",e,a,s,t)}var sN=class{constructor(r,e={},t){this.shouldThrowOnError=!1,this.url=r.replace(/\/$/,""),this.headers=Ye(Ye({},mm),e),this.fetch=vm(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(r){var e=this;try{return{data:await Xa(e.fetch,`${e.url}/CreateIndex`,r,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Wa(t))return{data:null,error:t};throw t}}async getIndex(r,e){var t=this;try{return{data:await Xa(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:r,indexName:e},{headers:t.headers}),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(Wa(a))return{data:null,error:a};throw a}}async listIndexes(r){var e=this;try{return{data:await Xa(e.fetch,`${e.url}/ListIndexes`,r,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Wa(t))return{data:null,error:t};throw t}}async deleteIndex(r,e){var t=this;try{return{data:await Xa(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:r,indexName:e},{headers:t.headers})||{},error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(Wa(a))return{data:null,error:a};throw a}}},nN=class{constructor(r,e={},t){this.shouldThrowOnError=!1,this.url=r.replace(/\/$/,""),this.headers=Ye(Ye({},mm),e),this.fetch=vm(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(r){var e=this;try{if(r.vectors.length<1||r.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Xa(e.fetch,`${e.url}/PutVectors`,r,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Wa(t))return{data:null,error:t};throw t}}async getVectors(r){var e=this;try{return{data:await Xa(e.fetch,`${e.url}/GetVectors`,r,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Wa(t))return{data:null,error:t};throw t}}async listVectors(r){var e=this;try{if(r.segmentCount!==void 0){if(r.segmentCount<1||r.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(r.segmentIndex!==void 0&&(r.segmentIndex<0||r.segmentIndex>=r.segmentCount))throw new Error(`segmentIndex must be between 0 and ${r.segmentCount-1}`)}return{data:await Xa(e.fetch,`${e.url}/ListVectors`,r,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Wa(t))return{data:null,error:t};throw t}}async queryVectors(r){var e=this;try{return{data:await Xa(e.fetch,`${e.url}/QueryVectors`,r,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Wa(t))return{data:null,error:t};throw t}}async deleteVectors(r){var e=this;try{if(r.keys.length<1||r.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Xa(e.fetch,`${e.url}/DeleteVectors`,r,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Wa(t))return{data:null,error:t};throw t}}},iN=class{constructor(r,e={},t){this.shouldThrowOnError=!1,this.url=r.replace(/\/$/,""),this.headers=Ye(Ye({},mm),e),this.fetch=vm(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(r){var e=this;try{return{data:await Xa(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:r},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Wa(t))return{data:null,error:t};throw t}}async getBucket(r){var e=this;try{return{data:await Xa(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:r},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Wa(t))return{data:null,error:t};throw t}}async listBuckets(r={}){var e=this;try{return{data:await Xa(e.fetch,`${e.url}/ListVectorBuckets`,r,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Wa(t))return{data:null,error:t};throw t}}async deleteBucket(r){var e=this;try{return{data:await Xa(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:r},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Wa(t))return{data:null,error:t};throw t}}},oN=class extends iN{constructor(r,e={}){super(r,e.headers||{},e.fetch)}from(r){return new lN(this.url,this.headers,r,this.fetch)}async createBucket(r){var e=()=>super.createBucket,t=this;return e().call(t,r)}async getBucket(r){var e=()=>super.getBucket,t=this;return e().call(t,r)}async listBuckets(r={}){var e=()=>super.listBuckets,t=this;return e().call(t,r)}async deleteBucket(r){var e=()=>super.deleteBucket,t=this;return e().call(t,r)}},lN=class extends sN{constructor(r,e,t,a){super(r,e,a),this.vectorBucketName=t}async createIndex(r){var e=()=>super.createIndex,t=this;return e().call(t,Ye(Ye({},r),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(r={}){var e=()=>super.listIndexes,t=this;return e().call(t,Ye(Ye({},r),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(r){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,r)}async deleteIndex(r){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,r)}index(r){return new cN(this.url,this.headers,this.vectorBucketName,r,this.fetch)}},cN=class extends nN{constructor(r,e,t,a,s){super(r,e,s),this.vectorBucketName=t,this.indexName=a}async putVectors(r){var e=()=>super.putVectors,t=this;return e().call(t,Ye(Ye({},r),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(r){var e=()=>super.getVectors,t=this;return e().call(t,Ye(Ye({},r),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(r={}){var e=()=>super.listVectors,t=this;return e().call(t,Ye(Ye({},r),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(r){var e=()=>super.queryVectors,t=this;return e().call(t,Ye(Ye({},r),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(r){var e=()=>super.deleteVectors,t=this;return e().call(t,Ye(Ye({},r),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},uN=class extends Jk{constructor(r,e={},t,a){super(r,e,t,a)}from(r){return new Kk(this.url,this.headers,r,this.fetch)}get vectors(){return new oN(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Qk(this.url+"/iceberg",this.headers,this.fetch)}};const Bw="2.89.0",vl=30*1e3,Ng=3,Kp=Ng*vl,hN="http://localhost:9999",dN="supabase.auth.token",fN={"X-Client-Info":`gotrue-js/${Bw}`},Rg="X-Supabase-Api-Version",Uw={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},pN=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,gN=600*1e3;class mu extends Error{constructor(e,t,a){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=a}}function He(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class mN extends mu{constructor(e,t,a){super(e,t,a),this.name="AuthApiError",this.status=t,this.code=a}}function vN(r){return He(r)&&r.name==="AuthApiError"}class Yi extends mu{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Ln extends mu{constructor(e,t,a,s){super(e,a,s),this.name=t,this.status=a}}class Ha extends Ln{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function xN(r){return He(r)&&r.name==="AuthSessionMissingError"}class nl extends Ln{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class vd extends Ln{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class xd extends Ln{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function _N(r){return He(r)&&r.name==="AuthImplicitGrantRedirectError"}class by extends Ln{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class yN extends Ln{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Og extends Ln{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Jp(r){return He(r)&&r.name==="AuthRetryableFetchError"}class wy extends Ln{constructor(e,t,a){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=a}}class Dg extends Ln{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Gd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ey=` 	
\r=`.split(""),bN=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<Ey.length;e+=1)r[Ey[e].charCodeAt(0)]=-2;for(let e=0;e<Gd.length;e+=1)r[Gd[e].charCodeAt(0)]=e;return r})();function Ay(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const a=e.queue>>e.queuedBits-6&63;t(Gd[a]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const a=e.queue>>e.queuedBits-6&63;t(Gd[a]),e.queuedBits-=6}}function zw(r,e,t){const a=bN[r];if(a>-1)for(e.queue=e.queue<<6|a,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function Sy(r){const e=[],t=o=>{e.push(String.fromCodePoint(o))},a={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{AN(o,a,t)};for(let o=0;o<r.length;o+=1)zw(r.charCodeAt(o),s,i);return e.join("")}function wN(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function EN(r,e){for(let t=0;t<r.length;t+=1){let a=r.charCodeAt(t);if(a>55295&&a<=56319){const s=(a-55296)*1024&65535;a=(r.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}wN(a,e)}}function AN(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let a=1;a<6;a+=1)if((r>>7-a&1)===0){e.utf8seq=a;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function kl(r){const e=[],t={queue:0,queuedBits:0},a=s=>{e.push(s)};for(let s=0;s<r.length;s+=1)zw(r.charCodeAt(s),t,a);return new Uint8Array(e)}function SN(r){const e=[];return EN(r,t=>e.push(t)),new Uint8Array(e)}function Ji(r){const e=[],t={queue:0,queuedBits:0},a=s=>{e.push(s)};return r.forEach(s=>Ay(s,t,a)),Ay(null,t,a),e.join("")}function TN(r){return Math.round(Date.now()/1e3)+r}function CN(){return Symbol("auth-callback")}const Xr=()=>typeof window<"u"&&typeof document<"u",Vi={tested:!1,writable:!1},Hw=()=>{if(!Xr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Vi.tested)return Vi.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Vi.tested=!0,Vi.writable=!0}catch{Vi.tested=!0,Vi.writable=!1}return Vi.writable};function kN(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return t.searchParams.forEach((a,s)=>{e[s]=a}),e}const $w=r=>r?(...e)=>r(...e):(...e)=>fetch(...e),NN=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",xl=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},qi=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Wr=async(r,e)=>{await r.removeItem(e)};class pf{constructor(){this.promise=new pf.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}pf.promiseConstructor=Promise;function Qp(r){const e=r.split(".");if(e.length!==3)throw new Dg("Invalid JWT structure");for(let a=0;a<e.length;a++)if(!pN.test(e[a]))throw new Dg("JWT not in base64url format");return{header:JSON.parse(Sy(e[0])),payload:JSON.parse(Sy(e[1])),signature:kl(e[2]),raw:{header:e[0],payload:e[1]}}}async function RN(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function ON(r,e){return new Promise((a,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await r(i);if(!e(i,null,o)){a(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function DN(r){return("0"+r.toString(16)).substr(-2)}function FN(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*a));return s}return crypto.getRandomValues(e),Array.from(e,DN).join("")}async function MN(r){const t=new TextEncoder().encode(r),a=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(a);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function LN(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await MN(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function il(r,e,t=!1){const a=FN();let s=a;t&&(s+="/PASSWORD_RECOVERY"),await xl(r,`${e}-code-verifier`,s);const i=await LN(a);return[i,a===i?"plain":"s256"]}const IN=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function jN(r){const e=r.headers.get(Rg);if(!e||!e.match(IN))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function PN(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function BN(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const UN=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ol(r){if(!UN.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Zp(){const r={};return new Proxy(r,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const a=t.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function zN(r,e){return new Proxy(r,{get:(t,a,s)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const i=a.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,a,s)}return!e.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,a,s)}})}function Ty(r){return JSON.parse(JSON.stringify(r))}const Wi=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),HN=[502,503,504];async function Cy(r){var e;if(!NN(r))throw new Og(Wi(r),0);if(HN.includes(r.status))throw new Og(Wi(r),r.status);let t;try{t=await r.json()}catch(i){throw new Yi(Wi(i),i)}let a;const s=jN(r);if(s&&s.getTime()>=Uw["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?a=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(a=t.error_code),a){if(a==="weak_password")throw new wy(Wi(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(a==="session_not_found")throw new Ha}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new wy(Wi(t),r.status,t.weak_password.reasons);throw new mN(Wi(t),r.status||500,a)}const $N=(r,e,t,a)=>{const s={method:r,headers:e?.headers||{}};return r==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(a),Object.assign(Object.assign({},s),t))};async function Xe(r,e,t,a){var s;const i=Object.assign({},a?.headers);i[Rg]||(i[Rg]=Uw["2024-01-01"].name),a?.jwt&&(i.Authorization=`Bearer ${a.jwt}`);const o=(s=a?.query)!==null&&s!==void 0?s:{};a?.redirectTo&&(o.redirect_to=a.redirectTo);const c=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",u=await GN(r,e,t+c,{headers:i,noResolveJson:a?.noResolveJson},{},a?.body);return a?.xform?a?.xform(u):{data:Object.assign({},u),error:null}}async function GN(r,e,t,a,s,i){const o=$N(e,a,s,i);let c;try{c=await r(t,Object.assign({},o))}catch(u){throw console.error(u),new Og(Wi(u),0)}if(c.ok||await Cy(c),a?.noResolveJson)return c;try{return await c.json()}catch(u){await Cy(u)}}function Os(r){var e;let t=null;WN(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=TN(r.expires_in)));const a=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:a},error:null}}function ky(r){const e=Os(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,a)=>t&&typeof a=="string",!0)&&(e.data.weak_password=r.weak_password),e}function hi(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function VN(r){return{data:r,error:null}}function qN(r){const{action_link:e,email_otp:t,hashed_token:a,redirect_to:s,verification_type:i}=r,o=df(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:t,hashed_token:a,redirect_to:s,verification_type:i},u=Object.assign({},o);return{data:{properties:c,user:u},error:null}}function Ny(r){return r}function WN(r){return r.access_token&&r.refresh_token&&r.expires_in}const eg=["global","local","others"];class XN{constructor({url:e="",headers:t={},fetch:a}){this.url=e,this.headers=t,this.fetch=$w(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=eg[0]){if(eg.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${eg.join(", ")}`);try{return await Xe(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(a){if(He(a))return{data:null,error:a};throw a}}async inviteUserByEmail(e,t={}){try{return await Xe(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:hi})}catch(a){if(He(a))return{data:{user:null},error:a};throw a}}async generateLink(e){try{const{options:t}=e,a=df(e,["options"]),s=Object.assign(Object.assign({},a),t);return"newEmail"in a&&(s.new_email=a?.newEmail,delete s.newEmail),await Xe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:qN,redirectTo:t?.redirectTo})}catch(t){if(He(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Xe(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:hi})}catch(t){if(He(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,a,s,i,o,c,u;try{const d={nextPage:null,lastPage:0,total:0},f=await Xe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&a!==void 0?a:"",per_page:(i=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Ny});if(f.error)throw f.error;const g=await f.json(),v=(o=f.headers.get("x-total-count"))!==null&&o!==void 0?o:0,x=(u=(c=f.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&u!==void 0?u:[];return x.length>0&&(x.forEach(y=>{const _=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(y.split(";")[1].split("=")[1]);d[`${w}Page`]=_}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},g),d),error:null}}catch(d){if(He(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){ol(e);try{return await Xe(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:hi})}catch(t){if(He(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){ol(e);try{return await Xe(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:hi})}catch(a){if(He(a))return{data:{user:null},error:a};throw a}}async deleteUser(e,t=!1){ol(e);try{return await Xe(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:hi})}catch(a){if(He(a))return{data:{user:null},error:a};throw a}}async _listFactors(e){ol(e.userId);try{const{data:t,error:a}=await Xe(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:a}}catch(t){if(He(t))return{data:null,error:t};throw t}}async _deleteFactor(e){ol(e.userId),ol(e.id);try{return{data:await Xe(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(He(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,a,s,i,o,c,u;try{const d={nextPage:null,lastPage:0,total:0},f=await Xe(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&a!==void 0?a:"",per_page:(i=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Ny});if(f.error)throw f.error;const g=await f.json(),v=(o=f.headers.get("x-total-count"))!==null&&o!==void 0?o:0,x=(u=(c=f.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&u!==void 0?u:[];return x.length>0&&(x.forEach(y=>{const _=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(y.split(";")[1].split("=")[1]);d[`${w}Page`]=_}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},g),d),error:null}}catch(d){if(He(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await Xe(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(He(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await Xe(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(He(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await Xe(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(He(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(e){try{return await Xe(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(He(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await Xe(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(He(t))return{data:null,error:t};throw t}}}function Ry(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}const ll={debug:!!(globalThis&&Hw()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Gw extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class YN extends Gw{}async function KN(r,e,t){ll.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const a=new globalThis.AbortController;return e>0&&setTimeout(()=>{a.abort(),ll.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async s=>{if(s){ll.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,s.name);try{return await t()}finally{ll.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,s.name)}}else{if(e===0)throw ll.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new YN(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(ll.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function JN(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Vw(r){if(!/^0x[a-fA-F0-9]{40}$/.test(r))throw new Error(`@supabase/auth-js: Address "${r}" is invalid.`);return r.toLowerCase()}function QN(r){return parseInt(r,16)}function ZN(r){const e=new TextEncoder().encode(r);return"0x"+Array.from(e,a=>a.toString(16).padStart(2,"0")).join("")}function eR(r){var e;const{chainId:t,domain:a,expirationTime:s,issuedAt:i=new Date,nonce:o,notBefore:c,requestId:u,resources:d,scheme:f,uri:g,version:v}=r;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!g)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(v!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${v}`);if(!((e=r.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${r.statement}`)}const x=Vw(r.address),y=f?`${f}://${a}`:a,_=r.statement?`${r.statement}
`:"",w=`${y} wants you to sign in with your Ethereum account:
${x}

${_}`;let A=`URI: ${g}
Version: ${v}
Chain ID: ${t}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(s&&(A+=`
Expiration Time: ${s.toISOString()}`),c&&(A+=`
Not Before: ${c.toISOString()}`),u&&(A+=`
Request ID: ${u}`),d){let T=`
Resources:`;for(const S of d){if(!S||typeof S!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${S}`);T+=`
- ${S}`}A+=T}return`${w}
${A}`}class Rr extends Error{constructor({message:e,code:t,cause:a,name:s}){var i;super(e,{cause:a}),this.__isWebAuthnError=!0,this.name=(i=s??(a instanceof Error?a.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=t}}class Vd extends Rr{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function tR({error:r,options:e}){var t,a,s;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Rr({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else if(r.name==="ConstraintError"){if(((t=i.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new Rr({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:r});if(e.mediation==="conditional"&&((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Rr({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:r});if(((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Rr({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:r})}else{if(r.name==="InvalidStateError")return new Rr({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:r});if(r.name==="NotAllowedError")return new Rr({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="NotSupportedError")return i.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new Rr({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:r}):new Rr({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:r});if(r.name==="SecurityError"){const o=window.location.hostname;if(qw(o)){if(i.rp.id!==o)return new Rr({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new Rr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Rr({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:r})}else if(r.name==="UnknownError")return new Rr({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new Rr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}function rR({error:r,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Rr({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else{if(r.name==="NotAllowedError")return new Rr({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="SecurityError"){const a=window.location.hostname;if(qw(a)){if(t.rpId!==a)return new Rr({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new Rr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="UnknownError")return new Rr({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new Rr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}class aR{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const sR=new aR;function nR(r){if(!r)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(r);const{challenge:e,user:t,excludeCredentials:a}=r,s=df(r,["challenge","user","excludeCredentials"]),i=kl(e).buffer,o=Object.assign(Object.assign({},t),{id:kl(t.id).buffer}),c=Object.assign(Object.assign({},s),{challenge:i,user:o});if(a&&a.length>0){c.excludeCredentials=new Array(a.length);for(let u=0;u<a.length;u++){const d=a[u];c.excludeCredentials[u]=Object.assign(Object.assign({},d),{id:kl(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return c}function iR(r){if(!r)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(r);const{challenge:e,allowCredentials:t}=r,a=df(r,["challenge","allowCredentials"]),s=kl(e).buffer,i=Object.assign(Object.assign({},a),{challenge:s});if(t&&t.length>0){i.allowCredentials=new Array(t.length);for(let o=0;o<t.length;o++){const c=t[o];i.allowCredentials[o]=Object.assign(Object.assign({},c),{id:kl(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return i}function oR(r){var e;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const t=r;return{id:r.id,rawId:r.id,response:{attestationObject:Ji(new Uint8Array(r.response.attestationObject)),clientDataJSON:Ji(new Uint8Array(r.response.clientDataJSON))},type:"public-key",clientExtensionResults:r.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function lR(r){var e;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const t=r,a=r.getClientExtensionResults(),s=r.response;return{id:r.id,rawId:r.id,response:{authenticatorData:Ji(new Uint8Array(s.authenticatorData)),clientDataJSON:Ji(new Uint8Array(s.clientDataJSON)),signature:Ji(new Uint8Array(s.signature)),userHandle:s.userHandle?Ji(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function qw(r){return r==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(r)}function Oy(){var r,e;return!!(Xr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((r=navigator?.credentials)===null||r===void 0?void 0:r.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function cR(r){try{const e=await navigator.credentials.create(r);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Vd("Browser returned unexpected credential type",e)}:{data:null,error:new Vd("Empty credential response",e)}}catch(e){return{data:null,error:tR({error:e,options:r})}}}async function uR(r){try{const e=await navigator.credentials.get(r);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Vd("Browser returned unexpected credential type",e)}:{data:null,error:new Vd("Empty credential response",e)}}catch(e){return{data:null,error:rR({error:e,options:r})}}}const hR={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},dR={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function qd(...r){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),a={};for(const s of r)if(s)for(const i in s){const o=s[i];if(o!==void 0)if(Array.isArray(o))a[i]=o;else if(t(o))a[i]=o;else if(e(o)){const c=a[i];e(c)?a[i]=qd(c,o):a[i]=qd(o)}else a[i]=o}return a}function fR(r,e){return qd(hR,r,e||{})}function pR(r,e){return qd(dR,r,e||{})}class gR{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:a,signal:s},i){try{const{data:o,error:c}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!o)return{data:null,error:c};const u=s??sR.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:d}=o.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${a}`),d.displayName||(d.displayName=d.name)}switch(o.webauthn.type){case"create":{const d=fR(o.webauthn.credential_options.publicKey,i?.create),{data:f,error:g}=await cR({publicKey:d,signal:u});return f?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:f}},error:null}:{data:null,error:g}}case"request":{const d=pR(o.webauthn.credential_options.publicKey,i?.request),{data:f,error:g}=await uR(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:d,signal:u}));return f?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:f}},error:null}:{data:null,error:g}}}}catch(o){return He(o)?{data:null,error:o}:{data:null,error:new Yi("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:t,webauthn:a}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:a})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!t)return{data:null,error:new mu("rpId is required for WebAuthn authentication")};try{if(!Oy())return{data:null,error:new Yi("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:a},signal:s},{request:i});if(!o)return{data:null,error:c};const{webauthn:u}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:u.type,rpId:t,rpOrigins:a,credential_response:u.credential_response}})}catch(o){return He(o)?{data:null,error:o}:{data:null,error:new Yi("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!t)return{data:null,error:new mu("rpId is required for WebAuthn registration")};try{if(!Oy())return{data:null,error:new Yi("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(f=>{var g;return(g=f.data)===null||g===void 0?void 0:g.all.find(v=>v.factor_type==="webauthn"&&v.friendly_name===e&&v.status!=="unverified")}).then(f=>f?this.client.mfa.unenroll({factorId:f?.id}):void 0),{data:null,error:c};const{data:u,error:d}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:t,rpOrigins:a},signal:s},{create:i});return u?this._verify({factorId:o.id,challengeId:u.challengeId,webauthn:{rpId:t,rpOrigins:a,type:u.webauthn.type,credential_response:u.webauthn.credential_response}}):{data:null,error:d}}catch(o){return He(o)?{data:null,error:o}:{data:null,error:new Yi("Unexpected error in register",o)}}}}JN();const mR={url:hN,storageKey:dN,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:fN,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Dy(r,e,t){return await t()}const cl={};class vu{get jwks(){var e,t;return(t=(e=cl[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){cl[this.storageKey]=Object.assign(Object.assign({},cl[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=cl[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){cl[this.storageKey]=Object.assign(Object.assign({},cl[this.storageKey]),{cachedAt:e})}constructor(e){var t,a,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},mR),e);if(this.storageKey=i.storageKey,this.instanceID=(t=vu.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,vu.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&Xr()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new XN({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=$w(i.fetch),this.lock=i.lock||Dy,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:this.persistSession&&Xr()&&(!((a=globalThis?.navigator)===null||a===void 0)&&a.locks)?this.lock=KN:this.lock=Dy,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new gR(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:Hw()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ry(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=Ry(this.memoryStorage)),Xr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Bw}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},a="none";if(Xr()&&(t=kN(window.location.href),this._isImplicitGrantCallback(t)?a="implicit":await this._isPKCECallback(t)&&(a="pkce")),Xr()&&this.detectSessionInUrl&&a!=="none"){const{data:s,error:i}=await this._getSessionFromURL(t,a);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),_N(i)){const u=(e=i.details)===null||e===void 0?void 0:e.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:c}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",c),await this._saveSession(o),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return He(t)?this._returnResult({error:t}):this._returnResult({error:new Yi("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,a,s;try{const i=await Xe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:Os}),{data:o,error:c}=i;if(c||!o)return this._returnResult({data:{user:null,session:null},error:c});const u=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),this._returnResult({data:{user:d,session:u},error:null})}catch(i){if(He(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var t,a,s;try{let i;if("email"in e){const{email:f,password:g,options:v}=e;let x=null,y=null;this.flowType==="pkce"&&([x,y]=await il(this.storage,this.storageKey)),i=await Xe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v?.emailRedirectTo,body:{email:f,password:g,data:(t=v?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:x,code_challenge_method:y},xform:Os})}else if("phone"in e){const{phone:f,password:g,options:v}=e;i=await Xe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:g,data:(a=v?.data)!==null&&a!==void 0?a:{},channel:(s=v?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:v?.captchaToken}},xform:Os})}else throw new vd("You must provide either an email or phone number and a password");const{data:o,error:c}=i;if(c||!o)return await Wr(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:c});const u=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),this._returnResult({data:{user:d,session:u},error:null})}catch(i){if(await Wr(this.storage,`${this.storageKey}-code-verifier`),He(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:o,options:c}=e;t=await Xe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:ky})}else if("phone"in e){const{phone:i,password:o,options:c}=e;t=await Xe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:ky})}else throw new vd("You must provide either an email or phone number and a password");const{data:a,error:s}=t;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!a||!a.session||!a.user){const i=new nl;return this._returnResult({data:{user:null,session:null},error:i})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:s})}catch(t){if(He(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,a,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,a,s,i,o,c,u,d,f,g,v;let x,y;if("message"in e)x=e.message,y=e.signature;else{const{chain:_,wallet:w,statement:A,options:T}=e;let S;if(Xr())if(typeof w=="object")S=w;else{const I=window;if("ethereum"in I&&typeof I.ethereum=="object"&&"request"in I.ethereum&&typeof I.ethereum.request=="function")S=I.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!T?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=w}const N=new URL((t=T?.url)!==null&&t!==void 0?t:window.location.href),R=await S.request({method:"eth_requestAccounts"}).then(I=>I).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!R||R.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const O=Vw(R[0]);let C=(a=T?.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!C){const I=await S.request({method:"eth_chainId"});C=QN(I)}const j={domain:N.host,address:O,statement:A,uri:N.href,version:"1",chainId:C,nonce:(s=T?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(i=T?.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(c=T?.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(u=T?.signInWithEthereum)===null||u===void 0?void 0:u.notBefore,requestId:(d=T?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(f=T?.signInWithEthereum)===null||f===void 0?void 0:f.resources};x=eR(j),y=await S.request({method:"personal_sign",params:[ZN(x),O]})}try{const{data:_,error:w}=await Xe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:x,signature:y},!((g=e.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:Os});if(w)throw w;if(!_||!_.session||!_.user){const A=new nl;return this._returnResult({data:{user:null,session:null},error:A})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:w})}catch(_){if(He(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(e){var t,a,s,i,o,c,u,d,f,g,v,x;let y,_;if("message"in e)y=e.message,_=e.signature;else{const{chain:w,wallet:A,statement:T,options:S}=e;let N;if(Xr())if(typeof A=="object")N=A;else{const O=window;if("solana"in O&&typeof O.solana=="object"&&("signIn"in O.solana&&typeof O.solana.signIn=="function"||"signMessage"in O.solana&&typeof O.solana.signMessage=="function"))N=O.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!S?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=A}const R=new URL((t=S?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in N&&N.signIn){const O=await N.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},S?.signInWithSolana),{version:"1",domain:R.host,uri:R.href}),T?{statement:T}:null));let C;if(Array.isArray(O)&&O[0]&&typeof O[0]=="object")C=O[0];else if(O&&typeof O=="object"&&"signedMessage"in O&&"signature"in O)C=O;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)y=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),_=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in N)||typeof N.signMessage!="function"||!("publicKey"in N)||typeof N!="object"||!N.publicKey||!("toBase58"in N.publicKey)||typeof N.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${R.host} wants you to sign in with your Solana account:`,N.publicKey.toBase58(),...T?["",T,""]:[""],"Version: 1",`URI: ${R.href}`,`Issued At: ${(s=(a=S?.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=S?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${S.signInWithSolana.notBefore}`]:[],...!((o=S?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${S.signInWithSolana.expirationTime}`]:[],...!((c=S?.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${S.signInWithSolana.chainId}`]:[],...!((u=S?.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${S.signInWithSolana.nonce}`]:[],...!((d=S?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${S.signInWithSolana.requestId}`]:[],...!((g=(f=S?.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||g===void 0)&&g.length?["Resources",...S.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const O=await N.signMessage(new TextEncoder().encode(y),"utf8");if(!O||!(O instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=O}}try{const{data:w,error:A}=await Xe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:Ji(_)},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:Os});if(A)throw A;if(!w||!w.session||!w.user){const T=new nl;return this._returnResult({data:{user:null,session:null},error:T})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:A})}catch(w){if(He(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async _exchangeCodeForSession(e){const t=await qi(this.storage,`${this.storageKey}-code-verifier`),[a,s]=(t??"").split("/");try{if(!a&&this.flowType==="pkce")throw new yN;const{data:i,error:o}=await Xe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:a},xform:Os});if(await Wr(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const c=new nl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(await Wr(this.storage,`${this.storageKey}-code-verifier`),He(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:t,provider:a,token:s,access_token:i,nonce:o}=e,c=await Xe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:Os}),{data:u,error:d}=c;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!u||!u.session||!u.user){const f=new nl;return this._returnResult({data:{user:null,session:null},error:f})}return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),this._returnResult({data:u,error:d})}catch(t){if(He(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,a,s,i,o;try{if("email"in e){const{email:c,options:u}=e;let d=null,f=null;this.flowType==="pkce"&&([d,f]=await il(this.storage,this.storageKey));const{error:g}=await Xe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(t=u?.data)!==null&&t!==void 0?t:{},create_user:(a=u?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},code_challenge:d,code_challenge_method:f},redirectTo:u?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:g})}if("phone"in e){const{phone:c,options:u}=e,{data:d,error:f}=await Xe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(s=u?.data)!==null&&s!==void 0?s:{},create_user:(i=u?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},channel:(o=u?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:f})}throw new vd("You must provide either an email or phone number.")}catch(c){if(await Wr(this.storage,`${this.storageKey}-code-verifier`),He(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(e){var t,a;try{let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(a=e.options)===null||a===void 0?void 0:a.captchaToken);const{data:o,error:c}=await Xe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Os});if(c)throw c;if(!o)throw new Error("An error occurred on token verification.");const u=o.session,d=o.user;return u?.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),this._returnResult({data:{user:d,session:u},error:null})}catch(s){if(He(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var t,a,s,i,o;try{let c=null,u=null;this.flowType==="pkce"&&([c,u]=await il(this.storage,this.storageKey));const d=await Xe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(a=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&a!==void 0?a:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:u}),headers:this.headers,xform:VN});return!((i=d.data)===null||i===void 0)&&i.url&&Xr()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(c){if(await Wr(this.storage,`${this.storageKey}-code-verifier`),He(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:a}=e;if(a)throw a;if(!t)throw new Ha;const{error:s}=await Xe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(He(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:a,type:s,options:i}=e,{error:o}=await Xe(this.fetch,"POST",t,{headers:this.headers,body:{email:a,type:s,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:a,type:s,options:i}=e,{data:o,error:c}=await Xe(this.fetch,"POST",t,{headers:this.headers,body:{phone:a,type:s,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:c})}throw new vd("You must provide either an email or phone number and a type")}catch(t){if(He(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await a,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=t();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await qi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const a=e.expires_at?e.expires_at*1e3-Date.now()<Kp:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",e.expires_at),!a){if(this.userStorage){const o=await qi(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=Zp()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=zN(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(-1,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await Xe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:hi}):await this._useSession(async t=>{var a,s,i;const{data:o,error:c}=t;if(c)throw c;return!(!((a=o.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ha}:await Xe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:hi})})}catch(t){if(He(t))return xN(t)&&(await this._removeSession(),await Wr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async a=>{const{data:s,error:i}=a;if(i)throw i;if(!s.session)throw new Ha;const o=s.session;let c=null,u=null;this.flowType==="pkce"&&e.email!=null&&([c,u]=await il(this.storage,this.storageKey));const{data:d,error:f}=await Xe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:u}),jwt:o.access_token,xform:hi});if(f)throw f;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(a){if(await Wr(this.storage,`${this.storageKey}-code-verifier`),He(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ha;const t=Date.now()/1e3;let a=t,s=!0,i=null;const{payload:o}=Qp(e.access_token);if(o.exp&&(a=o.exp,s=a<=t),s){const{data:c,error:u}=await this._callRefreshToken(e.refresh_token);if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c)return{data:{user:null,session:null},error:null};i=c}else{const{data:c,error:u}=await this._getUser(e.access_token);if(u)throw u;i={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:a-t,expires_at:a},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(t){if(He(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var a;if(!e){const{data:o,error:c}=t;if(c)throw c;e=(a=o.session)!==null&&a!==void 0?a:void 0}if(!e?.refresh_token)throw new Ha;const{data:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(He(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!Xr())throw new xd("No browser detected.");if(e.error||e.error_description||e.error_code)throw new xd(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new by("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new xd("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new by("No code detected.");const{data:T,error:S}=await this._exchangeCodeForSession(e.code);if(S)throw S;const N=new URL(window.location.href);return N.searchParams.delete("code"),window.history.replaceState(window.history.state,"",N.toString()),{data:{session:T.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:c,expires_at:u,token_type:d}=e;if(!i||!c||!o||!d)throw new xd("No session defined in URL");const f=Math.round(Date.now()/1e3),g=parseInt(c);let v=f+g;u&&(v=parseInt(u));const x=v-f;x*1e3<=vl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${g}s`);const y=v-g;f-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,v,f):f-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,v,f);const{data:_,error:w}=await this._getUser(i);if(w)throw w;const A={provider_token:a,provider_refresh_token:s,access_token:i,expires_in:g,expires_at:v,refresh_token:o,token_type:d,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:A,redirectType:e.type},error:null})}catch(a){if(He(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await qi(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var a;const{data:s,error:i}=t;if(i)return this._returnResult({error:i});const o=(a=s.session)===null||a===void 0?void 0:a.access_token;if(o){const{error:c}=await this.admin.signOut(o,e);if(c&&!(vN(c)&&(c.status===404||c.status===401||c.status===403)))return this._returnResult({error:c})}return e!=="others"&&(await this._removeSession(),await Wr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=CN(),a={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:a}}}async _emitInitialSession(e){return await this._useSession(async t=>{var a,s;try{const{data:{session:i},error:o}=t;if(o)throw o;await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let a=null,s=null;this.flowType==="pkce"&&([a,s]=await il(this.storage,this.storageKey,!0));try{return await Xe(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:a,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(await Wr(this.storage,`${this.storageKey}-code-verifier`),He(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:t,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(He(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:a,error:s}=await this._useSession(async i=>{var o,c,u,d,f;const{data:g,error:v}=i;if(v)throw v;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(u=e.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await Xe(this.fetch,"GET",x,{headers:this.headers,jwt:(f=(d=g.session)===null||d===void 0?void 0:d.access_token)!==null&&f!==void 0?f:void 0})});if(s)throw s;return Xr()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(a?.url),this._returnResult({data:{provider:e.provider,url:a?.url},error:null})}catch(a){if(He(a))return this._returnResult({data:{provider:e.provider,url:null},error:a});throw a}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var a;try{const{error:s,data:{session:i}}=t;if(s)throw s;const{options:o,provider:c,token:u,access_token:d,nonce:f}=e,g=await Xe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=i?.access_token)!==null&&a!==void 0?a:void 0,body:{provider:c,id_token:u,access_token:d,nonce:f,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Os}),{data:v,error:x}=g;return x?this._returnResult({data:{user:null,session:null},error:x}):!v||!v.session||!v.user?this._returnResult({data:{user:null,session:null},error:new nl}):(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("USER_UPDATED",v.session)),this._returnResult({data:v,error:x}))}catch(s){if(await Wr(this.storage,`${this.storageKey}-code-verifier`),He(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var a,s;const{data:i,error:o}=t;if(o)throw o;return await Xe(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(He(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const a=Date.now();return await ON(async s=>(s>0&&await RN(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await Xe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Os})),(s,i)=>{const o=200*Math.pow(2,s);return i&&Jp(i)&&Date.now()+o-a<vl})}catch(a){if(this._debug(t,"error",a),He(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const a=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",a),Xr()&&!t.skipBrowserRedirect&&window.location.assign(a),{data:{provider:e,url:a},error:null}}async _recoverAndRefresh(){var e,t;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const s=await qi(this.storage,this.storageKey);if(s&&this.userStorage){let o=await qi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await xl(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o?.user)!==null&&e!==void 0?e:Zp()}else if(s&&!s.user&&!s.user){const o=await qi(this.storage,this.storageKey+"-user");o&&o?.user?(s.user=o.user,await Wr(this.storage,this.storageKey+"-user"),await xl(this.storage,this.storageKey,s)):s.user=Zp()}if(this._debug(a,"session from storage",s),!this._isValidSession(s)){this._debug(a,"session is not valid"),s!==null&&await this._removeSession();return}const i=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Kp;if(this._debug(a,`session has${i?"":" not"} expired with margin of ${Kp}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),Jp(o)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:c}=await this._getUser(s.access_token);!c&&o?.user?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(a,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(a,"error",s),console.error(s);return}finally{this._debug(a,"end")}}async _callRefreshToken(e){var t,a;if(!e)throw new Ha;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new pf;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Ha;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const c={data:i.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(i){if(this._debug(s,"error",i),He(i)){const o={data:null,error:i};return Jp(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,a=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,t)}catch(u){i.push(u)}});if(await Promise.all(o),i.length>0){for(let c=0;c<i.length;c+=1)console.error(i[c]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Wr(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),a=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&t.user&&await xl(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const i=Ty(s);await xl(this.storage,this.storageKey,i)}else{const s=Ty(t);await xl(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Wr(this.storage,this.storageKey),await Wr(this.storage,this.storageKey+"-code-verifier"),await Wr(this.storage,this.storageKey+"-user"),this.userStorage&&await Wr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Xr()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),vl);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:a}}=t;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((a.expires_at*1e3-e)/vl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${vl}ms, refresh threshold is ${Ng} ticks`),s<=Ng&&await this._callRefreshToken(a.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Gw)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Xr()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,a){const s=[`provider=${encodeURIComponent(t)}`];if(a?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a?.scopes&&s.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[i,o]=await il(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(c.toString())}if(a?.queryParams){const i=new URLSearchParams(a.queryParams);s.push(i.toString())}return a?.skipBrowserRedirect&&s.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var a;const{data:s,error:i}=t;return i?this._returnResult({data:null,error:i}):await Xe(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(a=s?.session)===null||a===void 0?void 0:a.access_token})})}catch(t){if(He(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var a,s;const{data:i,error:o}=t;if(o)return this._returnResult({data:null,error:o});const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:u,error:d}=await Xe(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(a=i?.session)===null||a===void 0?void 0:a.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&u.type==="totp"&&(!((s=u?.totp)===null||s===void 0)&&s.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),this._returnResult({data:u,error:null}))})}catch(t){if(He(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var a;const{data:s,error:i}=t;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?oR(e.webauthn.credential_response):lR(e.webauthn.credential_response)})}:{code:e.code}),{data:c,error:u}=await Xe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(a=s?.session)===null||a===void 0?void 0:a.access_token});return u?this._returnResult({data:null,error:u}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:u}))})}catch(t){if(He(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var a;const{data:s,error:i}=t;if(i)return this._returnResult({data:null,error:i});const o=await Xe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(a=s?.session)===null||a===void 0?void 0:a.access_token});if(o.error)return o;const{data:c}=o;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:nR(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:iR(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(He(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:a}=await this._challenge({factorId:e.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:a}=await this.getUser();if(a)return{data:null,error:a};const s={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=t?.factors)!==null&&e!==void 0?e:[])s.all.push(i),i.status==="verified"&&s[i.factor_type].push(i);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:a},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Qp(a.access_token);let o=null;i.aal&&(o=i.aal);let c=o;((t=(e=a.user.factors)===null||e===void 0?void 0:e.filter(f=>f.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(c="aal2");const d=i.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:a},error:s}=t;return s?this._returnResult({data:null,error:s}):a?await Xe(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:a.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Ha})})}catch(t){if(He(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async a=>{const{data:{session:s},error:i}=a;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new Ha});const o=await Xe(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&Xr()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(a){if(He(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(e,t){try{return await this._useSession(async a=>{const{data:{session:s},error:i}=a;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new Ha});const o=await Xe(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&Xr()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(a){if(He(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:a}=e;return a?this._returnResult({data:null,error:a}):t?await Xe(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Ha})})}catch(e){if(He(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:a},error:s}=t;return s?this._returnResult({data:null,error:s}):a?(await Xe(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Ha})})}catch(t){if(He(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let a=t.keys.find(c=>c.kid===e);if(a)return a;const s=Date.now();if(a=this.jwks.keys.find(c=>c.kid===e),a&&this.jwks_cached_at+gN>s)return a;const{data:i,error:o}=await Xe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,a=i.keys.find(c=>c.kid===e),!a)?null:a}async getClaims(e,t={}){try{let a=e;if(!a){const{data:x,error:y}=await this.getSession();if(y||!x.session)return this._returnResult({data:null,error:y});a=x.session.access_token}const{header:s,payload:i,signature:o,raw:{header:c,payload:u}}=Qp(a);t?.allowExpired||PN(i.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!d){const{error:x}=await this.getUser(a);if(x)throw x;return{data:{claims:i,header:s,signature:o},error:null}}const f=BN(s.alg),g=await crypto.subtle.importKey("jwk",d,f,!0,["verify"]);if(!await crypto.subtle.verify(f,g,o,SN(`${c}.${u}`)))throw new Dg("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(a){if(He(a))return this._returnResult({data:null,error:a});throw a}}}vu.nextInstanceID={};const vR=vu,xR="2.89.0";let Vc="";typeof Deno<"u"?Vc="deno":typeof document<"u"?Vc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Vc="react-native":Vc="node";const _R={"X-Client-Info":`supabase-js-${Vc}/${xR}`},yR={headers:_R},bR={schema:"public"},wR={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ER={};function xu(r){"@babel/helpers - typeof";return xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xu(r)}function AR(r,e){if(xu(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var a=t.call(r,e);if(xu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function SR(r){var e=AR(r,"string");return xu(e)=="symbol"?e:e+""}function TR(r,e,t){return(e=SR(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Fy(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);e&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,a)}return t}function hr(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Fy(Object(t),!0).forEach(function(a){TR(r,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Fy(Object(t)).forEach(function(a){Object.defineProperty(r,a,Object.getOwnPropertyDescriptor(t,a))})}return r}const CR=r=>r?(...e)=>r(...e):(...e)=>fetch(...e),kR=()=>Headers,NR=(r,e,t)=>{const a=CR(t),s=kR();return async(i,o)=>{var c;const u=(c=await e())!==null&&c!==void 0?c:r;let d=new s(o?.headers);return d.has("apikey")||d.set("apikey",r),d.has("Authorization")||d.set("Authorization",`Bearer ${u}`),a(i,hr(hr({},o),{},{headers:d}))}};function RR(r){return r.endsWith("/")?r:r+"/"}function OR(r,e){var t,a;const{db:s,auth:i,realtime:o,global:c}=r,{db:u,auth:d,realtime:f,global:g}=e,v={db:hr(hr({},u),s),auth:hr(hr({},d),i),realtime:hr(hr({},f),o),storage:{},global:hr(hr(hr({},g),c),{},{headers:hr(hr({},(t=g?.headers)!==null&&t!==void 0?t:{}),(a=c?.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return r.accessToken?v.accessToken=r.accessToken:delete v.accessToken,v}function DR(r){const e=r?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(RR(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var FR=class extends vR{constructor(r){super(r)}},MR=class{constructor(r,e,t){var a,s;this.supabaseUrl=r,this.supabaseKey=e;const i=DR(r);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,c={db:bR,realtime:ER,auth:hr(hr({},wR),{},{storageKey:o}),global:yR},u=OR(t??{},c);if(this.storageKey=(a=u.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=u.global.headers)!==null&&s!==void 0?s:{},u.accessToken)this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}});else{var d;this.auth=this._initSupabaseAuthClient((d=u.auth)!==null&&d!==void 0?d:{},this.headers,u.global.fetch)}this.fetch=NR(e,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(hr({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.accessToken&&this.accessToken().then(f=>this.realtime.setAuth(f)).catch(f=>console.warn("Failed to set initial Realtime auth token:",f)),this.rest=new fk(new URL("rest/v1",i).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new uN(this.storageUrl.href,this.headers,this.fetch,t?.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new lk(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,e={},t={head:!1,get:!1,count:void 0}){return this.rest.rpc(r,e,t)}channel(r,e={config:{}}){return this.realtime.channel(r,e)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var r=this,e,t;if(r.accessToken)return await r.accessToken();const{data:a}=await r.auth.getSession();return(e=(t=a.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:r.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:e,detectSessionInUrl:t,storage:a,userStorage:s,storageKey:i,flowType:o,lock:c,debug:u,throwOnError:d},f,g){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new FR({url:this.authUrl.href,headers:hr(hr({},v),f),storageKey:i,autoRefreshToken:r,persistSession:e,detectSessionInUrl:t,storage:a,userStorage:s,flowType:o,lock:c,debug:u,throwOnError:d,fetch:g,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(r){return new Rk(this.realtimeUrl.href,hr(hr({},r),{},{params:hr(hr({},{apikey:this.supabaseKey}),r?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,e)=>{this._handleTokenChanged(r,"CLIENT",e?.access_token)})}_handleTokenChanged(r,e,t){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==t?(this.changedAccessToken=t,this.realtime.setAuth(t)):r==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const LR=(r,e,t)=>new MR(r,e,t);function IR(){if(typeof window<"u"||typeof process>"u")return!1;const r=process.version;if(r==null)return!1;const e=r.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}IR()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const jR="https://igortawzsqlyyktnhybv.supabase.co",PR="sb_publishable_1U2HHp6TWWaFReCrV1CYgg_0dV4BbCQ",qe=LR(jR,PR),Ww=Q.createContext({user:null,session:null,profile:null,loading:!0,signOut:async()=>{}}),BR=({children:r})=>{const[e,t]=Q.useState(null),[a,s]=Q.useState(null),[i,o]=Q.useState(null),[c,u]=Q.useState(!0),d=async g=>{try{const{data:v,error:x}=await qe.from("perfiles").select("*").eq("id",g).single();!x&&v&&o(v)}catch(v){console.error("Error fetching profile:",v)}};Q.useEffect(()=>{qe.auth.getSession().then(({data:{session:v}})=>{s(v),t(v?.user??null),v?.user&&d(v.user.id),u(!1)});const{data:{subscription:g}}=qe.auth.onAuthStateChange((v,x)=>{s(x),t(x?.user??null),x?.user?d(x.user.id):o(null),u(!1)});return()=>g.unsubscribe()},[]);const f=async()=>{await qe.auth.signOut(),o(null)};return m.jsx(Ww.Provider,{value:{user:e,session:a,profile:i,loading:c,signOut:f},children:!c&&r})},Pu=()=>Q.useContext(Ww),UR=()=>{const[r,e]=Q.useState(""),[t,a]=Q.useState(""),[s,i]=Q.useState(""),[o,c]=Q.useState(!1),u=ho(),d=async f=>{f.preventDefault(),c(!0),i("");const{error:g}=await qe.auth.signInWithPassword({email:r,password:t});g?i(g.message):u("/lista"),c(!1)};return m.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",backgroundColor:"#1e1e2d"},children:m.jsxs("div",{style:{backgroundColor:"#ffffff",padding:"32px",borderRadius:"12px",width:"100%",maxWidth:"400px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:[m.jsx("h2",{style:{textAlign:"center",color:"#181c32",marginBottom:"24px"},children:"Iniciar Sesin"}),m.jsxs("form",{onSubmit:d,style:{display:"flex",flexDirection:"column",gap:"16px"},children:[m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:500},children:"Email"}),m.jsx("input",{type:"email",value:r,onChange:f=>e(f.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #e1e3ea"},required:!0})]}),m.jsxs("div",{children:[m.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:500},children:"Contrasea"}),m.jsx("input",{type:"password",value:t,onChange:f=>a(f.target.value),style:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #e1e3ea"},required:!0})]}),s&&m.jsx("div",{style:{color:"#f64e60",fontSize:"14px"},children:s}),m.jsx("button",{type:"submit",disabled:o,style:{padding:"12px",backgroundColor:"#3699ff",color:"white",border:"none",borderRadius:"6px",fontWeight:600,cursor:o?"not-allowed":"pointer"},children:o?"Cargando...":"Ingresar"})]})]})})};const zR=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),HR=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),My=r=>{const e=HR(r);return e.charAt(0).toUpperCase()+e.slice(1)},Xw=(...r)=>r.filter((e,t,a)=>!!e&&e.trim()!==""&&a.indexOf(e)===t).join(" ").trim(),$R=r=>{for(const e in r)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var GR={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const VR=Q.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:a,className:s="",children:i,iconNode:o,...c},u)=>Q.createElement("svg",{ref:u,...GR,width:e,height:e,stroke:r,strokeWidth:a?Number(t)*24/Number(e):t,className:Xw("lucide",s),...!i&&!$R(c)&&{"aria-hidden":"true"},...c},[...o.map(([d,f])=>Q.createElement(d,f)),...Array.isArray(i)?i:[i]]));const Bt=(r,e)=>{const t=Q.forwardRef(({className:a,...s},i)=>Q.createElement(VR,{ref:i,iconNode:e,className:Xw(`lucide-${zR(My(r))}`,`lucide-${r}`,a),...s}));return t.displayName=My(r),t};const qR=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Yw=Bt("arrow-left",qR);const WR=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],XR=Bt("arrow-right",WR);const YR=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],ul=Bt("arrow-up-down",YR);const KR=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],JR=Bt("calendar",KR);const QR=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ZR=Bt("chevron-down",QR);const eO=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],tO=Bt("chevron-left",eO);const rO=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],aO=Bt("chevron-up",rO);const sO=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],nO=Bt("clock",sO);const iO=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],oO=Bt("cloud-upload",iO);const lO=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],tu=Bt("download",lO);const cO=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M16 18v-6",key:"15y0np"}]],uO=Bt("file-chart-column-increasing",cO);const hO=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],dO=Bt("file-check",hO);const fO=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Fs=Bt("file-text",fO);const pO=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],gO=Bt("image",pO);const mO=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],vO=Bt("layout-dashboard",mO);const xO=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],_O=Bt("log-out",xO);const yO=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],bO=Bt("mail",yO);const wO=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Wd=Bt("plus",wO);const EO=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],xm=Bt("printer",EO);const AO=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],SO=Bt("refresh-cw",AO);const TO=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Kw=Bt("save",TO);const CO=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],kO=Bt("send",CO);const NO=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],RO=Bt("settings",NO);const OO=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],DO=Bt("square-check-big",OO);const FO=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Hl=Bt("trash-2",FO);const MO=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],LO=Bt("upload",MO);const IO=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],jO=Bt("user",IO),PO="_sidebar_t5lci_1",BO="_nav_t5lci_21",UO="_item_t5lci_29",zO="_active_t5lci_48",HO="_footer_t5lci_58",$O="_user_t5lci_69",GO="_avatar_t5lci_75",VO="_userInfo_t5lci_89",qO="_name_t5lci_94",WO="_role_t5lci_100",XO="_logoutBtn_t5lci_105",Zt={sidebar:PO,nav:BO,item:UO,active:zO,footer:HO,user:$O,avatar:GO,userInfo:VO,name:qO,role:WO,logoutBtn:XO},YO=()=>{const{signOut:r,user:e,profile:t}=Pu(),a=t?.nombre||e?.user_metadata?.nombre||e?.email||"Usuario",s=t?.rol||e?.user_metadata?.rol||"Gestor";return m.jsxs("aside",{className:Zt.sidebar,children:[m.jsxs("nav",{className:Zt.nav,children:[m.jsxs(gl,{to:"/lista",className:({isActive:i})=>i?`${Zt.item} ${Zt.active}`:Zt.item,children:[m.jsx(vO,{size:18}),m.jsx("span",{children:"Casos"})]}),m.jsxs(gl,{to:"/tareas",className:({isActive:i})=>i?`${Zt.item} ${Zt.active}`:Zt.item,children:[m.jsx(DO,{size:18}),m.jsx("span",{children:"Tareas"})]}),m.jsxs(gl,{to:"/facturacion",className:({isActive:i})=>i?`${Zt.item} ${Zt.active}`:Zt.item,children:[m.jsx(Fs,{size:18}),m.jsx("span",{children:"Facturacin"})]}),m.jsxs(gl,{to:"/reportes",className:({isActive:i})=>i?`${Zt.item} ${Zt.active}`:Zt.item,children:[m.jsx(uO,{size:18}),m.jsx("span",{children:"Reportes"})]}),m.jsxs(gl,{to:"/administracion",className:({isActive:i})=>i?`${Zt.item} ${Zt.active}`:Zt.item,children:[m.jsx(RO,{size:18}),m.jsx("span",{children:"Administracin"})]})]}),m.jsxs("div",{className:Zt.footer,children:[m.jsxs("div",{className:Zt.user,children:[m.jsx("div",{className:Zt.avatar,children:a.charAt(0).toUpperCase()}),m.jsxs("div",{className:Zt.userInfo,children:[m.jsx("span",{className:Zt.name,children:a}),m.jsx("span",{className:Zt.role,children:s})]})]}),m.jsx("button",{onClick:r,className:Zt.logoutBtn,title:"Cerrar sesin",children:m.jsx(_O,{size:16})})]})]})},KO="_container_1g7ql_1",JO="_header_1g7ql_6",QO="_headerLeft_1g7ql_21",ZO="_logo_1g7ql_28",eD="_titulo_1g7ql_41",tD="_mainContent_1g7ql_49",hl={container:KO,header:JO,headerLeft:QO,logo:ZO,titulo:eD,mainContent:tD},Rn=({children:r})=>m.jsxs("div",{className:hl.container,children:[m.jsx("header",{className:hl.header,children:m.jsx("div",{className:hl.headerLeft,children:m.jsxs("div",{className:hl.logo,children:[m.jsx("img",{src:"/logo_gibert.png",alt:"Logo"}),m.jsxs("div",{className:hl.titulo,children:["H.M. Gibert",m.jsx("br",{}),m.jsx("span",{style:{fontSize:"12px",fontWeight:400,color:"var(--muted-color)"},children:"Sistema de Gestin"})]})]})})}),m.jsx(YO,{}),m.jsx("main",{className:hl.mainContent,children:r})]}),rD="_topActions_cgtxk_1",aD="_titleSection_cgtxk_8",sD="_filterPanel_cgtxk_20",nD="_filterHeader_cgtxk_29",iD="_filters_cgtxk_36",oD="_filterGroup_cgtxk_43",lD="_input_cgtxk_56",cD="_select_cgtxk_57",uD="_newCasePanel_cgtxk_74",hD="_formGrid_cgtxk_96",dD="_tableContainer_cgtxk_103",fD="_table_cgtxk_103",pD="_badge_cgtxk_142",gD="_actionBtn_cgtxk_155",mD="_primaryBtn_cgtxk_172",vD="_secondaryBtn_cgtxk_187",Ge={topActions:rD,titleSection:aD,filterPanel:sD,filterHeader:nD,filters:iD,filterGroup:oD,input:lD,select:cD,newCasePanel:uD,formGrid:hD,tableContainer:dD,table:fD,badge:pD,actionBtn:gD,primaryBtn:mD,secondaryBtn:vD};var Jw=1252,xD=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],_m={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ym=function(r){xD.indexOf(r)!=-1&&(Jw=_m[0]=r)};function _D(){ym(1252)}var js=function(r){ym(r)};function Qw(){js(1200),_D()}function Ly(r){for(var e=[],t=0,a=r.length;t<a;++t)e[t]=r.charCodeAt(t);return e}function yD(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t)+(r.charCodeAt(2*t+1)<<8));return e.join("")}function Zw(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t+1)+(r.charCodeAt(2*t)<<8));return e.join("")}var qc=function(r){var e=r.charCodeAt(0),t=r.charCodeAt(1);return e==255&&t==254?yD(r.slice(2)):e==254&&t==255?Zw(r.slice(2)):e==65279?r.slice(1):r},_d=function(e){return String.fromCharCode(e)},Iy=function(e){return String.fromCharCode(e)},_u,gi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function jy(r){for(var e="",t=0,a=0,s=0,i=0,o=0,c=0,u=0,d=0;d<r.length;)t=r.charCodeAt(d++),i=t>>2,a=r.charCodeAt(d++),o=(t&3)<<4|a>>4,s=r.charCodeAt(d++),c=(a&15)<<2|s>>6,u=s&63,isNaN(a)?c=u=64:isNaN(s)&&(u=64),e+=gi.charAt(i)+gi.charAt(o)+gi.charAt(c)+gi.charAt(u);return e}function Ka(r){var e="",t=0,a=0,s=0,i=0,o=0,c=0,u=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<r.length;)i=gi.indexOf(r.charAt(d++)),o=gi.indexOf(r.charAt(d++)),t=i<<2|o>>4,e+=String.fromCharCode(t),c=gi.indexOf(r.charAt(d++)),a=(o&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(a)),u=gi.indexOf(r.charAt(d++)),s=(c&3)<<6|u,u!==64&&(e+=String.fromCharCode(s));return e}var vt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),fo=(function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function xi(r){return vt?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function Py(r){return vt?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var Is=function(e){return vt?fo(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function po(r){if(Array.isArray(r))return r.map(function(a){return String.fromCharCode(a)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function bm(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return bm(new Uint8Array(r));for(var e=new Array(r.length),t=0;t<r.length;++t)e[t]=r[t];return e}var di=vt?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:fo(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var a=new Uint8Array(t),s=0;for(e=0,t=0;e<r.length;t+=s,++e)if(s=r[e].length,r[e]instanceof Uint8Array)a.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";a.set(new Uint8Array(r[e]),t)}return a}return[].concat.apply([],r.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function bD(r){for(var e=[],t=0,a=r.length+250,s=xi(r.length+255),i=0;i<r.length;++i){var o=r.charCodeAt(i);if(o<128)s[t++]=o;else if(o<2048)s[t++]=192|o>>6&31,s[t++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=r.charCodeAt(++i)&1023;s[t++]=240|o>>8&7,s[t++]=128|o>>2&63,s[t++]=128|c>>6&15|(o&3)<<4,s[t++]=128|c&63}else s[t++]=224|o>>12&15,s[t++]=128|o>>6&63,s[t++]=128|o&63;t>a&&(e.push(s.slice(0,t)),t=0,s=xi(65535),a=65530)}return e.push(s.slice(0,t)),di(e)}var va=/\u0000/g,Wc=/[\u0001-\u0006]/g;function Nl(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function Ps(r,e){var t=""+r;return t.length>=e?t:dr("0",e-t.length)+t}function wm(r,e){var t=""+r;return t.length>=e?t:dr(" ",e-t.length)+t}function Xd(r,e){var t=""+r;return t.length>=e?t:t+dr(" ",e-t.length)}function wD(r,e){var t=""+Math.round(r);return t.length>=e?t:dr("0",e-t.length)+t}function ED(r,e){var t=""+r;return t.length>=e?t:dr("0",e-t.length)+t}var By=Math.pow(2,32);function dl(r,e){if(r>By||r<-By)return wD(r,e);var t=Math.round(r);return ED(t,e)}function Yd(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var Uy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],tg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function AD(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',r}var it={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},zy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SD={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Kd(r,e,t){for(var a=r<0?-1:1,s=r*a,i=0,o=1,c=0,u=1,d=0,f=0,g=Math.floor(s);d<e&&(g=Math.floor(s),c=g*o+i,f=g*d+u,!(s-g<5e-8));)s=1/(s-g),i=o,o=c,u=d,d=f;if(f>e&&(d>e?(f=u,c=i):(f=d,c=o)),!t)return[0,a*c,f];var v=Math.floor(a*c/f);return[v,a*c-v*f,f]}function Qi(r,e,t){if(r>2958465||r<0)return null;var a=r|0,s=Math.floor(86400*(r-a)),i=0,o=[],c={D:a,T:s,u:86400*(r-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(a+=1462),c.u>.9999&&(c.u=0,++s==86400&&(c.T=s=0,++a,++c.D)),a===60)o=t?[1317,10,29]:[1900,2,29],i=3;else if(a===0)o=t?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var u=new Date(1900,0,1);u.setDate(u.getDate()+a-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],i=u.getDay(),a<60&&(i=(i+6)%7),t&&(i=OD(u,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=s%60,s=Math.floor(s/60),c.M=s%60,s=Math.floor(s/60),c.H=s,c.q=i,c}var eE=new Date(1899,11,31,0,0,0),TD=eE.getTime(),CD=new Date(1900,2,1,0,0,0);function tE(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=CD&&(t+=1440*60*1e3),(t-(TD+(r.getTimezoneOffset()-eE.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Em(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function kD(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function ND(r){var e=r<0?12:11,t=Em(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function RD(r){var e=Em(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function yu(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=ND(r):e===10?t=r.toFixed(10).substr(0,12):t=RD(r),Em(kD(t.toUpperCase()))}function io(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):yu(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return _s(14,tE(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function OD(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function DD(r,e,t,a){var s="",i=0,o=0,c=t.y,u,d=0;switch(r){case 98:c=t.y+543;case 121:switch(e.length){case 1:case 2:u=c%100,d=2;break;default:u=c%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:u=t.m,d=e.length;break;case 3:return tg[t.m-1][1];case 5:return tg[t.m-1][0];default:return tg[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:u=t.d,d=e.length;break;case 3:return Uy[t.q][0];default:return Uy[t.q][1]}break;case 104:switch(e.length){case 1:case 2:u=1+(t.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:u=t.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:u=t.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Ps(t.S,e.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,i=Math.round(o*(t.S+t.u)),i>=60*o&&(i=0),e==="s"?i===0?"0":""+i/o:(s=Ps(i,2+a),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":u=t.D*24+t.H;break;case"[m]":case"[mm]":u=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":u=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:u=c,d=1;break}var f=d>0?Ps(u,d):"";return f}function mi(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,a=r.substr(0,t);t!=r.length;t+=e)a+=(a.length>0?",":"")+r.substr(t,e);return a}var rE=/%/g;function FD(r,e,t){var a=e.replace(rE,""),s=e.length-a.length;return On(r,a,t*Math.pow(10,2*s))+dr("%",s)}function MD(r,e,t){for(var a=e.length-1;e.charCodeAt(a-1)===44;)--a;return On(r,e.substr(0,a),t/Math.pow(10,3*(e.length-a)))}function aE(r,e){var t,a=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+aE(r,-e);var s=r.indexOf(".");s===-1&&(s=r.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),t=(e/Math.pow(10,i)).toPrecision(a+1+(s+i)%s),t.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+i):t+="E+"+(o-i);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,s)+"."+t.substr(2+s),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,d,f){return u+d+f.substr(0,(s+i)%s)+"."+f.substr(i)+"E"})}else t=e.toExponential(a);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var sE=/# (\?+)( ?)\/( ?)(\d+)/;function LD(r,e,t){var a=parseInt(r[4],10),s=Math.round(e*a),i=Math.floor(s/a),o=s-i*a,c=a;return t+(i===0?"":""+i)+" "+(o===0?dr(" ",r[1].length+1+r[4].length):wm(o,r[1].length)+r[2]+"/"+r[3]+Ps(c,r[4].length))}function ID(r,e,t){return t+(e===0?"":""+e)+dr(" ",r[1].length+2+r[4].length)}var nE=/^#*0*\.([0#]+)/,iE=/\).*[0#]/,oE=/\(###\) ###\\?-####/;function fa(r){for(var e="",t,a=0;a!=r.length;++a)switch(t=r.charCodeAt(a)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function Hy(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function $y(r,e){var t=r-Math.floor(r),a=Math.pow(10,e);return e<(""+Math.round(t*a)).length?0:Math.round(t*a)}function jD(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function PD(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function gs(r,e,t){if(r.charCodeAt(0)===40&&!e.match(iE)){var a=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?gs("n",a,t):"("+gs("n",a,-t)+")"}if(e.charCodeAt(e.length-1)===44)return MD(r,e,t);if(e.indexOf("%")!==-1)return FD(r,e,t);if(e.indexOf("E")!==-1)return aE(e,t);if(e.charCodeAt(0)===36)return"$"+gs(r,e.substr(e.charAt(1)==" "?2:1),t);var s,i,o,c,u=Math.abs(t),d=t<0?"-":"";if(e.match(/^00+$/))return d+dl(u,e.length);if(e.match(/^[#?]+$/))return s=dl(t,0),s==="0"&&(s=""),s.length>e.length?s:fa(e.substr(0,e.length-s.length))+s;if(i=e.match(sE))return LD(i,u,d);if(e.match(/^#+0+$/))return d+dl(u,e.length-e.indexOf("0"));if(i=e.match(nE))return s=Hy(t,i[1].length).replace(/^([^\.]+)$/,"$1."+fa(i[1])).replace(/\.$/,"."+fa(i[1])).replace(/\.(\d*)$/,function(y,_){return"."+_+dr("0",fa(i[1]).length-_.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return d+Hy(u,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return d+mi(dl(u,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+gs(r,e,-t):mi(""+(Math.floor(t)+jD(t,i[1].length)))+"."+Ps($y(t,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return gs(r,e.replace(/^#,#*,/,""),t);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Nl(gs(r,e.replace(/[\\-]/g,""),t)),o=0,Nl(Nl(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<s.length?s.charAt(o++):y==="0"?"0":""}));if(e.match(oE))return s=gs(r,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=Kd(u,Math.pow(10,o)-1,!1),s=""+d,f=On("n",i[1],c[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+i[2]+"/"+i[3],f=Xd(c[2],o),f.length<i[4].length&&(f=fa(i[4].substr(i[4].length-f.length))+f),s+=f,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=Kd(u,Math.pow(10,o)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?wm(c[1],o)+i[2]+"/"+i[3]+Xd(c[2],o):dr(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=dl(t,0),e.length<=s.length?s:fa(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var g=e.indexOf(".")-o,v=e.length-s.length-g;return fa(e.substr(0,g)+s+e.substr(e.length-v))}if(i=e.match(/^00,000\.([#0]*0)$/))return o=$y(t,i[1].length),t<0?"-"+gs(r,e,-t):mi(PD(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Ps(0,3-y.length):"")+y})+"."+Ps(o,i[1].length);switch(e){case"###,##0.00":return gs(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var x=mi(dl(u,0));return x!=="0"?d+x:"";case"###,###.00":return gs(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return gs(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function BD(r,e,t){for(var a=e.length-1;e.charCodeAt(a-1)===44;)--a;return On(r,e.substr(0,a),t/Math.pow(10,3*(e.length-a)))}function UD(r,e,t){var a=e.replace(rE,""),s=e.length-a.length;return On(r,a,t*Math.pow(10,2*s))+dr("%",s)}function lE(r,e){var t,a=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+lE(r,-e);var s=r.indexOf(".");s===-1&&(s=r.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),t=(e/Math.pow(10,i)).toPrecision(a+1+(s+i)%s),!t.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+i):t+="E+"+(o-i),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,d,f){return u+d+f.substr(0,(s+i)%s)+"."+f.substr(i)+"E"})}else t=e.toExponential(a);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Qs(r,e,t){if(r.charCodeAt(0)===40&&!e.match(iE)){var a=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Qs("n",a,t):"("+Qs("n",a,-t)+")"}if(e.charCodeAt(e.length-1)===44)return BD(r,e,t);if(e.indexOf("%")!==-1)return UD(r,e,t);if(e.indexOf("E")!==-1)return lE(e,t);if(e.charCodeAt(0)===36)return"$"+Qs(r,e.substr(e.charAt(1)==" "?2:1),t);var s,i,o,c,u=Math.abs(t),d=t<0?"-":"";if(e.match(/^00+$/))return d+Ps(u,e.length);if(e.match(/^[#?]+$/))return s=""+t,t===0&&(s=""),s.length>e.length?s:fa(e.substr(0,e.length-s.length))+s;if(i=e.match(sE))return ID(i,u,d);if(e.match(/^#+0+$/))return d+Ps(u,e.length-e.indexOf("0"));if(i=e.match(nE))return s=(""+t).replace(/^([^\.]+)$/,"$1."+fa(i[1])).replace(/\.$/,"."+fa(i[1])),s=s.replace(/\.(\d*)$/,function(y,_){return"."+_+dr("0",fa(i[1]).length-_.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return d+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return d+mi(""+u);if(i=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Qs(r,e,-t):mi(""+t)+"."+dr("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Qs(r,e.replace(/^#,#*,/,""),t);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Nl(Qs(r,e.replace(/[\\-]/g,""),t)),o=0,Nl(Nl(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<s.length?s.charAt(o++):y==="0"?"0":""}));if(e.match(oE))return s=Qs(r,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=Kd(u,Math.pow(10,o)-1,!1),s=""+d,f=On("n",i[1],c[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+i[2]+"/"+i[3],f=Xd(c[2],o),f.length<i[4].length&&(f=fa(i[4].substr(i[4].length-f.length))+f),s+=f,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=Kd(u,Math.pow(10,o)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?wm(c[1],o)+i[2]+"/"+i[3]+Xd(c[2],o):dr(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+t,e.length<=s.length?s:fa(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var g=e.indexOf(".")-o,v=e.length-s.length-g;return fa(e.substr(0,g)+s+e.substr(e.length-v))}if(i=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Qs(r,e,-t):mi(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Ps(0,3-y.length):"")+y})+"."+Ps(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var x=mi(""+u);return x!=="0"?d+x:"";default:if(e.match(/\.[0#?]*$/))return Qs(r,e.slice(0,e.lastIndexOf(".")),t)+fa(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function On(r,e,t){return(t|0)===t?Qs(r,e,t):gs(r,e,t)}function zD(r){for(var e=[],t=!1,a=0,s=0;a<r.length;++a)switch(r.charCodeAt(a)){case 34:t=!t;break;case 95:case 42:case 92:++a;break;case 59:e[e.length]=r.substr(s,a-s),s=a+1}if(e[e.length]=r.substr(s),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var cE=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function $l(r){for(var e=0,t="",a="";e<r.length;)switch(t=r.charAt(e)){case"G":Yd(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(a=t;r.charAt(e++)!=="]"&&e<r.length;)a+=r.charAt(e);if(a.match(cE))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function HD(r,e,t,a){for(var s=[],i="",o=0,c="",u="t",d,f,g,v="H";o<r.length;)switch(c=r.charAt(o)){case"G":if(!Yd(r,o))throw new Error("unrecognized character "+c+" in "+r);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(g=r.charCodeAt(++o))!==34&&o<r.length;)i+=String.fromCharCode(g);s[s.length]={t:"t",v:i},++o;break;case"\\":var x=r.charAt(++o),y=x==="("||x===")"?x:"t";s[s.length]={t:y,v:x},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:e},++o;break;case"B":case"b":if(r.charAt(o+1)==="1"||r.charAt(o+1)==="2"){if(d==null&&(d=Qi(e,t,r.charAt(o+1)==="2"),d==null))return"";s[s.length]={t:"X",v:r.substr(o,2)},u=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=Qi(e,t),d==null))return"";for(i=c;++o<r.length&&r.charAt(o).toLowerCase()===c;)i+=c;c==="m"&&u.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=v),s[s.length]={t:c,v:i},u=c;break;case"A":case"a":case"":var _={t:c,v:c};if(d==null&&(d=Qi(e,t)),r.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(_.v=d.H>=12?"P":"A"),_.t="T",v="h",o+=3):r.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(_.v=d.H>=12?"PM":"AM"),_.t="T",o+=5,v="h"):r.substr(o,5).toUpperCase()==="/"?(d!=null&&(_.v=d.H>=12?"":""),_.t="T",o+=5,v="h"):(_.t="t",++o),d==null&&_.t==="T")return"";s[s.length]=_,u=c;break;case"[":for(i=c;r.charAt(o++)!=="]"&&o<r.length;)i+=r.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(cE)){if(d==null&&(d=Qi(e,t),d==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},u=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",$l(r)||(s[s.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=c;++o<r.length&&(c=r.charAt(o))==="0";)i+=c;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++o<r.length&&"0#?.,E+-%".indexOf(c=r.charAt(o))>-1;)i+=c;s[s.length]={t:"n",v:i};break;case"?":for(i=c;r.charAt(++o)===c;)i+=c;s[s.length]={t:c,v:i},u=c;break;case"*":++o,(r.charAt(o)==" "||r.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:a===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;o<r.length&&"0123456789".indexOf(r.charAt(++o))>-1;)i+=r.charAt(o);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:c,v:c},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+r);s[s.length]={t:"t",v:c},++o;break}var w=0,A=0,T;for(o=s.length-1,u="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=v,u="h",w<1&&(w=1);break;case"s":(T=s[o].v.match(/\.0+$/))&&(A=Math.max(A,T[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":u=s[o].t;break;case"m":u==="s"&&(s[o].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[o].v.match(/[Hh]/)&&(w=1),w<2&&s[o].v.match(/[Mm]/)&&(w=2),w<3&&s[o].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var S="",N;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=DD(s[o].t.charCodeAt(0),s[o].v,d,A),s[o].t="t";break;case"n":case"?":for(N=o+1;s[N]!=null&&((c=s[N].t)==="?"||c==="D"||(c===" "||c==="t")&&s[N+1]!=null&&(s[N+1].t==="?"||s[N+1].t==="t"&&s[N+1].v==="/")||s[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(s[N].v==="/"||s[N].v===" "&&s[N+1]!=null&&s[N+1].t=="?"));)s[o].v+=s[N].v,s[N]={v:"",t:";"},++N;S+=s[o].v,o=N-1;break;case"G":s[o].t="t",s[o].v=io(e,t);break}var R="",O,C;if(S.length>0){S.charCodeAt(0)==40?(O=e<0&&S.charCodeAt(0)===45?-e:e,C=On("n",S,O)):(O=e<0&&a>1?-e:e,C=On("n",S,O),O<0&&s[0]&&s[0].t=="t"&&(C=C.substr(1),s[0].v="-"+s[0].v)),N=C.length-1;var j=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){j=o;break}var I=s.length;if(j===s.length&&C.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(N>=s[o].v.length-1?(N-=s[o].v.length,s[o].v=C.substr(N+1,s[o].v.length)):N<0?s[o].v="":(s[o].v=C.substr(0,N+1),N=-1),s[o].t="t",I=o);N>=0&&I<s.length&&(s[I].v=C.substr(0,N+1)+s[I].v)}else if(j!==s.length&&C.indexOf("E")===-1){for(N=C.indexOf(".")-1,o=j;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(f=s[o].v.indexOf(".")>-1&&o===j?s[o].v.indexOf(".")-1:s[o].v.length-1,R=s[o].v.substr(f+1);f>=0;--f)N>=0&&(s[o].v.charAt(f)==="0"||s[o].v.charAt(f)==="#")&&(R=C.charAt(N--)+R);s[o].v=R,s[o].t="t",I=o}for(N>=0&&I<s.length&&(s[I].v=C.substr(0,N+1)+s[I].v),N=C.indexOf(".")+1,o=j;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==j)){for(f=s[o].v.indexOf(".")>-1&&o===j?s[o].v.indexOf(".")+1:0,R=s[o].v.substr(0,f);f<s[o].v.length;++f)N<C.length&&(R+=C.charAt(N++));s[o].v=R,s[o].t="t",I=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(O=a>1&&e<0&&o>0&&s[o-1].v==="-"?-e:e,s[o].v=On(s[o].t,s[o].v,O),s[o].t="t");var W="";for(o=0;o!==s.length;++o)s[o]!=null&&(W+=s[o].v);return W}var Gy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Vy(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function $D(r,e){var t=zD(r),a=t.length,s=t[a-1].indexOf("@");if(a<4&&s>-1&&--a,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||s>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=s>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=s>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=s>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var i=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[a,i];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var o=t[0].match(Gy),c=t[1].match(Gy);return Vy(e,o)?[a,t[0]]:Vy(e,c)?[a,t[1]]:[a,t[o!=null&&c!=null?2:1]]}return[a,i]}function _s(r,e,t){t==null&&(t={});var a="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?a=t.dateNF:a=r;break;case"number":r==14&&t.dateNF?a=t.dateNF:a=(t.table!=null?t.table:it)[r],a==null&&(a=t.table&&t.table[zy[r]]||it[zy[r]]),a==null&&(a=SD[r]||"General");break}if(Yd(a,0))return io(e,t);e instanceof Date&&(e=tE(e,t.date1904));var s=$D(a,e);if(Yd(s[1]))return io(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return HD(s[1],e,t,s[0])}function ao(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(it[t]==null){e<0&&(e=t);continue}if(it[t]==r){e=t;break}}e<0&&(e=391)}return it[e]=r,e}function uE(){it=AD()}var GD={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},hE=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function VD(r){var e=typeof r=="number"?it[r]:r;return e=e.replace(hE,"(\\d+)"),new RegExp("^"+e+"$")}function qD(r,e,t){var a=-1,s=-1,i=-1,o=-1,c=-1,u=-1;(e.match(hE)||[]).forEach(function(g,v){var x=parseInt(t[v+1],10);switch(g.toLowerCase().charAt(0)){case"y":a=x;break;case"d":i=x;break;case"h":o=x;break;case"s":u=x;break;case"m":o>=0?c=x:s=x;break}}),u>=0&&c==-1&&s>=0&&(c=s,s=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var f=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&c==-1&&u==-1?d:a==-1&&s==-1&&i==-1?f:d+"T"+f}var WD=(function(){var r={};r.version="1.2.0";function e(){for(var C=0,j=new Array(256),I=0;I!=256;++I)C=I,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,j[I]=C;return typeof Int32Array<"u"?new Int32Array(j):j}var t=e();function a(C){var j=0,I=0,W=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)H[W]=C[W];for(W=0;W!=256;++W)for(I=C[W],j=256+W;j<4096;j+=256)I=H[j]=I>>>8^C[I&255];var D=[];for(W=1;W!=16;++W)D[W-1]=typeof Int32Array<"u"?H.subarray(W*256,W*256+256):H.slice(W*256,W*256+256);return D}var s=a(t),i=s[0],o=s[1],c=s[2],u=s[3],d=s[4],f=s[5],g=s[6],v=s[7],x=s[8],y=s[9],_=s[10],w=s[11],A=s[12],T=s[13],S=s[14];function N(C,j){for(var I=j^-1,W=0,H=C.length;W<H;)I=I>>>8^t[(I^C.charCodeAt(W++))&255];return~I}function R(C,j){for(var I=j^-1,W=C.length-15,H=0;H<W;)I=S[C[H++]^I&255]^T[C[H++]^I>>8&255]^A[C[H++]^I>>16&255]^w[C[H++]^I>>>24]^_[C[H++]]^y[C[H++]]^x[C[H++]]^v[C[H++]]^g[C[H++]]^f[C[H++]]^d[C[H++]]^u[C[H++]]^c[C[H++]]^o[C[H++]]^i[C[H++]]^t[C[H++]];for(W+=15;H<W;)I=I>>>8^t[(I^C[H++])&255];return~I}function O(C,j){for(var I=j^-1,W=0,H=C.length,D=0,z=0;W<H;)D=C.charCodeAt(W++),D<128?I=I>>>8^t[(I^D)&255]:D<2048?(I=I>>>8^t[(I^(192|D>>6&31))&255],I=I>>>8^t[(I^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,z=C.charCodeAt(W++)&1023,I=I>>>8^t[(I^(240|D>>8&7))&255],I=I>>>8^t[(I^(128|D>>2&63))&255],I=I>>>8^t[(I^(128|z>>6&15|(D&3)<<4))&255],I=I>>>8^t[(I^(128|z&63))&255]):(I=I>>>8^t[(I^(224|D>>12&15))&255],I=I>>>8^t[(I^(128|D>>6&63))&255],I=I>>>8^t[(I^(128|D&63))&255]);return~I}return r.table=t,r.bstr=N,r.buf=R,r.str=O,r})(),xt=(function(){var e={};e.version="1.2.1";function t(M,V){for(var P=M.split("/"),B=V.split("/"),G=0,X=0,ue=Math.min(P.length,B.length);G<ue;++G){if(X=P[G].length-B[G].length)return X;if(P[G]!=B[G])return P[G]<B[G]?-1:1}return P.length-B.length}function a(M){if(M.charAt(M.length-1)=="/")return M.slice(0,-1).indexOf("/")===-1?M:a(M.slice(0,-1));var V=M.lastIndexOf("/");return V===-1?M:M.slice(0,V+1)}function s(M){if(M.charAt(M.length-1)=="/")return s(M.slice(0,-1));var V=M.lastIndexOf("/");return V===-1?M:M.slice(V+1)}function i(M,V){typeof V=="string"&&(V=new Date(V));var P=V.getHours();P=P<<6|V.getMinutes(),P=P<<5|V.getSeconds()>>>1,M.write_shift(2,P);var B=V.getFullYear()-1980;B=B<<4|V.getMonth()+1,B=B<<5|V.getDate(),M.write_shift(2,B)}function o(M){var V=M.read_shift(2)&65535,P=M.read_shift(2)&65535,B=new Date,G=P&31;P>>>=5;var X=P&15;P>>>=4,B.setMilliseconds(0),B.setFullYear(P+1980),B.setMonth(X-1),B.setDate(G);var ue=V&31;V>>>=5;var _e=V&63;return V>>>=6,B.setHours(V),B.setMinutes(_e),B.setSeconds(ue<<1),B}function c(M){Jr(M,0);for(var V={},P=0;M.l<=M.length-4;){var B=M.read_shift(2),G=M.read_shift(2),X=M.l+G,ue={};B===21589&&(P=M.read_shift(1),P&1&&(ue.mtime=M.read_shift(4)),G>5&&(P&2&&(ue.atime=M.read_shift(4)),P&4&&(ue.ctime=M.read_shift(4))),ue.mtime&&(ue.mt=new Date(ue.mtime*1e3))),M.l=X,V[B]=ue}return V}var u;function d(){return u||(u={})}function f(M,V){if(M[0]==80&&M[1]==75)return Si(M,V);if((M[0]|32)==109&&(M[1]|32)==105)return Ci(M,V);if(M.length<512)throw new Error("CFB file size "+M.length+" < 512");var P=3,B=512,G=0,X=0,ue=0,_e=0,he=0,de=[],pe=M.slice(0,512);Jr(pe,0);var Se=g(pe);switch(P=Se[0],P){case 3:B=512;break;case 4:B=4096;break;case 0:if(Se[1]==0)return Si(M,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+P)}B!==512&&(pe=M.slice(0,B),Jr(pe,28));var Re=M.slice(0,B);v(pe,P);var Fe=pe.read_shift(4,"i");if(P===3&&Fe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Fe);pe.l+=4,ue=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),_e=pe.read_shift(4,"i"),G=pe.read_shift(4,"i"),he=pe.read_shift(4,"i"),X=pe.read_shift(4,"i");for(var Ce=-1,Oe=0;Oe<109&&(Ce=pe.read_shift(4,"i"),!(Ce<0));++Oe)de[Oe]=Ce;var Pe=x(M,B);w(he,X,Pe,B,de);var Ut=T(Pe,ue,de,B);Ut[ue].name="!Directory",G>0&&_e!==z&&(Ut[_e].name="!MiniFAT"),Ut[de[0]].name="!FAT",Ut.fat_addrs=de,Ut.ssz=B;var zt={},Kt=[],es=[],ki=[];S(ue,Ut,Pe,Kt,G,zt,es,_e),y(es,ki,Kt),Kt.shift();var Pn={FileIndex:es,FullPaths:ki};return V&&V.raw&&(Pn.raw={header:Re,sectors:Pe}),Pn}function g(M){if(M[M.l]==80&&M[M.l+1]==75)return[0,0];M.chk(ne,"Header Signature: "),M.l+=16;var V=M.read_shift(2,"u");return[M.read_shift(2,"u"),V]}function v(M,V){var P=9;switch(M.l+=2,P=M.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+P);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+P);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+P)}M.chk("0600","Mini Sector Shift: "),M.chk("000000000000","Reserved: ")}function x(M,V){for(var P=Math.ceil(M.length/V)-1,B=[],G=1;G<P;++G)B[G-1]=M.slice(G*V,(G+1)*V);return B[P-1]=M.slice(P*V),B}function y(M,V,P){for(var B=0,G=0,X=0,ue=0,_e=0,he=P.length,de=[],pe=[];B<he;++B)de[B]=pe[B]=B,V[B]=P[B];for(;_e<pe.length;++_e)B=pe[_e],G=M[B].L,X=M[B].R,ue=M[B].C,de[B]===B&&(G!==-1&&de[G]!==G&&(de[B]=de[G]),X!==-1&&de[X]!==X&&(de[B]=de[X])),ue!==-1&&(de[ue]=B),G!==-1&&B!=de[B]&&(de[G]=de[B],pe.lastIndexOf(G)<_e&&pe.push(G)),X!==-1&&B!=de[B]&&(de[X]=de[B],pe.lastIndexOf(X)<_e&&pe.push(X));for(B=1;B<he;++B)de[B]===B&&(X!==-1&&de[X]!==X?de[B]=de[X]:G!==-1&&de[G]!==G&&(de[B]=de[G]));for(B=1;B<he;++B)if(M[B].type!==0){if(_e=B,_e!=de[_e])do _e=de[_e],V[B]=V[_e]+"/"+V[B];while(_e!==0&&de[_e]!==-1&&_e!=de[_e]);de[B]=-1}for(V[0]+="/",B=1;B<he;++B)M[B].type!==2&&(V[B]+="/")}function _(M,V,P){for(var B=M.start,G=M.size,X=[],ue=B;P&&G>0&&ue>=0;)X.push(V.slice(ue*D,ue*D+D)),G-=D,ue=Ki(P,ue*4);return X.length===0?Mr(0):di(X).slice(0,M.size)}function w(M,V,P,B,G){var X=z;if(M===z){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(M!==-1){var ue=P[M],_e=(B>>>2)-1;if(!ue)return;for(var he=0;he<_e&&(X=Ki(ue,he*4))!==z;++he)G.push(X);w(Ki(ue,B-4),V-1,P,B,G)}}function A(M,V,P,B,G){var X=[],ue=[];G||(G=[]);var _e=B-1,he=0,de=0;for(he=V;he>=0;){G[he]=!0,X[X.length]=he,ue.push(M[he]);var pe=P[Math.floor(he*4/B)];if(de=he*4&_e,B<4+de)throw new Error("FAT boundary crossed: "+he+" 4 "+B);if(!M[pe])break;he=Ki(M[pe],de)}return{nodes:X,data:tb([ue])}}function T(M,V,P,B){var G=M.length,X=[],ue=[],_e=[],he=[],de=B-1,pe=0,Se=0,Re=0,Fe=0;for(pe=0;pe<G;++pe)if(_e=[],Re=pe+V,Re>=G&&(Re-=G),!ue[Re]){he=[];var Ce=[];for(Se=Re;Se>=0;){Ce[Se]=!0,ue[Se]=!0,_e[_e.length]=Se,he.push(M[Se]);var Oe=P[Math.floor(Se*4/B)];if(Fe=Se*4&de,B<4+Fe)throw new Error("FAT boundary crossed: "+Se+" 4 "+B);if(!M[Oe]||(Se=Ki(M[Oe],Fe),Ce[Se]))break}X[Re]={nodes:_e,data:tb([he])}}return X}function S(M,V,P,B,G,X,ue,_e){for(var he=0,de=B.length?2:0,pe=V[M].data,Se=0,Re=0,Fe;Se<pe.length;Se+=128){var Ce=pe.slice(Se,Se+128);Jr(Ce,64),Re=Ce.read_shift(2),Fe=km(Ce,0,Re-de),B.push(Fe);var Oe={name:Fe,type:Ce.read_shift(1),color:Ce.read_shift(1),L:Ce.read_shift(4,"i"),R:Ce.read_shift(4,"i"),C:Ce.read_shift(4,"i"),clsid:Ce.read_shift(16),state:Ce.read_shift(4,"i"),start:0,size:0},Pe=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);Pe!==0&&(Oe.ct=N(Ce,Ce.l-8));var Ut=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);Ut!==0&&(Oe.mt=N(Ce,Ce.l-8)),Oe.start=Ce.read_shift(4,"i"),Oe.size=Ce.read_shift(4,"i"),Oe.size<0&&Oe.start<0&&(Oe.size=Oe.type=0,Oe.start=z,Oe.name=""),Oe.type===5?(he=Oe.start,G>0&&he!==z&&(V[he].name="!StreamData")):Oe.size>=4096?(Oe.storage="fat",V[Oe.start]===void 0&&(V[Oe.start]=A(P,Oe.start,V.fat_addrs,V.ssz)),V[Oe.start].name=Oe.name,Oe.content=V[Oe.start].data.slice(0,Oe.size)):(Oe.storage="minifat",Oe.size<0?Oe.size=0:he!==z&&Oe.start!==z&&V[he]&&(Oe.content=_(Oe,V[he].data,(V[_e]||{}).data))),Oe.content&&Jr(Oe.content,0),X[Fe]=Oe,ue.push(Oe)}}function N(M,V){return new Date((qa(M,V+4)/1e7*Math.pow(2,32)+qa(M,V)/1e7-11644473600)*1e3)}function R(M,V){return d(),f(u.readFileSync(M),V)}function O(M,V){var P=V&&V.type;switch(P||vt&&Buffer.isBuffer(M)&&(P="buffer"),P||"base64"){case"file":return R(M,V);case"base64":return f(Is(Ka(M)),V);case"binary":return f(Is(M),V)}return f(M,V)}function C(M,V){var P=V||{},B=P.root||"Root Entry";if(M.FullPaths||(M.FullPaths=[]),M.FileIndex||(M.FileIndex=[]),M.FullPaths.length!==M.FileIndex.length)throw new Error("inconsistent CFB structure");M.FullPaths.length===0&&(M.FullPaths[0]=B+"/",M.FileIndex[0]={name:B,type:5}),P.CLSID&&(M.FileIndex[0].clsid=P.CLSID),j(M)}function j(M){var V="Sh33tJ5";if(!xt.find(M,"/"+V)){var P=Mr(4);P[0]=55,P[1]=P[3]=50,P[2]=54,M.FileIndex.push({name:V,type:2,content:P,size:4,L:69,R:69,C:69}),M.FullPaths.push(M.FullPaths[0]+V),I(M)}}function I(M,V){C(M);for(var P=!1,B=!1,G=M.FullPaths.length-1;G>=0;--G){var X=M.FileIndex[G];switch(X.type){case 0:B?P=!0:(M.FileIndex.pop(),M.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(X.R*X.L*X.C)&&(P=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(P=!0);break;default:P=!0;break}}if(!(!P&&!V)){var ue=new Date(1987,1,19),_e=0,he=Object.create?Object.create(null):{},de=[];for(G=0;G<M.FullPaths.length;++G)he[M.FullPaths[G]]=!0,M.FileIndex[G].type!==0&&de.push([M.FullPaths[G],M.FileIndex[G]]);for(G=0;G<de.length;++G){var pe=a(de[G][0]);B=he[pe],B||(de.push([pe,{name:s(pe).replace("/",""),type:1,clsid:U,ct:ue,mt:ue,content:null}]),he[pe]=!0)}for(de.sort(function(Fe,Ce){return t(Fe[0],Ce[0])}),M.FullPaths=[],M.FileIndex=[],G=0;G<de.length;++G)M.FullPaths[G]=de[G][0],M.FileIndex[G]=de[G][1];for(G=0;G<de.length;++G){var Se=M.FileIndex[G],Re=M.FullPaths[G];if(Se.name=s(Re).replace("/",""),Se.L=Se.R=Se.C=-(Se.color=1),Se.size=Se.content?Se.content.length:0,Se.start=0,Se.clsid=Se.clsid||U,G===0)Se.C=de.length>1?1:-1,Se.size=0,Se.type=5;else if(Re.slice(-1)=="/"){for(_e=G+1;_e<de.length&&a(M.FullPaths[_e])!=Re;++_e);for(Se.C=_e>=de.length?-1:_e,_e=G+1;_e<de.length&&a(M.FullPaths[_e])!=a(Re);++_e);Se.R=_e>=de.length?-1:_e,Se.type=1}else a(M.FullPaths[G+1]||"")==a(Re)&&(Se.R=G+1),Se.type=2}}}function W(M,V){var P=V||{};if(P.fileType=="mad")return kf(M,P);if(I(M),P.fileType==="zip")return wo(M,P);var B=(function(Fe){for(var Ce=0,Oe=0,Pe=0;Pe<Fe.FileIndex.length;++Pe){var Ut=Fe.FileIndex[Pe];if(Ut.content){var zt=Ut.content.length;zt>0&&(zt<4096?Ce+=zt+63>>6:Oe+=zt+511>>9)}}for(var Kt=Fe.FullPaths.length+3>>2,es=Ce+7>>3,ki=Ce+127>>7,Pn=es+Oe+Kt+ki,Hs=Pn+127>>7,Yl=Hs<=109?0:Math.ceil((Hs-109)/127);Pn+Hs+Yl+127>>7>Hs;)Yl=++Hs<=109?0:Math.ceil((Hs-109)/127);var ba=[1,Yl,Hs,ki,Kt,Oe,Ce,0];return Fe.FileIndex[0].size=Ce<<6,ba[7]=(Fe.FileIndex[0].start=ba[0]+ba[1]+ba[2]+ba[3]+ba[4]+ba[5])+(ba[6]+7>>3),ba})(M),G=Mr(B[7]<<9),X=0,ue=0;{for(X=0;X<8;++X)G.write_shift(1,re[X]);for(X=0;X<8;++X)G.write_shift(2,0);for(G.write_shift(2,62),G.write_shift(2,3),G.write_shift(2,65534),G.write_shift(2,9),G.write_shift(2,6),X=0;X<3;++X)G.write_shift(2,0);for(G.write_shift(4,0),G.write_shift(4,B[2]),G.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),G.write_shift(4,0),G.write_shift(4,4096),G.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:z),G.write_shift(4,B[3]),G.write_shift(-4,B[1]?B[0]-1:z),G.write_shift(4,B[1]),X=0;X<109;++X)G.write_shift(-4,X<B[2]?B[1]+X:-1)}if(B[1])for(ue=0;ue<B[1];++ue){for(;X<236+ue*127;++X)G.write_shift(-4,X<B[2]?B[1]+X:-1);G.write_shift(-4,ue===B[1]-1?z:ue+1)}var _e=function(Fe){for(ue+=Fe;X<ue-1;++X)G.write_shift(-4,X+1);Fe&&(++X,G.write_shift(-4,z))};for(ue=X=0,ue+=B[1];X<ue;++X)G.write_shift(-4,te.DIFSECT);for(ue+=B[2];X<ue;++X)G.write_shift(-4,te.FATSECT);_e(B[3]),_e(B[4]);for(var he=0,de=0,pe=M.FileIndex[0];he<M.FileIndex.length;++he)pe=M.FileIndex[he],pe.content&&(de=pe.content.length,!(de<4096)&&(pe.start=ue,_e(de+511>>9)));for(_e(B[6]+7>>3);G.l&511;)G.write_shift(-4,te.ENDOFCHAIN);for(ue=X=0,he=0;he<M.FileIndex.length;++he)pe=M.FileIndex[he],pe.content&&(de=pe.content.length,!(!de||de>=4096)&&(pe.start=ue,_e(de+63>>6)));for(;G.l&511;)G.write_shift(-4,te.ENDOFCHAIN);for(X=0;X<B[4]<<2;++X){var Se=M.FullPaths[X];if(!Se||Se.length===0){for(he=0;he<17;++he)G.write_shift(4,0);for(he=0;he<3;++he)G.write_shift(4,-1);for(he=0;he<12;++he)G.write_shift(4,0);continue}pe=M.FileIndex[X],X===0&&(pe.start=pe.size?pe.start-1:z);var Re=X===0&&P.root||pe.name;if(de=2*(Re.length+1),G.write_shift(64,Re,"utf16le"),G.write_shift(2,de),G.write_shift(1,pe.type),G.write_shift(1,pe.color),G.write_shift(-4,pe.L),G.write_shift(-4,pe.R),G.write_shift(-4,pe.C),pe.clsid)G.write_shift(16,pe.clsid,"hex");else for(he=0;he<4;++he)G.write_shift(4,0);G.write_shift(4,pe.state||0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,pe.start),G.write_shift(4,pe.size),G.write_shift(4,0)}for(X=1;X<M.FileIndex.length;++X)if(pe=M.FileIndex[X],pe.size>=4096)if(G.l=pe.start+1<<9,vt&&Buffer.isBuffer(pe.content))pe.content.copy(G,G.l,0,pe.size),G.l+=pe.size+511&-512;else{for(he=0;he<pe.size;++he)G.write_shift(1,pe.content[he]);for(;he&511;++he)G.write_shift(1,0)}for(X=1;X<M.FileIndex.length;++X)if(pe=M.FileIndex[X],pe.size>0&&pe.size<4096)if(vt&&Buffer.isBuffer(pe.content))pe.content.copy(G,G.l,0,pe.size),G.l+=pe.size+63&-64;else{for(he=0;he<pe.size;++he)G.write_shift(1,pe.content[he]);for(;he&63;++he)G.write_shift(1,0)}if(vt)G.l=G.length;else for(;G.l<G.length;)G.write_shift(1,0);return G}function H(M,V){var P=M.FullPaths.map(function(he){return he.toUpperCase()}),B=P.map(function(he){var de=he.split("/");return de[de.length-(he.slice(-1)=="/"?2:1)]}),G=!1;V.charCodeAt(0)===47?(G=!0,V=P[0].slice(0,-1)+V):G=V.indexOf("/")!==-1;var X=V.toUpperCase(),ue=G===!0?P.indexOf(X):B.indexOf(X);if(ue!==-1)return M.FileIndex[ue];var _e=!X.match(Wc);for(X=X.replace(va,""),_e&&(X=X.replace(Wc,"!")),ue=0;ue<P.length;++ue)if((_e?P[ue].replace(Wc,"!"):P[ue]).replace(va,"")==X||(_e?B[ue].replace(Wc,"!"):B[ue]).replace(va,"")==X)return M.FileIndex[ue];return null}var D=64,z=-2,ne="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],U="00000000000000000000000000000000",te={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:z,FREESECT:-1,HEADER_SIGNATURE:ne,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:U,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function be(M,V,P){d();var B=W(M,P);u.writeFileSync(V,B)}function se(M){for(var V=new Array(M.length),P=0;P<M.length;++P)V[P]=String.fromCharCode(M[P]);return V.join("")}function ke(M,V){var P=W(M,V);switch(V&&V.type||"buffer"){case"file":return d(),u.writeFileSync(V.filename,P),P;case"binary":return typeof P=="string"?P:se(P);case"base64":return jy(typeof P=="string"?P:se(P));case"buffer":if(vt)return Buffer.isBuffer(P)?P:fo(P);case"array":return typeof P=="string"?Is(P):P}return P}var q;function F(M){try{var V=M.InflateRaw,P=new V;if(P._processChunk(new Uint8Array([3,0]),P._finishFlushFlag),P.bytesRead)q=M;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function J(M,V){if(!q)return Qu(M,V);var P=q.InflateRaw,B=new P,G=B._processChunk(M.slice(M.l),B._finishFlushFlag);return M.l+=B.bytesRead,G}function K(M){return q?q.deflateRawSync(M):lt(M)}var Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ve=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ne(M){var V=(M<<1|M<<11)&139536|(M<<5|M<<15)&558144;return(V>>16|V>>8|V)&255}for(var Ee=typeof Uint8Array<"u",Ae=Ee?new Uint8Array(256):[],rt=0;rt<256;++rt)Ae[rt]=Ne(rt);function Z(M,V){var P=Ae[M&255];return V<=8?P>>>8-V:(P=P<<8|Ae[M>>8&255],V<=16?P>>>16-V:(P=P<<8|Ae[M>>16&255],P>>>24-V))}function Mt(M,V){var P=V&7,B=V>>>3;return(M[B]|(P<=6?0:M[B+1]<<8))>>>P&3}function at(M,V){var P=V&7,B=V>>>3;return(M[B]|(P<=5?0:M[B+1]<<8))>>>P&7}function At(M,V){var P=V&7,B=V>>>3;return(M[B]|(P<=4?0:M[B+1]<<8))>>>P&15}function ot(M,V){var P=V&7,B=V>>>3;return(M[B]|(P<=3?0:M[B+1]<<8))>>>P&31}function De(M,V){var P=V&7,B=V>>>3;return(M[B]|(P<=1?0:M[B+1]<<8))>>>P&127}function Yt(M,V,P){var B=V&7,G=V>>>3,X=(1<<P)-1,ue=M[G]>>>B;return P<8-B||(ue|=M[G+1]<<8-B,P<16-B)||(ue|=M[G+2]<<16-B,P<24-B)||(ue|=M[G+3]<<24-B),ue&X}function ea(M,V,P){var B=V&7,G=V>>>3;return B<=5?M[G]|=(P&7)<<B:(M[G]|=P<<B&255,M[G+1]=(P&7)>>8-B),V+3}function _a(M,V,P){var B=V&7,G=V>>>3;return P=(P&1)<<B,M[G]|=P,V+1}function Fa(M,V,P){var B=V&7,G=V>>>3;return P<<=B,M[G]|=P&255,P>>>=8,M[G+1]=P,V+8}function Ai(M,V,P){var B=V&7,G=V>>>3;return P<<=B,M[G]|=P&255,P>>>=8,M[G+1]=P&255,M[G+2]=P>>>8,V+16}function zs(M,V){var P=M.length,B=2*P>V?2*P:V+5,G=0;if(P>=V)return M;if(vt){var X=Py(B);if(M.copy)M.copy(X);else for(;G<M.length;++G)X[G]=M[G];return X}else if(Ee){var ue=new Uint8Array(B);if(ue.set)ue.set(M);else for(;G<P;++G)ue[G]=M[G];return ue}return M.length=B,M}function Lt(M){for(var V=new Array(M),P=0;P<M;++P)V[P]=0;return V}function ws(M,V,P){var B=1,G=0,X=0,ue=0,_e=0,he=M.length,de=Ee?new Uint16Array(32):Lt(32);for(X=0;X<32;++X)de[X]=0;for(X=he;X<P;++X)M[X]=0;he=M.length;var pe=Ee?new Uint16Array(he):Lt(he);for(X=0;X<he;++X)de[G=M[X]]++,B<G&&(B=G),pe[X]=0;for(de[0]=0,X=1;X<=B;++X)de[X+16]=_e=_e+de[X-1]<<1;for(X=0;X<he;++X)_e=M[X],_e!=0&&(pe[X]=de[_e+16]++);var Se=0;for(X=0;X<he;++X)if(Se=M[X],Se!=0)for(_e=Z(pe[X],B)>>B-Se,ue=(1<<B+4-Se)-1;ue>=0;--ue)V[_e|ue<<Se]=Se&15|X<<4;return B}var Es=Ee?new Uint16Array(512):Lt(512),jn=Ee?new Uint16Array(32):Lt(32);if(!Ee){for(var yr=0;yr<512;++yr)Es[yr]=0;for(yr=0;yr<32;++yr)jn[yr]=0}(function(){for(var M=[],V=0;V<32;V++)M.push(5);ws(M,jn,32);var P=[];for(V=0;V<=143;V++)P.push(8);for(;V<=255;V++)P.push(9);for(;V<=279;V++)P.push(7);for(;V<=287;V++)P.push(8);ws(P,Es,288)})();var Qa=(function(){for(var V=Ee?new Uint8Array(32768):[],P=0,B=0;P<ve.length-1;++P)for(;B<ve[P+1];++B)V[B]=P;for(;B<32768;++B)V[B]=29;var G=Ee?new Uint8Array(259):[];for(P=0,B=0;P<oe.length-1;++P)for(;B<oe[P+1];++B)G[B]=P;function X(_e,he){for(var de=0;de<_e.length;){var pe=Math.min(65535,_e.length-de),Se=de+pe==_e.length;for(he.write_shift(1,+Se),he.write_shift(2,pe),he.write_shift(2,~pe&65535);pe-- >0;)he[he.l++]=_e[de++]}return he.l}function ue(_e,he){for(var de=0,pe=0,Se=Ee?new Uint16Array(32768):[];pe<_e.length;){var Re=Math.min(65535,_e.length-pe);if(Re<10){for(de=ea(he,de,+(pe+Re==_e.length)),de&7&&(de+=8-(de&7)),he.l=de/8|0,he.write_shift(2,Re),he.write_shift(2,~Re&65535);Re-- >0;)he[he.l++]=_e[pe++];de=he.l*8;continue}de=ea(he,de,+(pe+Re==_e.length)+2);for(var Fe=0;Re-- >0;){var Ce=_e[pe];Fe=(Fe<<5^Ce)&32767;var Oe=-1,Pe=0;if((Oe=Se[Fe])&&(Oe|=pe&-32768,Oe>pe&&(Oe-=32768),Oe<pe))for(;_e[Oe+Pe]==_e[pe+Pe]&&Pe<250;)++Pe;if(Pe>2){Ce=G[Pe],Ce<=22?de=Fa(he,de,Ae[Ce+1]>>1)-1:(Fa(he,de,3),de+=5,Fa(he,de,Ae[Ce-23]>>5),de+=3);var Ut=Ce<8?0:Ce-4>>2;Ut>0&&(Ai(he,de,Pe-oe[Ce]),de+=Ut),Ce=V[pe-Oe],de=Fa(he,de,Ae[Ce]>>3),de-=3;var zt=Ce<4?0:Ce-2>>1;zt>0&&(Ai(he,de,pe-Oe-ve[Ce]),de+=zt);for(var Kt=0;Kt<Pe;++Kt)Se[Fe]=pe&32767,Fe=(Fe<<5^_e[pe])&32767,++pe;Re-=Pe-1}else Ce<=143?Ce=Ce+48:de=_a(he,de,1),de=Fa(he,de,Ae[Ce]),Se[Fe]=pe&32767,++pe}de=Fa(he,de,0)-1}return he.l=(de+7)/8|0,he.l}return function(he,de){return he.length<8?X(he,de):ue(he,de)}})();function lt(M){var V=Mr(50+Math.floor(M.length*1.1)),P=Qa(M,V);return V.slice(0,P)}var sr=Ee?new Uint16Array(32768):Lt(32768),ya=Ee?new Uint16Array(32768):Lt(32768),Gt=Ee?new Uint16Array(128):Lt(128),gr=1,As=1;function ca(M,V){var P=ot(M,V)+257;V+=5;var B=ot(M,V)+1;V+=5;var G=At(M,V)+4;V+=4;for(var X=0,ue=Ee?new Uint8Array(19):Lt(19),_e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],he=1,de=Ee?new Uint8Array(8):Lt(8),pe=Ee?new Uint8Array(8):Lt(8),Se=ue.length,Re=0;Re<G;++Re)ue[Y[Re]]=X=at(M,V),he<X&&(he=X),de[X]++,V+=3;var Fe=0;for(de[0]=0,Re=1;Re<=he;++Re)pe[Re]=Fe=Fe+de[Re-1]<<1;for(Re=0;Re<Se;++Re)(Fe=ue[Re])!=0&&(_e[Re]=pe[Fe]++);var Ce=0;for(Re=0;Re<Se;++Re)if(Ce=ue[Re],Ce!=0){Fe=Ae[_e[Re]]>>8-Ce;for(var Oe=(1<<7-Ce)-1;Oe>=0;--Oe)Gt[Fe|Oe<<Ce]=Ce&7|Re<<3}var Pe=[];for(he=1;Pe.length<P+B;)switch(Fe=Gt[De(M,V)],V+=Fe&7,Fe>>>=3){case 16:for(X=3+Mt(M,V),V+=2,Fe=Pe[Pe.length-1];X-- >0;)Pe.push(Fe);break;case 17:for(X=3+at(M,V),V+=3;X-- >0;)Pe.push(0);break;case 18:for(X=11+De(M,V),V+=7;X-- >0;)Pe.push(0);break;default:Pe.push(Fe),he<Fe&&(he=Fe);break}var Ut=Pe.slice(0,P),zt=Pe.slice(P);for(Re=P;Re<286;++Re)Ut[Re]=0;for(Re=B;Re<30;++Re)zt[Re]=0;return gr=ws(Ut,sr,286),As=ws(zt,ya,30),V}function Tf(M,V){if(M[0]==3&&!(M[1]&3))return[xi(V),2];for(var P=0,B=0,G=Py(V||1<<18),X=0,ue=G.length>>>0,_e=0,he=0;(B&1)==0;){if(B=at(M,P),P+=3,B>>>1)B>>1==1?(_e=9,he=5):(P=ca(M,P),_e=gr,he=As);else{P&7&&(P+=8-(P&7));var de=M[P>>>3]|M[(P>>>3)+1]<<8;if(P+=32,de>0)for(!V&&ue<X+de&&(G=zs(G,X+de),ue=G.length);de-- >0;)G[X++]=M[P>>>3],P+=8;continue}for(;;){!V&&ue<X+32767&&(G=zs(G,X+32767),ue=G.length);var pe=Yt(M,P,_e),Se=B>>>1==1?Es[pe]:sr[pe];if(P+=Se&15,Se>>>=4,(Se>>>8&255)===0)G[X++]=Se;else{if(Se==256)break;Se-=257;var Re=Se<8?0:Se-4>>2;Re>5&&(Re=0);var Fe=X+oe[Se];Re>0&&(Fe+=Yt(M,P,Re),P+=Re),pe=Yt(M,P,he),Se=B>>>1==1?jn[pe]:ya[pe],P+=Se&15,Se>>>=4;var Ce=Se<4?0:Se-2>>1,Oe=ve[Se];for(Ce>0&&(Oe+=Yt(M,P,Ce),P+=Ce),!V&&ue<Fe&&(G=zs(G,Fe+100),ue=G.length);X<Fe;)G[X]=G[X-Oe],++X}}}return V?[G,P+7>>>3]:[G.slice(0,X),P+7>>>3]}function Qu(M,V){var P=M.slice(M.l||0),B=Tf(P,V);return M.l+=B[1],B[0]}function Zu(M,V){if(M)typeof console<"u"&&console.error(V);else throw new Error(V)}function Si(M,V){var P=M;Jr(P,0);var B=[],G=[],X={FileIndex:B,FullPaths:G};C(X,{root:V.root});for(var ue=P.length-4;(P[ue]!=80||P[ue+1]!=75||P[ue+2]!=5||P[ue+3]!=6)&&ue>=0;)--ue;P.l=ue+4,P.l+=4;var _e=P.read_shift(2);P.l+=6;var he=P.read_shift(4);for(P.l=he,ue=0;ue<_e;++ue){P.l+=20;var de=P.read_shift(4),pe=P.read_shift(4),Se=P.read_shift(2),Re=P.read_shift(2),Fe=P.read_shift(2);P.l+=8;var Ce=P.read_shift(4),Oe=c(P.slice(P.l+Se,P.l+Se+Re));P.l+=Se+Re+Fe;var Pe=P.l;P.l=Ce+4,bo(P,de,pe,X,Oe),P.l=Pe}return X}function bo(M,V,P,B,G){M.l+=2;var X=M.read_shift(2),ue=M.read_shift(2),_e=o(M);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var he=M.read_shift(4),de=M.read_shift(4),pe=M.read_shift(4),Se=M.read_shift(2),Re=M.read_shift(2),Fe="",Ce=0;Ce<Se;++Ce)Fe+=String.fromCharCode(M[M.l++]);if(Re){var Oe=c(M.slice(M.l,M.l+Re));(Oe[21589]||{}).mt&&(_e=Oe[21589].mt),((G||{})[21589]||{}).mt&&(_e=G[21589].mt)}M.l+=Re;var Pe=M.slice(M.l,M.l+de);switch(ue){case 8:Pe=J(M,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ue)}var Ut=!1;X&8&&(he=M.read_shift(4),he==134695760&&(he=M.read_shift(4),Ut=!0),de=M.read_shift(4),pe=M.read_shift(4)),de!=V&&Zu(Ut,"Bad compressed size: "+V+" != "+de),pe!=P&&Zu(Ut,"Bad uncompressed size: "+P+" != "+pe),Ao(B,Fe,Pe,{unsafe:!0,mt:_e})}function wo(M,V){var P=V||{},B=[],G=[],X=Mr(1),ue=P.compression?8:0,_e=0,he=0,de=0,pe=0,Se=0,Re=M.FullPaths[0],Fe=Re,Ce=M.FileIndex[0],Oe=[],Pe=0;for(he=1;he<M.FullPaths.length;++he)if(Fe=M.FullPaths[he].slice(Re.length),Ce=M.FileIndex[he],!(!Ce.size||!Ce.content||Fe=="Sh33tJ5")){var Ut=pe,zt=Mr(Fe.length);for(de=0;de<Fe.length;++de)zt.write_shift(1,Fe.charCodeAt(de)&127);zt=zt.slice(0,zt.l),Oe[Se]=WD.buf(Ce.content,0);var Kt=Ce.content;ue==8&&(Kt=K(Kt)),X=Mr(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,_e),X.write_shift(2,ue),Ce.mt?i(X,Ce.mt):X.write_shift(4,0),X.write_shift(-4,Oe[Se]),X.write_shift(4,Kt.length),X.write_shift(4,Ce.content.length),X.write_shift(2,zt.length),X.write_shift(2,0),pe+=X.length,B.push(X),pe+=zt.length,B.push(zt),pe+=Kt.length,B.push(Kt),X=Mr(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,_e),X.write_shift(2,ue),X.write_shift(4,0),X.write_shift(-4,Oe[Se]),X.write_shift(4,Kt.length),X.write_shift(4,Ce.content.length),X.write_shift(2,zt.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,Ut),Pe+=X.l,G.push(X),Pe+=zt.length,G.push(zt),++Se}return X=Mr(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,Se),X.write_shift(2,Se),X.write_shift(4,Pe),X.write_shift(4,pe),X.write_shift(2,0),di([di(B),di(G),X])}var Za={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Eo(M,V){if(M.ctype)return M.ctype;var P=M.name||"",B=P.match(/\.([^\.]+)$/);return B&&Za[B[1]]||V&&(B=(P=V).match(/[\.\\]([^\.\\])+$/),B&&Za[B[1]])?Za[B[1]]:"application/octet-stream"}function Ti(M){for(var V=jy(M),P=[],B=0;B<V.length;B+=76)P.push(V.slice(B,B+76));return P.join(`\r
`)+`\r
`}function Cf(M){var V=M.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(de){var pe=de.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var P=[],B=V.split(`\r
`),G=0;G<B.length;++G){var X=B[G];if(X.length==0){P.push("");continue}for(var ue=0;ue<X.length;){var _e=76,he=X.slice(ue,ue+_e);he.charAt(_e-1)=="="?_e--:he.charAt(_e-2)=="="?_e-=2:he.charAt(_e-3)=="="&&(_e-=3),he=X.slice(ue,ue+_e),ue+=_e,ue<X.length&&(he+="="),P.push(he)}}return P.join(`\r
`)}function eh(M){for(var V=[],P=0;P<M.length;++P){for(var B=M[P];P<=M.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+M[++P];V.push(B)}for(var G=0;G<V.length;++G)V[G]=V[G].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return Is(V.join(`\r
`))}function ql(M,V,P){for(var B="",G="",X="",ue,_e=0;_e<10;++_e){var he=V[_e];if(!he||he.match(/^\s*$/))break;var de=he.match(/^(.*?):\s*([^\s].*)$/);if(de)switch(de[1].toLowerCase()){case"content-location":B=de[2].trim();break;case"content-type":X=de[2].trim();break;case"content-transfer-encoding":G=de[2].trim();break}}switch(++_e,G.toLowerCase()){case"base64":ue=Is(Ka(V.slice(_e).join("")));break;case"quoted-printable":ue=eh(V.slice(_e));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+G)}var pe=Ao(M,B.slice(P.length),ue,{unsafe:!0});X&&(pe.ctype=X)}function Ci(M,V){if(se(M.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var P=V&&V.root||"",B=(vt&&Buffer.isBuffer(M)?M.toString("binary"):se(M)).split(`\r
`),G=0,X="";for(G=0;G<B.length;++G)if(X=B[G],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),P||(P=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,P.length)!=P))for(;P.length>0&&(P=P.slice(0,P.length-1),P=P.slice(0,P.lastIndexOf("/")+1),X.slice(0,P.length)!=P););var ue=(B[1]||"").match(/boundary="(.*?)"/);if(!ue)throw new Error("MAD cannot find boundary");var _e="--"+(ue[1]||""),he=[],de=[],pe={FileIndex:he,FullPaths:de};C(pe);var Se,Re=0;for(G=0;G<B.length;++G){var Fe=B[G];Fe!==_e&&Fe!==_e+"--"||(Re++&&ql(pe,B.slice(Se,G),P),Se=G)}return pe}function kf(M,V){var P=V||{},B=P.boundary||"SheetJS";B="------="+B;for(var G=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],X=M.FullPaths[0],ue=X,_e=M.FileIndex[0],he=1;he<M.FullPaths.length;++he)if(ue=M.FullPaths[he].slice(X.length),_e=M.FileIndex[he],!(!_e.size||!_e.content||ue=="Sh33tJ5")){ue=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Pe){return"_x"+Pe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Pe){return"_u"+Pe.charCodeAt(0).toString(16)+"_"});for(var de=_e.content,pe=vt&&Buffer.isBuffer(de)?de.toString("binary"):se(de),Se=0,Re=Math.min(1024,pe.length),Fe=0,Ce=0;Ce<=Re;++Ce)(Fe=pe.charCodeAt(Ce))>=32&&Fe<128&&++Se;var Oe=Se>=Re*4/5;G.push(B),G.push("Content-Location: "+(P.root||"file:///C:/SheetJS/")+ue),G.push("Content-Transfer-Encoding: "+(Oe?"quoted-printable":"base64")),G.push("Content-Type: "+Eo(_e,ue)),G.push(""),G.push(Oe?Cf(pe):Ti(pe))}return G.push(B+`--\r
`),G.join(`\r
`)}function th(M){var V={};return C(V,M),V}function Ao(M,V,P,B){var G=B&&B.unsafe;G||C(M);var X=!G&&xt.find(M,V);if(!X){var ue=M.FullPaths[0];V.slice(0,ue.length)==ue?ue=V:(ue.slice(-1)!="/"&&(ue+="/"),ue=(ue+V).replace("//","/")),X={name:s(V),type:2},M.FileIndex.push(X),M.FullPaths.push(ue),G||xt.utils.cfb_gc(M)}return X.content=P,X.size=P?P.length:0,B&&(B.CLSID&&(X.clsid=B.CLSID),B.mt&&(X.mt=B.mt),B.ct&&(X.ct=B.ct)),X}function rh(M,V){C(M);var P=xt.find(M,V);if(P){for(var B=0;B<M.FileIndex.length;++B)if(M.FileIndex[B]==P)return M.FileIndex.splice(B,1),M.FullPaths.splice(B,1),!0}return!1}function Wl(M,V,P){C(M);var B=xt.find(M,V);if(B){for(var G=0;G<M.FileIndex.length;++G)if(M.FileIndex[G]==B)return M.FileIndex[G].name=s(P),M.FullPaths[G]=P,!0}return!1}function Xl(M){I(M,!0)}return e.find=H,e.read=O,e.parse=f,e.write=ke,e.writeFile=be,e.utils={cfb_new:th,cfb_add:Ao,cfb_del:rh,cfb_mov:Wl,cfb_gc:Xl,ReadShift:ru,CheckField:FE,prep_blob:Jr,bconcat:di,use_zlib:F,_deflateRaw:lt,_inflateRaw:Qu,consts:te},e})();function XD(r){if(typeof Deno<"u")return Deno.readFileSync(r);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(r);e.open("r"),e.encoding="binary";var t=e.read();return e.close(),t}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+r)}function tn(r){for(var e=Object.keys(r),t=[],a=0;a<e.length;++a)Object.prototype.hasOwnProperty.call(r,e[a])&&t.push(e[a]);return t}function Am(r){for(var e=[],t=tn(r),a=0;a!==t.length;++a)e[r[t[a]]]=t[a];return e}var Jd=new Date(1899,11,30,0,0,0);function xa(r,e){var t=r.getTime(),a=Jd.getTime()+(r.getTimezoneOffset()-Jd.getTimezoneOffset())*6e4;return(t-a)/(1440*60*1e3)}var dE=new Date,YD=Jd.getTime()+(dE.getTimezoneOffset()-Jd.getTimezoneOffset())*6e4,qy=dE.getTimezoneOffset();function gf(r){var e=new Date;return e.setTime(r*24*60*60*1e3+YD),e.getTimezoneOffset()!==qy&&e.setTime(e.getTime()+(e.getTimezoneOffset()-qy)*6e4),e}function KD(r){var e=0,t=0,a=!1,s=r.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+r+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(t=1,i>3&&(a=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":t*=24;case"H":t*=60;case"M":if(a)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=t*parseInt(s[i],10)}return e}var Wy=new Date("2017-02-19T19:06:09.000Z"),fE=isNaN(Wy.getFullYear())?new Date("2/19/17"):Wy,JD=fE.getFullYear()==2017;function Hr(r,e){var t=new Date(r);if(JD)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(fE.getFullYear()==1917&&!isNaN(t.getFullYear())){var a=t.getFullYear();return r.indexOf(""+a)>-1||t.setFullYear(t.getFullYear()+100),t}var s=r.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return r.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function oo(r,e){if(vt&&Buffer.isBuffer(r)){if(e){if(r[0]==255&&r[1]==254)return Yc(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return Yc(Zw(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(r[0]==255&&r[1]==254)return Yc(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return Yc(new TextDecoder("utf-16be").decode(r.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(i){return t[i]||i})}catch{}for(var a=[],s=0;s!=r.length;++s)a.push(String.fromCharCode(r[s]));return a.join("")}function Qr(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=Qr(r[t]));return e}function dr(r,e){for(var t="";t.length<e;)t+=r;return t}function Bs(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,a=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,i){return t=-t,i}),!isNaN(e=Number(a)))?e/t:e}var QD=["january","february","march","april","may","june","july","august","september","october","november","december"];function Il(r){var e=new Date(r),t=new Date(NaN),a=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return t;var o=r.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&QD.indexOf(o)==-1)return t}else if(o.match(/[a-z]/))return t;return a<0||a>8099?t:(s>0||i>1)&&a!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}var ZD=(function(){var r="abacaba".split(/(:?b)/i).length==5;return function(t,a,s){if(r||typeof a=="string")return t.split(a);for(var i=t.split(a),o=[i[0]],c=1;c<i.length;++c)o.push(s),o.push(i[c]);return o}})();function pE(r){return r?r.content&&r.type?oo(r.content,!0):r.data?qc(r.data):r.asNodeBuffer&&vt?qc(r.asNodeBuffer().toString("binary")):r.asBinary?qc(r.asBinary()):r._data&&r._data.getContent?qc(oo(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function gE(r){if(!r)return null;if(r.data)return Ly(r.data);if(r.asNodeBuffer&&vt)return r.asNodeBuffer();if(r._data&&r._data.getContent){var e=r._data.getContent();return typeof e=="string"?Ly(e):Array.prototype.slice.call(e)}return r.content&&r.type?r.content:null}function e4(r){return r&&r.name.slice(-4)===".bin"?gE(r):pE(r)}function ms(r,e){for(var t=r.FullPaths||tn(r.files),a=e.toLowerCase().replace(/[\/]/g,"\\"),s=a.replace(/\\/g,"/"),i=0;i<t.length;++i){var o=t[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||s==o)return r.files?r.files[t[i]]:r.FileIndex[i]}return null}function Sm(r,e){var t=ms(r,e);if(t==null)throw new Error("Cannot find file "+e+" in zip");return t}function kr(r,e,t){if(!t)return e4(Sm(r,e));if(!e)return null;try{return kr(r,e)}catch{return null}}function Ya(r,e,t){if(!t)return pE(Sm(r,e));if(!e)return null;try{return Ya(r,e)}catch{return null}}function t4(r,e,t){return gE(Sm(r,e))}function Xy(r){for(var e=r.FullPaths||tn(r.files),t=[],a=0;a<e.length;++a)e[a].slice(-1)!="/"&&t.push(e[a].replace(/^Root Entry[\/]/,""));return t.sort()}function r4(r,e,t){if(r.FullPaths){if(typeof t=="string"){var a;return vt?a=fo(t):a=bD(t),xt.utils.cfb_add(r,e,a)}xt.utils.cfb_add(r,e,t)}else r.file(e,t)}function mE(r,e){switch(e.type){case"base64":return xt.read(r,{type:"base64"});case"binary":return xt.read(r,{type:"binary"});case"buffer":case"array":return xt.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Xc(r,e){if(r.charAt(0)=="/")return r.slice(1);var t=e.split("/");e.slice(-1)!="/"&&t.pop();for(var a=r.split("/");a.length!==0;){var s=a.shift();s===".."?t.pop():s!=="."&&t.push(s)}return t.join("/")}var vE=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,a4=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Yy=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,s4=/<[^>]*>/g,la=vE.match(Yy)?Yy:s4,n4=/<\w*:/,i4=/<(\/?)\w+:/;function Ke(r,e,t){for(var a={},s=0,i=0;s!==r.length&&!((i=r.charCodeAt(s))===32||i===10||i===13);++s);if(e||(a[0]=r.slice(0,s)),s===r.length)return a;var o=r.match(a4),c=0,u="",d=0,f="",g="",v=1;if(o)for(d=0;d!=o.length;++d){for(g=o[d],i=0;i!=g.length&&g.charCodeAt(i)!==61;++i);for(f=g.slice(0,i).trim();g.charCodeAt(i+1)==32;)++i;for(v=(s=g.charCodeAt(i+1))==34||s==39?1:0,u=g.slice(i+1+v,g.length-v),c=0;c!=f.length&&f.charCodeAt(c)!==58;++c);if(c===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),a[f]=u,a[f.toLowerCase()]=u;else{var x=(c===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(c+1);if(a[x]&&f.slice(c-3,c)=="ext")continue;a[x]=u,a[x.toLowerCase()]=u}}return a}function an(r){return r.replace(i4,"<$1")}var xE={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},o4=Am(xE),yt=(function(){var r=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function t(a){var s=a+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(r,function(c,u){return xE[c]||String.fromCharCode(parseInt(u,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,u){return String.fromCharCode(parseInt(u,16))});var o=s.indexOf("]]>");return t(s.slice(0,i))+s.slice(i+9,o)+t(s.slice(o+3))}})(),l4=/[&<>'"]/g,c4=/[\u0000-\u001f]/g;function Tm(r){var e=r+"";return e.replace(l4,function(t){return o4[t]}).replace(/\n/g,"<br/>").replace(c4,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var Ky=(function(){var r=/&#(\d+);/g;function e(t,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(r,e)}})();function rr(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function rg(r){for(var e="",t=0,a=0,s=0,i=0,o=0,c=0;t<r.length;){if(a=r.charCodeAt(t++),a<128){e+=String.fromCharCode(a);continue}if(s=r.charCodeAt(t++),a>191&&a<224){o=(a&31)<<6,o|=s&63,e+=String.fromCharCode(o);continue}if(i=r.charCodeAt(t++),a<240){e+=String.fromCharCode((a&15)<<12|(s&63)<<6|i&63);continue}o=r.charCodeAt(t++),c=((a&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function Jy(r){var e=xi(2*r.length),t,a,s=1,i=0,o=0,c;for(a=0;a<r.length;a+=s)s=1,(c=r.charCodeAt(a))<128?t=c:c<224?(t=(c&31)*64+(r.charCodeAt(a+1)&63),s=2):c<240?(t=(c&15)*4096+(r.charCodeAt(a+1)&63)*64+(r.charCodeAt(a+2)&63),s=3):(s=4,t=(c&7)*262144+(r.charCodeAt(a+1)&63)*4096+(r.charCodeAt(a+2)&63)*64+(r.charCodeAt(a+3)&63),t-=65536,o=55296+(t>>>10&1023),t=56320+(t&1023)),o!==0&&(e[i++]=o&255,e[i++]=o>>>8,o=0),e[i++]=t%256,e[i++]=t>>>8;return e.slice(0,i).toString("ucs2")}function Qy(r){return fo(r,"binary").toString("utf8")}var yd="foo bar baz",$t=vt&&(Qy(yd)==rg(yd)&&Qy||Jy(yd)==rg(yd)&&Jy)||rg,Yc=vt?function(r){return fo(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,a=0,s=0;t<r.length;)switch(a=r.charCodeAt(t++),!0){case a<128:e.push(String.fromCharCode(a));break;case a<2048:e.push(String.fromCharCode(192+(a>>6))),e.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=r.charCodeAt(t++)-56320+(a<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(a>>12))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)))}return e.join("")},bu=(function(){var r={};return function(t,a){var s=t+"|"+(a||"");return r[s]?r[s]:r[s]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",a||"")}})(),_E=(function(){var r=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var a=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<r.length;++s)a=a.replace(r[s][0],r[s][1]);return a}})(),u4=(function(){var r={};return function(t){return r[t]!==void 0?r[t]:r[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),h4=/<\/?(?:vt:)?variant>/g,d4=/<(?:vt:)([^>]*)>([\s\S]*)</;function Zy(r,e){var t=Ke(r),a=r.match(u4(t.baseType))||[],s=[];if(a.length!=t.size){if(e.WTF)throw new Error("unexpected vector length "+a.length+" != "+t.size);return s}return a.forEach(function(i){var o=i.replace(h4,"").match(d4);o&&s.push({v:$t(o[2]),t:o[1]})}),s}var f4=/(^\s|\s$|\n)/;function p4(r){return tn(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function g4(r,e,t){return"<"+r+(t!=null?p4(t):"")+(e!=null?(e.match(f4)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function Cm(r){if(vt&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return $t(po(bm(r)));throw new Error("Bad input format: expected Buffer or string")}var wu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,m4={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},v4=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function x4(r,e){for(var t=1-2*(r[e+7]>>>7),a=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),s=r[e+6]&15,i=5;i>=0;--i)s=s*256+r[e+i];return a==2047?s==0?t*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),t*Math.pow(2,a-52)*s)}function _4(r,e,t){var a=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,o=a?-e:e;isFinite(o)?o==0?s=i=0:(s=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var c=0;c<=5;++c,i/=256)r[t+c]=i&255;r[t+6]=(s&15)<<4|i&15,r[t+7]=s>>4|a}var eb=function(r){for(var e=[],t=10240,a=0;a<r[0].length;++a)if(r[0][a])for(var s=0,i=r[0][a].length;s<i;s+=t)e.push.apply(e,r[0][a].slice(s,s+t));return e},tb=vt?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:fo(e)})):eb(r)}:eb,rb=function(r,e,t){for(var a=[],s=e;s<t;s+=2)a.push(String.fromCharCode(kn(r,s)));return a.join("").replace(va,"")},km=vt?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace(va,""):rb(r,e,t)}:rb,ab=function(r,e,t){for(var a=[],s=e;s<e+t;++s)a.push(("0"+r[s].toString(16)).slice(-2));return a.join("")},yE=vt?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):ab(r,e,t)}:ab,sb=function(r,e,t){for(var a=[],s=e;s<t;s++)a.push(String.fromCharCode(_l(r,s)));return a.join("")},Bu=vt?function(e,t,a){return Buffer.isBuffer(e)?e.toString("utf8",t,a):sb(e,t,a)}:sb,bE=function(r,e){var t=qa(r,e);return t>0?Bu(r,e+4,e+4+t-1):""},wE=bE,EE=function(r,e){var t=qa(r,e);return t>0?Bu(r,e+4,e+4+t-1):""},AE=EE,SE=function(r,e){var t=2*qa(r,e);return t>0?Bu(r,e+4,e+4+t-1):""},TE=SE,CE=function(e,t){var a=qa(e,t);return a>0?km(e,t+4,t+4+a):""},kE=CE,NE=function(r,e){var t=qa(r,e);return t>0?Bu(r,e+4,e+4+t):""},RE=NE,OE=function(r,e){return x4(r,e)},Qd=OE,DE=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};vt&&(wE=function(e,t){if(!Buffer.isBuffer(e))return bE(e,t);var a=e.readUInt32LE(t);return a>0?e.toString("utf8",t+4,t+4+a-1):""},AE=function(e,t){if(!Buffer.isBuffer(e))return EE(e,t);var a=e.readUInt32LE(t);return a>0?e.toString("utf8",t+4,t+4+a-1):""},TE=function(e,t){if(!Buffer.isBuffer(e))return SE(e,t);var a=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+a-1)},kE=function(e,t){if(!Buffer.isBuffer(e))return CE(e,t);var a=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+a)},RE=function(e,t){if(!Buffer.isBuffer(e))return NE(e,t);var a=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+a)},Qd=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):OE(e,t)},DE=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var _l=function(r,e){return r[e]},kn=function(r,e){return r[e+1]*256+r[e]},y4=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},qa=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},Ki=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},b4=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function ru(r,e){var t="",a,s,i=[],o,c,u,d;switch(e){case"dbcs":if(d=this.l,vt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(u=0;u<r;++u)t+=String.fromCharCode(kn(this,d)),d+=2;r*=2;break;case"utf8":t=Bu(this,this.l,this.l+r);break;case"utf16le":r*=2,t=km(this,this.l,this.l+r);break;case"wstr":return ru.call(this,r,"dbcs");case"lpstr-ansi":t=wE(this,this.l),r=4+qa(this,this.l);break;case"lpstr-cp":t=AE(this,this.l),r=4+qa(this,this.l);break;case"lpwstr":t=TE(this,this.l),r=4+2*qa(this,this.l);break;case"lpp4":r=4+qa(this,this.l),t=kE(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+qa(this,this.l),t=RE(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(o=_l(this,this.l+r++))!==0;)i.push(_d(o));t=i.join("");break;case"_wstr":for(r=0,t="";(o=kn(this,this.l+r))!==0;)i.push(_d(o)),r+=2;r+=2,t=i.join("");break;case"dbcs-cont":for(t="",d=this.l,u=0;u<r;++u){if(this.lens&&this.lens.indexOf(d)!==-1)return o=_l(this,d),this.l=d+1,c=ru.call(this,r-u,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(_d(kn(this,d))),d+=2}t=i.join(""),r*=2;break;case"cpstr":case"sbcs-cont":for(t="",d=this.l,u=0;u!=r;++u){if(this.lens&&this.lens.indexOf(d)!==-1)return o=_l(this,d),this.l=d+1,c=ru.call(this,r-u,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(_d(_l(this,d))),d+=1}t=i.join("");break;default:switch(r){case 1:return a=_l(this,this.l),this.l++,a;case 2:return a=(e==="i"?y4:kn)(this,this.l),this.l+=2,a;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(a=(r>0?Ki:b4)(this,this.l),this.l+=4,a):(s=qa(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return r==8?s=Qd(this,this.l):s=Qd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;r=8;case 16:t=yE(this,this.l,r);break}}return this.l+=r,t}var w4=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},E4=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},A4=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function S4(r,e,t){var a=0,s=0;if(t==="dbcs"){for(s=0;s!=e.length;++s)A4(this,e.charCodeAt(s),this.l+2*s);a=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;a=e.length}else if(t==="hex"){for(;s<r;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(t==="utf16le"){var i=Math.min(this.l+r,this.length);for(s=0;s<Math.min(e.length,r);++s){var o=e.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(r){case 1:a=1,this[this.l]=e&255;break;case 2:a=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:a=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:a=4,w4(this,e,this.l);break;case 8:if(a=8,t==="f"){_4(this,e,this.l);break}case 16:break;case-4:a=4,E4(this,e,this.l);break}return this.l+=a,this}function FE(r,e){var t=yE(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function Jr(r,e){r.l=e,r.read_shift=ru,r.chk=FE,r.write_shift=S4}function oa(r,e){r.l+=e}function Mr(r){var e=xi(r);return Jr(e,0),e}function In(r,e,t){if(r){var a,s,i;Jr(r,r.l||0);for(var o=r.length,c=0,u=0;r.l<o;){c=r.read_shift(1),c&128&&(c=(c&127)+((r.read_shift(1)&127)<<7));var d=sf[c]||sf[65535];for(a=r.read_shift(1),i=a&127,s=1;s<4&&a&128;++s)i+=((a=r.read_shift(1))&127)<<7*s;u=r.l+i;var f=d.f&&d.f(r,i,t);if(r.l=u,e(f,d,c))return}}}function Fg(){var r=[],e=vt?256:2048,t=function(d){var f=Mr(d);return Jr(f,0),f},a=t(e),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&r.push(a),a=null)},i=function(d){return a&&d<a.length-a.l?a:(s(),a=t(Math.max(d+1,e)))},o=function(){return s(),di(r)},c=function(d){s(),a=d,a.l==null&&(a.l=a.length),i(e)};return{next:i,push:c,end:o,_bufs:r}}function au(r,e,t){var a=Qr(r);if(e.s?(a.cRel&&(a.c+=e.s.c),a.rRel&&(a.r+=e.s.r)):(a.cRel&&(a.c+=e.c),a.rRel&&(a.r+=e.r)),!t||t.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function nb(r,e,t){var a=Qr(r);return a.s=au(a.s,e.s,t),a.e=au(a.e,e.s,t),a}function su(r,e){if(r.cRel&&r.c<0)for(r=Qr(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=Qr(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=Qe(r);return!r.cRel&&r.cRel!=null&&(t=k4(t)),!r.rRel&&r.rRel!=null&&(t=T4(t)),t}function ag(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+Lr(r.s.c)+":"+(r.e.cRel?"":"$")+Lr(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+Zr(r.s.r)+":"+(r.e.rRel?"":"$")+Zr(r.e.r):su(r.s,e.biff)+":"+su(r.e,e.biff)}function Nm(r){return parseInt(C4(r),10)-1}function Zr(r){return""+(r+1)}function T4(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function C4(r){return r.replace(/\$(\d+)$/,"$1")}function Rm(r){for(var e=N4(r),t=0,a=0;a!==e.length;++a)t=26*t+e.charCodeAt(a)-64;return t-1}function Lr(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function k4(r){return r.replace(/^([A-Z])/,"$$$1")}function N4(r){return r.replace(/^\$([A-Z])/,"$1")}function R4(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ga(r){for(var e=0,t=0,a=0;a<r.length;++a){var s=r.charCodeAt(a);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(t=26*t+(s-64))}return{c:t-1,r:e-1}}function Qe(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function Gl(r){var e=r.indexOf(":");return e==-1?{s:ga(r),e:ga(r)}:{s:ga(r.slice(0,e)),e:ga(r.slice(e+1))}}function _t(r,e){return typeof e>"u"||typeof e=="number"?_t(r.s,r.e):(typeof r!="string"&&(r=Qe(r)),typeof e!="string"&&(e=Qe(e)),r==e?r:r+":"+e)}function pr(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,a=0,s=0,i=r.length;for(t=0;a<i&&!((s=r.charCodeAt(a)-64)<1||s>26);++a)t=26*t+s;for(e.s.c=--t,t=0;a<i&&!((s=r.charCodeAt(a)-48)<0||s>9);++a)t=10*t+s;if(e.s.r=--t,a===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++a,t=0;a!=i&&!((s=r.charCodeAt(a)-64)<1||s>26);++a)t=26*t+s;for(e.e.c=--t,t=0;a!=i&&!((s=r.charCodeAt(a)-48)<0||s>9);++a)t=10*t+s;return e.e.r=--t,e}function ib(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=_s(r.z,t?xa(e):e)}catch{}try{return r.w=_s((r.XF||{}).numFmtId||(t?14:0),t?xa(e):e)}catch{return""+e}}function Mn(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?vo[r.v]||r.v:e==null?ib(r,r.v):ib(r,e))}function Ei(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",a={};return a[t]=r,{SheetNames:[t],Sheets:a}}function ME(r,e,t){var a=t||{},s=r?Array.isArray(r):a.dense,i=r||(s?[]:{}),o=0,c=0;if(i&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var u=typeof a.origin=="string"?ga(a.origin):a.origin;o=u.r,c=u.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=pr(i["!ref"]);d.s.c=f.s.c,d.s.r=f.s.r,d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(d.e.r=o=f.e.r+1)}for(var g=0;g!=e.length;++g)if(e[g]){if(!Array.isArray(e[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=e[g].length;++v)if(!(typeof e[g][v]>"u")){var x={v:e[g][v]},y=o+g,_=c+v;if(d.s.r>y&&(d.s.r=y),d.s.c>_&&(d.s.c=_),d.e.r<y&&(d.e.r=y),d.e.c<_&&(d.e.c=_),e[g][v]&&typeof e[g][v]=="object"&&!Array.isArray(e[g][v])&&!(e[g][v]instanceof Date))x=e[g][v];else if(Array.isArray(x.v)&&(x.f=e[g][v][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(a.nullError)x.t="e",x.v=0;else if(a.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=a.dateNF||it[14],a.cellDates?(x.t="d",x.w=_s(x.z,xa(x.v))):(x.t="n",x.v=xa(x.v),x.w=_s(x.z,x.v))):x.t="s";if(s)i[y]||(i[y]=[]),i[y][_]&&i[y][_].z&&(x.z=i[y][_].z),i[y][_]=x;else{var w=Qe({c:_,r:y});i[w]&&i[w].z&&(x.z=i[w].z),i[w]=x}}}return d.s.c<1e7&&(i["!ref"]=_t(d)),i}function Vl(r,e){return ME(null,r,e)}function O4(r){return r.read_shift(4,"i")}function ia(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function D4(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function Om(r,e){var t=r.l,a=r.read_shift(1),s=ia(r),i=[],o={t:s,h:s};if((a&1)!==0){for(var c=r.read_shift(4),u=0;u!=c;++u)i.push(D4(r));o.r=i}else o.r=[{ich:0,ifnt:0}];return r.l=t+e,o}var F4=Om;function bs(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function go(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}var M4=ia;function Dm(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}var L4=ia,Mg=Dm;function Fm(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,a=e[0]&2;r.l+=4;var s=a===0?Qd([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Ki(e,0)>>2;return t?s/100:s}function LE(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}var mo=LE;function sa(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function I4(r){var e={},t=r.read_shift(1),a=t>>>1,s=r.read_shift(1),i=r.read_shift(2,"i"),o=r.read_shift(1),c=r.read_shift(1),u=r.read_shift(1);switch(r.l++,a){case 0:e.auto=1;break;case 1:e.index=s;var d=so[s];d&&(e.rgb=Au(d));break;case 2:e.rgb=Au([o,c,u]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function j4(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function IE(r,e){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=r.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return t[r.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return r.l-=4,r.read_shift(0,e==1?"lpstr":"lpwstr")}function P4(r){return IE(r,1)}function B4(r){return IE(r,2)}var Mm=2,Oa=3,bd=11,ob=12,Zd=19,wd=64,U4=65,z4=71,H4=4108,$4=4126,zr=80,jE=81,G4=[zr,jE],V4={1:{n:"CodePage",t:Mm},2:{n:"Category",t:zr},3:{n:"PresentationFormat",t:zr},4:{n:"ByteCount",t:Oa},5:{n:"LineCount",t:Oa},6:{n:"ParagraphCount",t:Oa},7:{n:"SlideCount",t:Oa},8:{n:"NoteCount",t:Oa},9:{n:"HiddenCount",t:Oa},10:{n:"MultimediaClipCount",t:Oa},11:{n:"ScaleCrop",t:bd},12:{n:"HeadingPairs",t:H4},13:{n:"TitlesOfParts",t:$4},14:{n:"Manager",t:zr},15:{n:"Company",t:zr},16:{n:"LinksUpToDate",t:bd},17:{n:"CharacterCount",t:Oa},19:{n:"SharedDoc",t:bd},22:{n:"HyperlinksChanged",t:bd},23:{n:"AppVersion",t:Oa,p:"version"},24:{n:"DigSig",t:U4},26:{n:"ContentType",t:zr},27:{n:"ContentStatus",t:zr},28:{n:"Language",t:zr},29:{n:"Version",t:zr},255:{},2147483648:{n:"Locale",t:Zd},2147483651:{n:"Behavior",t:Zd},1919054434:{}},q4={1:{n:"CodePage",t:Mm},2:{n:"Title",t:zr},3:{n:"Subject",t:zr},4:{n:"Author",t:zr},5:{n:"Keywords",t:zr},6:{n:"Comments",t:zr},7:{n:"Template",t:zr},8:{n:"LastAuthor",t:zr},9:{n:"RevNumber",t:zr},10:{n:"EditTime",t:wd},11:{n:"LastPrinted",t:wd},12:{n:"CreatedDate",t:wd},13:{n:"ModifiedDate",t:wd},14:{n:"PageCount",t:Oa},15:{n:"WordCount",t:Oa},16:{n:"CharCount",t:Oa},17:{n:"Thumbnail",t:z4},18:{n:"Application",t:zr},19:{n:"DocSecurity",t:Oa},255:{},2147483648:{n:"Locale",t:Zd},2147483651:{n:"Behavior",t:Zd},1919054434:{}},lb={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},W4=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function X4(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var Y4=X4([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),so=Qr(Y4),vo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},PE={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},cb={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function K4(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function J4(r){var e=K4();if(!r||!r.match)return e;var t={};if((r.match(la)||[]).forEach(function(a){var s=Ke(a);switch(s[0].replace(n4,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[s.Extension]=s.ContentType;break;case"<Override":e[cb[s.ContentType]]!==void 0&&e[cb[s.ContentType]].push(s.PartName);break}}),e.xmlns!==m4.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=t,delete e.calcchains,e}var Al={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Lg(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function nu(r,e){var t={"!id":{}};if(!r)return t;e.charAt(0)!=="/"&&(e="/"+e);var a={};return(r.match(la)||[]).forEach(function(s){var i=Ke(s);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:Xc(i.Target,e);t[c]=o,a[i.Id]=o}}),t["!id"]=a,t}var Q4="application/vnd.oasis.opendocument.spreadsheet";function Z4(r,e){for(var t=Cm(r),a,s;a=wu.exec(t);)switch(a[3]){case"manifest":break;case"file-entry":if(s=Ke(a[0],!1),s.path=="/"&&s.type!==Q4)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw a}}var iu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],e3=(function(){for(var r=new Array(iu.length),e=0;e<iu.length;++e){var t=iu[e],a="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);r[e]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return r})();function BE(r){var e={};r=$t(r);for(var t=0;t<iu.length;++t){var a=iu[t],s=r.match(e3[t]);s!=null&&s.length>0&&(e[a[1]]=yt(s[1])),a[2]==="date"&&e[a[1]]&&(e[a[1]]=Hr(e[a[1]]))}return e}var t3=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function UE(r,e,t,a){var s=[];if(typeof r=="string")s=Zy(r,a);else for(var i=0;i<r.length;++i)s=s.concat(r[i].map(function(f){return{v:f}}));var o=typeof e=="string"?Zy(e,a).map(function(f){return f.v}):e,c=0,u=0;if(o.length>0)for(var d=0;d!==s.length;d+=2){switch(u=+s[d+1].v,s[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=u,t.SheetNames=o.slice(c,c+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=u,t.DefinedNames=o.slice(c,c+u);break;case"Charts":case"Diagramme":t.Chartsheets=u,t.ChartNames=o.slice(c,c+u);break}c+=u}}function r3(r,e,t){var a={};return e||(e={}),r=$t(r),t3.forEach(function(s){var i=(r.match(bu(s[0]))||[])[1];switch(s[2]){case"string":i&&(e[s[1]]=yt(i));break;case"bool":e[s[1]]=i==="true";break;case"raw":var o=r.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(a[s[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&UE(a.HeadingPairs,a.TitlesOfParts,e,t),e}var a3=/<[^>]+>[^<]*/g;function s3(r,e){var t={},a="",s=r.match(a3);if(s)for(var i=0;i!=s.length;++i){var o=s[i],c=Ke(o);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":a=yt(c.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),d=u[0].slice(4),f=u[1];switch(d){case"lpstr":case"bstr":case"lpwstr":t[a]=yt(f);break;case"bool":t[a]=rr(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[a]=parseInt(f,10);break;case"r4":case"r8":case"decimal":t[a]=parseFloat(f);break;case"filetime":case"date":t[a]=Hr(f);break;case"cy":case"error":t[a]=yt(f);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,u)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return t}var n3={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},sg;function i3(r,e,t){sg||(sg=Am(n3)),e=sg[e]||e,r[e]=t}function Lm(r){var e=r.read_shift(4),t=r.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function zE(r,e,t){var a=r.l,s=r.read_shift(0,"lpstr-cp");if(t)for(;r.l-a&3;)++r.l;return s}function HE(r,e,t){var a=r.read_shift(0,"lpwstr");return a}function $E(r,e,t){return e===31?HE(r):zE(r,e,t)}function Ig(r,e,t){return $E(r,e,t===!1?0:4)}function o3(r,e){if(!e)throw new Error("VtUnalignedString must have positive length");return $E(r,e,0)}function l3(r){for(var e=r.read_shift(4),t=[],a=0;a!=e;++a){var s=r.l;t[a]=r.read_shift(0,"lpwstr").replace(va,""),r.l-s&2&&(r.l+=2)}return t}function c3(r){for(var e=r.read_shift(4),t=[],a=0;a!=e;++a)t[a]=r.read_shift(0,"lpstr-cp").replace(va,"");return t}function u3(r){var e=r.l,t=ef(r,jE);r[r.l]==0&&r[r.l+1]==0&&r.l-e&2&&(r.l+=2);var a=ef(r,Oa);return[t,a]}function h3(r){for(var e=r.read_shift(4),t=[],a=0;a<e/2;++a)t.push(u3(r));return t}function ub(r,e){for(var t=r.read_shift(4),a={},s=0;s!=t;++s){var i=r.read_shift(4),o=r.read_shift(4);a[i]=r.read_shift(o,e===1200?"utf16le":"utf8").replace(va,"").replace(Wc,"!"),e===1200&&o%2&&(r.l+=2)}return r.l&3&&(r.l=r.l>>3<<2),a}function GE(r){var e=r.read_shift(4),t=r.slice(r.l,r.l+e);return r.l+=e,(e&3)>0&&(r.l+=4-(e&3)&3),t}function d3(r){var e={};return e.Size=r.read_shift(4),r.l+=e.Size+3-(e.Size-1)%4,e}function ef(r,e,t){var a=r.read_shift(2),s,i=t||{};if(r.l+=2,e!==ob&&a!==e&&G4.indexOf(e)===-1&&!((e&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+e+" saw "+a);switch(e===ob?a:e){case 2:return s=r.read_shift(2,"i"),i.raw||(r.l+=2),s;case 3:return s=r.read_shift(4,"i"),s;case 11:return r.read_shift(4)!==0;case 19:return s=r.read_shift(4),s;case 30:return zE(r,a,4).replace(va,"");case 31:return HE(r);case 64:return Lm(r);case 65:return GE(r);case 71:return d3(r);case 80:return Ig(r,a,!i.raw).replace(va,"");case 81:return o3(r,a).replace(va,"");case 4108:return h3(r);case 4126:case 4127:return a==4127?l3(r):c3(r);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+a)}}function hb(r,e){var t=r.l,a=r.read_shift(4),s=r.read_shift(4),i=[],o=0,c=0,u=-1,d={};for(o=0;o!=s;++o){var f=r.read_shift(4),g=r.read_shift(4);i[o]=[f,g+t]}i.sort(function(T,S){return T[1]-S[1]});var v={};for(o=0;o!=s;++o){if(r.l!==i[o][1]){var x=!0;if(o>0&&e)switch(e[i[o-1][0]].t){case 2:r.l+2===i[o][1]&&(r.l+=2,x=!1);break;case 80:r.l<=i[o][1]&&(r.l=i[o][1],x=!1);break;case 4108:r.l<=i[o][1]&&(r.l=i[o][1],x=!1);break}if((!e||o==0)&&r.l<=i[o][1]&&(x=!1,r.l=i[o][1]),x)throw new Error("Read Error: Expected address "+i[o][1]+" at "+r.l+" :"+o)}if(e){var y=e[i[o][0]];if(v[y.n]=ef(r,y.t,{raw:!0}),y.p==="version"&&(v[y.n]=String(v[y.n]>>16)+"."+("0000"+String(v[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(v[y.n]){case 0:v[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:js(c=v[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[y.n])}}else if(i[o][0]===1){if(c=v.CodePage=ef(r,Mm),js(c),u!==-1){var _=r.l;r.l=i[u][1],d=ub(r,c),r.l=_}}else if(i[o][0]===0){if(c===0){u=o,r.l=i[o+1][1];continue}d=ub(r,c)}else{var w=d[i[o][0]],A;switch(r[r.l]){case 65:r.l+=4,A=GE(r);break;case 30:r.l+=4,A=Ig(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 31:r.l+=4,A=Ig(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,A=r.read_shift(4,"i");break;case 19:r.l+=4,A=r.read_shift(4);break;case 5:r.l+=4,A=r.read_shift(8,"f");break;case 11:r.l+=4,A=xr(r,4);break;case 64:r.l+=4,A=Hr(Lm(r));break;default:throw new Error("unparsed value: "+r[r.l])}v[w]=A}}return r.l=t+a,v}function db(r,e,t){var a=r.content;if(!a)return{};Jr(a,0);var s,i,o,c,u=0;a.chk("feff","Byte Order: "),a.read_shift(2);var d=a.read_shift(4),f=a.read_shift(16);if(f!==xt.utils.consts.HEADER_CLSID&&f!==t)throw new Error("Bad PropertySet CLSID "+f);if(s=a.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=a.read_shift(16),c=a.read_shift(4),s===1&&c!==a.l)throw new Error("Length mismatch: "+c+" !== "+a.l);s===2&&(o=a.read_shift(16),u=a.read_shift(4));var g=hb(a,e),v={SystemIdentifier:d};for(var x in g)v[x]=g[x];if(v.FMTID=i,s===1)return v;if(u-a.l==2&&(a.l+=2),a.l!==u)throw new Error("Length mismatch 2: "+a.l+" !== "+u);var y;try{y=hb(a,null)}catch{}for(x in y)v[x]=y[x];return v.FMTID=[i,o],v}function li(r,e){return r.read_shift(e),null}function f3(r,e,t){for(var a=[],s=r.l+e;r.l<s;)a.push(t(r,s-r.l));if(s!==r.l)throw new Error("Slurp error");return a}function xr(r,e){return r.read_shift(e)===1}function Nr(r){return r.read_shift(2,"u")}function VE(r,e){return f3(r,e,Nr)}function p3(r){var e=r.read_shift(1),t=r.read_shift(1);return t===1?e:e===1}function Uu(r,e,t){var a=r.read_shift(t&&t.biff>=12?2:1),s="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var i=r.read_shift(1);i&&(s="dbcs-cont")}else t.biff==12&&(s="wstr");t.biff>=2&&t.biff<=5&&(s="cpstr");var o=a?r.read_shift(a,s):"";return o}function g3(r){var e=r.read_shift(2),t=r.read_shift(1),a=t&4,s=t&8,i=1+(t&1),o=0,c,u={};s&&(o=r.read_shift(2)),a&&(c=r.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",f=e===0?"":r.read_shift(e,d);return s&&(r.l+=4*o),a&&(r.l+=c),u.t=f,s||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function lo(r,e,t){var a;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var s=r.read_shift(1);return s===0?a=r.read_shift(e,"sbcs-cont"):a=r.read_shift(e,"dbcs-cont"),a}function zu(r,e,t){var a=r.read_shift(t&&t.biff==2?1:2);return a===0?(r.l++,""):lo(r,a,t)}function xo(r,e,t){if(t.biff>5)return zu(r,e,t);var a=r.read_shift(1);return a===0?(r.l++,""):r.read_shift(a,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function m3(r){var e=r.read_shift(1);r.l++;var t=r.read_shift(2);return r.l+=2,[e,t]}function v3(r){var e=r.read_shift(4),t=r.l,a=!1;e>24&&(r.l+=e-24,r.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),r.l=t);var s=r.read_shift((a?e-24:e)>>1,"utf16le").replace(va,"");return a&&(r.l+=24),s}function x3(r){for(var e=r.read_shift(2),t="";e-- >0;)t+="../";var a=r.read_shift(0,"lpstr-ansi");if(r.l+=2,r.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=r.read_shift(4);if(s===0)return t+a.replace(/\\/g,"/");var i=r.read_shift(4);if(r.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=r.read_shift(i>>1,"utf16le").replace(va,"");return t+o}function _3(r,e){var t=r.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return v3(r);case"0303000000000000c000000000000046":return x3(r);default:throw new Error("Unsupported Moniker "+t)}}function Ed(r){var e=r.read_shift(4),t=e>0?r.read_shift(e,"utf16le").replace(va,""):"";return t}function y3(r,e){var t=r.l+e,a=r.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var s=r.read_shift(2);r.l+=2;var i,o,c,u,d="",f,g;s&16&&(i=Ed(r,t-r.l)),s&128&&(o=Ed(r,t-r.l)),(s&257)===257&&(c=Ed(r,t-r.l)),(s&257)===1&&(u=_3(r,t-r.l)),s&8&&(d=Ed(r,t-r.l)),s&32&&(f=r.read_shift(16)),s&64&&(g=Lm(r)),r.l=t;var v=o||c||u||"";v&&d&&(v+="#"+d),v||(v="#"+d),s&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var x={Target:v};return f&&(x.guid=f),g&&(x.time=g),i&&(x.Tooltip=i),x}function qE(r){var e=r.read_shift(1),t=r.read_shift(1),a=r.read_shift(1),s=r.read_shift(1);return[e,t,a,s]}function WE(r,e){var t=qE(r);return t[3]=0,t}function sn(r){var e=r.read_shift(2),t=r.read_shift(2),a=r.read_shift(2);return{r:e,c:t,ixfe:a}}function b3(r){var e=r.read_shift(2),t=r.read_shift(2);return r.l+=8,{type:e,flags:t}}function w3(r,e,t){return e===0?"":xo(r,e,t)}function E3(r,e,t){var a=t.biff>8?4:2,s=r.read_shift(a),i=r.read_shift(a,"i"),o=r.read_shift(a,"i");return[s,i,o]}function XE(r){var e=r.read_shift(2),t=Fm(r);return[e,t]}function A3(r,e,t){r.l+=4,e-=4;var a=r.l+e,s=Uu(r,e,t),i=r.read_shift(2);if(a-=r.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return r.l+=i,s}function mf(r){var e=r.read_shift(2),t=r.read_shift(2),a=r.read_shift(2),s=r.read_shift(2);return{s:{c:a,r:e},e:{c:s,r:t}}}function YE(r){var e=r.read_shift(2),t=r.read_shift(2),a=r.read_shift(1),s=r.read_shift(1);return{s:{c:a,r:e},e:{c:s,r:t}}}var S3=YE;function KE(r){r.l+=4;var e=r.read_shift(2),t=r.read_shift(2),a=r.read_shift(2);return r.l+=12,[t,e,a]}function T3(r){var e={};return r.l+=4,r.l+=16,e.fSharedNote=r.read_shift(2),r.l+=4,e}function C3(r){var e={};return r.l+=4,r.cf=r.read_shift(2),e}function ra(r){r.l+=2,r.l+=r.read_shift(2)}var k3={0:ra,4:ra,5:ra,6:ra,7:C3,8:ra,9:ra,10:ra,11:ra,12:ra,13:T3,14:ra,15:ra,16:ra,17:ra,18:ra,19:ra,20:ra,21:KE};function N3(r,e){for(var t=r.l+e,a=[];r.l<t;){var s=r.read_shift(2);r.l-=2;try{a.push(k3[s](r,t-r.l))}catch{return r.l=t,a}}return r.l!=t&&(r.l=t),a}function Ad(r,e){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=r.read_shift(2),e-=2,e>=2&&(t.dt=r.read_shift(2),r.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return r.read_shift(e),t}function R3(r,e){return e===0||r.read_shift(2),1200}function O3(r,e,t){if(t.enc)return r.l+=e,"";var a=r.l,s=xo(r,0,t);return r.read_shift(e+a-r.l),s}function D3(r,e,t){var a=t&&t.biff==8||e==2?r.read_shift(2):(r.l+=e,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function F3(r,e,t){var a=r.read_shift(4),s=r.read_shift(1)&3,i=r.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=Uu(r,0,t);return o.length===0&&(o="Sheet1"),{pos:a,hs:s,dt:i,name:o}}function M3(r,e){for(var t=r.l+e,a=r.read_shift(4),s=r.read_shift(4),i=[],o=0;o!=s&&r.l<t;++o)i.push(g3(r));return i.Count=a,i.Unique=s,i}function L3(r,e){var t={};return t.dsst=r.read_shift(2),r.l+=e-2,t}function I3(r){var e={};e.r=r.read_shift(2),e.c=r.read_shift(2),e.cnt=r.read_shift(2)-e.c;var t=r.read_shift(2);r.l+=4;var a=r.read_shift(1);return r.l+=3,a&7&&(e.level=a&7),a&32&&(e.hidden=!0),a&64&&(e.hpt=t/20),e}function j3(r){var e=b3(r);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var t=r.read_shift(4);return t!==0}function P3(r){return r.read_shift(2),r.read_shift(4)}function fb(r,e,t){var a=0;t&&t.biff==2||(a=r.read_shift(2));var s=r.read_shift(2);t&&t.biff==2&&(a=1-(s>>15),s&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,s]}function B3(r){var e=r.read_shift(2),t=r.read_shift(2),a=r.read_shift(2),s=r.read_shift(2),i=r.read_shift(2),o=r.read_shift(2),c=r.read_shift(2),u=r.read_shift(2),d=r.read_shift(2);return{Pos:[e,t],Dim:[a,s],Flags:i,CurTab:o,FirstTab:c,Selected:u,TabRatio:d}}function U3(r,e,t){if(t&&t.biff>=2&&t.biff<5)return{};var a=r.read_shift(2);return{RTL:a&64}}function z3(){}function H3(r,e,t){var a={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10;break}return a.name=Uu(r,0,t),a}function $3(r){var e=sn(r);return e.isst=r.read_shift(4),e}function G3(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var a=r.l+e,s=sn(r);t.biff==2&&r.l++;var i=zu(r,a-r.l,t);return s.val=i,s}function V3(r,e,t){var a=r.read_shift(2),s=xo(r,0,t);return[a,s]}var q3=xo;function pb(r,e,t){var a=r.l+e,s=t.biff==8||!t.biff?4:2,i=r.read_shift(s),o=r.read_shift(s),c=r.read_shift(2),u=r.read_shift(2);return r.l=a,{s:{r:i,c},e:{r:o,c:u}}}function W3(r){var e=r.read_shift(2),t=r.read_shift(2),a=XE(r);return{r:e,c:t,ixfe:a[0],rknum:a[1]}}function X3(r,e){for(var t=r.l+e-2,a=r.read_shift(2),s=r.read_shift(2),i=[];r.l<t;)i.push(XE(r));if(r.l!==t)throw new Error("MulRK read error");var o=r.read_shift(2);if(i.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:a,c:s,C:o,rkrec:i}}function Y3(r,e){for(var t=r.l+e-2,a=r.read_shift(2),s=r.read_shift(2),i=[];r.l<t;)i.push(r.read_shift(2));if(r.l!==t)throw new Error("MulBlank read error");var o=r.read_shift(2);if(i.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:a,c:s,C:o,ixfe:i}}function K3(r,e,t,a){var s={},i=r.read_shift(4),o=r.read_shift(4),c=r.read_shift(4),u=r.read_shift(2);return s.patternType=W4[c>>26],a.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=c&127,s.icvBottom=c>>7&127,s.icvDiag=c>>14&127,s.dgDiag=c>>21&15,s.icvFore=u&127,s.icvBack=u>>7&127,s.fsxButton=u>>14&1),s}function J3(r,e,t){var a={};return a.ifnt=r.read_shift(2),a.numFmtId=r.read_shift(2),a.flags=r.read_shift(2),a.fStyle=a.flags>>2&1,e-=6,a.data=K3(r,e,a.fStyle,t),a}function Q3(r){r.l+=4;var e=[r.read_shift(2),r.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function gb(r,e,t){var a=sn(r);(t.biff==2||e==9)&&++r.l;var s=p3(r);return a.val=s,a.t=s===!0||s===!1?"b":"e",a}function Z3(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var a=sn(r),s=sa(r);return a.val=s,a}var mb=w3;function eF(r,e,t){var a=r.l+e,s=r.read_shift(2),i=r.read_shift(2);if(t.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=lo(r,i),c=[];a>r.l;)c.push(zu(r));return[i,s,o,c]}function vb(r,e,t){var a=r.read_shift(2),s,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return t.sbcch===14849&&(s=A3(r,e-2,t)),i.body=s||r.read_shift(e-2),typeof s=="string"&&(i.Name=s),i}var tF=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function xb(r,e,t){var a=r.l+e,s=r.read_shift(2),i=r.read_shift(1),o=r.read_shift(1),c=r.read_shift(t&&t.biff==2?1:2),u=0;(!t||t.biff>=5)&&(t.biff!=5&&(r.l+=2),u=r.read_shift(2),t.biff==5&&(r.l+=2),r.l+=4);var d=lo(r,o,t);s&32&&(d=tF[d.charCodeAt(0)]);var f=a-r.l;t&&t.biff==2&&--f;var g=a==r.l||c===0||!(f>0)?[]:II(r,f,t,c);return{chKey:i,Name:d,itab:u,rgce:g}}function JE(r,e,t){if(t.biff<8)return rF(r,e,t);for(var a=[],s=r.l+e,i=r.read_shift(t.biff>8?4:2);i--!==0;)a.push(E3(r,t.biff>8?12:6,t));if(r.l!=s)throw new Error("Bad ExternSheet: "+r.l+" != "+s);return a}function rF(r,e,t){r[r.l+1]==3&&r[r.l]++;var a=Uu(r,e,t);return a.charCodeAt(0)==3?a.slice(1):a}function aF(r,e,t){if(t.biff<8){r.l+=e;return}var a=r.read_shift(2),s=r.read_shift(2),i=lo(r,a,t),o=lo(r,s,t);return[i,o]}function sF(r,e,t){var a=YE(r);r.l++;var s=r.read_shift(1);return e-=8,[jI(r,e,t),s,a]}function _b(r,e,t){var a=S3(r);switch(t.biff){case 2:r.l++,e-=7;break;case 3:case 4:r.l+=2,e-=8;break;default:r.l+=6,e-=12}return[a,MI(r,e,t)]}function nF(r){var e=r.read_shift(4)!==0,t=r.read_shift(4)!==0,a=r.read_shift(4);return[e,t,a]}function iF(r,e,t){if(!(t.biff<8)){var a=r.read_shift(2),s=r.read_shift(2),i=r.read_shift(2),o=r.read_shift(2),c=xo(r,0,t);return t.biff<8&&r.read_shift(1),[{r:a,c:s},c,o,i]}}function oF(r,e,t){return iF(r,e,t)}function lF(r,e){for(var t=[],a=r.read_shift(2);a--;)t.push(mf(r));return t}function cF(r,e,t){if(t&&t.biff<8)return hF(r,e,t);var a=KE(r),s=N3(r,e-22,a[1]);return{cmo:a,ft:s}}var uF={8:function(r,e){var t=r.l+e;r.l+=10;var a=r.read_shift(2);r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4;var s=r.read_shift(1);return r.l+=s,r.l=t,{fmt:a}}};function hF(r,e,t){r.l+=4;var a=r.read_shift(2),s=r.read_shift(2),i=r.read_shift(2);r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=6,e-=36;var o=[];return o.push((uF[a]||oa)(r,e,t)),{cmo:[s,a,i],ft:o}}function dF(r,e,t){var a=r.l,s="";try{r.l+=4;var i=(t.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?r.l+=6:o=m3(r,6,t);var c=r.read_shift(2);r.read_shift(2),Nr(r,2);var u=r.read_shift(2);r.l+=u;for(var d=1;d<r.lens.length-1;++d){if(r.l-a!=r.lens[d])throw new Error("TxO: bad continue record");var f=r[r.l],g=lo(r,r.lens[d+1]-r.lens[d]-1);if(s+=g,s.length>=(f?c:2*c))break}if(s.length!==c&&s.length!==c*2)throw new Error("cchText: "+c+" != "+s.length);return r.l=a+e,{t:s}}catch{return r.l=a+e,{t:s}}}function fF(r,e){var t=mf(r);r.l+=16;var a=y3(r,e-24);return[t,a]}function pF(r,e){r.read_shift(2);var t=mf(r),a=r.read_shift((e-10)/2,"dbcs-cont");return a=a.replace(va,""),[t,a]}function gF(r){var e=[0,0],t;return t=r.read_shift(2),e[0]=lb[t]||t,t=r.read_shift(2),e[1]=lb[t]||t,e}function mF(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(WE(r));return t}function vF(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(WE(r));return t}function xF(r){r.l+=2;var e={cxfs:0,crc:0};return e.cxfs=r.read_shift(2),e.crc=r.read_shift(4),e}function QE(r,e,t){if(!t.cellStyles)return oa(r,e);var a=t&&t.biff>=12?4:2,s=r.read_shift(a),i=r.read_shift(a),o=r.read_shift(a),c=r.read_shift(a),u=r.read_shift(2);a==2&&(r.l+=2);var d={s,e:i,w:o,ixfe:c,flags:u};return(t.biff>=5||!t.biff)&&(d.level=u>>8&7),d}function _F(r,e){var t={};return e<32||(r.l+=16,t.header=sa(r),t.footer=sa(r),r.l+=2),t}function yF(r,e,t){var a={area:!1};if(t.biff!=5)return r.l+=e,a;var s=r.read_shift(1);return r.l+=3,s&16&&(a.area=!0),a}var bF=sn,wF=VE,EF=zu;function AF(r){var e=r.read_shift(2),t=r.read_shift(2),a=r.read_shift(4),s={fmt:e,env:t,len:a,data:r.slice(r.l,r.l+a)};return r.l+=a,s}function SF(r,e,t){t.biffguess&&t.biff==5&&(t.biff=2);var a=sn(r);++r.l;var s=xo(r,e-7,t);return a.t="str",a.val=s,a}function TF(r){var e=sn(r);++r.l;var t=sa(r);return e.t="n",e.val=t,e}function CF(r){var e=sn(r);++r.l;var t=r.read_shift(2);return e.t="n",e.val=t,e}function kF(r){var e=r.read_shift(1);return e===0?(r.l++,""):r.read_shift(e,"sbcs-cont")}function NF(r,e){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=e-13}function RF(r,e,t){var a=r.l+e,s=sn(r),i=r.read_shift(2),o=lo(r,i,t);return r.l=a,s.t="str",s.val=o,s}var OF=[2,3,48,49,131,139,140,245],yb=(function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Am({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,u){var d=[],f=xi(1);switch(u.type){case"base64":f=Is(Ka(c));break;case"binary":f=Is(c);break;case"buffer":case"array":f=c;break}Jr(f,0);var g=f.read_shift(1),v=!!(g&136),x=!1,y=!1;switch(g){case 2:break;case 3:break;case 48:x=!0,v=!0;break;case 49:x=!0,v=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var _=0,w=521;g==2&&(_=f.read_shift(2)),f.l+=3,g!=2&&(_=f.read_shift(4)),_>1048576&&(_=1e6),g!=2&&(w=f.read_shift(2));var A=f.read_shift(2),T=u.codepage||1252;g!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(T=r[f[f.l]]),f.l+=1,f.l+=2),y&&(f.l+=36);for(var S=[],N={},R=Math.min(f.length,g==2?521:w-10-(x?264:0)),O=y?32:11;f.l<R&&f[f.l]!=13;)switch(N={},N.name=_u.utils.decode(T,f.slice(f.l,f.l+O)).replace(/[\u0000\r\n].*$/g,""),f.l+=O,N.type=String.fromCharCode(f.read_shift(1)),g!=2&&!y&&(N.offset=f.read_shift(4)),N.len=f.read_shift(1),g==2&&(N.offset=f.read_shift(2)),N.dec=f.read_shift(1),N.name.length&&S.push(N),g!=2&&(f.l+=y?13:14),N.type){case"B":(!x||N.len!=8)&&u.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(f[f.l]!==13&&(f.l=w-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=w;var C=0,j=0;for(d[0]=[],j=0;j!=S.length;++j)d[0][j]=S[j].name;for(;_-- >0;){if(f[f.l]===42){f.l+=A;continue}for(++f.l,d[++C]=[],j=0,j=0;j!=S.length;++j){var I=f.slice(f.l,f.l+S[j].len);f.l+=S[j].len,Jr(I,0);var W=_u.utils.decode(T,I);switch(S[j].type){case"C":W.trim().length&&(d[C][j]=W.replace(/\s+$/,""));break;case"D":W.length===8?d[C][j]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):d[C][j]=W;break;case"F":d[C][j]=parseFloat(W.trim());break;case"+":case"I":d[C][j]=y?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":d[C][j]=!0;break;case"N":case"F":d[C][j]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));d[C][j]="##MEMO##"+(y?parseInt(W.trim(),10):I.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(d[C][j]=+W||0);break;case"@":d[C][j]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":d[C][j]=new Date((I.read_shift(4)-2440588)*864e5+I.read_shift(4));break;case"Y":d[C][j]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[C][j]=-I.read_shift(-8,"f");break;case"B":if(x&&S[j].len==8){d[C][j]=I.read_shift(8,"f");break}case"G":case"P":I.l+=S[j].len;break;case"0":if(S[j].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[j].type)}}}if(g!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return u&&u.sheetRows&&(d=d.slice(0,u.sheetRows)),u.DBF=S,d}function a(c,u){var d=u||{};d.dateNF||(d.dateNF="yyyymmdd");var f=Vl(t(c,d),d);return f["!cols"]=d.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete d.DBF,f}function s(c,u){try{return Ei(a(c,u),u)}catch(d){if(u&&u.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,u){var d=u||{};if(+d.codepage>=0&&js(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var f=Fg(),g=$g(c,{header:1,raw:!0,cellDates:!0}),v=g[0],x=g.slice(1),y=c["!cols"]||[],_=0,w=0,A=0,T=1;for(_=0;_<v.length;++_){if(((y[_]||{}).DBF||{}).name){v[_]=y[_].DBF.name,++A;continue}if(v[_]!=null){if(++A,typeof v[_]=="number"&&(v[_]=v[_].toString(10)),typeof v[_]!="string")throw new Error("DBF Invalid column name "+v[_]+" |"+typeof v[_]+"|");if(v.indexOf(v[_])!==_){for(w=0;w<1024;++w)if(v.indexOf(v[_]+"_"+w)==-1){v[_]+="_"+w;break}}}}var S=pr(c["!ref"]),N=[],R=[],O=[];for(_=0;_<=S.e.c-S.s.c;++_){var C="",j="",I=0,W=[];for(w=0;w<x.length;++w)x[w][_]!=null&&W.push(x[w][_]);if(W.length==0||v[_]==null){N[_]="?";continue}for(w=0;w<W.length;++w){switch(typeof W[w]){case"number":j="B";break;case"string":j="C";break;case"boolean":j="L";break;case"object":j=W[w]instanceof Date?"D":"C";break;default:j="C"}I=Math.max(I,String(W[w]).length),C=C&&C!=j?"C":j}I>250&&(I=250),j=((y[_]||{}).DBF||{}).type,j=="C"&&y[_].DBF.len>I&&(I=y[_].DBF.len),C=="B"&&j=="N"&&(C="N",O[_]=y[_].DBF.dec,I=y[_].DBF.len),R[_]=C=="C"||j=="N"?I:i[C]||0,T+=R[_],N[_]=C}var H=f.next(32);for(H.write_shift(4,318902576),H.write_shift(4,x.length),H.write_shift(2,296+32*A),H.write_shift(2,T),_=0;_<4;++_)H.write_shift(4,0);for(H.write_shift(4,0|(+e[Jw]||3)<<8),_=0,w=0;_<v.length;++_)if(v[_]!=null){var D=f.next(32),z=(v[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,z,"sbcs"),D.write_shift(1,N[_]=="?"?"C":N[_],"sbcs"),D.write_shift(4,w),D.write_shift(1,R[_]||i[N[_]]||0),D.write_shift(1,O[_]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),w+=R[_]||i[N[_]]||0}var ne=f.next(264);for(ne.write_shift(4,13),_=0;_<65;++_)ne.write_shift(4,0);for(_=0;_<x.length;++_){var re=f.next(T);for(re.write_shift(1,0),w=0;w<v.length;++w)if(v[w]!=null)switch(N[w]){case"L":re.write_shift(1,x[_][w]==null?63:x[_][w]?84:70);break;case"B":re.write_shift(8,x[_][w]||0,"f");break;case"N":var U="0";for(typeof x[_][w]=="number"&&(U=x[_][w].toFixed(O[w]||0)),A=0;A<R[w]-U.length;++A)re.write_shift(1,32);re.write_shift(1,U,"sbcs");break;case"D":x[_][w]?(re.write_shift(4,("0000"+x[_][w].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(x[_][w].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+x[_][w].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var te=String(x[_][w]!=null?x[_][w]:"").slice(0,R[w]);for(re.write_shift(1,te,"sbcs"),A=0;A<R[w]-te.length;++A)re.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:a,from_sheet:o}})(),DF=(function(){var r={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+tn(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(v,x){var y=r[x];return typeof y=="number"?Iy(y):y},a=function(v,x,y){var _=x.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return _==59?v:Iy(_)};r["|"]=254;function s(v,x){switch(x.type){case"base64":return i(Ka(v),x);case"binary":return i(v,x);case"buffer":return i(vt&&Buffer.isBuffer(v)?v.toString("binary"):po(v),x);case"array":return i(oo(v),x)}throw new Error("Unrecognized type "+x.type)}function i(v,x){var y=v.split(/[\n\r]+/),_=-1,w=-1,A=0,T=0,S=[],N=[],R=null,O={},C=[],j=[],I=[],W=0,H;for(+x.codepage>=0&&js(+x.codepage);A!==y.length;++A){W=0;var D=y[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(e,t),z=D.replace(/;;/g,"\0").split(";").map(function(Y){return Y.replace(/\u0000/g,";")}),ne=z[0],re;if(D.length>0)switch(ne){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":z[1].charAt(0)=="P"&&N.push(D.slice(3).replace(/;;/g,";"));break;case"C":var U=!1,te=!1,be=!1,se=!1,ke=-1,q=-1;for(T=1;T<z.length;++T)switch(z[T].charAt(0)){case"A":break;case"X":w=parseInt(z[T].slice(1))-1,te=!0;break;case"Y":for(_=parseInt(z[T].slice(1))-1,te||(w=0),H=S.length;H<=_;++H)S[H]=[];break;case"K":re=z[T].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(Bs(re))?isNaN(Il(re).getDate())||(re=Hr(re)):(re=Bs(re),R!==null&&$l(R)&&(re=gf(re))),U=!0;break;case"E":se=!0;var F=Rl(z[T].slice(1),{r:_,c:w});S[_][w]=[S[_][w],F];break;case"S":be=!0,S[_][w]=[S[_][w],"S5S"];break;case"G":break;case"R":ke=parseInt(z[T].slice(1))-1;break;case"C":q=parseInt(z[T].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+D)}if(U&&(S[_][w]&&S[_][w].length==2?S[_][w][0]=re:S[_][w]=re,R=null),be){if(se)throw new Error("SYLK shared formula cannot have own formula");var J=ke>-1&&S[ke][q];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");S[_][w][1]=lA(J[1],{r:_-ke,c:w-q})}break;case"F":var K=0;for(T=1;T<z.length;++T)switch(z[T].charAt(0)){case"X":w=parseInt(z[T].slice(1))-1,++K;break;case"Y":for(_=parseInt(z[T].slice(1))-1,H=S.length;H<=_;++H)S[H]=[];break;case"M":W=parseInt(z[T].slice(1))/20;break;case"F":break;case"G":break;case"P":R=N[parseInt(z[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(I=z[T].slice(1).split(" "),H=parseInt(I[0],10);H<=parseInt(I[1],10);++H)W=parseInt(I[2],10),j[H-1]=W===0?{hidden:!0}:{wch:W},jl(j[H-1]);break;case"C":w=parseInt(z[T].slice(1))-1,j[w]||(j[w]={});break;case"R":_=parseInt(z[T].slice(1))-1,C[_]||(C[_]={}),W>0?(C[_].hpt=W,C[_].hpx=Su(W)):W===0&&(C[_].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+D)}K<1&&(R=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+D)}}return C.length>0&&(O["!rows"]=C),j.length>0&&(O["!cols"]=j),x&&x.sheetRows&&(S=S.slice(0,x.sheetRows)),[S,O]}function o(v,x){var y=s(v,x),_=y[0],w=y[1],A=Vl(_,x);return tn(w).forEach(function(T){A[T]=w[T]}),A}function c(v,x){return Ei(o(v,x),x)}function u(v,x,y,_){var w="C;Y"+(y+1)+";X"+(_+1)+";K";switch(v.t){case"n":w+=v.v||0,v.f&&!v.F&&(w+=";E"+xL(v.f,{r:y,c:_}));break;case"b":w+=v.v?"TRUE":"FALSE";break;case"e":w+=v.w||v.v;break;case"d":w+='"'+(v.w||v.v)+'"';break;case"s":w+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function d(v,x){x.forEach(function(y,_){var w="F;W"+(_+1)+" "+(_+1)+" ";y.hidden?w+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=rf(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=af(y.wpx)),typeof y.wch=="number"&&(w+=Math.round(y.wch))),w.charAt(w.length-1)!=" "&&v.push(w)})}function f(v,x){x.forEach(function(y,_){var w="F;";y.hidden?w+="M0;":y.hpt?w+="M"+20*y.hpt+";":y.hpx&&(w+="M"+20*nA(y.hpx)+";"),w.length>2&&v.push(w+"R"+(_+1))})}function g(v,x){var y=["ID;PWXL;N;E"],_=[],w=pr(v["!ref"]),A,T=Array.isArray(v),S=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),v["!cols"]&&d(y,v["!cols"]),v["!rows"]&&f(y,v["!rows"]),y.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var N=w.s.r;N<=w.e.r;++N)for(var R=w.s.c;R<=w.e.c;++R){var O=Qe({r:N,c:R});A=T?(v[N]||[])[R]:v[O],!(!A||A.v==null&&(!A.f||A.F))&&_.push(u(A,v,N,R))}return y.join(S)+S+_.join(S)+S+"E"+S}return{to_workbook:c,to_sheet:o,from_sheet:g}})(),FF=(function(){function r(i,o){switch(o.type){case"base64":return e(Ka(i),o);case"binary":return e(i,o);case"buffer":return e(vt&&Buffer.isBuffer(i)?i.toString("binary"):po(i),o);case"array":return e(oo(i),o)}throw new Error("Unrecognized type "+o.type)}function e(i,o){for(var c=i.split(`
`),u=-1,d=-1,f=0,g=[];f!==c.length;++f){if(c[f].trim()==="BOT"){g[++u]=[],d=0;continue}if(!(u<0)){var v=c[f].trim().split(","),x=v[0],y=v[1];++f;for(var _=c[f]||"";(_.match(/["]/g)||[]).length&1&&f<c.length-1;)_+=`
`+c[++f];switch(_=_.trim(),+x){case-1:if(_==="BOT"){g[++u]=[],d=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?g[u][d]=!0:_==="FALSE"?g[u][d]=!1:isNaN(Bs(y))?isNaN(Il(y).getDate())?g[u][d]=y:g[u][d]=Hr(y):g[u][d]=Bs(y),++d;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),g[u][d++]=_!==""?_:null;break}if(_==="EOD")break}}return o&&o.sheetRows&&(g=g.slice(0,o.sheetRows)),g}function t(i,o){return Vl(r(i,o),o)}function a(i,o){return Ei(t(i,o),o)}var s=(function(){var i=function(u,d,f,g,v){u.push(d),u.push(f+","+g),u.push('"'+v.replace(/"/g,'""')+'"')},o=function(u,d,f,g){u.push(d+","+f),u.push(d==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(u){var d=[],f=pr(u["!ref"]),g,v=Array.isArray(u);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,f.e.r-f.s.r+1,""),i(d,"TUPLES",0,f.e.c-f.s.c+1,""),i(d,"DATA",0,0,"");for(var x=f.s.r;x<=f.e.r;++x){o(d,-1,0,"BOT");for(var y=f.s.c;y<=f.e.c;++y){var _=Qe({r:x,c:y});if(g=v?(u[x]||[])[y]:u[_],!g){o(d,1,0,"");continue}switch(g.t){case"n":var w=g.w;!w&&g.v!=null&&(w=g.v),w==null?g.f&&!g.F?o(d,1,0,"="+g.f):o(d,1,0,""):o(d,0,w,"V");break;case"b":o(d,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=_s(g.z||it[14],xa(Hr(g.v)))),o(d,0,g.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var A=`\r
`,T=d.join(A);return T}})();return{to_workbook:a,to_sheet:t,from_sheet:s}})(),MF=(function(){function r(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(g,v){for(var x=g.split(`
`),y=-1,_=-1,w=0,A=[];w!==x.length;++w){var T=x[w].trim().split(":");if(T[0]==="cell"){var S=ga(T[1]);if(A.length<=S.r)for(y=A.length;y<=S.r;++y)A[y]||(A[y]=[]);switch(y=S.r,_=S.c,T[2]){case"t":A[y][_]=r(T[3]);break;case"v":A[y][_]=+T[3];break;case"vtf":var N=T[T.length-1];case"vtc":T[3]==="nl"?A[y][_]=!!+T[4]:A[y][_]=+T[4],T[2]=="vtf"&&(A[y][_]=[A[y][_],N])}}}return v&&v.sheetRows&&(A=A.slice(0,v.sheetRows)),A}function a(g,v){return Vl(t(g,v),v)}function s(g,v){return Ei(a(g,v),v)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function d(g){if(!g||!g["!ref"])return"";for(var v=[],x=[],y,_="",w=Gl(g["!ref"]),A=Array.isArray(g),T=w.s.r;T<=w.e.r;++T)for(var S=w.s.c;S<=w.e.c;++S)if(_=Qe({r:T,c:S}),y=A?(g[T]||[])[S]:g[_],!(!y||y.v==null||y.t==="z")){switch(x=["cell",_,"t"],y.t){case"s":case"str":x.push(e(y.v));break;case"n":y.f?(x[2]="vtf",x[3]="n",x[4]=y.v,x[5]=e(y.f)):(x[2]="v",x[3]=y.v);break;case"b":x[2]="vt"+(y.f?"f":"c"),x[3]="nl",x[4]=y.v?"1":"0",x[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var N=xa(Hr(y.v));x[2]="vtc",x[3]="nd",x[4]=""+N,x[5]=y.w||_s(y.z||it[14],N);break;case"e":continue}v.push(x.join(":"))}return v.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function f(g){return[i,o,c,o,d(g),u].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:f}})(),Eu=(function(){function r(f,g,v,x,y){y.raw?g[v][x]=f:f===""||(f==="TRUE"?g[v][x]=!0:f==="FALSE"?g[v][x]=!1:isNaN(Bs(f))?isNaN(Il(f).getDate())?g[v][x]=f:g[v][x]=Hr(f):g[v][x]=Bs(f))}function e(f,g){var v=g||{},x=[];if(!f||f.length===0)return x;for(var y=f.split(/[\r\n]/),_=y.length-1;_>=0&&y[_].length===0;)--_;for(var w=10,A=0,T=0;T<=_;++T)A=y[T].indexOf(" "),A==-1?A=y[T].length:A++,w=Math.max(w,A);for(T=0;T<=_;++T){x[T]=[];var S=0;for(r(y[T].slice(0,w).trim(),x,T,S,v),S=1;S<=(y[T].length-w)/10+1;++S)r(y[T].slice(w+(S-1)*10,w+S*10).trim(),x,T,S,v)}return v.sheetRows&&(x=x.slice(0,v.sheetRows)),x}var t={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(f){for(var g={},v=!1,x=0,y=0;x<f.length;++x)(y=f.charCodeAt(x))==34?v=!v:!v&&y in t&&(g[y]=(g[y]||0)+1);y=[];for(x in g)Object.prototype.hasOwnProperty.call(g,x)&&y.push([g[x],x]);if(!y.length){g=a;for(x in g)Object.prototype.hasOwnProperty.call(g,x)&&y.push([g[x],x])}return y.sort(function(_,w){return _[0]-w[0]||a[_[1]]-a[w[1]]}),t[y.pop()[1]]||44}function i(f,g){var v=g||{},x="",y=v.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(x=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(x=f.charAt(4),f=f.slice(6)):x=s(f.slice(0,1024)):v&&v.FS?x=v.FS:x=s(f.slice(0,1024));var w=0,A=0,T=0,S=0,N=0,R=x.charCodeAt(0),O=!1,C=0,j=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var I=v.dateNF!=null?VD(v.dateNF):null;function W(){var H=f.slice(S,N),D={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)D.t="z";else if(v.raw)D.t="s",D.v=H;else if(H.trim().length===0)D.t="s",D.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(D.t="s",D.v=H.slice(2,-1).replace(/""/g,'"')):yL(H)?(D.t="n",D.f=H.slice(1)):(D.t="s",D.v=H);else if(H=="TRUE")D.t="b",D.v=!0;else if(H=="FALSE")D.t="b",D.v=!1;else if(!isNaN(T=Bs(H)))D.t="n",v.cellText!==!1&&(D.w=H),D.v=T;else if(!isNaN(Il(H).getDate())||I&&H.match(I)){D.z=v.dateNF||it[14];var z=0;I&&H.match(I)&&(H=qD(H,v.dateNF,H.match(I)||[]),z=1),v.cellDates?(D.t="d",D.v=Hr(H,z)):(D.t="n",D.v=xa(Hr(H,z))),v.cellText!==!1&&(D.w=_s(D.z,D.v instanceof Date?xa(D.v):D.v)),v.cellNF||delete D.z}else D.t="s",D.v=H;if(D.t=="z"||(v.dense?(y[w]||(y[w]=[]),y[w][A]=D):y[Qe({c:A,r:w})]=D),S=N+1,j=f.charCodeAt(S),_.e.c<A&&(_.e.c=A),_.e.r<w&&(_.e.r=w),C==R)++A;else if(A=0,++w,v.sheetRows&&v.sheetRows<=w)return!0}e:for(;N<f.length;++N)switch(C=f.charCodeAt(N)){case 34:j===34&&(O=!O);break;case R:case 10:case 13:if(!O&&W())break e;break}return N-S>0&&W(),y["!ref"]=_t(_),y}function o(f,g){return!(g&&g.PRN)||g.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,g):Vl(e(f,g),g)}function c(f,g){var v="",x=g.type=="string"?[0,0,0,0]:$m(f,g);switch(g.type){case"base64":v=Ka(f);break;case"binary":v=f;break;case"buffer":g.codepage==65001?v=f.toString("utf8"):g.codepage&&typeof _u<"u"||(v=vt&&Buffer.isBuffer(f)?f.toString("binary"):po(f));break;case"array":v=oo(f);break;case"string":v=f;break;default:throw new Error("Unrecognized type "+g.type)}return x[0]==239&&x[1]==187&&x[2]==191?v=$t(v.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?v=$t(v):g.type=="binary"&&typeof _u<"u",v.slice(0,19)=="socialcalc:version:"?MF.to_sheet(g.type=="string"?v:$t(v),g):o(v,g)}function u(f,g){return Ei(c(f,g),g)}function d(f){for(var g=[],v=pr(f["!ref"]),x,y=Array.isArray(f),_=v.s.r;_<=v.e.r;++_){for(var w=[],A=v.s.c;A<=v.e.c;++A){var T=Qe({r:_,c:A});if(x=y?(f[_]||[])[A]:f[T],!x||x.v==null){w.push("          ");continue}for(var S=(x.w||(Mn(x),x.w)||"").slice(0,10);S.length<10;)S+=" ";w.push(S+(A===0?" ":""))}g.push(w.join(""))}return g.join(`
`)}return{to_workbook:u,to_sheet:c,from_sheet:d}})();function LF(r,e){var t=e||{},a=!!t.WTF;t.WTF=!0;try{var s=DF.to_workbook(r,t);return t.WTF=a,s}catch(i){if(t.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return Eu.to_workbook(r,e)}}var ou=(function(){function r(F,J,K){if(F){Jr(F,F.l||0);for(var Y=K.Enum||ke;F.l<F.length;){var oe=F.read_shift(2),ve=Y[oe]||Y[65535],Ne=F.read_shift(2),Ee=F.l+Ne,Ae=ve.f&&ve.f(F,Ne,K);if(F.l=Ee,J(Ae,ve,oe))return}}}function e(F,J){switch(J.type){case"base64":return t(Is(Ka(F)),J);case"binary":return t(Is(F),J);case"buffer":case"array":return t(F,J)}throw"Unsupported type "+J.type}function t(F,J){if(!F)return F;var K=J||{},Y=K.dense?[]:{},oe="Sheet1",ve="",Ne=0,Ee={},Ae=[],rt=[],Z={s:{r:0,c:0},e:{r:0,c:0}},Mt=K.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)K.Enum=ke,r(F,function(De,Yt,ea){switch(ea){case 0:K.vers=De,De>=4096&&(K.qpro=!0);break;case 6:Z=De;break;case 204:De&&(ve=De);break;case 222:ve=De;break;case 15:case 51:K.qpro||(De[1].v=De[1].v.slice(1));case 13:case 14:case 16:ea==14&&(De[2]&112)==112&&(De[2]&15)>1&&(De[2]&15)<15&&(De[1].z=K.dateNF||it[14],K.cellDates&&(De[1].t="d",De[1].v=gf(De[1].v))),K.qpro&&De[3]>Ne&&(Y["!ref"]=_t(Z),Ee[oe]=Y,Ae.push(oe),Y=K.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},Ne=De[3],oe=ve||"Sheet"+(Ne+1),ve="");var _a=K.dense?(Y[De[0].r]||[])[De[0].c]:Y[Qe(De[0])];if(_a){_a.t=De[1].t,_a.v=De[1].v,De[1].z!=null&&(_a.z=De[1].z),De[1].f!=null&&(_a.f=De[1].f);break}K.dense?(Y[De[0].r]||(Y[De[0].r]=[]),Y[De[0].r][De[0].c]=De[1]):Y[Qe(De[0])]=De[1];break}},K);else if(F[2]==26||F[2]==14)K.Enum=q,F[2]==14&&(K.qpro=!0,F.l=0),r(F,function(De,Yt,ea){switch(ea){case 204:oe=De;break;case 22:De[1].v=De[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(De[3]>Ne&&(Y["!ref"]=_t(Z),Ee[oe]=Y,Ae.push(oe),Y=K.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},Ne=De[3],oe="Sheet"+(Ne+1)),Mt>0&&De[0].r>=Mt)break;K.dense?(Y[De[0].r]||(Y[De[0].r]=[]),Y[De[0].r][De[0].c]=De[1]):Y[Qe(De[0])]=De[1],Z.e.c<De[0].c&&(Z.e.c=De[0].c),Z.e.r<De[0].r&&(Z.e.r=De[0].r);break;case 27:De[14e3]&&(rt[De[14e3][0]]=De[14e3][1]);break;case 1537:rt[De[0]]=De[1],De[0]==Ne&&(oe=De[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(Y["!ref"]=_t(Z),Ee[ve||oe]=Y,Ae.push(ve||oe),!rt.length)return{SheetNames:Ae,Sheets:Ee};for(var at={},At=[],ot=0;ot<rt.length;++ot)Ee[Ae[ot]]?(At.push(rt[ot]||Ae[ot]),at[rt[ot]]=Ee[rt[ot]]||Ee[Ae[ot]]):(At.push(rt[ot]),at[rt[ot]]={"!ref":"A1"});return{SheetNames:At,Sheets:at}}function a(F,J){var K=J||{};if(+K.codepage>=0&&js(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var Y=Fg(),oe=pr(F["!ref"]),ve=Array.isArray(F),Ne=[];Ns(Y,0,i(1030)),Ns(Y,6,u(oe));for(var Ee=Math.min(oe.e.r,8191),Ae=oe.s.r;Ae<=Ee;++Ae)for(var rt=Zr(Ae),Z=oe.s.c;Z<=oe.e.c;++Z){Ae===oe.s.r&&(Ne[Z]=Lr(Z));var Mt=Ne[Z]+rt,at=ve?(F[Ae]||[])[Z]:F[Mt];if(!(!at||at.t=="z"))if(at.t=="n")(at.v|0)==at.v&&at.v>=-32768&&at.v<=32767?Ns(Y,13,x(Ae,Z,at.v)):Ns(Y,14,_(Ae,Z,at.v));else{var At=Mn(at);Ns(Y,15,g(Ae,Z,At.slice(0,239)))}}return Ns(Y,1),Y.end()}function s(F,J){var K=J||{};if(+K.codepage>=0&&js(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var Y=Fg();Ns(Y,0,o(F));for(var oe=0,ve=0;oe<F.SheetNames.length;++oe)(F.Sheets[F.SheetNames[oe]]||{})["!ref"]&&Ns(Y,27,se(F.SheetNames[oe],ve++));var Ne=0;for(oe=0;oe<F.SheetNames.length;++oe){var Ee=F.Sheets[F.SheetNames[oe]];if(!(!Ee||!Ee["!ref"])){for(var Ae=pr(Ee["!ref"]),rt=Array.isArray(Ee),Z=[],Mt=Math.min(Ae.e.r,8191),at=Ae.s.r;at<=Mt;++at)for(var At=Zr(at),ot=Ae.s.c;ot<=Ae.e.c;++ot){at===Ae.s.r&&(Z[ot]=Lr(ot));var De=Z[ot]+At,Yt=rt?(Ee[at]||[])[ot]:Ee[De];if(!(!Yt||Yt.t=="z"))if(Yt.t=="n")Ns(Y,23,W(at,ot,Ne,Yt.v));else{var ea=Mn(Yt);Ns(Y,22,C(at,ot,Ne,ea.slice(0,239)))}}++Ne}}return Ns(Y,1),Y.end()}function i(F){var J=Mr(2);return J.write_shift(2,F),J}function o(F){var J=Mr(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var K=0,Y=0,oe=0,ve=0;ve<F.SheetNames.length;++ve){var Ne=F.SheetNames[ve],Ee=F.Sheets[Ne];if(!(!Ee||!Ee["!ref"])){++oe;var Ae=Gl(Ee["!ref"]);K<Ae.e.r&&(K=Ae.e.r),Y<Ae.e.c&&(Y=Ae.e.c)}}return K>8191&&(K=8191),J.write_shift(2,K),J.write_shift(1,oe),J.write_shift(1,Y),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function c(F,J,K){var Y={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&K.qpro?(Y.s.c=F.read_shift(1),F.l++,Y.s.r=F.read_shift(2),Y.e.c=F.read_shift(1),F.l++,Y.e.r=F.read_shift(2),Y):(Y.s.c=F.read_shift(2),Y.s.r=F.read_shift(2),J==12&&K.qpro&&(F.l+=2),Y.e.c=F.read_shift(2),Y.e.r=F.read_shift(2),J==12&&K.qpro&&(F.l+=2),Y.s.c==65535&&(Y.s.c=Y.e.c=Y.s.r=Y.e.r=0),Y)}function u(F){var J=Mr(8);return J.write_shift(2,F.s.c),J.write_shift(2,F.s.r),J.write_shift(2,F.e.c),J.write_shift(2,F.e.r),J}function d(F,J,K){var Y=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(Y[0].c=F.read_shift(1),Y[3]=F.read_shift(1),Y[0].r=F.read_shift(2),F.l+=2):(Y[2]=F.read_shift(1),Y[0].c=F.read_shift(2),Y[0].r=F.read_shift(2)),Y}function f(F,J,K){var Y=F.l+J,oe=d(F,J,K);if(oe[1].t="s",K.vers==20768){F.l++;var ve=F.read_shift(1);return oe[1].v=F.read_shift(ve,"utf8"),oe}return K.qpro&&F.l++,oe[1].v=F.read_shift(Y-F.l,"cstr"),oe}function g(F,J,K){var Y=Mr(7+K.length);Y.write_shift(1,255),Y.write_shift(2,J),Y.write_shift(2,F),Y.write_shift(1,39);for(var oe=0;oe<Y.length;++oe){var ve=K.charCodeAt(oe);Y.write_shift(1,ve>=128?95:ve)}return Y.write_shift(1,0),Y}function v(F,J,K){var Y=d(F,J,K);return Y[1].v=F.read_shift(2,"i"),Y}function x(F,J,K){var Y=Mr(7);return Y.write_shift(1,255),Y.write_shift(2,J),Y.write_shift(2,F),Y.write_shift(2,K,"i"),Y}function y(F,J,K){var Y=d(F,J,K);return Y[1].v=F.read_shift(8,"f"),Y}function _(F,J,K){var Y=Mr(13);return Y.write_shift(1,255),Y.write_shift(2,J),Y.write_shift(2,F),Y.write_shift(8,K,"f"),Y}function w(F,J,K){var Y=F.l+J,oe=d(F,J,K);if(oe[1].v=F.read_shift(8,"f"),K.qpro)F.l=Y;else{var ve=F.read_shift(2);N(F.slice(F.l,F.l+ve),oe),F.l+=ve}return oe}function A(F,J,K){var Y=J&32768;return J&=-32769,J=(Y?F:0)+(J>=8192?J-16384:J),(Y?"":"$")+(K?Lr(J):Zr(J))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(F,J){Jr(F,0);for(var K=[],Y=0,oe="",ve="",Ne="",Ee="";F.l<F.length;){var Ae=F[F.l++];switch(Ae){case 0:K.push(F.read_shift(8,"f"));break;case 1:ve=A(J[0].c,F.read_shift(2),!0),oe=A(J[0].r,F.read_shift(2),!1),K.push(ve+oe);break;case 2:{var rt=A(J[0].c,F.read_shift(2),!0),Z=A(J[0].r,F.read_shift(2),!1);ve=A(J[0].c,F.read_shift(2),!0),oe=A(J[0].r,F.read_shift(2),!1),K.push(rt+Z+":"+ve+oe)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(F.read_shift(2));break;case 6:{for(var Mt="";Ae=F[F.l++];)Mt+=String.fromCharCode(Ae);K.push('"'+Mt.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:Ee=K.pop(),Ne=K.pop(),K.push(["AND","OR"][Ae-20]+"("+Ne+","+Ee+")");break;default:if(Ae<32&&S[Ae])Ee=K.pop(),Ne=K.pop(),K.push(Ne+S[Ae]+Ee);else if(T[Ae]){if(Y=T[Ae][1],Y==69&&(Y=F[F.l++]),Y>K.length){console.error("WK1 bad formula parse 0x"+Ae.toString(16)+":|"+K.join("|")+"|");return}var at=K.slice(-Y);K.length-=Y,K.push(T[Ae][0]+"("+at.join(",")+")")}else return Ae<=7?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=24?console.error("WK1 unsupported op "+Ae.toString(16)):Ae<=30?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=115?console.error("WK1 unsupported function opcode "+Ae.toString(16)):console.error("WK1 unrecognized opcode "+Ae.toString(16))}}K.length==1?J[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function R(F){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=F.read_shift(2),J[3]=F[F.l++],J[0].c=F[F.l++],J}function O(F,J){var K=R(F);return K[1].t="s",K[1].v=F.read_shift(J-4,"cstr"),K}function C(F,J,K,Y){var oe=Mr(6+Y.length);oe.write_shift(2,F),oe.write_shift(1,K),oe.write_shift(1,J),oe.write_shift(1,39);for(var ve=0;ve<Y.length;++ve){var Ne=Y.charCodeAt(ve);oe.write_shift(1,Ne>=128?95:Ne)}return oe.write_shift(1,0),oe}function j(F,J){var K=R(F);K[1].v=F.read_shift(2);var Y=K[1].v>>1;if(K[1].v&1)switch(Y&7){case 0:Y=(Y>>3)*5e3;break;case 1:Y=(Y>>3)*500;break;case 2:Y=(Y>>3)/20;break;case 3:Y=(Y>>3)/200;break;case 4:Y=(Y>>3)/2e3;break;case 5:Y=(Y>>3)/2e4;break;case 6:Y=(Y>>3)/16;break;case 7:Y=(Y>>3)/64;break}return K[1].v=Y,K}function I(F,J){var K=R(F),Y=F.read_shift(4),oe=F.read_shift(4),ve=F.read_shift(2);if(ve==65535)return Y===0&&oe===3221225472?(K[1].t="e",K[1].v=15):Y===0&&oe===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var Ne=ve&32768;return ve=(ve&32767)-16446,K[1].v=(1-Ne*2)*(oe*Math.pow(2,ve+32)+Y*Math.pow(2,ve)),K}function W(F,J,K,Y){var oe=Mr(14);if(oe.write_shift(2,F),oe.write_shift(1,K),oe.write_shift(1,J),Y==0)return oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(2,65535),oe;var ve=0,Ne=0,Ee=0,Ae=0;return Y<0&&(ve=1,Y=-Y),Ne=Math.log2(Y)|0,Y/=Math.pow(2,Ne-31),Ae=Y>>>0,(Ae&2147483648)==0&&(Y/=2,++Ne,Ae=Y>>>0),Y-=Ae,Ae|=2147483648,Ae>>>=0,Y*=Math.pow(2,32),Ee=Y>>>0,oe.write_shift(4,Ee),oe.write_shift(4,Ae),Ne+=16383+(ve?32768:0),oe.write_shift(2,Ne),oe}function H(F,J){var K=I(F);return F.l+=J-14,K}function D(F,J){var K=R(F),Y=F.read_shift(4);return K[1].v=Y>>6,K}function z(F,J){var K=R(F),Y=F.read_shift(8,"f");return K[1].v=Y,K}function ne(F,J){var K=z(F);return F.l+=J-10,K}function re(F,J){return F[F.l+J-1]==0?F.read_shift(J,"cstr"):""}function U(F,J){var K=F[F.l++];K>J-1&&(K=J-1);for(var Y="";Y.length<K;)Y+=String.fromCharCode(F[F.l++]);return Y}function te(F,J,K){if(!(!K.qpro||J<21)){var Y=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var oe=F.read_shift(J-21,"cstr");return[Y,oe]}}function be(F,J){for(var K={},Y=F.l+J;F.l<Y;){var oe=F.read_shift(2);if(oe==14e3){for(K[oe]=[0,""],K[oe][0]=F.read_shift(2);F[F.l];)K[oe][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return K}function se(F,J){var K=Mr(5+F.length);K.write_shift(2,14e3),K.write_shift(2,J);for(var Y=0;Y<F.length;++Y){var oe=F.charCodeAt(Y);K[K.l++]=oe>127?95:oe}return K[K.l++]=0,K}var ke={0:{n:"BOF",f:Nr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:y},15:{n:"LABEL",f},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:U},65535:{n:""}},q={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:I},24:{n:"NUMBER18",f:j},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:be},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:z},40:{n:"FORMULA28",f:ne},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:te},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:e}})();function IF(r){var e={},t=r.match(la),a=0,s=!1;if(t)for(;a!=t.length;++a){var i=Ke(t[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=_m[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return e}var jF=(function(){var r=bu("t"),e=bu("rPr");function t(i){var o=i.match(r);if(!o)return{t:"s",v:""};var c={t:"s",v:yt(o[1])},u=i.match(e);return u&&(c.s=IF(u[1])),c}var a=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(s).map(t).filter(function(c){return c.v})}})(),PF=(function(){var e=/(\r\n|\n)/g;function t(s,i,o){var c=[];s.u&&c.push("text-decoration: underline;"),s.uval&&c.push("text-underline-style:"+s.uval+";"),s.sz&&c.push("font-size:"+s.sz+"pt;"),s.outline&&c.push("text-effect: outline;"),s.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),s.b&&(i.push("<b>"),o.push("</b>")),s.i&&(i.push("<i>"),o.push("</i>")),s.strike&&(i.push("<s>"),o.push("</s>"));var u=s.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(i.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),s}function a(s){var i=[[],s.v,[]];return s.v?(s.s&&t(s.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}})(),BF=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,UF=/<(?:\w+:)?r>/,zF=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Im(r,e){var t=e?e.cellHTML:!0,a={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=yt($t(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=$t(r),t&&(a.h=Tm(a.t))):r.match(UF)&&(a.r=$t(r),a.t=yt($t((r.replace(zF,"").match(BF)||[]).join("").replace(la,""))),t&&(a.h=PF(jF(a.r)))),a):{t:""}}var HF=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,$F=/<(?:\w+:)?(?:si|sstItem)>/g,GF=/<\/(?:\w+:)?(?:si|sstItem)>/;function VF(r,e){var t=[],a="";if(!r)return t;var s=r.match(HF);if(s){a=s[2].replace($F,"").split(GF);for(var i=0;i!=a.length;++i){var o=Im(a[i].trim(),e);o!=null&&(t[t.length]=o)}s=Ke(s[1]),t.Count=s.count,t.Unique=s.uniqueCount}return t}function qF(r){return[r.read_shift(4),r.read_shift(4)]}function WF(r,e){var t=[],a=!1;return In(r,function(i,o,c){switch(c){case 159:t.Count=i[0],t.Unique=i[1];break;case 19:t.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t}function ZE(r){for(var e=[],t=r.split(""),a=0;a<t.length;++a)e[a]=t[a].charCodeAt(0);return e}function Dn(r,e){var t={};return t.Major=r.read_shift(2),t.Minor=r.read_shift(2),e>=4&&(r.l+=e-4),t}function XF(r){var e={};return e.id=r.read_shift(0,"lpp4"),e.R=Dn(r,4),e.U=Dn(r,4),e.W=Dn(r,4),e}function YF(r){for(var e=r.read_shift(4),t=r.l+e-4,a={},s=r.read_shift(4),i=[];s-- >0;)i.push({t:r.read_shift(4),v:r.read_shift(0,"lpp4")});if(a.name=r.read_shift(0,"lpp4"),a.comps=i,r.l!=t)throw new Error("Bad DataSpaceMapEntry: "+r.l+" != "+t);return a}function KF(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(YF(r));return e}function JF(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(r.read_shift(0,"lpp4"));return e}function QF(r){var e={};return r.read_shift(4),r.l+=4,e.id=r.read_shift(0,"lpp4"),e.name=r.read_shift(0,"lpp4"),e.R=Dn(r,4),e.U=Dn(r,4),e.W=Dn(r,4),e}function ZF(r){var e=QF(r);if(e.ename=r.read_shift(0,"8lpp4"),e.blksz=r.read_shift(4),e.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function eA(r,e){var t=r.l+e,a={};a.Flags=r.read_shift(4)&63,r.l+=4,a.AlgID=r.read_shift(4);var s=!1;switch(a.AlgID){case 26126:case 26127:case 26128:s=a.Flags==36;break;case 26625:s=a.Flags==4;break;case 0:s=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=r.read_shift(4),a.KeySize=r.read_shift(4),a.ProviderType=r.read_shift(4),r.l+=8,a.CSPName=r.read_shift(t-r.l>>1,"utf16le"),r.l=t,a}function tA(r,e){var t={},a=r.l+e;return r.l+=4,t.Salt=r.slice(r.l,r.l+16),r.l+=16,t.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),t.VerifierHash=r.slice(r.l,a),r.l=a,t}function eM(r){var e=Dn(r);switch(e.Minor){case 2:return[e.Minor,tM(r)];case 3:return[e.Minor,rM()];case 4:return[e.Minor,aM(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function tM(r){var e=r.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var t=r.read_shift(4),a=eA(r,t),s=tA(r,r.length-r.l);return{t:"Std",h:a,v:s}}function rM(){throw new Error("File is password-protected: ECMA-376 Extensible")}function aM(r){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];r.l+=4;var t=r.read_shift(r.length-r.l,"utf8"),a={};return t.replace(la,function(i){var o=Ke(i);switch(an(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){a[c]=o[c]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function sM(r,e){var t={},a=t.EncryptionVersionInfo=Dn(r,4);if(e-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);t.Flags=r.read_shift(4),e-=4;var s=r.read_shift(4);return e-=4,t.EncryptionHeader=eA(r,s),e-=s,t.EncryptionVerifier=tA(r,e),t}function nM(r){var e={},t=e.EncryptionVersionInfo=Dn(r,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return e.Salt=r.read_shift(16),e.EncryptedVerifier=r.read_shift(16),e.EncryptedVerifierHash=r.read_shift(16),e}function iM(r){var e=0,t,a=ZE(r),s=a.length+1,i,o,c,u,d;for(t=xi(s),t[0]=a.length,i=1;i!=s;++i)t[i]=a[i-1];for(i=s-1;i>=0;--i)o=t[i],c=(e&16384)===0?0:1,u=e<<1&32767,d=c|u,e=d^o;return e^52811}var rA=(function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},s=function(o,c){return a(o^c)},i=function(o){for(var c=e[o.length-1],u=104,d=o.length-1;d>=0;--d)for(var f=o[d],g=0;g!=7;++g)f&64&&(c^=t[u]),f*=2,--u;return c};return function(o){for(var c=ZE(o),u=i(c),d=c.length,f=xi(16),g=0;g!=16;++g)f[g]=0;var v,x,y;for((d&1)===1&&(v=u>>8,f[d]=s(r[0],v),--d,v=u&255,x=c[c.length-1],f[d]=s(x,v));d>0;)--d,v=u>>8,f[d]=s(c[d],v),--d,v=u&255,f[d]=s(c[d],v);for(d=15,y=15-c.length;y>0;)v=u>>8,f[d]=s(r[y],v),--d,--y,v=u&255,f[d]=s(c[d],v),--d,--y;return f}})(),oM=function(r,e,t,a,s){s||(s=e),a||(a=rA(r));var i,o;for(i=0;i!=e.length;++i)o=e[i],o^=a[t],o=(o>>5|o<<3)&255,s[i]=o,++t;return[s,t,a]},lM=function(r){var e=0,t=rA(r);return function(a){var s=oM("",a,e,t);return e=s[1],s[0]}};function cM(r,e,t,a){var s={key:Nr(r),verificationBytes:Nr(r)};return t.password&&(s.verifier=iM(t.password)),a.valid=s.verificationBytes===s.verifier,a.valid&&(a.insitu=lM(t.password)),s}function uM(r,e,t){var a=t||{};return a.Info=r.read_shift(2),r.l-=2,a.Info===1?a.Data=nM(r):a.Data=sM(r,e),a}function hM(r,e,t){var a={Type:t.biff>=8?r.read_shift(2):0};return a.Type?uM(r,e-2,a):cM(r,t.biff>=8?e:e-2,t,a),a}var dM=(function(){function r(s,i){switch(i.type){case"base64":return e(Ka(s),i);case"binary":return e(s,i);case"buffer":return e(vt&&Buffer.isBuffer(s)?s.toString("binary"):po(s),i);case"array":return e(oo(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var o=i||{},c=o.dense?[]:{},u=s.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(f,g){Array.isArray(c)&&(c[g]=[]);for(var v=/\\\w+\b/g,x=0,y,_=-1;y=v.exec(f);){switch(y[0]){case"\\cell":var w=f.slice(x,v.lastIndex-y[0].length);if(w[0]==" "&&(w=w.slice(1)),++_,w.length){var A={v:w,t:"s"};Array.isArray(c)?c[g][_]=A:c[Qe({r:g,c:_})]=A}break}x=v.lastIndex}_>d.e.c&&(d.e.c=_)}),c["!ref"]=_t(d),c}function t(s,i){return Ei(r(s,i),i)}function a(s){for(var i=["{\\rtf1\\ansi"],o=pr(s["!ref"]),c,u=Array.isArray(s),d=o.s.r;d<=o.e.r;++d){i.push("\\trowd\\trautofit1");for(var f=o.s.c;f<=o.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=o.s.c;f<=o.e.c;++f){var g=Qe({r:d,c:f});c=u?(s[d]||[])[f]:s[g],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(Mn(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:a}})();function fM(r){var e=r.slice(r[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Au(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}function pM(r){var e=r[0]/255,t=r[1]/255,a=r[2]/255,s=Math.max(e,t,a),i=Math.min(e,t,a),o=s-i;if(o===0)return[0,0,e];var c=0,u=0,d=s+i;switch(u=o/(d>1?2-d:d),s){case e:c=((t-a)/o+6)%6;break;case t:c=(a-e)/o+2;break;case a:c=(e-t)/o+4;break}return[c/6,u,d/2]}function gM(r){var e=r[0],t=r[1],a=r[2],s=t*2*(a<.5?a:1-a),i=a-s/2,o=[i,i,i],c=6*e,u;if(t!==0)switch(c|0){case 0:case 6:u=s*c,o[0]+=s,o[1]+=u;break;case 1:u=s*(2-c),o[0]+=u,o[1]+=s;break;case 2:u=s*(c-2),o[1]+=s,o[2]+=u;break;case 3:u=s*(4-c),o[1]+=u,o[2]+=s;break;case 4:u=s*(c-4),o[2]+=s,o[0]+=u;break;case 5:u=s*(6-c),o[2]+=u,o[0]+=s;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function tf(r,e){if(e===0)return r;var t=pM(fM(r));return e<0?t[2]=t[2]*(1+e):t[2]=1-(1-t[2])*(1-e),Au(gM(t))}var aA=6,mM=15,vM=1,pa=aA;function rf(r){return Math.floor((r+Math.round(128/pa)/256)*pa)}function af(r){return Math.floor((r-5)/pa*100+.5)/100}function jg(r){return Math.round((r*pa+5)/pa*256)/256}function ng(r){return jg(af(rf(r)))}function jm(r){var e=Math.abs(r-ng(r)),t=pa;if(e>.005)for(pa=vM;pa<mM;++pa)Math.abs(r-ng(r))<=e&&(e=Math.abs(r-ng(r)),t=pa);pa=t}function jl(r){r.width?(r.wpx=rf(r.width),r.wch=af(r.wpx),r.MDW=pa):r.wpx?(r.wch=af(r.wpx),r.width=jg(r.wch),r.MDW=pa):typeof r.wch=="number"&&(r.width=jg(r.wch),r.wpx=rf(r.width),r.MDW=pa),r.customWidth&&delete r.customWidth}var xM=96,sA=xM;function nA(r){return r*96/sA}function Su(r){return r*sA/96}var _M={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function yM(r,e,t,a){e.Borders=[];var s={},i=!1;(r[0].match(la)||[]).forEach(function(o){var c=Ke(o);switch(an(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},c.diagonalUp&&(s.diagonalUp=rr(c.diagonalUp)),c.diagonalDown&&(s.diagonalDown=rr(c.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function bM(r,e,t,a){e.Fills=[];var s={},i=!1;(r[0].match(la)||[]).forEach(function(o){var c=Ke(o);switch(an(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":c.patternType&&(s.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),c.indexed&&(s.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(s.bgColor.theme=parseInt(c.theme,10)),c.tint&&(s.bgColor.tint=parseFloat(c.tint)),c.rgb&&(s.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),c.theme&&(s.fgColor.theme=parseInt(c.theme,10)),c.tint&&(s.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(s.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function wM(r,e,t,a){e.Fonts=[];var s={},i=!1;(r[0].match(la)||[]).forEach(function(o){var c=Ke(o);switch(an(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":c.val&&(s.name=$t(c.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=c.val?rr(c.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=c.val?rr(c.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(c.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=c.val?rr(c.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=c.val?rr(c.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=c.val?rr(c.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=c.val?rr(c.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=c.val?rr(c.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":c.val&&(s.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(s.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(s.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(s.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=_m[parseInt(c.val,10)];break;case"<color":if(s.color||(s.color={}),c.auto&&(s.color.auto=rr(c.auto)),c.rgb)s.color.rgb=c.rgb.slice(-6);else if(c.indexed){s.color.index=parseInt(c.indexed,10);var u=so[s.color.index];s.color.index==81&&(u=so[1]),u||(u=so[1]),s.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else c.theme&&(s.color.theme=parseInt(c.theme,10),c.tint&&(s.color.tint=parseFloat(c.tint)),c.theme&&t.themeElements&&t.themeElements.clrScheme&&(s.color.rgb=tf(t.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function EM(r,e,t){e.NumberFmt=[];for(var a=tn(it),s=0;s<a.length;++s)e.NumberFmt[a[s]]=it[a[s]];var i=r[0].match(la);if(i)for(s=0;s<i.length;++s){var o=Ke(i[s]);switch(an(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=yt($t(o.formatCode)),u=parseInt(o.numFmtId,10);if(e.NumberFmt[u]=c,u>0){if(u>392){for(u=392;u>60&&e.NumberFmt[u]!=null;--u);e.NumberFmt[u]=c}ao(c,u)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var Sd=["numFmtId","fillId","fontId","borderId","xfId"],Td=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function AM(r,e,t){e.CellXf=[];var a,s=!1;(r[0].match(la)||[]).forEach(function(i){var o=Ke(i),c=0;switch(an(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],c=0;c<Sd.length;++c)a[Sd[c]]&&(a[Sd[c]]=parseInt(a[Sd[c]],10));for(c=0;c<Td.length;++c)a[Td[c]]&&(a[Td[c]]=rr(a[Td[c]]));if(e.NumberFmt&&a.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[a.numFmtId]==e.NumberFmt[c]){a.numFmtId=c;break}}e.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=rr(o.wrapText)),a.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(t&&t.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var SM=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,u,d){var f={};if(!c)return f;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=c.match(e))&&EM(g,f,d),(g=c.match(s))&&wM(g,f,u,d),(g=c.match(a))&&bM(g,f,u,d),(g=c.match(i))&&yM(g,f,u,d),(g=c.match(t))&&AM(g,f,d),f}})();function TM(r,e){var t=r.read_shift(2),a=ia(r);return[t,a]}function CM(r,e,t){var a={};a.sz=r.read_shift(2)/20;var s=j4(r);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var i=r.read_shift(2);switch(i===700&&(a.bold=1),r.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=r.read_shift(1);o!=0&&(a.underline=o);var c=r.read_shift(1);c>0&&(a.family=c);var u=r.read_shift(1);switch(u>0&&(a.charset=u),r.l++,a.color=I4(r),r.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=ia(r),a}var kM=oa;function NM(r,e){var t=r.l+e,a=r.read_shift(2),s=r.read_shift(2);return r.l=t,{ixfe:a,numFmtId:s}}var RM=oa;function OM(r,e,t){var a={};a.NumberFmt=[];for(var s in it)a.NumberFmt[s]=it[s];a.CellXf=[],a.Fonts=[];var i=[],o=!1;return In(r,function(u,d,f){switch(f){case 44:a.NumberFmt[u[0]]=u[1],ao(u[1],u[0]);break;case 43:a.Fonts.push(u),u.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(u.color.rgb=tf(e.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(f),o=!0;break;case 38:i.pop(),o=!1;break;default:if(d.T>0)i.push(f);else if(d.T<0)i.pop();else if(!o||t.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),a}var DM=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function FM(r,e,t){e.themeElements.clrScheme=[];var a={};(r[0].match(la)||[]).forEach(function(s){var i=Ke(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[DM.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function MM(){}function LM(){}var IM=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,jM=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,PM=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function BM(r,e,t){e.themeElements={};var a;[["clrScheme",IM,FM],["fontScheme",jM,MM],["fmtScheme",PM,LM]].forEach(function(s){if(!(a=r.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](a,e,t)})}var UM=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function iA(r,e){(!r||r.length===0)&&(r=zM());var t,a={};if(!(t=r.match(UM)))throw new Error("themeElements not found in theme");return BM(t[0],a,e),a.raw=r,a}function zM(r,e){var t=[vE];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function HM(r,e,t){var a=r.l+e,s=r.read_shift(4);if(s!==124226){if(!t.cellStyles){r.l=a;return}var i=r.slice(r.l);r.l=a;var o;try{o=mE(i,{type:"array"})}catch{return}var c=Ya(o,"theme/theme/theme1.xml",!0);if(c)return iA(c,t)}}function $M(r){return r.read_shift(4)}function GM(r){var e={};switch(e.xclrType=r.read_shift(2),e.nTintShade=r.read_shift(2),e.xclrType){case 0:r.l+=4;break;case 1:e.xclrValue=VM(r,4);break;case 2:e.xclrValue=qE(r);break;case 3:e.xclrValue=$M(r);break;case 4:r.l+=4;break}return r.l+=8,e}function VM(r,e){return oa(r,e)}function qM(r,e){return oa(r,e)}function WM(r){var e=r.read_shift(2),t=r.read_shift(2)-4,a=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=GM(r);break;case 6:a[1]=qM(r,t);break;case 14:case 15:a[1]=r.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+t)}return a}function XM(r,e){var t=r.l+e;r.l+=2;var a=r.read_shift(2);r.l+=2;for(var s=r.read_shift(2),i=[];s-- >0;)i.push(WM(r,t-r.l));return{ixfe:a,ext:i}}function YM(r,e){e.forEach(function(t){t[0]})}function KM(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:ia(r)}}function JM(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function QM(r){return r.l+=4,r.read_shift(4)!=0}function ZM(r,e,t){var a={Types:[],Cell:[],Value:[]},s=t||{},i=[],o=!1,c=2;return In(r,function(u,d,f){switch(f){case 335:a.Types.push({name:u.name});break;case 51:u.forEach(function(g){c==1?a.Cell.push({type:a.Types[g[0]-1].name,index:g[1]}):c==0&&a.Value.push({type:a.Types[g[0]-1].name,index:g[1]})});break;case 337:c=u?1:0;break;case 338:c=2;break;case 35:i.push(f),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!d.T){if(!o||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),a}function eL(r,e,t){var a={Types:[],Cell:[],Value:[]};if(!r)return a;var s=!1,i=2,o;return r.replace(la,function(c){var u=Ke(c);switch(an(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<a.Types.length;++d)a.Types[d].name==u.name&&(o=a.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[u.t-1].name,index:+u.v}):i==0&&a.Value.push({type:a.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!s&&t.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return c}),a}function tL(r){var e=[];if(!r)return e;var t=1;return(r.match(la)||[]).forEach(function(a){var s=Ke(a);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?t=s.i:s.i=t,e.push(s);break}}),e}function rL(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=Qe(t);var a=r.read_shift(1);return a&2&&(e.l="1"),a&8&&(e.a="1"),e}function aL(r,e,t){var a=[];return In(r,function(i,o,c){switch(c){case 63:a.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),a}function sL(r,e,t,a){if(!r)return r;var s=a||{},i=!1;In(r,function(c,u,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!u.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},s)}function nL(r,e){if(!r)return"??";var t=(r.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][t].Target}function bb(r,e,t,a){var s=Array.isArray(r),i;e.forEach(function(o){var c=ga(o.ref);if(s?(r[c.r]||(r[c.r]=[]),i=r[c.r][c.c]):i=r[o.ref],!i){i={t:"z"},s?r[c.r][c.c]=i:r[o.ref]=i;var u=pr(r["!ref"]||"BDWGO1000001:A1");u.s.r>c.r&&(u.s.r=c.r),u.e.r<c.r&&(u.e.r=c.r),u.s.c>c.c&&(u.s.c=c.c),u.e.c<c.c&&(u.e.c=c.c);var d=_t(u);d!==r["!ref"]&&(r["!ref"]=d)}i.c||(i.c=[]);var f={a:o.author,t:o.t,r:o.r,T:t};o.h&&(f.h=o.h);for(var g=i.c.length-1;g>=0;--g){if(!t&&i.c[g].T)return;t&&!i.c[g].T&&i.c.splice(g,1)}if(t&&a){for(g=0;g<a.length;++g)if(f.a==a[g].id){f.a=a[g].name||f.a;break}}i.c.push(f)})}function iL(r,e){if(r.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],a=[],s=r.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&t.push(c[1])}});var i=r.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?comment[^>]*>/);if(c){var u=Ke(c[0]),d={author:u.authorId&&t[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},f=ga(u.ref);if(!(e.sheetRows&&e.sheetRows<=f.r)){var g=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!g&&!!g[1]&&Im(g[1])||{r:"",t:"",h:""};d.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),d.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=v.h),a.push(d)}}}}),a}function oL(r,e){var t=[],a=!1,s={},i=0;return r.replace(la,function(c,u){var d=Ke(c);switch(an(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":s.t!=null&&t.push(s);break;case"<text>":case"<text":i=u+c.length;break;case"</text>":s.t=r.slice(i,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return c}),t}function lL(r,e){var t=[],a=!1;return r.replace(la,function(i){var o=Ke(i);switch(an(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),t}function cL(r){var e={};e.iauthor=r.read_shift(4);var t=mo(r);return e.rfx=t.s,e.ref=Qe(t.s),r.l+=16,e}var uL=ia;function hL(r,e){var t=[],a=[],s={},i=!1;return In(r,function(c,u,d){switch(d){case 632:a.push(c);break;case 635:s=c;break;case 637:s.t=c.t,s.h=c.h,s.r=c.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,t.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),t}var dL="application/vnd.ms-office.vbaProject";function fL(r){var e=xt.utils.cfb_new({root:"R"});return r.FullPaths.forEach(function(t,a){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var s=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");xt.utils.cfb_add(e,s,r.FileIndex[a].content)}}),xt.write(e)}function pL(){return{"!type":"dialog"}}function gL(){return{"!type":"dialog"}}function mL(){return{"!type":"macro"}}function vL(){return{"!type":"macro"}}var Rl=(function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(a,s,i,o){var c=!1,u=!1;i.length==0?u=!0:i.charAt(0)=="["&&(u=!0,i=i.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,f=o.length>0?parseInt(o,10)|0:0;return c?f+=e.c:--f,u?d+=e.r:--d,s+(c?"":"$")+Lr(f)+(u?"":"$")+Zr(d)}return function(s,i){return e=i,s.replace(r,t)}})(),oA=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,xL=(function(){return function(e,t){return e.replace(oA,function(a,s,i,o,c,u){var d=Rm(o)-(i?0:t.c),f=Nm(u)-(c?0:t.r),g=f==0?"":c?f+1:"["+f+"]",v=d==0?"":i?d+1:"["+d+"]";return s+"R"+g+"C"+v})}})();function lA(r,e){return r.replace(oA,function(t,a,s,i,o,c){return a+(s=="$"?s+i:Lr(Rm(i)+e.c))+(o=="$"?o+c:Zr(Nm(c)+e.r))})}function _L(r,e,t){var a=Gl(e),s=a.s,i=ga(t),o={r:i.r-s.r,c:i.c-s.c};return lA(r,o)}function yL(r){return r.length!=1}function wb(r){return r.replace(/_xlfn\./g,"")}function Sr(r){r.l+=1}function _i(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function cA(r,e,t){var a=2;if(t){if(t.biff>=2&&t.biff<=5)return uA(r);t.biff==12&&(a=4)}var s=r.read_shift(a),i=r.read_shift(a),o=_i(r),c=_i(r);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function uA(r){var e=_i(r),t=_i(r),a=r.read_shift(1),s=r.read_shift(1);return{s:{r:e[0],c:a,cRel:e[1],rRel:e[2]},e:{r:t[0],c:s,cRel:t[1],rRel:t[2]}}}function bL(r,e,t){if(t.biff<8)return uA(r);var a=r.read_shift(t.biff==12?4:2),s=r.read_shift(t.biff==12?4:2),i=_i(r),o=_i(r);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function hA(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return wL(r);var a=r.read_shift(t&&t.biff==12?4:2),s=_i(r);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function wL(r){var e=_i(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function EL(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function AL(r,e,t){var a=t&&t.biff?t.biff:8;if(a>=2&&a<=5)return SL(r);var s=r.read_shift(a>=12?4:2),i=r.read_shift(2),o=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;s>524287;)s-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:o,rRel:c}}function SL(r){var e=r.read_shift(2),t=r.read_shift(1),a=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,a==1&&e>=8192&&(e=e-16384),s==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:s,rRel:a}}function TL(r,e,t){var a=(r[r.l++]&96)>>5,s=cA(r,t.biff>=2&&t.biff<=5?6:8,t);return[a,s]}function CL(r,e,t){var a=(r[r.l++]&96)>>5,s=r.read_shift(2,"i"),i=8;if(t)switch(t.biff){case 5:r.l+=12,i=6;break;case 12:i=12;break}var o=cA(r,i,t);return[a,s,o]}function kL(r,e,t){var a=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[a]}function NL(r,e,t){var a=(r[r.l++]&96)>>5,s=r.read_shift(2),i=8;if(t)switch(t.biff){case 5:r.l+=12,i=6;break;case 12:i=12;break}return r.l+=i,[a,s]}function RL(r,e,t){var a=(r[r.l++]&96)>>5,s=bL(r,e-1,t);return[a,s]}function OL(r,e,t){var a=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[a]}function Eb(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function DL(r,e,t){r.l+=2;for(var a=r.read_shift(t&&t.biff==2?1:2),s=[],i=0;i<=a;++i)s.push(r.read_shift(t&&t.biff==2?1:2));return s}function FL(r,e,t){var a=r[r.l+1]&255?1:0;return r.l+=2,[a,r.read_shift(t&&t.biff==2?1:2)]}function ML(r,e,t){var a=r[r.l+1]&255?1:0;return r.l+=2,[a,r.read_shift(t&&t.biff==2?1:2)]}function LL(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function IL(r,e,t){var a=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[a]}function dA(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function jL(r){return r.read_shift(2),dA(r)}function PL(r){return r.read_shift(2),dA(r)}function BL(r,e,t){var a=(r[r.l]&96)>>5;r.l+=1;var s=hA(r,0,t);return[a,s]}function UL(r,e,t){var a=(r[r.l]&96)>>5;r.l+=1;var s=AL(r,0,t);return[a,s]}function zL(r,e,t){var a=(r[r.l]&96)>>5;r.l+=1;var s=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var i=hA(r,0,t);return[a,s,i]}function HL(r,e,t){var a=(r[r.l]&96)>>5;r.l+=1;var s=r.read_shift(t&&t.biff<=3?1:2);return[$I[s],gA[s],a]}function $L(r,e,t){var a=r[r.l++],s=r.read_shift(1),i=t&&t.biff<=3?[a==88?-1:0,r.read_shift(1)]:GL(r);return[s,(i[0]===0?gA:HI)[i[1]]]}function GL(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function VL(r,e,t){r.l+=t&&t.biff==2?3:4}function qL(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var a=r.read_shift(2),s=r.read_shift(t&&t.biff==2?1:2);return[a,s]}function WL(r){return r.l++,vo[r.read_shift(1)]}function XL(r){return r.l++,r.read_shift(2)}function YL(r){return r.l++,r.read_shift(1)!==0}function KL(r){return r.l++,sa(r)}function JL(r,e,t){return r.l++,Uu(r,e-1,t)}function QL(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=xr(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=vo[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=sa(r);break;case 2:t[1]=xo(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function ZL(r,e,t){for(var a=r.read_shift(t.biff==12?4:2),s=[],i=0;i!=a;++i)s.push((t.biff==12?mo:mf)(r));return s}function eI(r,e,t){var a=0,s=0;t.biff==12?(a=r.read_shift(4),s=r.read_shift(4)):(s=1+r.read_shift(1),a=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--a,--s==0&&(s=256));for(var i=0,o=[];i!=a&&(o[i]=[]);++i)for(var c=0;c!=s;++c)o[i][c]=QL(r,t.biff);return o}function tI(r,e,t){var a=r.read_shift(1)>>>5&3,s=!t||t.biff>=8?4:2,i=r.read_shift(s);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[a,0,i]}function rI(r,e,t){if(t.biff==5)return aI(r);var a=r.read_shift(1)>>>5&3,s=r.read_shift(2),i=r.read_shift(4);return[a,s,i]}function aI(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var a=r.read_shift(2);return r.l+=12,[e,t,a]}function sI(r,e,t){var a=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var s=r.read_shift(t&&t.biff==2?1:2);return[a,s]}function nI(r,e,t){var a=r.read_shift(1)>>>5&3,s=r.read_shift(t&&t.biff==2?1:2);return[a,s]}function iI(r,e,t){var a=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[a]}function oI(r,e,t){var a=(r[r.l++]&96)>>5,s=r.read_shift(2),i=4;if(t)switch(t.biff){case 5:i=15;break;case 12:i=6;break}return r.l+=i,[a,s]}var lI=oa,cI=oa,uI=oa;function Hu(r,e,t){return r.l+=2,[EL(r)]}function Pm(r){return r.l+=6,[]}var hI=Hu,dI=Pm,fI=Pm,pI=Hu;function fA(r){return r.l+=2,[Nr(r),r.read_shift(2)&1]}var gI=Hu,mI=fA,vI=Pm,xI=Hu,_I=Hu,yI=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function bI(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),a=r.read_shift(4),s=r.read_shift(2),i=r.read_shift(2),o=yI[t>>2&31];return{ixti:e,coltype:t&3,rt:o,idx:a,c:s,C:i}}function wI(r){return r.l+=2,[r.read_shift(4)]}function EI(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function AI(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function SI(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function TI(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function CI(r){return r.l+=4,[0,0]}var Ab={1:{n:"PtgExp",f:qL},2:{n:"PtgTbl",f:uI},3:{n:"PtgAdd",f:Sr},4:{n:"PtgSub",f:Sr},5:{n:"PtgMul",f:Sr},6:{n:"PtgDiv",f:Sr},7:{n:"PtgPower",f:Sr},8:{n:"PtgConcat",f:Sr},9:{n:"PtgLt",f:Sr},10:{n:"PtgLe",f:Sr},11:{n:"PtgEq",f:Sr},12:{n:"PtgGe",f:Sr},13:{n:"PtgGt",f:Sr},14:{n:"PtgNe",f:Sr},15:{n:"PtgIsect",f:Sr},16:{n:"PtgUnion",f:Sr},17:{n:"PtgRange",f:Sr},18:{n:"PtgUplus",f:Sr},19:{n:"PtgUminus",f:Sr},20:{n:"PtgPercent",f:Sr},21:{n:"PtgParen",f:Sr},22:{n:"PtgMissArg",f:Sr},23:{n:"PtgStr",f:JL},26:{n:"PtgSheet",f:EI},27:{n:"PtgEndSheet",f:AI},28:{n:"PtgErr",f:WL},29:{n:"PtgBool",f:YL},30:{n:"PtgInt",f:XL},31:{n:"PtgNum",f:KL},32:{n:"PtgArray",f:OL},33:{n:"PtgFunc",f:HL},34:{n:"PtgFuncVar",f:$L},35:{n:"PtgName",f:tI},36:{n:"PtgRef",f:BL},37:{n:"PtgArea",f:TL},38:{n:"PtgMemArea",f:sI},39:{n:"PtgMemErr",f:lI},40:{n:"PtgMemNoMem",f:cI},41:{n:"PtgMemFunc",f:nI},42:{n:"PtgRefErr",f:iI},43:{n:"PtgAreaErr",f:kL},44:{n:"PtgRefN",f:UL},45:{n:"PtgAreaN",f:RL},46:{n:"PtgMemAreaN",f:SI},47:{n:"PtgMemNoMemN",f:TI},57:{n:"PtgNameX",f:rI},58:{n:"PtgRef3d",f:zL},59:{n:"PtgArea3d",f:CL},60:{n:"PtgRefErr3d",f:oI},61:{n:"PtgAreaErr3d",f:NL},255:{}},kI={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},NI={1:{n:"PtgElfLel",f:fA},2:{n:"PtgElfRw",f:xI},3:{n:"PtgElfCol",f:hI},6:{n:"PtgElfRwV",f:_I},7:{n:"PtgElfColV",f:pI},10:{n:"PtgElfRadical",f:gI},11:{n:"PtgElfRadicalS",f:vI},13:{n:"PtgElfColS",f:dI},15:{n:"PtgElfColSV",f:fI},16:{n:"PtgElfRadicalLel",f:mI},25:{n:"PtgList",f:bI},29:{n:"PtgSxName",f:wI},255:{}},RI={0:{n:"PtgAttrNoop",f:CI},1:{n:"PtgAttrSemi",f:IL},2:{n:"PtgAttrIf",f:ML},4:{n:"PtgAttrChoose",f:DL},8:{n:"PtgAttrGoto",f:FL},16:{n:"PtgAttrSum",f:VL},32:{n:"PtgAttrBaxcel",f:Eb},33:{n:"PtgAttrBaxcel",f:Eb},64:{n:"PtgAttrSpace",f:jL},65:{n:"PtgAttrSpaceSemi",f:PL},128:{n:"PtgAttrIfError",f:LL},255:{}};function $u(r,e,t,a){if(a.biff<8)return oa(r,e);for(var s=r.l+e,i=[],o=0;o!==t.length;++o)switch(t[o][0]){case"PtgArray":t[o][1]=eI(r,0,a),i.push(t[o][1]);break;case"PtgMemArea":t[o][2]=ZL(r,t[o][1],a),i.push(t[o][2]);break;case"PtgExp":a&&a.biff==12&&(t[o][1][1]=r.read_shift(4),i.push(t[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[o][0]}return e=s-r.l,e!==0&&i.push(oa(r,e)),i}function Gu(r,e,t){for(var a=r.l+e,s,i,o=[];a!=r.l;)e=a-r.l,i=r[r.l],s=Ab[i]||Ab[kI[i]],(i===24||i===25)&&(s=(i===24?NI:RI)[r[r.l+1]]),!s||!s.f?oa(r,e):o.push([s.n,s.f(r,e,t)]);return o}function OI(r){for(var e=[],t=0;t<r.length;++t){for(var a=r[t],s=[],i=0;i<a.length;++i){var o=a[i];o?o[0]===2?s.push('"'+o[1].replace(/"/g,'""')+'"'):s.push(o[1]):s.push("")}e.push(s.join(","))}return e.join(";")}var DI={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function FI(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function pA(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var a=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!a)return"SH33TJSERR1";var s="";if(t.biff>8)switch(r[a[0]][0]){case 357:return s=a[1]==-1?"#REF":r.SheetNames[a[1]],a[1]==a[2]?s:s+":"+r.SheetNames[a[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[a[0]][0];default:return"SH33TJSSRC"+r[a[0]][0]}switch(r[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":r.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+r.SheetNames[a[2]];case 14849:return r[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return r[a[0]][0][3]?(s=a[1]==-1?"#REF":r[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+r[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Sb(r,e,t){var a=pA(r,e,t);return a=="#REF"?a:FI(a,t)}function aa(r,e,t,a,s){var i=s&&s.biff||8,o={s:{c:0,r:0}},c=[],u,d,f,g=0,v=0,x,y="";if(!r[0]||!r[0][0])return"";for(var _=-1,w="",A=0,T=r[0].length;A<T;++A){var S=r[0][A];switch(S[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=c.pop(),d=c.pop(),_>=0){switch(r[0][_][1][0]){case 0:w=dr(" ",r[0][_][1][1]);break;case 1:w=dr("\r",r[0][_][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][_][1][0])}d=d+w,_=-1}c.push(d+DI[S[0]]+u);break;case"PtgIsect":u=c.pop(),d=c.pop(),c.push(d+" "+u);break;case"PtgUnion":u=c.pop(),d=c.pop(),c.push(d+","+u);break;case"PtgRange":u=c.pop(),d=c.pop(),c.push(d+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=au(S[1][1],o,s),c.push(su(f,i));break;case"PtgRefN":f=t?au(S[1][1],t,s):S[1][1],c.push(su(f,i));break;case"PtgRef3d":g=S[1][1],f=au(S[1][2],o,s),y=Sb(a,g,s),c.push(y+"!"+su(f,i));break;case"PtgFunc":case"PtgFuncVar":var N=S[1][0],R=S[1][1];N||(N=0),N&=127;var O=N==0?[]:c.slice(-N);c.length-=N,R==="User"&&(R=O.shift()),c.push(R+"("+O.join(",")+")");break;case"PtgBool":c.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(S[1]);break;case"PtgNum":c.push(String(S[1]));break;case"PtgStr":c.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(S[1]);break;case"PtgAreaN":x=nb(S[1][1],t?{s:t}:o,s),c.push(ag(x,s));break;case"PtgArea":x=nb(S[1][1],o,s),c.push(ag(x,s));break;case"PtgArea3d":g=S[1][1],x=S[1][2],y=Sb(a,g,s),c.push(y+"!"+ag(x,s));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=S[1][2];var C=(a.names||[])[v-1]||(a[0]||[])[v],j=C?C.Name:"SH33TJSNAME"+String(v);j&&j.slice(0,6)=="_xlfn."&&!s.xlfn&&(j=j.slice(6)),c.push(j);break;case"PtgNameX":var I=S[1][1];v=S[1][2];var W;if(s.biff<=5)I<0&&(I=-I),a[I]&&(W=a[I][v]);else{var H="";if(((a[I]||[])[0]||[])[0]==14849||(((a[I]||[])[0]||[])[0]==1025?a[I][v]&&a[I][v].itab>0&&(H=a.SheetNames[a[I][v].itab-1]+"!"):H=a.SheetNames[v-1]+"!"),a[I]&&a[I][v])H+=a[I][v].Name;else if(a[0]&&a[0][v])H+=a[0][v].Name;else{var D=(pA(a,I,s)||"").split(";;");D[v-1]?H=D[v-1]:H+="SH33TJSERRX"}c.push(H);break}W||(W={Name:"SH33TJSERRY"}),c.push(W.Name);break;case"PtgParen":var z="(",ne=")";if(_>=0){switch(w="",r[0][_][1][0]){case 2:z=dr(" ",r[0][_][1][1])+z;break;case 3:z=dr("\r",r[0][_][1][1])+z;break;case 4:ne=dr(" ",r[0][_][1][1])+ne;break;case 5:ne=dr("\r",r[0][_][1][1])+ne;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][_][1][0])}_=-1}c.push(z+c.pop()+ne);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":f={c:S[1][1],r:S[1][0]};var re={c:t.c,r:t.r};if(a.sharedf[Qe(f)]){var U=a.sharedf[Qe(f)];c.push(aa(U,o,re,a,s))}else{var te=!1;for(u=0;u!=a.arrayf.length;++u)if(d=a.arrayf[u],!(f.c<d[0].s.c||f.c>d[0].e.c)&&!(f.r<d[0].s.r||f.r>d[0].e.r)){c.push(aa(d[1],o,re,a,s)),te=!0;break}te||c.push(S[1])}break;case"PtgArray":c.push("{"+OI(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var be=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&_>=0&&be.indexOf(r[0][A][0])==-1){S=r[0][_];var se=!0;switch(S[1][0]){case 4:se=!1;case 0:w=dr(" ",S[1][1]);break;case 5:se=!1;case 1:w=dr("\r",S[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}c.push((se?w:"")+c.pop()+(se?"":w)),_=-1}}if(c.length>1&&s.WTF)throw new Error("bad formula stack");return c[0]}function MI(r,e,t){var a=r.l+e,s=t.biff==2?1:2,i,o=r.read_shift(s);if(o==65535)return[[],oa(r,e-2)];var c=Gu(r,o,t);return e!==o+s&&(i=$u(r,e-o-s,c,t)),r.l=a,[c,i]}function LI(r,e,t){var a=r.l+e,s=t.biff==2?1:2,i,o=r.read_shift(s);if(o==65535)return[[],oa(r,e-2)];var c=Gu(r,o,t);return e!==o+s&&(i=$u(r,e-o-s,c,t)),r.l=a,[c,i]}function II(r,e,t,a){var s=r.l+e,i=Gu(r,a,t),o;return s!==r.l&&(o=$u(r,s-r.l,i,t)),[i,o]}function jI(r,e,t){var a=r.l+e,s,i=r.read_shift(2),o=Gu(r,i,t);return i==65535?[[],oa(r,e-2)]:(e!==i+2&&(s=$u(r,a-i-2,o,t)),[o,s])}function PI(r){var e;if(kn(r,r.l+6)!==65535)return[sa(r),"n"];switch(r[r.l]){case 0:return r.l+=8,["String","s"];case 1:return e=r[r.l+2]===1,r.l+=8,[e,"b"];case 2:return e=r[r.l+2],r.l+=8,[e,"e"];case 3:return r.l+=8,["","s"]}return[]}function ig(r,e,t){var a=r.l+e,s=sn(r);t.biff==2&&++r.l;var i=PI(r),o=r.read_shift(1);t.biff!=2&&(r.read_shift(1),t.biff>=5&&r.read_shift(4));var c=LI(r,a-r.l,t);return{cell:s,val:i[0],formula:c,shared:o>>3&1,tt:i[1]}}function vf(r,e,t){var a=r.read_shift(4),s=Gu(r,a,t),i=r.read_shift(4),o=i>0?$u(r,i,s,t):null;return[s,o]}var BI=vf,xf=vf,UI=vf,zI=vf,HI={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},gA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},$I={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Tb(r){return r.slice(0,3)=="of:"&&(r=r.slice(3)),r.charCodeAt(0)==61&&(r=r.slice(1),r.charCodeAt(0)==61&&(r=r.slice(1))),r=r.replace(/COM\.MICROSOFT\./g,""),r=r.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")}),r=r.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),r.replace(/[;~]/g,",").replace(/\|/g,";")}function og(r){var e=r.split(":"),t=e[0].split(".")[0];return[t,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var lu={},Ol={};function cu(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(t=[1,1,1,1,.5,.5]),r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function mA(r,e,t,a,s,i){try{a.cellNF&&(r.z=it[e])}catch(c){if(a.WTF)throw c}if(!(r.t==="z"&&!a.cellStyles)){if(r.t==="d"&&typeof r.v=="string"&&(r.v=Hr(r.v)),(!a||a.cellText!==!1)&&r.t!=="z")try{if(it[e]==null&&ao(GD[e]||"General",e),r.t==="e")r.w=r.w||vo[r.v];else if(e===0)if(r.t==="n")(r.v|0)===r.v?r.w=r.v.toString(10):r.w=yu(r.v);else if(r.t==="d"){var o=xa(r.v);(o|0)===o?r.w=o.toString(10):r.w=yu(o)}else{if(r.v===void 0)return"";r.w=io(r.v,Ol)}else r.t==="d"?r.w=_s(e,xa(r.v),Ol):r.w=_s(e,r.v,Ol)}catch(c){if(a.WTF)throw c}if(a.cellStyles&&t!=null)try{r.s=i.Fills[t],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=tf(s.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),a.WTF&&(r.s.fgColor.raw_rgb=s.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=tf(s.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),a.WTF&&(r.s.bgColor.raw_rgb=s.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(c){if(a.WTF&&i.Fills)throw c}}}function GI(r,e){var t=pr(e);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(r["!ref"]=_t(t))}var VI=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,qI=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,WI=/<(?:\w:)?hyperlink [^>]*>/mg,XI=/"(\w*:\w*)"/,YI=/<(?:\w:)?col\b[^>]*[\/]?>/g,KI=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,JI=/<(?:\w:)?pageMargins[^>]*\/>/g,vA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,QI=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,ZI=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function ej(r,e,t,a,s,i,o){if(!r)return r;a||(a={"!id":{}});var c=e.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",f="",g=r.match(qI);g?(d=r.slice(0,g.index),f=r.slice(g.index+g[0].length)):d=f=r;var v=d.match(vA);v?Bm(v[0],c,s,t):(v=d.match(QI))&&tj(v[0],v[1]||"",c,s,t);var x=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var y=d.slice(x,x+50).match(XI);y&&GI(c,y[1])}var _=d.match(ZI);_&&_[1]&&oj(_[1],s);var w=[];if(e.cellStyles){var A=d.match(YI);A&&sj(w,A)}g&&lj(g[1],c,e,u,i,o);var T=f.match(KI);T&&(c["!autofilter"]=nj(T[0]));var S=[],N=f.match(VI);if(N)for(x=0;x!=N.length;++x)S[x]=pr(N[x].slice(N[x].indexOf('"')+1));var R=f.match(WI);R&&rj(c,R,a);var O=f.match(JI);if(O&&(c["!margins"]=aj(Ke(O[0]))),!c["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(c["!ref"]=_t(u)),e.sheetRows>0&&c["!ref"]){var C=pr(c["!ref"]);e.sheetRows<=+C.e.r&&(C.e.r=e.sheetRows-1,C.e.r>u.e.r&&(C.e.r=u.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>u.e.c&&(C.e.c=u.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),c["!fullref"]=c["!ref"],c["!ref"]=_t(C))}return w.length>0&&(c["!cols"]=w),S.length>0&&(c["!merges"]=S),c}function Bm(r,e,t,a){var s=Ke(r);t.Sheets[a]||(t.Sheets[a]={}),s.codeName&&(t.Sheets[a].CodeName=yt($t(s.codeName)))}function tj(r,e,t,a,s){Bm(r.slice(0,r.indexOf(">")),t,a,s)}function rj(r,e,t){for(var a=Array.isArray(r),s=0;s!=e.length;++s){var i=Ke($t(e[s]),!0);if(!i.ref)return;var o=((t||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+yt(i.location))):(i.Target="#"+yt(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=pr(i.ref),u=c.s.r;u<=c.e.r;++u)for(var d=c.s.c;d<=c.e.c;++d){var f=Qe({c:d,r:u});a?(r[u]||(r[u]=[]),r[u][d]||(r[u][d]={t:"z",v:void 0}),r[u][d].l=i):(r[f]||(r[f]={t:"z",v:void 0}),r[f].l=i)}}}function aj(r){var e={};return["left","right","top","bottom","header","footer"].forEach(function(t){r[t]&&(e[t]=parseFloat(r[t]))}),e}function sj(r,e){for(var t=!1,a=0;a!=e.length;++a){var s=Ke(e[a],!0);s.hidden&&(s.hidden=rr(s.hidden));var i=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!t&&s.width&&(t=!0,jm(s.width)),jl(s);i<=o;)r[i++]=Qr(s)}}function nj(r){var e={ref:(r.match(/ref="([^"]*)"/)||[])[1]};return e}var ij=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function oj(r,e){e.Views||(e.Views=[{}]),(r.match(ij)||[]).forEach(function(t,a){var s=Ke(t);e.Views[a]||(e.Views[a]={}),+s.zoomScale&&(e.Views[a].zoom=+s.zoomScale),rr(s.rightToLeft)&&(e.Views[a].RTL=!0)})}var lj=(function(){var r=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=bu("v"),o=bu("f");return function(u,d,f,g,v,x){for(var y=0,_="",w=[],A=[],T=0,S=0,N=0,R="",O,C,j=0,I=0,W,H,D=0,z=0,ne=Array.isArray(x.CellXf),re,U=[],te=[],be=Array.isArray(d),se=[],ke={},q=!1,F=!!f.sheetStubs,J=u.split(e),K=0,Y=J.length;K!=Y;++K){_=J[K].trim();var oe=_.length;if(oe!==0){var ve=0;e:for(y=0;y<oe;++y)switch(_[y]){case">":if(_[y-1]!="/"){++y;break e}if(f&&f.cellStyles){if(C=Ke(_.slice(ve,y),!0),j=C.r!=null?parseInt(C.r,10):j+1,I=-1,f.sheetRows&&f.sheetRows<j)continue;ke={},q=!1,C.ht&&(q=!0,ke.hpt=parseFloat(C.ht),ke.hpx=Su(ke.hpt)),C.hidden=="1"&&(q=!0,ke.hidden=!0),C.outlineLevel!=null&&(q=!0,ke.level=+C.outlineLevel),q&&(se[j-1]=ke)}break;case"<":ve=y;break}if(ve>=y)break;if(C=Ke(_.slice(ve,y),!0),j=C.r!=null?parseInt(C.r,10):j+1,I=-1,!(f.sheetRows&&f.sheetRows<j)){g.s.r>j-1&&(g.s.r=j-1),g.e.r<j-1&&(g.e.r=j-1),f&&f.cellStyles&&(ke={},q=!1,C.ht&&(q=!0,ke.hpt=parseFloat(C.ht),ke.hpx=Su(ke.hpt)),C.hidden=="1"&&(q=!0,ke.hidden=!0),C.outlineLevel!=null&&(q=!0,ke.level=+C.outlineLevel),q&&(se[j-1]=ke)),w=_.slice(y).split(r);for(var Ne=0;Ne!=w.length&&w[Ne].trim().charAt(0)=="<";++Ne);for(w=w.slice(Ne),y=0;y!=w.length;++y)if(_=w[y].trim(),_.length!==0){if(A=_.match(t),T=y,S=0,N=0,_="<c "+(_.slice(0,1)=="<"?">":"")+_,A!=null&&A.length===2){for(T=0,R=A[1],S=0;S!=R.length&&!((N=R.charCodeAt(S)-64)<1||N>26);++S)T=26*T+N;--T,I=T}else++I;for(S=0;S!=_.length&&_.charCodeAt(S)!==62;++S);if(++S,C=Ke(_.slice(0,S),!0),C.r||(C.r=Qe({r:j-1,c:I})),R=_.slice(S),O={t:""},(A=R.match(i))!=null&&A[1]!==""&&(O.v=yt(A[1])),f.cellFormula){if((A=R.match(o))!=null&&A[1]!==""){if(O.f=yt($t(A[1])).replace(/\r\n/g,`
`),f.xlfn||(O.f=wb(O.f)),A[0].indexOf('t="array"')>-1)O.F=(R.match(s)||[])[1],O.F.indexOf(":")>-1&&U.push([pr(O.F),O.F]);else if(A[0].indexOf('t="shared"')>-1){H=Ke(A[0]);var Ee=yt($t(A[1]));f.xlfn||(Ee=wb(Ee)),te[parseInt(H.si,10)]=[H,Ee,C.r]}}else(A=R.match(/<f[^>]*\/>/))&&(H=Ke(A[0]),te[H.si]&&(O.f=_L(te[H.si][1],te[H.si][2],C.r)));var Ae=ga(C.r);for(S=0;S<U.length;++S)Ae.r>=U[S][0].s.r&&Ae.r<=U[S][0].e.r&&Ae.c>=U[S][0].s.c&&Ae.c<=U[S][0].e.c&&(O.F=U[S][1])}if(C.t==null&&O.v===void 0)if(O.f||O.F)O.v=0,O.t="n";else if(F)O.t="z";else continue;else O.t=C.t||"n";switch(g.s.c>I&&(g.s.c=I),g.e.c<I&&(g.e.c=I),O.t){case"n":if(O.v==""||O.v==null){if(!F)continue;O.t="z"}else O.v=parseFloat(O.v);break;case"s":if(typeof O.v>"u"){if(!F)continue;O.t="z"}else W=lu[parseInt(O.v,10)],O.v=W.t,O.r=W.r,f.cellHTML&&(O.h=W.h);break;case"str":O.t="s",O.v=O.v!=null?$t(O.v):"",f.cellHTML&&(O.h=Tm(O.v));break;case"inlineStr":A=R.match(a),O.t="s",A!=null&&(W=Im(A[1]))?(O.v=W.t,f.cellHTML&&(O.h=W.h)):O.v="";break;case"b":O.v=rr(O.v);break;case"d":f.cellDates?O.v=Hr(O.v,1):(O.v=xa(Hr(O.v,1)),O.t="n");break;case"e":(!f||f.cellText!==!1)&&(O.w=O.v),O.v=PE[O.v];break}if(D=z=0,re=null,ne&&C.s!==void 0&&(re=x.CellXf[C.s],re!=null&&(re.numFmtId!=null&&(D=re.numFmtId),f.cellStyles&&re.fillId!=null&&(z=re.fillId))),mA(O,D,z,f,v,x),f.cellDates&&ne&&O.t=="n"&&$l(it[D])&&(O.t="d",O.v=gf(O.v)),C.cm&&f.xlmeta){var rt=(f.xlmeta.Cell||[])[+C.cm-1];rt&&rt.type=="XLDAPR"&&(O.D=!0)}if(be){var Z=ga(C.r);d[Z.r]||(d[Z.r]=[]),d[Z.r][Z.c]=O}else d[C.r]=O}}}}se.length>0&&(d["!rows"]=se)}})();function cj(r,e){var t={},a=r.l+e;t.r=r.read_shift(4),r.l+=4;var s=r.read_shift(2);r.l+=1;var i=r.read_shift(1);return r.l=a,i&7&&(t.level=i&7),i&16&&(t.hidden=!0),i&32&&(t.hpt=s/20),t}var uj=mo;function hj(){}function dj(r,e){var t={},a=r[r.l];return++r.l,t.above=!(a&64),t.left=!(a&128),r.l+=18,t.name=M4(r),t}function fj(r){var e=bs(r);return[e]}function pj(r){var e=go(r);return[e]}function gj(r){var e=bs(r),t=r.read_shift(1);return[e,t,"b"]}function mj(r){var e=go(r),t=r.read_shift(1);return[e,t,"b"]}function vj(r){var e=bs(r),t=r.read_shift(1);return[e,t,"e"]}function xj(r){var e=go(r),t=r.read_shift(1);return[e,t,"e"]}function _j(r){var e=bs(r),t=r.read_shift(4);return[e,t,"s"]}function yj(r){var e=go(r),t=r.read_shift(4);return[e,t,"s"]}function bj(r){var e=bs(r),t=sa(r);return[e,t,"n"]}function xA(r){var e=go(r),t=sa(r);return[e,t,"n"]}function wj(r){var e=bs(r),t=Fm(r);return[e,t,"n"]}function Ej(r){var e=go(r),t=Fm(r);return[e,t,"n"]}function Aj(r){var e=bs(r),t=Om(r);return[e,t,"is"]}function Sj(r){var e=bs(r),t=ia(r);return[e,t,"str"]}function Tj(r){var e=go(r),t=ia(r);return[e,t,"str"]}function Cj(r,e,t){var a=r.l+e,s=bs(r);s.r=t["!row"];var i=r.read_shift(1),o=[s,i,"b"];if(t.cellFormula){r.l+=2;var c=xf(r,a-r.l,t);o[3]=aa(c,null,s,t.supbooks,t)}else r.l=a;return o}function kj(r,e,t){var a=r.l+e,s=bs(r);s.r=t["!row"];var i=r.read_shift(1),o=[s,i,"e"];if(t.cellFormula){r.l+=2;var c=xf(r,a-r.l,t);o[3]=aa(c,null,s,t.supbooks,t)}else r.l=a;return o}function Nj(r,e,t){var a=r.l+e,s=bs(r);s.r=t["!row"];var i=sa(r),o=[s,i,"n"];if(t.cellFormula){r.l+=2;var c=xf(r,a-r.l,t);o[3]=aa(c,null,s,t.supbooks,t)}else r.l=a;return o}function Rj(r,e,t){var a=r.l+e,s=bs(r);s.r=t["!row"];var i=ia(r),o=[s,i,"str"];if(t.cellFormula){r.l+=2;var c=xf(r,a-r.l,t);o[3]=aa(c,null,s,t.supbooks,t)}else r.l=a;return o}var Oj=mo;function Dj(r,e){var t=r.l+e,a=mo(r),s=Dm(r),i=ia(r),o=ia(r),c=ia(r);r.l=t;var u={rfx:a,relId:s,loc:i,display:c};return o&&(u.Tooltip=o),u}function Fj(){}function Mj(r,e,t){var a=r.l+e,s=LE(r),i=r.read_shift(1),o=[s];if(o[2]=i,t.cellFormula){var c=BI(r,a-r.l,t);o[1]=c}else r.l=a;return o}function Lj(r,e,t){var a=r.l+e,s=mo(r),i=[s];if(t.cellFormula){var o=zI(r,a-r.l,t);i[1]=o,r.l=a}else r.l=a;return i}var Ij=["left","right","top","bottom","header","footer"];function jj(r){var e={};return Ij.forEach(function(t){e[t]=sa(r)}),e}function Pj(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function Bj(){}function Uj(){}function zj(r,e,t,a,s,i,o){if(!r)return r;var c=e||{};a||(a={"!id":{}});var u=c.dense?[]:{},d,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,v=!1,x,y,_,w,A,T,S,N,R,O=[];c.biff=12,c["!row"]=0;var C=0,j=!1,I=[],W={},H=c.supbooks||s.supbooks||[[]];if(H.sharedf=W,H.arrayf=I,H.SheetNames=s.SheetNames||s.Sheets.map(function(be){return be.name}),!c.supbooks&&(c.supbooks=H,s.Names))for(var D=0;D<s.Names.length;++D)H[0][D+1]=s.Names[D];var z=[],ne=[],re=!1;sf[16]={n:"BrtShortReal",f:xA};var U;if(In(r,function(se,ke,q){if(!v)switch(q){case 148:d=se;break;case 0:x=se,c.sheetRows&&c.sheetRows<=x.r&&(v=!0),N=Zr(w=x.r),c["!row"]=x.r,(se.hidden||se.hpt||se.level!=null)&&(se.hpt&&(se.hpx=Su(se.hpt)),ne[se.r]=se);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:se[2]},se[2]){case"n":y.v=se[1];break;case"s":S=lu[se[1]],y.v=S.t,y.r=S.r;break;case"b":y.v=!!se[1];break;case"e":y.v=se[1],c.cellText!==!1&&(y.w=vo[y.v]);break;case"str":y.t="s",y.v=se[1];break;case"is":y.t="s",y.v=se[1].t;break}if((_=o.CellXf[se[0].iStyleRef])&&mA(y,_.numFmtId,null,c,i,o),A=se[0].c==-1?A+1:se[0].c,c.dense?(u[w]||(u[w]=[]),u[w][A]=y):u[Lr(A)+N]=y,c.cellFormula){for(j=!1,C=0;C<I.length;++C){var F=I[C];x.r>=F[0].s.r&&x.r<=F[0].e.r&&A>=F[0].s.c&&A<=F[0].e.c&&(y.F=_t(F[0]),j=!0)}!j&&se.length>3&&(y.f=se[3])}if(f.s.r>x.r&&(f.s.r=x.r),f.s.c>A&&(f.s.c=A),f.e.r<x.r&&(f.e.r=x.r),f.e.c<A&&(f.e.c=A),c.cellDates&&_&&y.t=="n"&&$l(it[_.numFmtId])){var J=Qi(y.v);J&&(y.t="d",y.v=new Date(J.y,J.m-1,J.d,J.H,J.M,J.S,J.u))}U&&(U.type=="XLDAPR"&&(y.D=!0),U=void 0);break;case 1:case 12:if(!c.sheetStubs||g)break;y={t:"z",v:void 0},A=se[0].c==-1?A+1:se[0].c,c.dense?(u[w]||(u[w]=[]),u[w][A]=y):u[Lr(A)+N]=y,f.s.r>x.r&&(f.s.r=x.r),f.s.c>A&&(f.s.c=A),f.e.r<x.r&&(f.e.r=x.r),f.e.c<A&&(f.e.c=A),U&&(U.type=="XLDAPR"&&(y.D=!0),U=void 0);break;case 176:O.push(se);break;case 49:U=((c.xlmeta||{}).Cell||[])[se-1];break;case 494:var K=a["!id"][se.relId];for(K?(se.Target=K.Target,se.loc&&(se.Target+="#"+se.loc),se.Rel=K):se.relId==""&&(se.Target="#"+se.loc),w=se.rfx.s.r;w<=se.rfx.e.r;++w)for(A=se.rfx.s.c;A<=se.rfx.e.c;++A)c.dense?(u[w]||(u[w]=[]),u[w][A]||(u[w][A]={t:"z",v:void 0}),u[w][A].l=se):(T=Qe({c:A,r:w}),u[T]||(u[T]={t:"z",v:void 0}),u[T].l=se);break;case 426:if(!c.cellFormula)break;I.push(se),R=c.dense?u[w][A]:u[Lr(A)+N],R.f=aa(se[1],f,{r:x.r,c:A},H,c),R.F=_t(se[0]);break;case 427:if(!c.cellFormula)break;W[Qe(se[0].s)]=se[1],R=c.dense?u[w][A]:u[Lr(A)+N],R.f=aa(se[1],f,{r:x.r,c:A},H,c);break;case 60:if(!c.cellStyles)break;for(;se.e>=se.s;)z[se.e--]={width:se.w/256,hidden:!!(se.flags&1),level:se.level},re||(re=!0,jm(se.w/256)),jl(z[se.e+1]);break;case 161:u["!autofilter"]={ref:_t(se)};break;case 476:u["!margins"]=se;break;case 147:s.Sheets[t]||(s.Sheets[t]={}),se.name&&(s.Sheets[t].CodeName=se.name),(se.above||se.left)&&(u["!outline"]={above:se.above,left:se.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),se.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!ke.T){if(!g||c.WTF)throw new Error("Unexpected record 0x"+q.toString(16))}}},c),delete c.supbooks,delete c["!row"],!u["!ref"]&&(f.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(u["!ref"]=_t(d||f)),c.sheetRows&&u["!ref"]){var te=pr(u["!ref"]);c.sheetRows<=+te.e.r&&(te.e.r=c.sheetRows-1,te.e.r>f.e.r&&(te.e.r=f.e.r),te.e.r<te.s.r&&(te.s.r=te.e.r),te.e.c>f.e.c&&(te.e.c=f.e.c),te.e.c<te.s.c&&(te.s.c=te.e.c),u["!fullref"]=u["!ref"],u["!ref"]=_t(te))}return O.length>0&&(u["!merges"]=O),z.length>0&&(u["!cols"]=z),ne.length>0&&(u["!rows"]=ne),u}function Hj(r){var e=[],t=r.match(/^<c:numCache>/),a;(r.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=t?+o[2]:o[2])});var s=yt((r.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(r.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[e,s,a]}function $j(r,e,t,a,s,i){var o=i||{"!type":"chart"};if(!r)return i;var c=0,u=0,d="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var v=Hj(g);f.s.r=f.s.c=0,f.e.c=c,d=Lr(c),v[0].forEach(function(x,y){o[d+Zr(y)]={t:"n",v:x,z:v[1]},u=y}),f.e.r<u&&(f.e.r=u),++c}),c>0&&(o["!ref"]=_t(f)),o}function Gj(r,e,t,a,s){if(!r)return r;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,c=r.match(vA);return c&&Bm(c[0],i,s,t),(o=r.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function Vj(r,e){r.l+=10;var t=ia(r);return{name:t}}function qj(r,e,t,a,s){if(!r)return r;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return In(r,function(u,d,f){switch(f){case 550:i["!rel"]=u;break;case 651:s.Sheets[t]||(s.Sheets[t]={}),u.name&&(s.Sheets[t].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},e),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var _A=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Wj=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Xj=[],Yj=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Cb(r,e){for(var t=0;t!=r.length;++t)for(var a=r[t],s=0;s!=e.length;++s){var i=e[s];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=rr(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function kb(r,e){for(var t=0;t!=e.length;++t){var a=e[t];if(r[a[0]]==null)r[a[0]]=a[1];else switch(a[2]){case"bool":typeof r[a[0]]=="string"&&(r[a[0]]=rr(r[a[0]]));break;case"int":typeof r[a[0]]=="string"&&(r[a[0]]=parseInt(r[a[0]],10));break}}}function yA(r){kb(r.WBProps,_A),kb(r.CalcPr,Yj),Cb(r.WBView,Wj),Cb(r.Sheets,Xj),Ol.date1904=rr(r.WBProps.date1904)}var Kj="][*?/\\".split("");function Jj(r,e){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return Kj.forEach(function(a){if(r.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var Qj=/<\w+:workbook/;function Zj(r,e){if(!r)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,s="xmlns",i={},o=0;if(r.replace(la,function(u,d){var f=Ke(u);switch(an(f[0])){case"<?xml":break;case"<workbook":u.match(Qj)&&(s="xmlns"+u.match(/<(\w+):/)[1]),t.xmlns=f[s];break;case"</workbook>":break;case"<fileVersion":delete f[0],t.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":_A.forEach(function(g){if(f[g[0]]!=null)switch(g[2]){case"bool":t.WBProps[g[0]]=rr(f[g[0]]);break;case"int":t.WBProps[g[0]]=parseInt(f[g[0]],10);break;default:t.WBProps[g[0]]=f[g[0]]}}),f.codeName&&(t.WBProps.CodeName=$t(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],t.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=yt($t(f.name)),delete f[0],t.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=$t(f.name),f.comment&&(i.Comment=f.comment),f.localSheetId&&(i.Sheet=+f.localSheetId),rr(f.hidden||"0")&&(i.Hidden=!0),o=d+u.length;break;case"</definedName>":i.Ref=yt($t(r.slice(o,d))),t.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete f[0],t.CalcPr=f;break;case"<calcPr/>":delete f[0],t.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&e.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return u}),v4.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return yA(t),t}function eP(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=Mg(r),t.name=ia(r),t}function tP(r,e){var t={},a=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var s=e>8?ia(r):"";return s.length>0&&(t.CodeName=s),t.autoCompressPictures=!!(a&65536),t.backupFile=!!(a&64),t.checkCompatibility=!!(a&4096),t.date1904=!!(a&1),t.filterPrivacy=!!(a&8),t.hidePivotFieldList=!!(a&1024),t.promptedSolutions=!!(a&16),t.publishItems=!!(a&2048),t.refreshAllConnections=!!(a&262144),t.saveExternalLinkValues=!!(a&128),t.showBorderUnselectedTables=!!(a&4),t.showInkAnnotation=!!(a&32),t.showObjects=["all","placeholders","none"][a>>13&3],t.showPivotChartFilter=!!(a&32768),t.updateLinks=["userSet","never","always"][a>>8&3],t}function rP(r,e){var t={};return r.read_shift(4),t.ArchID=r.read_shift(4),r.l+=e-8,t}function aP(r,e,t){var a=r.l+e;r.l+=4,r.l+=1;var s=r.read_shift(4),i=L4(r),o=UI(r,0,t),c=Dm(r);r.l=a;var u={Name:i,Ptg:o};return s<268435455&&(u.Sheet=s),c&&(u.Comment=c),u}function sP(r,e){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;e||(e={}),e.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],sf[16]={n:"BrtFRTArchID$",f:rP},In(r,function(u,d,f){switch(f){case 156:o.SheetNames.push(u.name),t.Sheets.push(u);break;case 153:t.WBProps=u;break;case 39:u.Sheet!=null&&(e.SID=u.Sheet),u.Ref=aa(u.Ptg,null,null,o,e),delete e.SID,delete u.Ptg,i.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([f,u]):o[0]=[f,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(f),s=!0;break;case 36:a.pop(),s=!1;break;case 37:a.push(f),s=!0;break;case 38:a.pop(),s=!1;break;case 16:break;default:if(!d.T){if(!s||e.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},e),yA(t),t.Names=i,t.supbooks=o,t}function nP(r,e,t){return e.slice(-4)===".bin"?sP(r,t):Zj(r,t)}function iP(r,e,t,a,s,i,o,c){return e.slice(-4)===".bin"?zj(r,a,t,s,i,o,c):ej(r,a,t,s,i,o,c)}function oP(r,e,t,a,s,i,o,c){return e.slice(-4)===".bin"?qj(r,a,t,s,i):Gj(r,a,t,s,i)}function lP(r,e,t,a,s,i,o,c){return e.slice(-4)===".bin"?mL():vL()}function cP(r,e,t,a,s,i,o,c){return e.slice(-4)===".bin"?pL():gL()}function uP(r,e,t,a){return e.slice(-4)===".bin"?OM(r,t,a):SM(r,t,a)}function hP(r,e,t){return iA(r,t)}function dP(r,e,t){return e.slice(-4)===".bin"?WF(r,t):VF(r,t)}function fP(r,e,t){return e.slice(-4)===".bin"?hL(r,t):iL(r,t)}function pP(r,e,t){return e.slice(-4)===".bin"?aL(r):tL(r)}function gP(r,e,t,a){return t.slice(-4)===".bin"?sL(r,e,t,a):void 0}function mP(r,e,t){return e.slice(-4)===".bin"?ZM(r,e,t):eL(r,e,t)}var bA=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,wA=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ks(r,e){var t=r.split(/\s+/),a=[];if(a[0]=t[0],t.length===1)return a;var s=r.match(bA),i,o,c,u;if(s)for(u=0;u!=s.length;++u)i=s[u].match(wA),(o=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(o+1),a[c]=i[2].slice(1,i[2].length-1));return a}function vP(r){var e=r.split(/\s+/),t={};if(e.length===1)return t;var a=r.match(bA),s,i,o,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(wA),(i=s[1].indexOf(":"))===-1?t[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),t[o]=s[2].slice(1,s[2].length-1));return t}var uu;function xP(r,e){var t=uu[r]||yt(r);return t==="General"?io(e):_s(t,e)}function _P(r,e,t,a){var s=a;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=rr(a);break;case"i2":case"int":s=parseInt(a,10);break;case"r4":case"float":s=parseFloat(a);break;case"date":case"dateTime.tz":s=Hr(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}r[yt(e)]=s}function yP(r,e,t){if(r.t!=="z"){if(!t||t.cellText!==!1)try{r.t==="e"?r.w=r.w||vo[r.v]:e==="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=yu(r.v):r.w=io(r.v):r.w=xP(e||"General",r.v)}catch(i){if(t.WTF)throw i}try{var a=uu[e]||e||"General";if(t.cellNF&&(r.z=a),t.cellDates&&r.t=="n"&&$l(a)){var s=Qi(r.v);s&&(r.t="d",r.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(t.WTF)throw i}}}function bP(r,e,t){if(t.cellStyles&&e.Interior){var a=e.Interior;a.Pattern&&(a.patternType=_M[a.Pattern]||a.Pattern)}r[e.ID]=e}function wP(r,e,t,a,s,i,o,c,u,d){var f="General",g=a.StyleID,v={};d=d||{};var x=[],y=0;for(g===void 0&&c&&(g=c.StyleID),g===void 0&&o&&(g=o.StyleID);i[g]!==void 0&&(i[g].nf&&(f=i[g].nf),i[g].Interior&&x.push(i[g].Interior),!!i[g].Parent);)g=i[g].Parent;switch(t.Type){case"Boolean":a.t="b",a.v=rr(r);break;case"String":a.t="s",a.r=Ky(yt(r)),a.v=r.indexOf("<")>-1?yt(e||r).replace(/<.*?>/g,""):a.r;break;case"DateTime":r.slice(-1)!="Z"&&(r+="Z"),a.v=(Hr(r)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=yt(r):a.v<60&&(a.v=a.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+r),a.t||(a.t="n");break;case"Error":a.t="e",a.v=PE[r],d.cellText!==!1&&(a.w=r);break;default:r==""&&e==""?a.t="z":(a.t="s",a.v=Ky(e||r));break}if(yP(a,f,d),d.cellFormula!==!1)if(a.Formula){var _=yt(a.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),a.f=Rl(_,s),delete a.Formula,a.ArrayRange=="RC"?a.F=Rl("RC:RC",s):a.ArrayRange&&(a.F=Rl(a.ArrayRange,s),u.push([pr(a.F),a.F]))}else for(y=0;y<u.length;++y)s.r>=u[y][0].s.r&&s.r<=u[y][0].e.r&&s.c>=u[y][0].s.c&&s.c<=u[y][0].e.c&&(a.F=u[y][1]);d.cellStyles&&(x.forEach(function(w){!v.patternType&&w.patternType&&(v.patternType=w.patternType)}),a.s=v),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function EP(r){r.t=r.v||"",r.t=r.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.v=r.w=r.ixfe=void 0}function lg(r,e){var t=e||{};uE();var a=qc(Cm(r));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(a=$t(a));var s=a.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=Qr(t);return o.type="string",Eu.to_workbook(a,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Yt){s.indexOf("<"+Yt)>=0&&(i=!0)}),i)return DP(a,t);uu={"General Number":"General","General Date":it[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":it[15],"Short Date":it[14],"Long Time":it[19],"Medium Time":it[18],"Short Time":it[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:it[2],Standard:it[4],Percent:it[10],Scientific:it[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,u=[],d,f={},g=[],v=t.dense?[]:{},x="",y={},_={},w=ks('<Data ss:Type="String">'),A=0,T=0,S=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},R={},O={},C="",j=0,I=[],W={},H={},D=0,z=[],ne=[],re={},U=[],te,be=!1,se=[],ke=[],q={},F=0,J=0,K={Sheets:[],WBProps:{date1904:!1}},Y={};wu.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var oe="";c=wu.exec(a);)switch(c[3]=(oe=c[3]).toLowerCase()){case"data":if(oe=="data"){if(c[1]==="/"){if((d=u.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break}if(u[u.length-1][1])break;c[1]==="/"?wP(a.slice(A,c.index),C,w,u[u.length-1][0]=="comment"?re:y,{c:T,r:S},R,U[T],_,se,t):(C="",w=ks(c[0]),A=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(ne.length>0&&(y.c=ne),(!t.sheetRows||t.sheetRows>S)&&y.v!==void 0&&(t.dense?(v[S]||(v[S]=[]),v[S][T]=y):v[Lr(T)+Zr(S)]=y),y.HRef&&(y.l={Target:yt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(F=T+(parseInt(y.MergeAcross,10)|0),J=S+(parseInt(y.MergeDown,10)|0),I.push({s:{c:T,r:S},e:{c:F,r:J}})),!t.sheetStubs)y.MergeAcross?T=F+1:++T;else if(y.MergeAcross||y.MergeDown){for(var ve=T;ve<=F;++ve)for(var Ne=S;Ne<=J;++Ne)(ve>T||Ne>S)&&(t.dense?(v[Ne]||(v[Ne]=[]),v[Ne][ve]={t:"z"}):v[Lr(ve)+Zr(Ne)]={t:"z"});T=F+1}else++T;else y=vP(c[0]),y.Index&&(T=+y.Index-1),T<N.s.c&&(N.s.c=T),T>N.e.c&&(N.e.c=T),c[0].slice(-2)==="/>"&&++T,ne=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(S<N.s.r&&(N.s.r=S),S>N.e.r&&(N.e.r=S),c[0].slice(-2)==="/>"&&(_=ks(c[0]),_.Index&&(S=+_.Index-1)),T=0,++S):(_=ks(c[0]),_.Index&&(S=+_.Index-1),q={},(_.AutoFitHeight=="0"||_.Height)&&(q.hpx=parseInt(_.Height,10),q.hpt=nA(q.hpx),ke[S]=q),_.Hidden=="1"&&(q.hidden=!0,ke[S]=q));break;case"worksheet":if(c[1]==="/"){if((d=u.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));g.push(x),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(v["!ref"]=_t(N),t.sheetRows&&t.sheetRows<=N.e.r&&(v["!fullref"]=v["!ref"],N.e.r=t.sheetRows-1,v["!ref"]=_t(N))),I.length&&(v["!merges"]=I),U.length>0&&(v["!cols"]=U),ke.length>0&&(v["!rows"]=ke),f[x]=v}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=T=0,u.push([c[3],!1]),d=ks(c[0]),x=yt(d.Name),v=t.dense?[]:{},I=[],se=[],ke=[],Y={name:x,Hidden:0},K.Sheets.push(Y);break;case"table":if(c[1]==="/"){if((d=u.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else{if(c[0].slice(-2)=="/>")break;u.push([c[3],!1]),U=[],be=!1}break;case"style":c[1]==="/"?bP(R,O,t):O=ks(c[0]);break;case"numberformat":O.nf=yt(ks(c[0]).Format||"General"),uu[O.nf]&&(O.nf=uu[O.nf]);for(var Ee=0;Ee!=392&&it[Ee]!=O.nf;++Ee);if(Ee==392){for(Ee=57;Ee!=392;++Ee)if(it[Ee]==null){ao(O.nf,Ee);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(te=ks(c[0]),te.Hidden&&(te.hidden=!0,delete te.Hidden),te.Width&&(te.wpx=parseInt(te.Width,10)),!be&&te.wpx>10){be=!0,pa=aA;for(var Ae=0;Ae<U.length;++Ae)U[Ae]&&jl(U[Ae])}be&&jl(te),U[te.Index-1||U.length]=te;for(var rt=0;rt<+te.Span;++rt)U[U.length]=Qr(te);break;case"namedrange":if(c[1]==="/")break;K.Names||(K.Names=[]);var Z=Ke(c[0]),Mt={Name:Z.Name,Ref:Rl(Z.RefersTo.slice(1),{r:0,c:0})};K.Sheets.length>0&&(Mt.Sheet=K.Sheets.length-1),K.Names.push(Mt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?C+=a.slice(j,c.index):j=c.index+c[0].length;break;case"interior":if(!t.cellStyles)break;O.Interior=ks(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?i3(W,oe,a.slice(D,c.index)):D=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((d=u.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else u.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((d=u.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));EP(re),ne.push(re)}else u.push([c[3],!1]),d=ks(c[0]),re={a:d.Author};break;case"autofilter":if(c[1]==="/"){if((d=u.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var at=ks(c[0]);v["!autofilter"]={ref:Rl(at.Range).replace(/\$/g,"")},u.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((d=u.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((d=u.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"null":break;default:if(u.length==0&&c[3]=="document"||u.length==0&&c[3]=="uof")return Mb(a,t);var At=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:At=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:At=!1}break;case"excelworkbook":switch(c[3]){case"date1904":K.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:At=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:At=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(a.slice(D,c.index)){case"SheetHidden":Y.Hidden=1;break;case"SheetVeryHidden":Y.Hidden=2;break}else D=c.index+c[0].length;break;case"header":v["!margins"]||cu(v["!margins"]={},"xlml"),isNaN(+Ke(c[0]).Margin)||(v["!margins"].header=+Ke(c[0]).Margin);break;case"footer":v["!margins"]||cu(v["!margins"]={},"xlml"),isNaN(+Ke(c[0]).Margin)||(v["!margins"].footer=+Ke(c[0]).Margin);break;case"pagemargins":var ot=Ke(c[0]);v["!margins"]||cu(v["!margins"]={},"xlml"),isNaN(+ot.Top)||(v["!margins"].top=+ot.Top),isNaN(+ot.Left)||(v["!margins"].left=+ot.Left),isNaN(+ot.Right)||(v["!margins"].right=+ot.Right),isNaN(+ot.Bottom)||(v["!margins"].bottom=+ot.Bottom);break;case"displayrighttoleft":K.Views||(K.Views=[]),K.Views[0]||(K.Views[0]={}),K.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:At=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:At=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:At=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:At=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:At=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:At=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:At=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:At=!1}break;case"smarttags":break;default:At=!1;break}if(At||c[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?_P(H,oe,z,a.slice(D,c.index)):(z=c,D=c.index+c[0].length);break}if(t.WTF)throw"Unrecognized tag: "+c[3]+"|"+u.join("|")}var De={};return!t.bookSheets&&!t.bookProps&&(De.Sheets=f),De.SheetNames=g,De.Workbook=K,De.SSF=Qr(it),De.Props=W,De.Custprops=H,De}function Pg(r,e){switch(Hm(e=e||{}),e.type||"base64"){case"base64":return lg(Ka(r),e);case"binary":case"buffer":case"file":return lg(r,e);case"array":return lg(po(r),e)}}function AP(r){var e={},t=r.content;if(t.l=28,e.AnsiUserType=t.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=P4(t),t.length-t.l<=4)return e;var a=t.read_shift(4);if(a==0||a>40||(t.l-=4,e.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(a=t.read_shift(4),a!==1907505652)||(e.UnicodeClipboardFormat=B4(t),a=t.read_shift(4),a==0||a>40))return e;t.l-=4,e.Reserved2=t.read_shift(0,"lpwstr")}var SP=[60,1084,2066,2165,2175];function TP(r,e,t,a,s){var i=a,o=[],c=t.slice(t.l,t.l+i);if(s&&s.enc&&s.enc.insitu&&c.length>0)switch(r){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(c)}o.push(c),t.l+=i;for(var u=kn(t,t.l),d=Bg[u],f=0;d!=null&&SP.indexOf(u)>-1;)i=kn(t,t.l+2),f=t.l+4,u==2066?f+=4:(u==2165||u==2175)&&(f+=12),c=t.slice(f,t.l+4+i),o.push(c),t.l+=4+i,d=Bg[u=kn(t,t.l)];var g=di(o);Jr(g,0);var v=0;g.lens=[];for(var x=0;x<o.length;++x)g.lens.push(v),v+=o[x].length;if(g.length<a)throw"XLS Record 0x"+r.toString(16)+" Truncated: "+g.length+" < "+a;return e.f(g,g.length,s)}function Ys(r,e,t){if(r.t!=="z"&&r.XF){var a=0;try{a=r.z||r.XF.numFmtId||0,e.cellNF&&(r.z=it[a])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{r.t==="e"?r.w=r.w||vo[r.v]:a===0||a=="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=yu(r.v):r.w=io(r.v):r.w=_s(a,r.v,{date1904:!!t,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&a&&r.t=="n"&&$l(it[a]||String(a))){var s=Qi(r.v);s&&(r.t="d",r.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Cd(r,e,t){return{v:r,ixfe:e,t}}function CP(r,e){var t={opts:{}},a={},s=e.dense?[]:{},i={},o={},c=null,u=[],d="",f={},g,v="",x,y,_,w,A={},T=[],S,N,R=[],O=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},j={},I=function(lt){return lt<8?so[lt]:lt<64&&O[lt-8]||so[lt]},W=function(lt,sr,ya){var Gt=sr.XF.data;if(!(!Gt||!Gt.patternType||!ya||!ya.cellStyles)){sr.s={},sr.s.patternType=Gt.patternType;var gr;(gr=Au(I(Gt.icvFore)))&&(sr.s.fgColor={rgb:gr}),(gr=Au(I(Gt.icvBack)))&&(sr.s.bgColor={rgb:gr})}},H=function(lt,sr,ya){if(!(q>1)&&!(ya.sheetRows&&lt.r>=ya.sheetRows)){if(ya.cellStyles&&sr.XF&&sr.XF.data&&W(lt,sr,ya),delete sr.ixfe,delete sr.XF,g=lt,v=Qe(lt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),lt.r<o.s.r&&(o.s.r=lt.r),lt.c<o.s.c&&(o.s.c=lt.c),lt.r+1>o.e.r&&(o.e.r=lt.r+1),lt.c+1>o.e.c&&(o.e.c=lt.c+1),ya.cellFormula&&sr.f){for(var Gt=0;Gt<T.length;++Gt)if(!(T[Gt][0].s.c>lt.c||T[Gt][0].s.r>lt.r)&&!(T[Gt][0].e.c<lt.c||T[Gt][0].e.r<lt.r)){sr.F=_t(T[Gt][0]),(T[Gt][0].s.c!=lt.c||T[Gt][0].s.r!=lt.r)&&delete sr.f,sr.f&&(sr.f=""+aa(T[Gt][1],o,lt,se,D));break}}ya.dense?(s[lt.r]||(s[lt.r]=[]),s[lt.r][lt.c]=sr):s[v]=sr}},D={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(D.password=e.password);var z,ne=[],re=[],U=[],te=[],be=!1,se=[];se.SheetNames=D.snames,se.sharedf=D.sharedf,se.arrayf=D.arrayf,se.names=[],se.XTI=[];var ke=0,q=0,F=0,J=[],K=[],Y;D.codepage=1200,js(1200);for(var oe=!1;r.l<r.length-1;){var ve=r.l,Ne=r.read_shift(2);if(Ne===0&&ke===10)break;var Ee=r.l===r.length?0:r.read_shift(2),Ae=Bg[Ne];if(Ae&&Ae.f){if(e.bookSheets&&ke===133&&Ne!==133)break;if(ke=Ne,Ae.r===2||Ae.r==12){var rt=r.read_shift(2);if(Ee-=2,!D.enc&&rt!==Ne&&((rt&255)<<8|rt>>8)!==Ne)throw new Error("rt mismatch: "+rt+"!="+Ne);Ae.r==12&&(r.l+=10,Ee-=10)}var Z={};if(Ne===10?Z=Ae.f(r,Ee,D):Z=TP(Ne,Ae,r,Ee,D),q==0&&[9,521,1033,2057].indexOf(ke)===-1)continue;switch(Ne){case 34:t.opts.Date1904=C.WBProps.date1904=Z;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(D.enc||(r.l=0),D.enc=Z,!e.password)throw new Error("File is password-protected");if(Z.valid==null)throw new Error("Encryption scheme unsupported");if(!Z.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=Z;break;case 66:var Mt=Number(Z);switch(Mt){case 21010:Mt=1200;break;case 32768:Mt=1e4;break;case 32769:Mt=1252;break}js(D.codepage=Mt),oe=!0;break;case 317:D.rrtabid=Z;break;case 25:D.winlocked=Z;break;case 439:t.opts.RefreshAll=Z;break;case 12:t.opts.CalcCount=Z;break;case 16:t.opts.CalcDelta=Z;break;case 17:t.opts.CalcIter=Z;break;case 13:t.opts.CalcMode=Z;break;case 14:t.opts.CalcPrecision=Z;break;case 95:t.opts.CalcSaveRecalc=Z;break;case 15:D.CalcRefMode=Z;break;case 2211:t.opts.FullCalc=Z;break;case 129:Z.fDialog&&(s["!type"]="dialog"),Z.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),Z.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:R.push(Z);break;case 430:se.push([Z]),se[se.length-1].XTI=[];break;case 35:case 547:se[se.length-1].push(Z);break;case 24:case 536:Y={Name:Z.Name,Ref:aa(Z.rgce,o,null,se,D)},Z.itab>0&&(Y.Sheet=Z.itab-1),se.names.push(Y),se[0]||(se[0]=[],se[0].XTI=[]),se[se.length-1].push(Z),Z.Name=="_xlnm._FilterDatabase"&&Z.itab>0&&Z.rgce&&Z.rgce[0]&&Z.rgce[0][0]&&Z.rgce[0][0][0]=="PtgArea3d"&&(K[Z.itab-1]={ref:_t(Z.rgce[0][0][1][2])});break;case 22:D.ExternCount=Z;break;case 23:se.length==0&&(se[0]=[],se[0].XTI=[]),se[se.length-1].XTI=se[se.length-1].XTI.concat(Z),se.XTI=se.XTI.concat(Z);break;case 2196:if(D.biff<8)break;Y!=null&&(Y.Comment=Z[1]);break;case 18:s["!protect"]=Z;break;case 19:Z!==0&&D.WTF&&console.error("Password verifier: "+Z);break;case 133:i[Z.pos]=Z,D.snames.push(Z.name);break;case 10:{if(--q)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=_t(o),e.sheetRows&&e.sheetRows<=o.e.r){var at=o.e.r;o.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=_t(o),o.e.r=at}o.e.r++,o.e.c++}ne.length>0&&(s["!merges"]=ne),re.length>0&&(s["!objects"]=re),U.length>0&&(s["!cols"]=U),te.length>0&&(s["!rows"]=te),C.Sheets.push(j)}d===""?f=s:a[d]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[Ne]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Z.BIFFVer]||8),D.biffguess=Z.BIFFVer==0,Z.BIFFVer==0&&Z.dt==4096&&(D.biff=5,oe=!0,js(D.codepage=28591)),D.biff==8&&Z.BIFFVer==0&&Z.dt==16&&(D.biff=2),q++)break;if(s=e.dense?[]:{},D.biff<8&&!oe&&(oe=!0,js(D.codepage=e.codepage||1252)),D.biff<5||Z.BIFFVer==0&&Z.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var At={pos:r.l-Ee,name:d};i[At.pos]=At,D.snames.push(d)}else d=(i[ve]||{name:""}).name;Z.dt==32&&(s["!type"]="chart"),Z.dt==64&&(s["!type"]="macro"),ne=[],re=[],D.arrayf=T=[],U=[],te=[],be=!1,j={Hidden:(i[ve]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[Z.r]||[])[Z.c]:s[Qe({c:Z.c,r:Z.r})])&&++Z.c,S={ixfe:Z.ixfe,XF:R[Z.ixfe]||{},v:Z.val,t:"n"},F>0&&(S.z=J[S.ixfe>>8&63]),Ys(S,e,t.opts.Date1904),H({c:Z.c,r:Z.r},S,e);break;case 5:case 517:S={ixfe:Z.ixfe,XF:R[Z.ixfe],v:Z.val,t:Z.t},F>0&&(S.z=J[S.ixfe>>8&63]),Ys(S,e,t.opts.Date1904),H({c:Z.c,r:Z.r},S,e);break;case 638:S={ixfe:Z.ixfe,XF:R[Z.ixfe],v:Z.rknum,t:"n"},F>0&&(S.z=J[S.ixfe>>8&63]),Ys(S,e,t.opts.Date1904),H({c:Z.c,r:Z.r},S,e);break;case 189:for(var ot=Z.c;ot<=Z.C;++ot){var De=Z.rkrec[ot-Z.c][0];S={ixfe:De,XF:R[De],v:Z.rkrec[ot-Z.c][1],t:"n"},F>0&&(S.z=J[S.ixfe>>8&63]),Ys(S,e,t.opts.Date1904),H({c:ot,r:Z.r},S,e)}break;case 6:case 518:case 1030:{if(Z.val=="String"){c=Z;break}if(S=Cd(Z.val,Z.cell.ixfe,Z.tt),S.XF=R[S.ixfe],e.cellFormula){var Yt=Z.formula;if(Yt&&Yt[0]&&Yt[0][0]&&Yt[0][0][0]=="PtgExp"){var ea=Yt[0][0][1][0],_a=Yt[0][0][1][1],Fa=Qe({r:ea,c:_a});A[Fa]?S.f=""+aa(Z.formula,o,Z.cell,se,D):S.F=((e.dense?(s[ea]||[])[_a]:s[Fa])||{}).F}else S.f=""+aa(Z.formula,o,Z.cell,se,D)}F>0&&(S.z=J[S.ixfe>>8&63]),Ys(S,e,t.opts.Date1904),H(Z.cell,S,e),c=Z}break;case 7:case 519:if(c)c.val=Z,S=Cd(Z,c.cell.ixfe,"s"),S.XF=R[S.ixfe],e.cellFormula&&(S.f=""+aa(c.formula,o,c.cell,se,D)),F>0&&(S.z=J[S.ixfe>>8&63]),Ys(S,e,t.opts.Date1904),H(c.cell,S,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(Z);var Ai=Qe(Z[0].s);if(x=e.dense?(s[Z[0].s.r]||[])[Z[0].s.c]:s[Ai],e.cellFormula&&x){if(!c||!Ai||!x)break;x.f=""+aa(Z[1],o,Z[0],se,D),x.F=_t(Z[0])}}break;case 1212:{if(!e.cellFormula)break;if(v){if(!c)break;A[Qe(c.cell)]=Z[0],x=e.dense?(s[c.cell.r]||[])[c.cell.c]:s[Qe(c.cell)],(x||{}).f=""+aa(Z[0],o,g,se,D)}}break;case 253:S=Cd(u[Z.isst].t,Z.ixfe,"s"),u[Z.isst].h&&(S.h=u[Z.isst].h),S.XF=R[S.ixfe],F>0&&(S.z=J[S.ixfe>>8&63]),Ys(S,e,t.opts.Date1904),H({c:Z.c,r:Z.r},S,e);break;case 513:e.sheetStubs&&(S={ixfe:Z.ixfe,XF:R[Z.ixfe],t:"z"},F>0&&(S.z=J[S.ixfe>>8&63]),Ys(S,e,t.opts.Date1904),H({c:Z.c,r:Z.r},S,e));break;case 190:if(e.sheetStubs)for(var zs=Z.c;zs<=Z.C;++zs){var Lt=Z.ixfe[zs-Z.c];S={ixfe:Lt,XF:R[Lt],t:"z"},F>0&&(S.z=J[S.ixfe>>8&63]),Ys(S,e,t.opts.Date1904),H({c:zs,r:Z.r},S,e)}break;case 214:case 516:case 4:S=Cd(Z.val,Z.ixfe,"s"),S.XF=R[S.ixfe],F>0&&(S.z=J[S.ixfe>>8&63]),Ys(S,e,t.opts.Date1904),H({c:Z.c,r:Z.r},S,e);break;case 0:case 512:q===1&&(o=Z);break;case 252:u=Z;break;case 1054:if(D.biff==4){J[F++]=Z[1];for(var ws=0;ws<F+163&&it[ws]!=Z[1];++ws);ws>=163&&ao(Z[1],F+163)}else ao(Z[1],Z[0]);break;case 30:{J[F++]=Z;for(var Es=0;Es<F+163&&it[Es]!=Z;++Es);Es>=163&&ao(Z,F+163)}break;case 229:ne=ne.concat(Z);break;case 93:re[Z.cmo[0]]=D.lastobj=Z;break;case 438:D.lastobj.TxO=Z;break;case 127:D.lastobj.ImData=Z;break;case 440:for(w=Z[0].s.r;w<=Z[0].e.r;++w)for(_=Z[0].s.c;_<=Z[0].e.c;++_)x=e.dense?(s[w]||[])[_]:s[Qe({c:_,r:w})],x&&(x.l=Z[1]);break;case 2048:for(w=Z[0].s.r;w<=Z[0].e.r;++w)for(_=Z[0].s.c;_<=Z[0].e.c;++_)x=e.dense?(s[w]||[])[_]:s[Qe({c:_,r:w})],x&&x.l&&(x.l.Tooltip=Z[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;x=e.dense?(s[Z[0].r]||[])[Z[0].c]:s[Qe(Z[0])];var jn=re[Z[2]];x||(e.dense?(s[Z[0].r]||(s[Z[0].r]=[]),x=s[Z[0].r][Z[0].c]={t:"z"}):x=s[Qe(Z[0])]={t:"z"},o.e.r=Math.max(o.e.r,Z[0].r),o.s.r=Math.min(o.s.r,Z[0].r),o.e.c=Math.max(o.e.c,Z[0].c),o.s.c=Math.min(o.s.c,Z[0].c)),x.c||(x.c=[]),y={a:Z[1],t:jn.TxO.t},x.c.push(y)}break;case 2173:YM(R[Z.ixfe],Z.ext);break;case 125:{if(!D.cellStyles)break;for(;Z.e>=Z.s;)U[Z.e--]={width:Z.w/256,level:Z.level||0,hidden:!!(Z.flags&1)},be||(be=!0,jm(Z.w/256)),jl(U[Z.e+1])}break;case 520:{var yr={};Z.level!=null&&(te[Z.r]=yr,yr.level=Z.level),Z.hidden&&(te[Z.r]=yr,yr.hidden=!0),Z.hpt&&(te[Z.r]=yr,yr.hpt=Z.hpt,yr.hpx=Su(Z.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||cu(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ne]]=Z;break;case 161:s["!margins"]||cu(s["!margins"]={}),s["!margins"].header=Z.header,s["!margins"].footer=Z.footer;break;case 574:Z.RTL&&(C.Views[0].RTL=!0);break;case 146:O=Z;break;case 2198:z=Z;break;case 140:N=Z;break;case 442:d?j.CodeName=Z||j.name:C.WBProps.CodeName=Z||"ThisWorkbook";break}}else Ae||console.error("Missing Info for XLS Record 0x"+Ne.toString(16)),r.l+=Ee}return t.SheetNames=tn(i).sort(function(Qa,lt){return Number(Qa)-Number(lt)}).map(function(Qa){return i[Qa].name}),e.bookSheets||(t.Sheets=a),!t.SheetNames.length&&f["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=f)):t.Preamble=f,t.Sheets&&K.forEach(function(Qa,lt){t.Sheets[t.SheetNames[lt]]["!autofilter"]=Qa}),t.Strings=u,t.SSF=Qr(it),D.enc&&(t.Encryption=D.enc),z&&(t.Themes=z),t.Metadata={},N!==void 0&&(t.Metadata.Country=N),se.names.length>0&&(C.Names=se.names),t.Workbook=C,t}var Nb={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function kP(r,e,t){var a=xt.find(r,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var s=db(a,V4,Nb.DSI);for(var i in s)e[i]=s[i]}catch(d){if(t.WTF)throw d}var o=xt.find(r,"/!SummaryInformation");if(o&&o.size>0)try{var c=db(o,q4,Nb.SI);for(var u in c)e[u]==null&&(e[u]=c[u])}catch(d){if(t.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(UE(e.HeadingPairs,e.TitlesOfParts,e,t),delete e.HeadingPairs,delete e.TitlesOfParts)}function EA(r,e){e||(e={}),Hm(e),Qw(),e.codepage&&ym(e.codepage);var t,a;if(r.FullPaths){if(xt.find(r,"/encryption"))throw new Error("File is password-protected");t=xt.find(r,"!CompObj"),a=xt.find(r,"/Workbook")||xt.find(r,"/Book")}else{switch(e.type){case"base64":r=Is(Ka(r));break;case"binary":r=Is(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r));break}Jr(r,0),a={content:r}}var s,i;if(t&&AP(t),e.bookProps&&!e.bookSheets)s={};else{var o=vt?"buffer":"array";if(a&&a.content)s=CP(a.content,e);else if((i=xt.find(r,"PerfectOffice_MAIN"))&&i.content)s=ou.to_workbook(i.content,(e.type=o,e));else if((i=xt.find(r,"NativeContent_MAIN"))&&i.content)s=ou.to_workbook(i.content,(e.type=o,e));else throw(i=xt.find(r,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&r.FullPaths&&xt.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=fL(r))}var c={};return r.FullPaths&&kP(r,c,e),s.Props=s.Custprops=c,e.bookFiles&&(s.cfb=r),s}var sf={0:{f:cj},1:{f:fj},2:{f:wj},3:{f:vj},4:{f:gj},5:{f:bj},6:{f:Sj},7:{f:_j},8:{f:Rj},9:{f:Nj},10:{f:Cj},11:{f:kj},12:{f:pj},13:{f:Ej},14:{f:xj},15:{f:mj},16:{f:xA},17:{f:Tj},18:{f:yj},19:{f:Om},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:aP},40:{},42:{},43:{f:CM},44:{f:TM},45:{f:kM},46:{f:RM},47:{f:NM},48:{},49:{f:O4},50:{},51:{f:JM},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:QE},62:{f:Aj},63:{f:rL},64:{f:Bj},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:oa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Pj},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:dj},148:{f:uj,p:16},151:{f:Fj},152:{},153:{f:tP},154:{},155:{},156:{f:eP},157:{},158:{},159:{T:1,f:qF},160:{T:-1},161:{T:1,f:mo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Oj},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:KM},336:{T:-1},337:{f:QM,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Mg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:JE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Mj},427:{f:Lj},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:jj},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:hj},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Dj},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Mg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:uL},633:{T:1},634:{T:-1},635:{T:1,f:cL},636:{T:-1},637:{f:F4},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Vj},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Uj},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Bg={6:{f:ig},10:{f:li},12:{f:Nr},13:{f:Nr},14:{f:xr},15:{f:xr},16:{f:sa},17:{f:xr},18:{f:xr},19:{f:Nr},20:{f:mb},21:{f:mb},23:{f:JE},24:{f:xb},25:{f:xr},26:{},27:{},28:{f:oF},29:{},34:{f:xr},35:{f:vb},38:{f:sa},39:{f:sa},40:{f:sa},41:{f:sa},42:{f:xr},43:{f:xr},47:{f:hM},49:{f:H3},51:{f:Nr},60:{},61:{f:B3},64:{f:xr},65:{f:z3},66:{f:Nr},77:{},80:{},81:{},82:{},85:{f:Nr},89:{},90:{},91:{},92:{f:O3},93:{f:cF},94:{},95:{f:xr},96:{},97:{},99:{f:xr},125:{f:QE},128:{f:Q3},129:{f:D3},130:{f:Nr},131:{f:xr},132:{f:xr},133:{f:F3},134:{},140:{f:gF},141:{f:Nr},144:{},146:{f:vF},151:{},152:{},153:{},154:{},155:{},156:{f:Nr},157:{},158:{},160:{f:wF},161:{f:_F},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:X3},190:{f:Y3},193:{f:li},197:{},198:{},199:{},200:{},201:{},202:{f:xr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Nr},220:{},221:{f:xr},222:{},224:{f:J3},225:{f:R3},226:{f:li},227:{},229:{f:lF},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:M3},253:{f:$3},255:{f:L3},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:VE},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:xr},353:{f:li},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:eF},431:{f:xr},432:{},433:{},434:{},437:{},438:{f:dF},439:{f:xr},440:{f:fF},441:{},442:{f:zu},443:{},444:{f:Nr},445:{},446:{},448:{f:li},449:{f:P3,r:2},450:{f:li},512:{f:pb},513:{f:bF},515:{f:Z3},516:{f:G3},517:{f:gb},519:{f:EF},520:{f:I3},523:{},545:{f:_b},549:{f:fb},566:{},574:{f:U3},638:{f:W3},659:{},1048:{},1054:{f:V3},1084:{},1212:{f:sF},2048:{f:pF},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ad},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:li},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:xF,r:12},2173:{f:XM,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:xr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:aF,r:12},2197:{},2198:{f:HM,r:12},2199:{},2200:{},2201:{},2202:{f:nF,r:12},2203:{f:li},2204:{},2205:{},2206:{},2207:{},2211:{f:j3},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Nr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:yF},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:mF},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:pb},1:{},2:{f:CF},3:{f:TF},4:{f:SF},5:{f:gb},7:{f:kF},8:{},9:{f:Ad},11:{},22:{f:Nr},30:{f:q3},31:{},32:{},33:{f:_b},36:{},37:{f:fb},50:{f:NF},62:{},52:{},67:{},68:{f:Nr},69:{},86:{},126:{},127:{f:AF},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:RF},223:{},234:{},354:{},421:{},518:{f:ig},521:{f:Ad},536:{f:xb},547:{f:vb},561:{},579:{},1030:{f:ig},1033:{f:Ad},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ns(r,e,t,a){var s=e;if(!isNaN(s)){var i=(t||[]).length||0,o=r.next(4);o.write_shift(2,s),o.write_shift(2,i),i>0&&DE(t)&&r.push(t)}}function Rb(r,e){var t=e||{},a=t.dense?[]:{};r=r.replace(/<!--.*?-->/g,"");var s=r.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=r.match(/<\/table/i),o=s.index,c=i&&i.index||r.length,u=ZD(r.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,f=0,g=0,v=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(o=0;o<u.length;++o){var _=u[o].trim(),w=_.slice(0,3).toLowerCase();if(w=="<tr"){if(++d,t.sheetRows&&t.sheetRows<=d){--d;break}f=0;continue}if(!(w!="<td"&&w!="<th")){var A=_.split(/<\/t[dh]>/i);for(c=0;c<A.length;++c){var T=A[c].trim();if(T.match(/<t[dh]/i)){for(var S=T,N=0;S.charAt(0)=="<"&&(N=S.indexOf(">"))>-1;)S=S.slice(N+1);for(var R=0;R<y.length;++R){var O=y[R];O.s.c==f&&O.s.r<d&&d<=O.e.r&&(f=O.e.c+1,R=-1)}var C=Ke(T.slice(0,T.indexOf(">")));v=C.colspan?+C.colspan:1,((g=+C.rowspan)>1||v>1)&&y.push({s:{r:d,c:f},e:{r:d+(g||1)-1,c:f+v-1}});var j=C.t||C["data-t"]||"";if(!S.length){f+=v;continue}if(S=_E(S),x.s.r>d&&(x.s.r=d),x.e.r<d&&(x.e.r=d),x.s.c>f&&(x.s.c=f),x.e.c<f&&(x.e.c=f),!S.length){f+=v;continue}var I={t:"s",v:S};t.raw||!S.trim().length||j=="s"||(S==="TRUE"?I={t:"b",v:!0}:S==="FALSE"?I={t:"b",v:!1}:isNaN(Bs(S))?isNaN(Il(S).getDate())||(I={t:"d",v:Hr(S)},t.cellDates||(I={t:"n",v:xa(I.v)}),I.z=t.dateNF||it[14]):I={t:"n",v:Bs(S)}),t.dense?(a[d]||(a[d]=[]),a[d][f]=I):a[Qe({r:d,c:f})]=I,f+=v}}}}return a["!ref"]=_t(x),y.length&&(a["!merges"]=y),a}function NP(r,e,t,a){for(var s=r["!merges"]||[],i=[],o=e.s.c;o<=e.e.c;++o){for(var c=0,u=0,d=0;d<s.length;++d)if(!(s[d].s.r>t||s[d].s.c>o)&&!(s[d].e.r<t||s[d].e.c<o)){if(s[d].s.r<t||s[d].s.c<o){c=-1;break}c=s[d].e.r-s[d].s.r+1,u=s[d].e.c-s[d].s.c+1;break}if(!(c<0)){var f=Qe({r:t,c:o}),g=a.dense?(r[t]||[])[o]:r[f],v=g&&g.v!=null&&(g.h||Tm(g.w||(Mn(g),g.w)||""))||"",x={};c>1&&(x.rowspan=c),u>1&&(x.colspan=u),a.editable?v='<span contenteditable="true">'+v+"</span>":g&&(x["data-t"]=g&&g.t||"z",g.v!=null&&(x["data-v"]=g.v),g.z!=null&&(x["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+g.l.Target+'">'+v+"</a>")),x.id=(a.id||"sjs")+"-"+f,i.push(g4("td",v,x))}}var y="<tr>";return y+i.join("")+"</tr>"}var RP='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',OP="</body></html>";function DP(r,e){var t=r.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Ei(Rb(t[0],e),e);var a=Gm();return t.forEach(function(s,i){Vm(a,Rb(s,e),"Sheet"+(i+1))}),a}function FP(r,e,t){var a=[];return a.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function MP(r,e){var t=e||{},a=t.header!=null?t.header:RP,s=t.footer!=null?t.footer:OP,i=[a],o=Gl(r["!ref"]);t.dense=Array.isArray(r),i.push(FP(r,o,t));for(var c=o.s.r;c<=o.e.r;++c)i.push(NP(r,o,c,t));return i.push("</table>"+s),i.join("")}function AA(r,e,t){var a=t||{},s=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var o=typeof a.origin=="string"?ga(a.origin):a.origin;s=o.r,i=o.c}var c=e.getElementsByTagName("tr"),u=Math.min(a.sheetRows||1e7,c.length),d={s:{r:0,c:0},e:{r:s,c:i}};if(r["!ref"]){var f=Gl(r["!ref"]);d.s.r=Math.min(d.s.r,f.s.r),d.s.c=Math.min(d.s.c,f.s.c),d.e.r=Math.max(d.e.r,f.e.r),d.e.c=Math.max(d.e.c,f.e.c),s==-1&&(d.e.r=s=f.e.r+1)}var g=[],v=0,x=r["!rows"]||(r["!rows"]=[]),y=0,_=0,w=0,A=0,T=0,S=0;for(r["!cols"]||(r["!cols"]=[]);y<c.length&&_<u;++y){var N=c[y];if(Ob(N)){if(a.display)continue;x[_]={hidden:!0}}var R=N.children;for(w=A=0;w<R.length;++w){var O=R[w];if(!(a.display&&Ob(O))){var C=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):_E(O.innerHTML),j=O.getAttribute("data-z")||O.getAttribute("z");for(v=0;v<g.length;++v){var I=g[v];I.s.c==A+i&&I.s.r<_+s&&_+s<=I.e.r&&(A=I.e.c+1-i,v=-1)}S=+O.getAttribute("colspan")||1,((T=+O.getAttribute("rowspan")||1)>1||S>1)&&g.push({s:{r:_+s,c:A+i},e:{r:_+s+(T||1)-1,c:A+i+(S||1)-1}});var W={t:"s",v:C},H=O.getAttribute("data-t")||O.getAttribute("t")||"";C!=null&&(C.length==0?W.t=H||"z":a.raw||C.trim().length==0||H=="s"||(C==="TRUE"?W={t:"b",v:!0}:C==="FALSE"?W={t:"b",v:!1}:isNaN(Bs(C))?isNaN(Il(C).getDate())||(W={t:"d",v:Hr(C)},a.cellDates||(W={t:"n",v:xa(W.v)}),W.z=a.dateNF||it[14]):W={t:"n",v:Bs(C)})),W.z===void 0&&j!=null&&(W.z=j);var D="",z=O.getElementsByTagName("A");if(z&&z.length)for(var ne=0;ne<z.length&&!(z[ne].hasAttribute("href")&&(D=z[ne].getAttribute("href"),D.charAt(0)!="#"));++ne);D&&D.charAt(0)!="#"&&(W.l={Target:D}),a.dense?(r[_+s]||(r[_+s]=[]),r[_+s][A+i]=W):r[Qe({c:A+i,r:_+s})]=W,d.e.c<A+i&&(d.e.c=A+i),A+=S}}++_}return g.length&&(r["!merges"]=(r["!merges"]||[]).concat(g)),d.e.r=Math.max(d.e.r,_-1+s),r["!ref"]=_t(d),_>=u&&(r["!fullref"]=_t((d.e.r=c.length-y+_-1+s,d))),r}function SA(r,e){var t=e||{},a=t.dense?[]:{};return AA(a,r,e)}function LP(r,e){return Ei(SA(r,e),e)}function Ob(r){var e="",t=IP(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function IP(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function jP(r){var e=r.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=yt(e.replace(/<[^>]*>/g,""));return[t]}var Db={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function TA(r,e){var t=e||{},a=Cm(r),s=[],i,o,c={name:""},u="",d=0,f,g,v={},x=[],y=t.dense?[]:{},_,w,A={value:""},T="",S=0,N=[],R=-1,O=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},j=0,I={},W=[],H={},D=0,z=0,ne=[],re=1,U=1,te=[],be={Names:[]},se={},ke=["",""],q=[],F={},J="",K=0,Y=!1,oe=!1,ve=0;for(wu.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");_=wu.exec(a);)switch(_[3]=_[3].replace(/_.*$/,"")){case"table":case"":_[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?y["!ref"]=_t(C):y["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=C.e.r&&(y["!fullref"]=y["!ref"],C.e.r=t.sheetRows-1,y["!ref"]=_t(C)),W.length&&(y["!merges"]=W),ne.length&&(y["!rows"]=ne),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),x.push(f.name),v[f.name]=y,oe=!1):_[0].charAt(_[0].length-2)!=="/"&&(f=Ke(_[0],!1),R=O=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,y=t.dense?[]:{},W=[],ne=[],oe=!0);break;case"table-row-group":_[1]==="/"?--j:++j;break;case"table-row":case"":if(_[1]==="/"){R+=re,re=1;break}if(g=Ke(_[0],!1),g.?R=g.-1:R==-1&&(R=0),re=+g["number-rows-repeated"]||1,re<10)for(ve=0;ve<re;++ve)j>0&&(ne[R+ve]={level:j});O=-1;break;case"covered-table-cell":_[1]!=="/"&&++O,t.sheetStubs&&(t.dense?(y[R]||(y[R]=[]),y[R][O]={t:"z"}):y[Qe({r:R,c:O})]={t:"z"}),T="",N=[];break;case"table-cell":case"":if(_[0].charAt(_[0].length-2)==="/")++O,A=Ke(_[0],!1),U=parseInt(A["number-columns-repeated"]||"1",10),w={t:"z",v:null},A.formula&&t.cellFormula!=!1&&(w.f=Tb(yt(A.formula))),(A.||A["value-type"])=="string"&&(w.t="s",w.v=yt(A["string-value"]||""),t.dense?(y[R]||(y[R]=[]),y[R][O]=w):y[Qe({r:R,c:O})]=w),O+=U-1;else if(_[1]!=="/"){++O,T="",S=0,N=[],U=1;var Ne=re?R+re-1:R;if(O>C.e.c&&(C.e.c=O),O<C.s.c&&(C.s.c=O),R<C.s.r&&(C.s.r=R),Ne>C.e.r&&(C.e.r=Ne),A=Ke(_[0],!1),q=[],F={},w={t:A.||A["value-type"],v:null},t.cellFormula)if(A.formula&&(A.formula=yt(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(D=parseInt(A["number-matrix-rows-spanned"],10)||0,z=parseInt(A["number-matrix-columns-spanned"],10)||0,H={s:{r:R,c:O},e:{r:R+D-1,c:O+z-1}},w.F=_t(H),te.push([H,w.F])),A.formula)w.f=Tb(A.formula);else for(ve=0;ve<te.length;++ve)R>=te[ve][0].s.r&&R<=te[ve][0].e.r&&O>=te[ve][0].s.c&&O<=te[ve][0].e.c&&(w.F=te[ve][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(D=parseInt(A["number-rows-spanned"],10)||0,z=parseInt(A["number-columns-spanned"],10)||0,H={s:{r:R,c:O},e:{r:R+D-1,c:O+z-1}},W.push(H)),A["number-columns-repeated"]&&(U=parseInt(A["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=rr(A["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(A.value);break;case"percentage":w.t="n",w.v=parseFloat(A.value);break;case"currency":w.t="n",w.v=parseFloat(A.value);break;case"date":w.t="d",w.v=Hr(A["date-value"]),t.cellDates||(w.t="n",w.v=xa(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=KD(A["time-value"])/86400,t.cellDates&&(w.t="d",w.v=gf(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(A.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",A["string-value"]!=null&&(T=yt(A["string-value"]),N=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(Y=!1,w.t==="s"&&(w.v=T||"",N.length&&(w.R=N),Y=S==0),se.Target&&(w.l=se),q.length>0&&(w.c=q,q=[]),T&&t.cellText!==!1&&(w.w=T),Y&&(w.t="z",delete w.v),(!Y||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=R))for(var Ee=0;Ee<re;++Ee){if(U=parseInt(A["number-columns-repeated"]||"1",10),t.dense)for(y[R+Ee]||(y[R+Ee]=[]),y[R+Ee][O]=Ee==0?w:Qr(w);--U>0;)y[R+Ee][O+U]=Qr(w);else for(y[Qe({r:R+Ee,c:O})]=w;--U>0;)y[Qe({r:R+Ee,c:O+U})]=Qr(w);C.e.c<=O&&(C.e.c=O)}U=parseInt(A["number-columns-repeated"]||"1",10),O+=U-1,U=0,w={},T="",N=[]}se={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(_[1]==="/"){if((i=s.pop())[0]!==_[3])throw"Bad state: "+i}else _[0].charAt(_[0].length-2)!=="/"&&s.push([_[3],!0]);break;case"annotation":if(_[1]==="/"){if((i=s.pop())[0]!==_[3])throw"Bad state: "+i;F.t=T,N.length&&(F.R=N),F.a=J,q.push(F)}else _[0].charAt(_[0].length-2)!=="/"&&s.push([_[3],!1]);J="",K=0,T="",S=0,N=[];break;case"creator":_[1]==="/"?J=a.slice(K,_.index):K=_.index+_[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(_[1]==="/"){if((i=s.pop())[0]!==_[3])throw"Bad state: "+i}else _[0].charAt(_[0].length-2)!=="/"&&s.push([_[3],!1]);T="",S=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(_[1]==="/"){if(I[c.name]=u,(i=s.pop())[0]!==_[3])throw"Bad state: "+i}else _[0].charAt(_[0].length-2)!=="/"&&(u="",c=Ke(_[0],!1),s.push([_[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Ke(_[0],!1),u+=Db[_[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Ke(_[0],!1),u+=Db[_[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(_[0].slice(-2)==="/>")break;if(_[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":u+=a.slice(d,_.index);break}else d=_.index+_[0].length;break;case"named-range":o=Ke(_[0],!1),ke=og(o["cell-range-address"]);var Ae={Name:o.name,Ref:ke[0]+"!"+ke[1]};oe&&(Ae.Sheet=x.length),be.Names.push(Ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(_[1]==="/"&&(!A||!A["string-value"])){var rt=jP(a.slice(S,_.index));T=(T.length>0?T+`
`:"")+rt[0]}else Ke(_[0],!1),S=_.index+_[0].length;break;case"s":break;case"database-range":if(_[1]==="/")break;try{ke=og(Ke(_[0])["target-range-address"]),v[ke[0]]["!autofilter"]={ref:ke[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(_[1]!=="/"){if(se=Ke(_[0],!1),!se.href)break;se.Target=yt(se.href),delete se.href,se.Target.charAt(0)=="#"&&se.Target.indexOf(".")>-1?(ke=og(se.Target.slice(1)),se.Target="#"+ke[0]+"!"+ke[1]):se.Target.match(/^\.\.[\\\/]/)&&(se.Target=se.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(_[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(_)}}var Z={Sheets:v,SheetNames:x,Workbook:be};return t.bookSheets&&delete Z.Sheets,Z}function Fb(r,e){e=e||{},ms(r,"META-INF/manifest.xml")&&Z4(kr(r,"META-INF/manifest.xml"),e);var t=Ya(r,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var a=TA($t(t),e);return ms(r,"meta.xml")&&(a.Props=BE(kr(r,"meta.xml"))),a}function Mb(r,e){return TA(r,e)}function Um(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Ug(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):$t(po(r))}function zg(r){var e=r.reduce(function(s,i){return s+i.length},0),t=new Uint8Array(e),a=0;return r.forEach(function(s){t.set(s,a),a+=s.length}),t}function Lb(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>>24}function PP(r,e){for(var t=(r[e+15]&127)<<7|r[e+14]>>1,a=r[e+14]&1,s=e+13;s>=e;--s)a=a*256+r[s];return(r[e+15]&128?-a:a)*Math.pow(10,t-6176)}function Tu(r,e){var t=e?e[0]:0,a=r[t]&127;e:if(r[t++]>=128&&(a|=(r[t]&127)<<7,r[t++]<128||(a|=(r[t]&127)<<14,r[t++]<128)||(a|=(r[t]&127)<<21,r[t++]<128)||(a+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(a+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(a+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),a}function Ir(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function na(r){for(var e=[],t=[0];t[0]<r.length;){var a=t[0],s=Tu(r,t),i=s&7;s=Math.floor(s/8);var o=0,c;if(s==0)break;switch(i){case 0:{for(var u=t[0];r[t[0]++]>=128;);c=r.slice(u,t[0])}break;case 5:o=4,c=r.slice(t[0],t[0]+o),t[0]+=o;break;case 1:o=8,c=r.slice(t[0],t[0]+o),t[0]+=o;break;case 2:o=Tu(r,t),c=r.slice(t[0],t[0]+o),t[0]+=o;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(a))}var d={data:c,type:i};e[s]==null?e[s]=[d]:e[s].push(d)}return e}function zm(r,e){return r?.map(function(t){return e(t.data)})||[]}function BP(r){for(var e,t=[],a=[0];a[0]<r.length;){var s=Tu(r,a),i=na(r.slice(a[0],a[0]+s));a[0]+=s;var o={id:Ir(i[1][0].data),messages:[]};i[2].forEach(function(c){var u=na(c.data),d=Ir(u[3][0].data);o.messages.push({meta:u,data:r.slice(a[0],a[0]+d)}),a[0]+=d}),(e=i[3])!=null&&e[0]&&(o.merge=Ir(i[3][0].data)>>>0>0),t.push(o)}return t}function UP(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],a=Tu(e,t),s=[];t[0]<e.length;){var i=e[t[0]]&3;if(i==0){var o=e[t[0]++]>>2;if(o<60)++o;else{var c=o-59;o=e[t[0]],c>1&&(o|=e[t[0]+1]<<8),c>2&&(o|=e[t[0]+2]<<16),c>3&&(o|=e[t[0]+3]<<24),o>>>=0,o++,t[0]+=c}s.push(e.slice(t[0],t[0]+o)),t[0]+=o;continue}else{var u=0,d=0;if(i==1?(d=(e[t[0]]>>2&7)+4,u=(e[t[0]++]&224)<<3,u|=e[t[0]++]):(d=(e[t[0]++]>>2)+1,i==2?(u=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(u=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),s=[zg(s)],u==0)throw new Error("Invalid offset 0");if(u>s[0].length)throw new Error("Invalid offset beyond length");if(d>=u)for(s.push(s[0].slice(-u)),d-=u;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-u,-u+d))}}var f=zg(s);if(f.length!=a)throw new Error("Unexpected length: ".concat(f.length," != ").concat(a));return f}function zP(r){for(var e=[],t=0;t<r.length;){var a=r[t++],s=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(UP(a,r.slice(t,t+s))),t+=s}if(t!==r.length)throw new Error("data is not a valid framed stream!");return zg(e)}function HP(r,e,t,a){var s=Um(r),i=s.getUint32(4,!0),o=(a>1?12:8)+Lb(i&(a>1?3470:398))*4,c=-1,u=-1,d=NaN,f=new Date(2001,0,1);i&512&&(c=s.getUint32(o,!0),o+=4),o+=Lb(i&(a>1?12288:4096))*4,i&16&&(u=s.getUint32(o,!0),o+=4),i&32&&(d=s.getFloat64(o,!0),o+=8),i&64&&(f.setTime(f.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var g;switch(r[2]){case 0:break;case 2:g={t:"n",v:d};break;case 3:g={t:"s",v:e[u]};break;case 5:g={t:"d",v:f};break;case 6:g={t:"b",v:d>0};break;case 7:g={t:"n",v:d/86400};break;case 8:g={t:"e",v:0};break;case 9:if(c>-1)g={t:"s",v:t[c]};else if(u>-1)g={t:"s",v:e[u]};else if(!isNaN(d))g={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(r.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(r.slice(0,4)))}return g}function $P(r,e,t){var a=Um(r),s=a.getUint32(8,!0),i=12,o=-1,c=-1,u=NaN,d=NaN,f=new Date(2001,0,1);s&1&&(u=PP(r,i),i+=16),s&2&&(d=a.getFloat64(i,!0),i+=8),s&4&&(f.setTime(f.getTime()+a.getFloat64(i,!0)*1e3),i+=8),s&8&&(c=a.getUint32(i,!0),i+=4),s&16&&(o=a.getUint32(i,!0),i+=4);var g;switch(r[1]){case 0:break;case 2:g={t:"n",v:u};break;case 3:g={t:"s",v:e[c]};break;case 5:g={t:"d",v:f};break;case 6:g={t:"b",v:d>0};break;case 7:g={t:"n",v:d/86400};break;case 8:g={t:"e",v:0};break;case 9:if(o>-1)g={t:"s",v:t[o]};else throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(s&31," : ").concat(r.slice(0,4)));break;case 10:g={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(s&31," : ").concat(r.slice(0,4)))}return g}function GP(r,e,t){switch(r[0]){case 0:case 1:case 2:case 3:return HP(r,e,t,r[0]);case 5:return $P(r,e,t);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function vi(r){var e=na(r);return Tu(e[1][0].data)}function Ib(r,e){var t=na(e.data),a=Ir(t[1][0].data),s=t[3],i=[];return(s||[]).forEach(function(o){var c=na(o.data),u=Ir(c[1][0].data)>>>0;switch(a){case 1:i[u]=Ug(c[3][0].data);break;case 8:{var d=r[vi(c[9][0].data)][0],f=na(d.data),g=r[vi(f[1][0].data)][0],v=Ir(g.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var x=na(g.data);i[u]=x[3].map(function(y){return Ug(y.data)}).join("")}break}}),i}function VP(r,e){var t,a,s,i,o,c,u,d,f,g,v,x,y,_,w=na(r),A=Ir(w[1][0].data)>>>0,T=Ir(w[2][0].data)>>>0,S=((a=(t=w[8])==null?void 0:t[0])==null?void 0:a.data)&&Ir(w[8][0].data)>0||!1,N,R;if((i=(s=w[7])==null?void 0:s[0])!=null&&i.data&&e!=0)N=(c=(o=w[7])==null?void 0:o[0])==null?void 0:c.data,R=(d=(u=w[6])==null?void 0:u[0])==null?void 0:d.data;else if((g=(f=w[4])==null?void 0:f[0])!=null&&g.data&&e!=1)N=(x=(v=w[4])==null?void 0:v[0])==null?void 0:x.data,R=(_=(y=w[3])==null?void 0:y[0])==null?void 0:_.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var O=S?4:1,C=Um(N),j=[],I=0;I<N.length/2;++I){var W=C.getUint16(I*2,!0);W<65535&&j.push([I,W])}if(j.length!=T)throw"Expected ".concat(T," cells, found ").concat(j.length);var H=[];for(I=0;I<j.length-1;++I)H[j[I][0]]=R.subarray(j[I][1]*O,j[I+1][1]*O);return j.length>=1&&(H[j[j.length-1][0]]=R.subarray(j[j.length-1][1]*O)),{R:A,cells:H}}function qP(r,e){var t,a=na(e.data),s=(t=a?.[7])!=null&&t[0]?Ir(a[7][0].data)>>>0>0?1:0:-1,i=zm(a[5],function(o){return VP(o,s)});return{nrows:Ir(a[4][0].data)>>>0,data:i.reduce(function(o,c){return o[c.R]||(o[c.R]=[]),c.cells.forEach(function(u,d){if(o[c.R][d])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(d));o[c.R][d]=u}),o},[])}}function WP(r,e,t){var a,s=na(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Ir(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Ir(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));t["!ref"]=_t(i);var o=na(s[4][0].data),c=Ib(r,r[vi(o[4][0].data)][0]),u=(a=o[17])!=null&&a[0]?Ib(r,r[vi(o[17][0].data)][0]):[],d=na(o[3][0].data),f=0;d[1].forEach(function(g){var v=na(g.data),x=r[vi(v[2][0].data)][0],y=Ir(x.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var _=qP(r,x);_.data.forEach(function(w,A){w.forEach(function(T,S){var N=Qe({r:f+A,c:S}),R=GP(T,c,u);R&&(t[N]=R)})}),f+=_.nrows})}function XP(r,e){var t=na(e.data),a={"!ref":"A1"},s=r[vi(t[2][0].data)],i=Ir(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return WP(r,s[0],a),a}function YP(r,e){var t,a=na(e.data),s={name:(t=a[1])!=null&&t[0]?Ug(a[1][0].data):"",sheets:[]},i=zm(a[2],vi);return i.forEach(function(o){r[o].forEach(function(c){var u=Ir(c.meta[1][0].data);u==6e3&&s.sheets.push(XP(r,c))})}),s}function KP(r,e){var t=Gm(),a=na(e.data),s=zm(a[1],vi);if(s.forEach(function(i){r[i].forEach(function(o){var c=Ir(o.meta[1][0].data);if(c==2){var u=YP(r,o);u.sheets.forEach(function(d,f){Vm(t,d,f==0?u.name:u.name+"_"+f,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function cg(r){var e,t,a,s,i={},o=[];if(r.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var d;try{d=zP(u.content)}catch(g){return console.log("?? "+u.content.length+" "+(g.message||g))}var f;try{f=BP(d)}catch(g){return console.log("## "+(g.message||g))}f.forEach(function(g){i[g.id]=g.messages,o.push(g.id)})}}),!o.length)throw new Error("File has no messages");var c=((s=(a=(t=(e=i?.[1])==null?void 0:e[0])==null?void 0:t.meta)==null?void 0:a[1])==null?void 0:s[0].data)&&Ir(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||o.forEach(function(u){i[u].forEach(function(d){var f=Ir(d.meta[1][0].data)>>>0;if(f==1)if(!c)c=d;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return KP(i,c)}function JP(r){return function(t){for(var a=0;a!=r.length;++a){var s=r[a];t[s[0]]===void 0&&(t[s[0]]=s[1]),s[2]==="n"&&(t[s[0]]=Number(t[s[0]]))}}}function Hm(r){JP([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function QP(r){return Al.WS.indexOf(r)>-1?"sheet":r==Al.CS?"chart":r==Al.DS?"dialog":r==Al.MS?"macro":r&&r.length?r:"sheet"}function ZP(r,e){if(!r)return 0;try{r=e.map(function(a){return a.id||(a.id=a.strRelID),[a.name,r["!id"][a.id].Target,QP(r["!id"][a.id].Type)]})}catch{return null}return!r||r.length===0?null:r}function e6(r,e,t,a,s,i,o,c,u,d,f,g){try{i[a]=nu(Ya(r,t,!0),e);var v=kr(r,e),x;switch(c){case"sheet":x=iP(v,e,s,u,i[a],d,f,g);break;case"chart":if(x=oP(v,e,s,u,i[a],d,f,g),!x||!x["!drawel"])break;var y=Xc(x["!drawel"].Target,e),_=Lg(y),w=nL(Ya(r,y,!0),nu(Ya(r,_,!0),y)),A=Xc(w,y),T=Lg(A);x=$j(Ya(r,A,!0),A,u,nu(Ya(r,T,!0),A),d,x);break;case"macro":x=lP(v,e,s,u,i[a],d,f,g);break;case"dialog":x=cP(v,e,s,u,i[a],d,f,g);break;default:throw new Error("Unrecognized sheet type "+c)}o[a]=x;var S=[];i&&i[a]&&tn(i[a]).forEach(function(N){var R="";if(i[a][N].Type==Al.CMNT){R=Xc(i[a][N].Target,e);var O=fP(kr(r,R,!0),R,u);if(!O||!O.length)return;bb(x,O,!1)}i[a][N].Type==Al.TCMNT&&(R=Xc(i[a][N].Target,e),S=S.concat(oL(kr(r,R,!0),u)))}),S&&S.length&&bb(x,S,!0,u.people||[])}catch(N){if(u.WTF)throw N}}function hs(r){return r.charAt(0)=="/"?r.slice(1):r}function t6(r,e){if(uE(),e=e||{},Hm(e),ms(r,"META-INF/manifest.xml")||ms(r,"objectdata.xml"))return Fb(r,e);if(ms(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof cg<"u"){if(r.FileIndex)return cg(r);var t=xt.utils.cfb_new();return Xy(r).forEach(function(ne){r4(t,ne,t4(r,ne))}),cg(t)}throw new Error("Unsupported NUMBERS file")}if(!ms(r,"[Content_Types].xml"))throw ms(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ms(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Xy(r),s=J4(Ya(r,"[Content_Types].xml")),i=!1,o,c;if(s.workbooks.length===0&&(c="xl/workbook.xml",kr(r,c,!0)&&s.workbooks.push(c)),s.workbooks.length===0){if(c="xl/workbook.bin",!kr(r,c,!0))throw new Error("Could not find workbook");s.workbooks.push(c),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var u={},d={};if(!e.bookSheets&&!e.bookProps){if(lu=[],s.sst)try{lu=dP(kr(r,hs(s.sst)),s.sst,e)}catch(ne){if(e.WTF)throw ne}e.cellStyles&&s.themes.length&&(u=hP(Ya(r,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(d=uP(kr(r,hs(s.style)),s.style,u,e))}s.links.map(function(ne){try{var re=nu(Ya(r,Lg(hs(ne))),ne);return gP(kr(r,hs(ne)),re,ne,e)}catch{}});var f=nP(kr(r,hs(s.workbooks[0])),s.workbooks[0],e),g={},v="";s.coreprops.length&&(v=kr(r,hs(s.coreprops[0]),!0),v&&(g=BE(v)),s.extprops.length!==0&&(v=kr(r,hs(s.extprops[0]),!0),v&&r3(v,g,e)));var x={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(v=Ya(r,hs(s.custprops[0]),!0),v&&(x=s3(v,e)));var y={};if((e.bookSheets||e.bookProps)&&(f.Sheets?o=f.Sheets.map(function(re){return re.name}):g.Worksheets&&g.SheetNames.length>0&&(o=g.SheetNames),e.bookProps&&(y.Props=g,y.Custprops=x),e.bookSheets&&typeof o<"u"&&(y.SheetNames=o),e.bookSheets?y.SheetNames:e.bookProps))return y;o={};var _={};e.bookDeps&&s.calcchain&&(_=pP(kr(r,hs(s.calcchain)),s.calcchain));var w=0,A={},T,S;{var N=f.Sheets;g.Worksheets=N.length,g.SheetNames=[];for(var R=0;R!=N.length;++R)g.SheetNames[R]=N[R].name}var O=i?"bin":"xml",C=s.workbooks[0].lastIndexOf("/"),j=(s.workbooks[0].slice(0,C+1)+"_rels/"+s.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");ms(r,j)||(j="xl/_rels/workbook."+O+".rels");var I=nu(Ya(r,j,!0),j.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=mP(kr(r,hs(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=lL(kr(r,hs(s.people[0])),e)),I&&(I=ZP(I,f.Sheets));var W=kr(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=g.Worksheets;++w){var H="sheet";if(I&&I[w]?(T="xl/"+I[w][1].replace(/[\/]?xl\//,""),ms(r,T)||(T=I[w][1]),ms(r,T)||(T=j.replace(/_rels\/.*$/,"")+I[w][1]),H=I[w][2]):(T="xl/worksheets/sheet"+(w+1-W)+"."+O,T=T.replace(/sheet0\./,"sheet.")),S=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(g.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var D=!1,z=0;z!=e.sheets.length;++z)typeof e.sheets[z]=="number"&&e.sheets[z]==w&&(D=1),typeof e.sheets[z]=="string"&&e.sheets[z].toLowerCase()==g.SheetNames[w].toLowerCase()&&(D=1);if(!D)continue e}}e6(r,T,S,g.SheetNames[w],w,A,o,H,e,f,u,d)}return y={Directory:s,Workbook:f,Props:g,Custprops:x,Deps:_,Sheets:o,SheetNames:g.SheetNames,Strings:lu,Styles:d,Themes:u,SSF:Qr(it)},e&&e.bookFiles&&(r.files?(y.keys=a,y.files=r.files):(y.keys=[],y.files={},r.FullPaths.forEach(function(ne,re){ne=ne.replace(/^Root Entry[\/]/,""),y.keys.push(ne),y.files[ne]=r.FileIndex[re]}))),e&&e.bookVBA&&(s.vba.length>0?y.vbaraw=kr(r,hs(s.vba[0]),!0):s.defaults&&s.defaults.bin===dL&&(y.vbaraw=kr(r,"xl/vbaProject.bin",!0))),y}function r6(r,e){var t=e||{},a="Workbook",s=xt.find(r,a);try{if(a="/!DataSpaces/Version",s=xt.find(r,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(XF(s.content),a="/!DataSpaces/DataSpaceMap",s=xt.find(r,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=KF(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=xt.find(r,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=JF(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=xt.find(r,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);ZF(s.content)}catch{}if(a="/EncryptionInfo",s=xt.find(r,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=eM(s.content);if(a="/EncryptedPackage",s=xt.find(r,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],s.content,t.password||"",t);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],s.content,t.password||"",t);throw new Error("File is password-protected")}function $m(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=Ka(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function a6(r,e){return xt.find(r,"EncryptedPackage")?r6(r,e):EA(r,e)}function s6(r,e){var t,a=r,s=e||{};return s.type||(s.type=vt&&Buffer.isBuffer(r)?"buffer":"base64"),t=mE(a,s),t6(t,s)}function CA(r,e){var t=0;e:for(;t<r.length;)switch(r.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Pg(r.slice(t),e);default:break e}return Eu.to_workbook(r,e)}function n6(r,e){var t="",a=$m(r,e);switch(e.type){case"base64":t=Ka(r);break;case"binary":t=r;break;case"buffer":t=r.toString("binary");break;case"array":t=oo(r);break;default:throw new Error("Unrecognized type "+e.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(t=$t(t)),e.type="binary",CA(t,e)}function i6(r,e){var t=r;return e.type=="base64"&&(t=Ka(t)),t=_u.utils.decode(1200,t.slice(2),"str"),e.type="binary",CA(t,e)}function o6(r){return r.match(/[^\x00-\x7F]/)?Yc(r):r}function ug(r,e,t,a){return a?(t.type="string",Eu.to_workbook(r,t)):Eu.to_workbook(e,t)}function Hg(r,e){Qw();var t=e||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return Hg(new Uint8Array(r),(t=Qr(t),t.type="array",t));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var a=r,s=[0,0,0,0],i=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Ol={},t.dateNF&&(Ol.dateNF=t.dateNF),t.type||(t.type=vt&&Buffer.isBuffer(r)?"buffer":"base64"),t.type=="file"&&(t.type=vt?"buffer":"binary",a=XD(r),typeof Uint8Array<"u"&&!vt&&(t.type="array")),t.type=="string"&&(i=!0,t.type="binary",t.codepage=65001,a=o6(r)),t.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),c=new Uint8Array(o);if(c.foo="bar",!c.foo)return t=Qr(t),t.type="array",Hg(bm(a),t)}switch((s=$m(a,t))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return a6(xt.read(a,t),t);break;case 9:if(s[1]<=8)return EA(a,t);break;case 60:return Pg(a,t);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return LF(a,t);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return FF.to_workbook(a,t);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?s6(a,t):ug(r,a,t,i);case 239:return s[3]===60?Pg(a,t):ug(r,a,t,i);case 255:if(s[1]===254)return i6(a,t);if(s[1]===0&&s[2]===2&&s[3]===0)return ou.to_workbook(a,t);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return ou.to_workbook(a,t);break;case 3:case 131:case 139:case 140:return yb.to_workbook(a,t);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return dM.to_workbook(a,t);break;case 10:case 13:case 32:return n6(a,t);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return OF.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?yb.to_workbook(a,t):ug(r,a,t,i)}function l6(r,e,t,a,s,i,o,c){var u=Zr(t),d=c.defval,f=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),g=!0,v=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:t,enumerable:!1})}catch{v.__rowNum__=t}else v.__rowNum__=t;if(!o||r[t])for(var x=e.s.c;x<=e.e.c;++x){var y=o?r[t][x]:r[a[x]+u];if(y===void 0||y.t===void 0){if(d===void 0)continue;i[x]!=null&&(v[i[x]]=d);continue}var _=y.v;switch(y.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(i[x]!=null){if(_==null)if(y.t=="e"&&_===null)v[i[x]]=null;else if(d!==void 0)v[i[x]]=d;else if(f&&_===null)v[i[x]]=null;else continue;else v[i[x]]=f&&(y.t!=="n"||y.t==="n"&&c.rawNumbers!==!1)?_:Mn(y,_,c);_!=null&&(g=!1)}}return{row:v,isempty:g}}function $g(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},a=0,s=1,i=[],o=0,c="",u={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},f=d.range!=null?d.range:r["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof f){case"string":u=pr(f);break;case"number":u=pr(r["!ref"]),u.s.r=f;break;default:u=f}a>0&&(s=0);var g=Zr(u.s.r),v=[],x=[],y=0,_=0,w=Array.isArray(r),A=u.s.r,T=0,S={};w&&!r[A]&&(r[A]=[]);var N=d.skipHidden&&r["!cols"]||[],R=d.skipHidden&&r["!rows"]||[];for(T=u.s.c;T<=u.e.c;++T)if(!(N[T]||{}).hidden)switch(v[T]=Lr(T),t=w?r[A][T]:r[v[T]+g],a){case 1:i[T]=T-u.s.c;break;case 2:i[T]=v[T];break;case 3:i[T]=d.header[T-u.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=o=Mn(t,null,d),_=S[o]||0,!_)S[o]=1;else{do c=o+"_"+_++;while(S[c]);S[o]=_,S[c]=1}i[T]=c}for(A=u.s.r+s;A<=u.e.r;++A)if(!(R[A]||{}).hidden){var O=l6(r,u,A,v,a,i,w,d);(O.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(x[y++]=O.row)}return x.length=y,x}var jb=/"/g;function c6(r,e,t,a,s,i,o,c){for(var u=!0,d=[],f="",g=Zr(t),v=e.s.c;v<=e.e.c;++v)if(a[v]){var x=c.dense?(r[t]||[])[v]:r[a[v]+g];if(x==null)f="";else if(x.v!=null){u=!1,f=""+(c.rawNumbers&&x.t=="n"?x.v:Mn(x,null,c));for(var y=0,_=0;y!==f.length;++y)if((_=f.charCodeAt(y))===s||_===i||_===34||c.forceQuotes){f='"'+f.replace(jb,'""')+'"';break}f=="ID"&&(f='"ID"')}else x.f!=null&&!x.F?(u=!1,f="="+x.f,f.indexOf(",")>=0&&(f='"'+f.replace(jb,'""')+'"')):f="";d.push(f)}return c.blankrows===!1&&u?null:d.join(o)}function kA(r,e){var t=[],a=e??{};if(r==null||r["!ref"]==null)return"";var s=pr(r["!ref"]),i=a.FS!==void 0?a.FS:",",o=i.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,u=c.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),f="",g=[];a.dense=Array.isArray(r);for(var v=a.skipHidden&&r["!cols"]||[],x=a.skipHidden&&r["!rows"]||[],y=s.s.c;y<=s.e.c;++y)(v[y]||{}).hidden||(g[y]=Lr(y));for(var _=0,w=s.s.r;w<=s.e.r;++w)(x[w]||{}).hidden||(f=c6(r,s,w,g,o,u,i,a),f!=null&&(a.strip&&(f=f.replace(d,"")),(f||a.blankrows!==!1)&&t.push((_++?c:"")+f)));return delete a.dense,t.join("")}function u6(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=kA(r,e);return t}function h6(r){var e="",t,a="";if(r==null||r["!ref"]==null)return[];var s=pr(r["!ref"]),i="",o=[],c,u=[],d=Array.isArray(r);for(c=s.s.c;c<=s.e.c;++c)o[c]=Lr(c);for(var f=s.s.r;f<=s.e.r;++f)for(i=Zr(f),c=s.s.c;c<=s.e.c;++c)if(e=o[c]+i,t=d?(r[f]||[])[c]:r[e],a="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;a=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)a=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)a=""+t.v;else if(t.t=="b")a=t.v?"TRUE":"FALSE";else if(t.w!==void 0)a="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?a="'"+t.v:a=""+t.v}}u[u.length]=e+"="+a}return u}function NA(r,e,t){var a=t||{},s=+!a.skipHeader,i=r||{},o=0,c=0;if(i&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var u=typeof a.origin=="string"?ga(a.origin):a.origin;o=u.r,c=u.c}var d,f={s:{c:0,r:0},e:{c,r:o+e.length-1+s}};if(i["!ref"]){var g=pr(i["!ref"]);f.e.c=Math.max(f.e.c,g.e.c),f.e.r=Math.max(f.e.r,g.e.r),o==-1&&(o=g.e.r+1,f.e.r=o+e.length-1+s)}else o==-1&&(o=0,f.e.r=e.length-1+s);var v=a.header||[],x=0;e.forEach(function(_,w){tn(_).forEach(function(A){(x=v.indexOf(A))==-1&&(v[x=v.length]=A);var T=_[A],S="z",N="",R=Qe({c:c+x,r:o+w+s});d=Cu(i,R),T&&typeof T=="object"&&!(T instanceof Date)?i[R]=T:(typeof T=="number"?S="n":typeof T=="boolean"?S="b":typeof T=="string"?S="s":T instanceof Date?(S="d",a.cellDates||(S="n",T=xa(T)),N=a.dateNF||it[14]):T===null&&a.nullError&&(S="e",T=0),d?(d.t=S,d.v=T,delete d.w,delete d.R,N&&(d.z=N)):i[R]=d={t:S,v:T},N&&(d.z=N))})}),f.e.c=Math.max(f.e.c,c+v.length-1);var y=Zr(o);if(s)for(x=0;x<v.length;++x)i[Lr(x+c)+y]={t:"s",v:v[x]};return i["!ref"]=_t(f),i}function d6(r,e){return NA(null,r,e)}function Cu(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var a=ga(e);return r[a.r]||(r[a.r]=[]),r[a.r][a.c]||(r[a.r][a.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?Cu(r,Qe(e)):Cu(r,Qe({r:e,c:t||0}))}function f6(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Gm(){return{SheetNames:[],Sheets:{}}}function Vm(r,e,t,a){var s=1;if(!t)for(;s<=65535&&r.SheetNames.indexOf(t="Sheet"+s)!=-1;++s,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&r.SheetNames.indexOf(t)>=0){var i=t.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var o=i&&i[1]||t;for(++s;s<=65535&&r.SheetNames.indexOf(t=o+s)!=-1;++s);}if(Jj(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function p6(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var a=f6(r,e);switch(r.Workbook.Sheets[a]||(r.Workbook.Sheets[a]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[a].Hidden=t}function g6(r,e){return r.z=e,r}function RA(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function m6(r,e,t){return RA(r,"#"+e,t)}function v6(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function x6(r,e,t,a){for(var s=typeof e!="string"?e:pr(e),i=typeof e=="string"?e:_t(e),o=s.s.r;o<=s.e.r;++o)for(var c=s.s.c;c<=s.e.c;++c){var u=Cu(r,o,c);u.t="n",u.F=i,delete u.v,o==s.s.r&&c==s.s.c&&(u.f=t,a&&(u.D=!0))}return r}var _6={encode_col:Lr,encode_row:Zr,encode_cell:Qe,encode_range:_t,decode_col:Rm,decode_row:Nm,split_cell:R4,decode_cell:ga,decode_range:Gl,format_cell:Mn,sheet_add_aoa:ME,sheet_add_json:NA,sheet_add_dom:AA,aoa_to_sheet:Vl,json_to_sheet:d6,table_to_sheet:SA,table_to_book:LP,sheet_to_csv:kA,sheet_to_txt:u6,sheet_to_json:$g,sheet_to_html:MP,sheet_to_formulae:h6,sheet_to_row_object_array:$g,sheet_get_cell:Cu,book_new:Gm,book_append_sheet:Vm,book_set_sheet_visibility:p6,cell_set_number_format:g6,cell_set_hyperlink:RA,cell_set_internal_link:m6,cell_add_comment:v6,sheet_set_array_formula:x6,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const y6=()=>{const{user:r,profile:e}=Pu(),t=ho(),[a,s]=Q.useState([]),[i,o]=Q.useState([]),[c,u]=Q.useState(!0),[d,f]=Q.useState({companias:[],analistas:[],estados:[]}),[g,v]=Q.useState({siniestro:"",asegurado:"",dni:"",compania:"",analista:"",estado:"",patente:"",misCasos:!1}),[x,y]=Q.useState(!1),[_,w]=Q.useState({cia:"",asegurado:"",dni:"",nSiniestro:"",poliza:"",ramo:"",analista:"",telefono:"",mail:"",fecha_ingreso:new Date().toISOString().split("T")[0],fecha_denuncia:"",fecha_siniestro:"",motivo_derivacion:""}),A=Q.useRef(null);Q.useEffect(()=>{N()},[]);const[T,S]=Q.useState({key:"id",direction:"ascending"});Q.useEffect(()=>{R()},[g,a,T]);const N=async()=>{u(!0);try{const[D,z,ne]=await Promise.all([qe.from("companias").select("*").eq("activo",1),qe.from("analistas").select("*").eq("activo",1),qe.from("estados").select("*").eq("activo",1)]);f({companias:D.data||[],analistas:z.data||[],estados:ne.data||[]});const{data:re,error:U}=await qe.from("casos").select("*").order("id",{ascending:!0});if(U)throw U;s(re||[])}catch(D){console.error("Error loading data:",D)}finally{u(!1)}},R=()=>{let D=[...a];if(g.misCasos&&(r||e)){const z=e?.nombre||r?.user_metadata?.nombre;if(z){const ne=z.toLowerCase();D=D.filter(re=>re.analista&&re.analista.toLowerCase()===ne)}}g.siniestro&&(D=D.filter(z=>String(z.n_siniestro).toLowerCase().includes(g.siniestro.toLowerCase()))),g.asegurado&&(D=D.filter(z=>z.asegurado?.toLowerCase().includes(g.asegurado.toLowerCase()))),g.dni&&(D=D.filter(z=>String(z.dni).includes(g.dni))),g.compania&&(D=D.filter(z=>z.cia===g.compania)),g.analista&&(D=D.filter(z=>z.analista===g.analista)),g.estado&&(D=D.filter(z=>z.estado===g.estado)),D.sort((z,ne)=>z[T.key]<ne[T.key]?T.direction==="ascending"?-1:1:z[T.key]>ne[T.key]?T.direction==="ascending"?1:-1:0),o(D)},O=D=>{let z="ascending";T.key===D&&T.direction==="ascending"&&(z="descending"),S({key:D,direction:z})},C=(D,z)=>{v(ne=>({...ne,[D]:z}))},j=async()=>{const{cia:D,asegurado:z,dni:ne,nSiniestro:re,poliza:U,ramo:te,analista:be,telefono:se,mail:ke,fecha_ingreso:q,fecha_denuncia:F,fecha_siniestro:J,motivo_derivacion:K}=_;if(!D||!z||!re){alert("Completa los campos obligatorios (*)");return}try{const Y={cia:D,asegurado:z,dni:ne,n_siniestro:re,poliza:U,ramo:te,analista:be,telefono:se,mail:ke,fecha_ingreso:q,fecha_denuncia:F,fecha_siniestro:J,motivo_derivacion:K,estado:"Ingresado"},{error:oe}=await qe.from("casos").insert(Y);if(oe)throw oe;alert("Caso creado correctamente"),y(!1),w({cia:"",asegurado:"",dni:"",nSiniestro:"",poliza:"",ramo:"",analista:"",telefono:"",mail:"",fecha_ingreso:new Date().toISOString().split("T")[0],fecha_denuncia:"",fecha_siniestro:"",motivo_derivacion:""}),N()}catch(Y){alert("Error al guardar: "+Y.message)}},I=()=>{A.current&&A.current.click()},W=async D=>{const z=D.target.files?.[0];if(!z)return;const ne=new FileReader;ne.onload=async re=>{try{const U=re.target?.result,te=Hg(U,{type:"binary"}),be=te.SheetNames[0],se=te.Sheets[be],ke=_6.sheet_to_json(se);if(ke.length===0){alert("El archivo est vaco.");return}const q=Y=>Y.toLowerCase().trim().normalize("NFD").replace(/[\u0300-\u036f]/g,""),F=(Y,oe)=>{const Ne=Object.keys(Y).find(Ee=>oe.includes(q(Ee)));return Ne?Y[Ne]:null},J=ke.map(Y=>({n_siniestro:F(Y,["siniestro","n_siniestro","n siniestro","numero siniestro","num siniestro","nro siniestro","expediente","carpeta","caso"]),cia:F(Y,["compania","cia","aseguradora","empresa","cliente"]),asegurado:F(Y,["asegurado","nombre","asociado","tercero"]),dni:F(Y,["dni","documento","cuit","cuil","nro doc"]),poliza:F(Y,["poliza","nro poliza","num poliza","policy"]),ramo:F(Y,["ramo","tipo","cobertura"]),analista:F(Y,["analista","gestor","asignado","asignado a"]),patente:F(Y,["patente","dominio","vehiculo","matricula"]),estado:"Ingresado",fecha_ingreso:new Date().toISOString()})).filter(Y=>Y.n_siniestro&&Y.cia);if(J.length===0){alert("No se pudieron encontrar casos vlidos. Verifique los nombres de las columnas (Siniestro, Compania, Asegurado).");return}const{error:K}=await qe.from("casos").insert(J);K?(console.error("Error importing cases:",K),alert("Error al importar casos: "+K.message)):(alert(`${J.length} casos importados correctamente.`),N())}catch(U){console.error("Error parsing file:",U),alert("Error al procesar el archivo Excel: "+U.message)}finally{A.current&&(A.current.value="")}},ne.readAsBinaryString(z)},H=D=>d.estados.find(ne=>ne.nombre===D)?.color||"#3699ff";return m.jsxs(Rn,{children:[m.jsxs("div",{className:Ge.topActions,children:[m.jsxs("div",{className:Ge.titleSection,children:[m.jsx("h1",{children:"Listado de Casos"}),m.jsxs("p",{children:[i.length," casos encontrados"]})]}),m.jsxs("div",{style:{display:"flex",gap:"10px"},children:[m.jsx("input",{type:"file",ref:A,onChange:W,style:{display:"none"},accept:".xlsx, .xls"}),m.jsx("button",{className:Ge.secondaryBtn,onClick:I,children:"Importar Excel"}),m.jsx("button",{className:Ge.primaryBtn,onClick:()=>y(!x),children:x?"Cerrar Panel":"Nuevo Caso +"})]})]}),x&&m.jsxs("div",{className:Ge.newCasePanel,children:[m.jsx("h3",{className:Ge.filterHeader,children:"Alta de Nuevo Caso"}),m.jsxs("div",{className:Ge.formGrid,children:[m.jsxs("div",{className:Ge.filterGroup,children:[m.jsx("label",{children:"Compaa *"}),m.jsxs("select",{className:Ge.select,value:_.cia,onChange:D=>w({..._,cia:D.target.value}),children:[m.jsx("option",{value:"",children:"Seleccionar..."}),d.companias.map(D=>m.jsx("option",{value:D.nombre,children:D.nombre},D.id))]})]}),m.jsxs("div",{className:Ge.filterGroup,children:[m.jsx("label",{children:"Asegurado *"}),m.jsx("input",{className:Ge.input,type:"text",placeholder:"Nombre completo",value:_.asegurado,onChange:D=>w({..._,asegurado:D.target.value})})]}),m.jsxs("div",{className:Ge.filterGroup,children:[m.jsx("label",{children:"DNI"}),m.jsx("input",{className:Ge.input,type:"text",value:_.dni,onChange:D=>w({..._,dni:D.target.value})})]}),m.jsxs("div",{className:Ge.filterGroup,children:[m.jsx("label",{children:"N Siniestro *"}),m.jsx("input",{className:Ge.input,type:"text",value:_.nSiniestro,onChange:D=>w({..._,nSiniestro:D.target.value})})]}),m.jsxs("div",{className:Ge.filterGroup,children:[m.jsx("label",{children:"Pliza"}),m.jsx("input",{className:Ge.input,type:"text",value:_.poliza,onChange:D=>w({..._,poliza:D.target.value})})]}),m.jsxs("div",{className:Ge.filterGroup,children:[m.jsx("label",{children:"Mail"}),m.jsx("input",{className:Ge.input,type:"text",value:_.mail,onChange:D=>w({..._,mail:D.target.value})})]}),m.jsxs("div",{className:Ge.filterGroup,children:[m.jsx("label",{children:"Telfono"}),m.jsx("input",{className:Ge.input,type:"text",value:_.telefono,onChange:D=>w({..._,telefono:D.target.value})})]}),m.jsxs("div",{className:Ge.filterGroup,children:[m.jsx("label",{children:"Fecha Asignacin"}),m.jsx("input",{className:Ge.input,type:"date",value:_.fecha_ingreso,onChange:D=>w({..._,fecha_ingreso:D.target.value})})]}),m.jsxs("div",{className:Ge.filterGroup,children:[m.jsx("label",{children:"Fecha Denuncia"}),m.jsx("input",{className:Ge.input,type:"date",value:_.fecha_denuncia,onChange:D=>w({..._,fecha_denuncia:D.target.value})})]}),m.jsxs("div",{className:Ge.filterGroup,children:[m.jsx("label",{children:"Fecha Siniestro"}),m.jsx("input",{className:Ge.input,type:"date",value:_.fecha_siniestro,onChange:D=>w({..._,fecha_siniestro:D.target.value})})]}),m.jsxs("div",{className:Ge.filterGroup,style:{gridColumn:"1 / -1"},children:[m.jsx("label",{children:"Comentario de Derivacin"}),m.jsx("textarea",{className:Ge.textarea,style:{height:"60px"},value:_.motivo_derivacion,onChange:D=>w({..._,motivo_derivacion:D.target.value})})]}),m.jsxs("div",{className:Ge.filterGroup,children:[m.jsx("label",{children:"Ramo"}),m.jsx("input",{className:Ge.input,type:"text",value:_.ramo,onChange:D=>w({..._,ramo:D.target.value})})]}),m.jsxs("div",{className:Ge.filterGroup,children:[m.jsx("label",{children:"Analista"}),m.jsxs("select",{className:Ge.select,value:_.analista,onChange:D=>w({..._,analista:D.target.value}),children:[m.jsx("option",{value:"",children:"Seleccionar..."}),d.analistas.map(D=>m.jsx("option",{value:D.nombre,children:D.nombre},D.id))]})]})]}),m.jsxs("div",{style:{display:"flex",gap:"10px"},children:[m.jsx("button",{className:Ge.primaryBtn,onClick:j,children:"Guardar Caso"}),m.jsx("button",{className:Ge.secondaryBtn,onClick:()=>y(!1),children:"Cancelar"})]})]}),m.jsxs("div",{className:Ge.filterPanel,children:[m.jsx("div",{className:Ge.filterHeader,children:"FILTROS DE BSQUEDA"}),m.jsxs("div",{className:Ge.filters,children:[m.jsxs("div",{className:Ge.filterGroup,children:[m.jsx("label",{children:"N Siniestro"}),m.jsx("input",{className:Ge.input,type:"text",placeholder:"Buscar...",value:g.siniestro,onChange:D=>C("siniestro",D.target.value)})]}),m.jsxs("div",{className:Ge.filterGroup,children:[m.jsx("label",{children:"Asegurado"}),m.jsx("input",{className:Ge.input,type:"text",placeholder:"Buscar...",value:g.asegurado,onChange:D=>C("asegurado",D.target.value)})]}),m.jsxs("div",{className:Ge.filterGroup,children:[m.jsx("label",{children:"DNI"}),m.jsx("input",{className:Ge.input,type:"text",placeholder:"Buscar...",value:g.dni,onChange:D=>C("dni",D.target.value)})]}),m.jsxs("div",{className:Ge.filterGroup,children:[m.jsx("label",{children:"Compaa"}),m.jsxs("select",{className:Ge.select,value:g.compania,onChange:D=>C("compania",D.target.value),children:[m.jsx("option",{value:"",children:"Todas"}),d.companias.map(D=>m.jsx("option",{value:D.nombre,children:D.nombre},D.id))]})]}),m.jsxs("div",{className:Ge.filterGroup,children:[m.jsx("label",{children:"Analista"}),m.jsxs("select",{className:Ge.select,value:g.analista,onChange:D=>C("analista",D.target.value),children:[m.jsx("option",{value:"",children:"Todos"}),d.analistas.map(D=>m.jsx("option",{value:D.nombre,children:D.nombre},D.id))]})]}),m.jsxs("div",{className:Ge.filterGroup,children:[m.jsx("label",{children:"Estado"}),m.jsxs("select",{className:Ge.select,value:g.estado,onChange:D=>C("estado",D.target.value),children:[m.jsx("option",{value:"",children:"Todos"}),d.estados.map(D=>m.jsx("option",{value:D.nombre,children:D.nombre},D.id))]})]}),m.jsxs("div",{className:Ge.filterGroup,style:{flexDirection:"row",alignItems:"center",paddingBottom:"8px"},children:[m.jsx("input",{type:"checkbox",id:"misCasos",checked:g.misCasos,onChange:D=>C("misCasos",D.target.checked)}),m.jsx("label",{htmlFor:"misCasos",style:{cursor:"pointer",margin:0},children:"Solo mis casos"})]})]})]}),m.jsx("div",{className:Ge.tableContainer,children:c?m.jsx("div",{style:{padding:"20px",textAlign:"center",color:"var(--muted-color)"},children:"Cargando datos..."}):m.jsxs("table",{className:Ge.table,children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsxs("th",{onClick:()=>O("id"),style:{cursor:"pointer"},children:["N ",T.key==="id"&&(T.direction==="ascending"?"":"")]}),m.jsxs("th",{onClick:()=>O("n_siniestro"),style:{cursor:"pointer"},children:["N Siniestro ",T.key==="n_siniestro"&&(T.direction==="ascending"?"":"")]}),m.jsxs("th",{onClick:()=>O("asegurado"),style:{cursor:"pointer"},children:["Asegurado / DNI ",T.key==="asegurado"&&(T.direction==="ascending"?"":"")]}),m.jsxs("th",{onClick:()=>O("cia"),style:{cursor:"pointer"},children:["Compaa ",T.key==="cia"&&(T.direction==="ascending"?"":"")]}),m.jsxs("th",{onClick:()=>O("analista"),style:{cursor:"pointer"},children:["Analista ",T.key==="analista"&&(T.direction==="ascending"?"":"")]}),m.jsxs("th",{onClick:()=>O("estado"),style:{cursor:"pointer"},children:["Estado ",T.key==="estado"&&(T.direction==="ascending"?"":"")]}),m.jsx("th",{children:"Acciones"})]})}),m.jsxs("tbody",{children:[i.map(D=>m.jsxs("tr",{children:[m.jsx("td",{style:{color:"var(--muted-color)",fontSize:"12px"},children:D.id}),m.jsx("td",{style:{fontWeight:600},children:D.n_siniestro}),m.jsxs("td",{children:[m.jsx("div",{style:{fontWeight:500},children:D.asegurado}),m.jsx("div",{style:{fontSize:"12px",color:"var(--muted-color)"},children:D.dni||"-"})]}),m.jsx("td",{style:{color:"var(--muted-color)"},children:D.cia}),m.jsx("td",{style:{color:"var(--muted-color)"},children:D.analista||"-"}),m.jsx("td",{children:m.jsx("span",{className:Ge.badge,style:{backgroundColor:H(D.estado)+"22",color:H(D.estado)==="#ffffff"?"#333":H(D.estado)},children:D.estado||"SIN ESTADO"})}),m.jsx("td",{children:m.jsx("button",{className:Ge.actionBtn,onClick:z=>{z.stopPropagation(),t(`/detalle/${D.id}`)},children:"Ver Detalle"})})]},D.id)),i.length===0&&m.jsx("tr",{children:m.jsx("td",{colSpan:7,style:{textAlign:"center",padding:"30px",color:"var(--muted-color)"},children:"No se encontraron casos que coincidan con los filtros."})})]})]})})]})},b6="_topBar_ysoq7_1",w6="_backLink_ysoq7_14",E6="_container_ysoq7_28",A6="_caseHeader_ysoq7_33",S6="_headerItem_ysoq7_45",T6="_headerLabel_ysoq7_51",C6="_headerValue_ysoq7_59",k6="_tabsContainer_ysoq7_75",N6="_tabsHeader_ysoq7_84",R6="_tabBtn_ysoq7_91",O6="_activeTab_ysoq7_116",D6="_tabContent_ysoq7_122",Wt={topBar:b6,backLink:w6,container:E6,caseHeader:A6,headerItem:S6,headerLabel:T6,headerValue:C6,tabsContainer:k6,tabsHeader:N6,tabBtn:R6,activeTab:O6,tabContent:D6},F6="_wrapper_1bjcr_1",M6="_topActions_1bjcr_5",L6="_btnAdd_1bjcr_9",I6="_cobertura_1bjcr_23",j6="_cabecera_1bjcr_31",P6="_coberturaInputGroup_1bjcr_41",B6="_label_1bjcr_48",U6="_input_1bjcr_55",z6="_tableHeader_1bjcr_70",H6="_itemRow_1bjcr_81",$6="_btnDelete_1bjcr_89",G6="_btnDeleteCobertura_1bjcr_107",V6="_bottomActions_1bjcr_117",q6="_totalRow_1bjcr_125",W6="_totalValue_1bjcr_134",X6="_globalTotal_1bjcr_139",er={wrapper:F6,topActions:M6,btnAdd:L6,cobertura:I6,cabecera:j6,coberturaInputGroup:P6,label:B6,input:U6,tableHeader:z6,itemRow:H6,btnDelete:$6,btnDeleteCobertura:G6,bottomActions:V6,totalRow:q6,totalValue:W6,globalTotal:X6},Y6=({data:r,onUpdate:e})=>{const[t,a]=Q.useState(r||[]);Q.useEffect(()=>{a(r||[])},[r]);const s=_=>{a(_),e(_)},i=()=>{const _={nombre:"",suma:"",items:[]};s([...t,_])},o=_=>{if(!confirm("Eliminar esta cobertura junto con sus tems?"))return;const w=[...t];w.splice(_,1),s(w)},c=(_,w,A)=>{const T=[...t];T[_]={...T[_],[w]:A},s(T)},u=_=>{const w=[...t];w[_].items.push({concepto:"",montoConvenido:"",montoIndemnizacion:""}),s(w)},d=(_,w)=>{const A=[...t];A[_].items.splice(w,1),s(A)},f=(_,w,A,T)=>{const S=[...t],N=[...S[_].items];N[w]={...N[w],[A]:T},S[_].items=N,s(S)},g=_=>{if(typeof _=="number")return _;if(!_)return 0;let w=String(_).trim();w=w.replace(/\./g,""),w=w.replace(",",".");const A=parseFloat(w);return isNaN(A)?0:A},v=_=>_.reduce((w,A)=>w+g(A.montoIndemnizacion),0),x=t.reduce((_,w)=>_+v(w.items),0),y=_=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(_);return m.jsxs("div",{className:er.wrapper,children:[m.jsx("div",{className:er.topActions,children:m.jsxs("button",{className:er.btnAdd,onClick:i,children:[m.jsx(Wd,{size:16})," Agregar Cobertura"]})}),t.map((_,w)=>{const A=v(_.items);return m.jsxs("div",{className:er.cobertura,children:[m.jsxs("div",{className:er.cabecera,children:[m.jsxs("div",{className:er.coberturaInputGroup,style:{flex:2},children:[m.jsx("span",{className:er.label,children:"Nombre Cobertura"}),m.jsx("input",{className:er.input,value:_.nombre,onChange:T=>c(w,"nombre",T.target.value),placeholder:"Ej: Robo TV"})]}),m.jsxs("div",{className:er.coberturaInputGroup,style:{flex:1},children:[m.jsx("span",{className:er.label,children:"Suma Asegurada"}),m.jsx("input",{className:er.input,value:_.suma,onChange:T=>c(w,"suma",T.target.value),placeholder:"0"})]})]}),m.jsxs("div",{className:er.tableHeader,children:[m.jsx("div",{children:"Concepto"}),m.jsx("div",{children:"Monto Convenido"}),m.jsx("div",{children:"Monto Indemnizacin"}),m.jsx("div",{})]}),_.items.map((T,S)=>m.jsxs("div",{className:er.itemRow,children:[m.jsx("input",{className:er.input,value:T.concepto,onChange:N=>f(w,S,"concepto",N.target.value),placeholder:"Descripcin del dao..."}),m.jsx("input",{className:er.input,value:T.montoConvenido,onChange:N=>f(w,S,"montoConvenido",N.target.value),placeholder:"0.00"}),m.jsx("input",{className:er.input,value:T.montoIndemnizacion,onChange:N=>f(w,S,"montoIndemnizacion",N.target.value),placeholder:"0.00"}),m.jsx("button",{className:er.btnDelete,onClick:()=>d(w,S),children:m.jsx(Hl,{size:16})})]},S)),m.jsxs("div",{className:er.bottomActions,children:[m.jsxs("button",{className:er.btnAdd,style:{fontSize:"12px",padding:"6px 12px"},onClick:()=>u(w),children:[m.jsx(Wd,{size:14})," tem"]}),m.jsxs("div",{className:er.totalRow,children:[m.jsx("span",{className:er.label,children:"Total Cobertura:"}),m.jsx("span",{className:er.totalValue,children:y(A)})]}),m.jsx("button",{className:er.btnDeleteCobertura,onClick:()=>o(w),children:"Eliminar Cobertura"})]})]},w)}),t.length>0&&m.jsxs("div",{className:er.globalTotal,children:["TOTAL GLOBAL INDEMNIZACIN: ",y(x)]}),t.length===0&&m.jsx("div",{style:{textAlign:"center",padding:"40px",color:"var(--muted-color)"},children:"No hay coberturas cargadas. Agreg una para comenzar."})]})},K6="_wrapper_1wb05_1",J6="_header_1wb05_6",Q6="_title_1wb05_11",Z6="_subtitle_1wb05_19",e8="_list_1wb05_24",t8="_item_1wb05_31",r8="_checked_1wb05_47",a8="_itemLeft_1wb05_52",s8="_checkbox_1wb05_59",n8="_label_1wb05_66",i8="_btnDelete_1wb05_77",o8="_inputRow_1wb05_100",l8="_input_1wb05_100",c8="_btnAdd_1wb05_123",Na={wrapper:K6,header:J6,title:Q6,subtitle:Z6,list:e8,item:t8,checked:r8,itemLeft:a8,checkbox:s8,label:n8,btnDelete:i8,inputRow:o8,input:l8,btnAdd:c8},u8={"ROBO EN VIA PUBLICA":["DNI","DENUNCIA POLICIAL","BAJA DE IMEI","ULTIMA ACTIVIDAD"],"DAO ELECTRODOMESTICOS":["DNI","FACTURA DE COMPRA","INFORME TCNICO","FOTOS DEL DAO"],"VARIACION DE TENSION":["DNI","FACTURA DE COMPRA","INFORME TCNICO","COMPROBANTE DE ESTABILIZADOR"]},h8=["DNI","DOCUMENTACIN RESPALDATORIA","FOTOS / PRUEBAS","OBSERVACIONES"],d8=({data:r,causa:e,onUpdate:t})=>{const[a,s]=Q.useState([]),[i,o]=Q.useState("");Q.useEffect(()=>{if(Array.isArray(r)&&r.length>0)s(r);else{const x=(u8[e?.toUpperCase()]||h8).map(y=>({text:y,checked:!1}));s(x)}},[r,e]);const c=v=>{s(v),t(v)},u=v=>{const x=[...a];x[v].checked=!x[v].checked,c(x)},d=v=>{const x=[...a];x.splice(v,1),c(x)},f=()=>{if(!i.trim())return;const v=[...a,{text:i.trim(),checked:!1}];c(v),o("")},g=v=>{v.key==="Enter"&&f()};return m.jsxs("div",{className:Na.wrapper,children:[m.jsxs("div",{className:Na.header,children:[m.jsxs("div",{className:Na.title,children:["Requisitos para: ",e||"GENERAL"]}),m.jsx("div",{className:Na.subtitle,children:"Marc los elementos recibidos o completados."})]}),m.jsx("div",{className:Na.list,children:a.map((v,x)=>m.jsxs("div",{className:`${Na.item} ${v.checked?Na.checked:""}`,children:[m.jsxs("div",{className:Na.itemLeft,children:[m.jsx("input",{type:"checkbox",className:Na.checkbox,checked:v.checked,onChange:()=>u(x)}),m.jsx("span",{className:Na.label,children:v.text})]}),m.jsx("button",{className:Na.btnDelete,onClick:()=>d(x),title:"Eliminar item",children:m.jsx(Hl,{size:14})})]},x))}),m.jsxs("div",{className:Na.inputRow,children:[m.jsx("input",{type:"text",className:Na.input,placeholder:"Agregar nuevo requisito...",value:i,onChange:v=>o(v.target.value),onKeyDown:g}),m.jsxs("button",{className:Na.btnAdd,onClick:f,children:[m.jsx(Wd,{size:16})," Agregar"]})]})]})},f8="_wrapper_6id0q_1",p8="_topBar_6id0q_6",g8="_inputGroup_6id0q_17",m8="_field_6id0q_23",v8="_fieldLabel_6id0q_29",x8="_input_6id0q_17",_8="_btnAdd_6id0q_51",y8="_taskList_6id0q_70",b8="_taskItem_6id0q_76",w8="_hecha_6id0q_93",E8="_checkbox_6id0q_98",A8="_taskContent_6id0q_106",S8="_taskText_6id0q_113",T8="_taskMeta_6id0q_124",C8="_badgeUser_6id0q_132",k8="_btnDelete_6id0q_143",Xt={wrapper:f8,topBar:p8,inputGroup:g8,field:m8,fieldLabel:v8,input:x8,btnAdd:_8,taskList:y8,taskItem:b8,hecha:w8,checkbox:E8,taskContent:A8,taskText:S8,taskMeta:T8,badgeUser:C8,btnDelete:k8},N8=({nSiniestro:r,defaultAssignee:e})=>{const[t,a]=Q.useState([]),[s,i]=Q.useState(!0),[o,c]=Q.useState([]),[u,d]=Q.useState(""),[f,g]=Q.useState(""),[v,x]=Q.useState(""),[y,_]=Q.useState(e||"");Q.useEffect(()=>{r&&(w(),A())},[r]),Q.useEffect(()=>{e&&!y&&_(e)},[e]);const w=async()=>{i(!0);const{data:R,error:O}=await qe.from("tareas").select("*").eq("n_siniestro",r).order("creada_en",{ascending:!1});O?console.error("Error fetching tasks:",O):a(R||[]),i(!1)},A=async()=>{const{data:R}=await qe.from("analistas").select("*").eq("activo",1);R&&c(R)},T=async()=>{if(!u.trim())return alert("Ingresa una descripcin para la tarea.");const R={n_siniestro:r,texto:u,fecha:f||null,hora:v||null,hecha:!1,asignado_a:y};try{const{error:O}=await qe.from("tareas").insert([R]);if(O){console.error("Error adding task:",O),O.code==="42703"?alert("Error: La base de datos no tiene el campo 'asignado_a'. Contacta al administrador."):alert(`Error al crear tarea: ${O.message||"Error desconocido"}`);return}d(""),g(""),x(""),w()}catch(O){console.error(O)}},S=async R=>{const O=!R.hecha;a(j=>j.map(I=>I.id===R.id?{...I,hecha:O}:I));const{error:C}=await qe.from("tareas").update({hecha:O}).eq("id",R.id);C&&(console.error("Error updating task:",C),w())},N=async R=>{if(!confirm("Eliminar tarea?"))return;a(C=>C.filter(j=>j.id!==R));const{error:O}=await qe.from("tareas").delete().eq("id",R);O&&(console.error("Error deleting task:",O),w())};return m.jsxs("div",{className:Xt.wrapper,children:[m.jsxs("div",{className:Xt.topBar,children:[m.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"12px"},children:m.jsxs("div",{className:Xt.field,children:[m.jsx("span",{className:Xt.fieldLabel,children:"Descripcin"}),m.jsx("input",{className:Xt.input,placeholder:"Nueva tarea...",value:u,onChange:R=>d(R.target.value),onKeyDown:R=>R.key==="Enter"&&T()})]})}),m.jsxs("div",{className:Xt.inputGroup,children:[m.jsxs("div",{className:Xt.field,style:{width:"150px"},children:[m.jsx("span",{className:Xt.fieldLabel,children:"Fecha Lmite"}),m.jsx("input",{type:"date",className:Xt.input,value:f,onChange:R=>g(R.target.value)})]}),m.jsxs("div",{className:Xt.field,style:{width:"120px"},children:[m.jsx("span",{className:Xt.fieldLabel,children:"Hora"}),m.jsx("input",{type:"time",className:Xt.input,value:v,onChange:R=>x(R.target.value)})]}),m.jsxs("div",{className:Xt.field,style:{flex:1},children:[m.jsx("span",{className:Xt.fieldLabel,children:"Asignado A"}),m.jsxs("select",{className:Xt.input,value:y,onChange:R=>_(R.target.value),children:[m.jsx("option",{value:"",children:"- Sin asignar -"}),o.map(R=>m.jsx("option",{value:R.nombre,children:R.nombre},R.id))]})]}),m.jsxs("button",{className:Xt.btnAdd,onClick:T,children:[m.jsx(Wd,{size:18})," Agregar"]})]})]}),m.jsxs("div",{className:Xt.taskList,children:[s&&m.jsx("div",{style:{padding:"20px",textAlign:"center",color:"var(--muted-color)"},children:"Cargando tareas..."}),!s&&t.length===0&&m.jsx("div",{style:{padding:"40px",textAlign:"center",color:"var(--muted-color)"},children:"No hay tareas pendientes."}),t.map(R=>m.jsxs("div",{className:`${Xt.taskItem} ${R.hecha?Xt.hecha:""}`,children:[m.jsx("input",{type:"checkbox",className:Xt.checkbox,checked:R.hecha,onChange:()=>S(R)}),m.jsxs("div",{className:Xt.taskContent,children:[m.jsx("span",{className:Xt.taskText,children:R.texto}),m.jsxs("div",{className:Xt.taskMeta,children:[R.fecha&&m.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[m.jsx(JR,{size:12})," ",R.fecha]}),R.hora&&m.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[m.jsx(nO,{size:12})," ",R.hora]}),R.asignado_a&&m.jsxs("span",{className:Xt.badgeUser,children:[m.jsx(jO,{size:10})," ",R.asignado_a]})]})]}),m.jsx("button",{className:Xt.btnDelete,onClick:()=>N(R.id),children:m.jsx(Hl,{size:16})})]},R.id))]})]})},R8="_wrapper_lrqvb_1",O8="_pdfBox_lrqvb_6",D8="_pdfLabel_lrqvb_17",F8="_gridHeader_lrqvb_39",M8="_field_lrqvb_46",L8="_label_lrqvb_52",I8="_input_lrqvb_59",j8="_sectionTitle_lrqvb_74",P8="_titleText_lrqvb_83",B8="_btnAdd_lrqvb_89",U8="_tableContainer_lrqvb_104",z8="_table_lrqvb_104",H8="_inputCell_lrqvb_136",$8="_btnDel_lrqvb_153",G8="_totalsRow_lrqvb_170",V8="_actions_lrqvb_176",q8="_btnSave_lrqvb_182",jt={wrapper:R8,pdfBox:O8,pdfLabel:D8,gridHeader:F8,field:M8,label:L8,input:I8,sectionTitle:j8,titleText:P8,btnAdd:B8,tableContainer:U8,table:z8,inputCell:H8,btnDel:$8,totalsRow:G8,actions:V8,btnSave:q8},W8="_dropzone_wyg96_1",X8="_active_wyg96_18",Y8="_icon_wyg96_25",K8="_text_wyg96_31",J8="_subtext_wyg96_36",Q8="_fileInput_wyg96_41",fl={dropzone:W8,active:X8,icon:Y8,text:K8,subtext:J8,fileInput:Q8},OA=({onFileSelect:r,label:e="Arrastr tus archivos ac",subLabel:t="o hac click para seleccionar",accept:a,multiple:s=!1})=>{const i=Q.useRef(null),[o,c]=Q.useState(!1),u=y=>{if(!y)return;const _=[];for(let w=0;w<y.length;w++)_.push(y[w]);_.length>0&&r(_)},d=y=>{y.preventDefault(),y.stopPropagation(),c(!0)},f=y=>{y.preventDefault(),y.stopPropagation(),c(!1)},g=y=>{y.preventDefault(),y.stopPropagation(),c(!0)},v=y=>{y.preventDefault(),y.stopPropagation(),c(!1),u(y.dataTransfer.files)},x=y=>{u(y.target.files)};return m.jsxs("div",{className:`${fl.dropzone} ${o?fl.active:""}`,onDragEnter:d,onDragLeave:f,onDragOver:g,onDrop:v,onClick:()=>i.current?.click(),children:[m.jsx(oO,{className:fl.icon}),m.jsxs("div",{children:[m.jsx("div",{className:fl.text,children:e}),m.jsx("div",{className:fl.subtext,children:t})]}),m.jsx("input",{type:"file",ref:i,className:fl.fileInput,onChange:x,accept:a,multiple:s})]})},ha=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Gg=[.001,0,0,.001,0,0],hg=1.35,$a={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},fi={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},ku="pdfjs_internal_editor_",tt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},gt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Z8={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Vg={TRIANGLES:1,LATTICE:2},Dr={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Ud={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Cr={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},yl={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},_f={ERRORS:0,WARNINGS:1,INFOS:5},Nu={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Uc={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},eB={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let yf=_f.WARNINGS;function tB(r){Number.isInteger(r)&&(yf=r)}function rB(){return yf}function bf(r){yf>=_f.INFOS&&console.info(`Info: ${r}`)}function Ze(r){yf>=_f.WARNINGS&&console.warn(`Warning: ${r}`)}function Pt(r){throw new Error(r)}function mt(r,e){r||Pt(e)}function aB(r){switch(r?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function DA(r,e=null,t=null){if(!r)return null;if(t&&typeof r=="string"&&(t.addDefaultProtocol&&r.startsWith("www.")&&r.match(/\./g)?.length>=2&&(r=`http://${r}`),t.tryConvertEncoding))try{r=lB(r)}catch{}const a=e?URL.parse(r,e):URL.parse(r);return aB(a)?a:null}function FA(r,e,t=!1){const a=URL.parse(r);return a?(a.hash=e,a.href):t&&DA(r,"http://example.com")?r.split("#",1)[0]+`${e?`#${e}`:""}`:""}function et(r,e,t,a=!1){return Object.defineProperty(r,e,{value:t,enumerable:!a,configurable:!0,writable:!1}),t}const _o=(function(){function e(t,a){this.message=t,this.name=a}return e.prototype=new Error,e.constructor=e,e})();class Pb extends _o{constructor(e,t){super(e,"PasswordException"),this.code=t}}class dg extends _o{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class qg extends _o{constructor(e){super(e,"InvalidPDFException")}}class nf extends _o{constructor(e,t,a){super(e,"ResponseException"),this.status=t,this.missing=a}}class sB extends _o{constructor(e){super(e,"FormatError")}}class yi extends _o{constructor(e){super(e,"AbortException")}}function MA(r){(typeof r!="object"||r?.length===void 0)&&Pt("Invalid argument for bytesToString");const e=r.length,t=8192;if(e<t)return String.fromCharCode.apply(null,r);const a=[];for(let s=0;s<e;s+=t){const i=Math.min(s+t,e),o=r.subarray(s,i);a.push(String.fromCharCode.apply(null,o))}return a.join("")}function Vu(r){typeof r!="string"&&Pt("Invalid argument for stringToBytes");const e=r.length,t=new Uint8Array(e);for(let a=0;a<e;++a)t[a]=r.charCodeAt(a)&255;return t}function nB(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function iB(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function oB(){try{return new Function(""),!0}catch{return!1}}class jr{static get isLittleEndian(){return et(this,"isLittleEndian",iB())}static get isEvalSupported(){return et(this,"isEvalSupported",oB())}static get isOffscreenCanvasSupported(){return et(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return et(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return et(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return et(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return et(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){return et(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const fg=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));class Le{static makeHexColor(e,t,a){return`#${fg[e]}${fg[t]}${fg[a]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let a;e[0]?(e[0]<0&&(a=t[0],t[0]=t[2],t[2]=a),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(a=t[1],t[1]=t[3],t[3]=a),t[1]*=e[3],t[3]*=e[3]):(a=t[0],t[0]=t[1],t[1]=a,a=t[2],t[2]=t[3],t[3]=a,e[1]<0&&(a=t[1],t[1]=t[3],t[3]=a),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(a=t[0],t[0]=t[2],t[2]=a),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,a=0){const s=e[a],i=e[a+1];e[a]=s*t[0]+i*t[2]+t[4],e[a+1]=s*t[1]+i*t[3]+t[5]}static applyTransformToBezier(e,t,a=0){const s=t[0],i=t[1],o=t[2],c=t[3],u=t[4],d=t[5];for(let f=0;f<6;f+=2){const g=e[a+f],v=e[a+f+1];e[a+f]=g*s+v*o+u,e[a+f+1]=g*i+v*c+d}}static applyInverseTransform(e,t){const a=e[0],s=e[1],i=t[0]*t[3]-t[1]*t[2];e[0]=(a*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/i,e[1]=(-a*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/i}static axialAlignedBoundingBox(e,t,a){const s=t[0],i=t[1],o=t[2],c=t[3],u=t[4],d=t[5],f=e[0],g=e[1],v=e[2],x=e[3];let y=s*f+u,_=y,w=s*v+u,A=w,T=c*g+d,S=T,N=c*x+d,R=N;if(i!==0||o!==0){const O=i*f,C=i*v,j=o*g,I=o*x;y+=j,A+=j,w+=I,_+=I,T+=O,R+=O,N+=C,S+=C}a[0]=Math.min(a[0],y,w,_,A),a[1]=Math.min(a[1],T,N,S,R),a[2]=Math.max(a[2],y,w,_,A),a[3]=Math.max(a[3],T,N,S,R)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const a=e[0],s=e[1],i=e[2],o=e[3],c=a**2+s**2,u=a*i+s*o,d=i**2+o**2,f=(c+d)/2,g=Math.sqrt(f**2-(c*d-u**2));t[0]=Math.sqrt(f+g||1),t[1]=Math.sqrt(f-g||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const a=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(a>s)return null;const i=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return i>o?null:[a,i,s,o]}static pointBoundingBox(e,t,a){a[0]=Math.min(a[0],e),a[1]=Math.min(a[1],t),a[2]=Math.max(a[2],e),a[3]=Math.max(a[3],t)}static rectBoundingBox(e,t,a,s,i){i[0]=Math.min(i[0],e,a),i[1]=Math.min(i[1],t,s),i[2]=Math.max(i[2],e,a),i[3]=Math.max(i[3],t,s)}static#e(e,t,a,s,i,o,c,u,d,f){if(d<=0||d>=1)return;const g=1-d,v=d*d,x=v*d,y=g*(g*(g*e+3*d*t)+3*v*a)+x*s,_=g*(g*(g*i+3*d*o)+3*v*c)+x*u;f[0]=Math.min(f[0],y),f[1]=Math.min(f[1],_),f[2]=Math.max(f[2],y),f[3]=Math.max(f[3],_)}static#t(e,t,a,s,i,o,c,u,d,f,g,v){if(Math.abs(d)<1e-12){Math.abs(f)>=1e-12&&this.#e(e,t,a,s,i,o,c,u,-g/f,v);return}const x=f**2-4*g*d;if(x<0)return;const y=Math.sqrt(x),_=2*d;this.#e(e,t,a,s,i,o,c,u,(-f+y)/_,v),this.#e(e,t,a,s,i,o,c,u,(-f-y)/_,v)}static bezierBoundingBox(e,t,a,s,i,o,c,u,d){d[0]=Math.min(d[0],e,c),d[1]=Math.min(d[1],t,u),d[2]=Math.max(d[2],e,c),d[3]=Math.max(d[3],t,u),this.#t(e,a,i,c,t,s,o,u,3*(-e+3*(a-i)+c),6*(e-2*a+i),3*(a-e),d),this.#t(e,a,i,c,t,s,o,u,3*(-t+3*(s-o)+u),6*(t-2*s+o),3*(s-t),d)}}function lB(r){return decodeURIComponent(escape(r))}let pg=null,Bb=null;function cB(r){return pg||(pg=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Bb=new Map([["","t"]])),r.replaceAll(pg,(e,t,a)=>t?t.normalize("NFKC"):Bb.get(a))}function LA(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);return crypto.getRandomValues(r),MA(r)}const Sl="pdfjs_internal_id_";function uB(r,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[a,s,...i]=t;if(!r(a)&&!Number.isInteger(a)||!e(s))return!1;const o=i.length;let c=!0;switch(s.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;c=!1;break;default:return!1}for(const u of i)if(!(typeof u=="number"||c&&u===null))return!1;return!0}function da(r,e,t){return Math.min(Math.max(r,e),t)}function IA(r){return Uint8Array.prototype.toBase64?r.toBase64():btoa(MA(r))}function hB(r){return Uint8Array.fromBase64?Uint8Array.fromBase64(r):Vu(atob(r))}typeof Promise.try!="function"&&(Promise.try=function(r,...e){return new Promise(t=>{t(r(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(r){return r.reduce((e,t)=>e+t,0)});class Ru{static textContent(e){const t=[],a={items:t,styles:Object.create(null)};function s(i){if(!i)return;let o=null;const c=i.name;if(c==="#text")o=i.value;else if(Ru.shouldBuildText(c))i?.attributes?.textContent?o=i.attributes.textContent:i.value&&(o=i.value);else return;if(o!==null&&t.push({str:o}),!!i.children)for(const u of i.children)s(u)}return s(e),a}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class jA{static setupStorage(e,t,a,s,i){const o=s.getValue(t,{value:null});switch(a.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),i==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})});break;case"input":if(a.attributes.type==="radio"||a.attributes.type==="checkbox"){if(o.value===a.attributes.xfaOn?e.setAttribute("checked",!0):o.value===a.attributes.xfaOff&&e.removeAttribute("checked"),i==="print")break;e.addEventListener("change",c=>{s.setValue(t,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),i==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const c of a.children)c.attributes.value===o.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}e.addEventListener("input",c=>{const u=c.target.options,d=u.selectedIndex===-1?"":u[u.selectedIndex].value;s.setValue(t,{value:d})});break}}static setAttributes({html:e,element:t,storage:a=null,intent:s,linkService:i}){const{attributes:o}=t,c=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${s}`);for(const[u,d]of Object.entries(o))if(d!=null)switch(u){case"class":d.length&&e.setAttribute(u,d.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",d);break;case"style":Object.assign(e.style,d);break;case"textContent":e.textContent=d;break;default:(!c||u!=="href"&&u!=="newWindow")&&e.setAttribute(u,d)}c&&i.addLinkAttributes(e,o.href,o.newWindow),a&&o.dataId&&this.setupStorage(e,o.dataId,t,a)}static render(e){const t=e.annotationStorage,a=e.linkService,s=e.xfaHtml,i=e.intent||"display",o=document.createElement(s.name);s.attributes&&this.setAttributes({html:o,element:s,intent:i,linkService:a});const c=i!=="richText",u=e.div;if(u.append(o),e.viewport){const g=`matrix(${e.viewport.transform.join(",")})`;u.style.transform=g}c&&u.setAttribute("class","xfaLayer xfaFont");const d=[];if(s.children.length===0){if(s.value){const g=document.createTextNode(s.value);o.append(g),c&&Ru.shouldBuildText(s.name)&&d.push(g)}return{textDivs:d}}const f=[[s,-1,o]];for(;f.length>0;){const[g,v,x]=f.at(-1);if(v+1===g.children.length){f.pop();continue}const y=g.children[++f.at(-1)[1]];if(y===null)continue;const{name:_}=y;if(_==="#text"){const A=document.createTextNode(y.value);d.push(A),x.append(A);continue}const w=y?.attributes?.xmlns?document.createElementNS(y.attributes.xmlns,_):document.createElement(_);if(x.append(w),y.attributes&&this.setAttributes({html:w,element:y,storage:t,intent:i,linkService:a}),y.children?.length>0)f.push([y,-1,w]);else if(y.value){const A=document.createTextNode(y.value);c&&Ru.shouldBuildText(_)&&d.push(A),w.append(A)}}for(const g of u.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:d}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const An="http://www.w3.org/2000/svg";class Pl{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function qu(r,e="text"){if(Kc(r,document.baseURI)){const t=await fetch(r);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,a)=>{const s=new XMLHttpRequest;s.open("GET",r,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}a(new Error(s.statusText))}},s.send(null)})}class Wu{constructor({viewBox:e,userUnit:t,scale:a,rotation:s,offsetX:i=0,offsetY:o=0,dontFlip:c=!1}){this.viewBox=e,this.userUnit=t,this.scale=a,this.rotation=s,this.offsetX=i,this.offsetY=o,a*=t;const u=(e[2]+e[0])/2,d=(e[3]+e[1])/2;let f,g,v,x;switch(s%=360,s<0&&(s+=360),s){case 180:f=-1,g=0,v=0,x=1;break;case 90:f=0,g=1,v=1,x=0;break;case 270:f=0,g=-1,v=-1,x=0;break;case 0:f=1,g=0,v=0,x=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(v=-v,x=-x);let y,_,w,A;f===0?(y=Math.abs(d-e[1])*a+i,_=Math.abs(u-e[0])*a+o,w=(e[3]-e[1])*a,A=(e[2]-e[0])*a):(y=Math.abs(u-e[0])*a+i,_=Math.abs(d-e[1])*a+o,w=(e[2]-e[0])*a,A=(e[3]-e[1])*a),this.transform=[f*a,g*a,v*a,x*a,y-f*a*u-v*a*d,_-g*a*u-x*a*d],this.width=w,this.height=A}get rawDims(){const e=this.viewBox;return et(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:a=this.offsetX,offsetY:s=this.offsetY,dontFlip:i=!1}={}){return new Wu({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:a,offsetY:s,dontFlip:i})}convertToViewportPoint(e,t){const a=[e,t];return Le.applyTransform(a,this.transform),a}convertToViewportRectangle(e){const t=[e[0],e[1]];Le.applyTransform(t,this.transform);const a=[e[2],e[3]];return Le.applyTransform(a,this.transform),[t[0],t[1],a[0],a[1]]}convertToPdfPoint(e,t){const a=[e,t];return Le.applyInverseTransform(a,this.transform),a}}class qm extends _o{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function wf(r){const e=r.length;let t=0;for(;t<e&&r[t].trim()==="";)t++;return r.substring(t,t+5).toLowerCase()==="data:"}function Wm(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function dB(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function fB(r,e="document.pdf"){if(typeof r!="string")return e;if(wf(r))return Ze('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const a=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(r);if(!a)return e;const s=c=>{try{let u=decodeURIComponent(c);return u.includes("/")?(u=u.split("/").at(-1),u.test(/^\.pdf$/i)?u:c):u}catch{return c}},i=/\.pdf$/i,o=a.pathname.split("/").at(-1);if(i.test(o))return s(o);if(a.searchParams.size>0){const c=Array.from(a.searchParams.values()).reverse();for(const d of c)if(i.test(d))return s(d);const u=Array.from(a.searchParams.keys()).reverse();for(const d of u)if(i.test(d))return s(d)}if(a.hash){const u=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(a.hash);if(u)return s(u[0])}return e}class Ub{started=Object.create(null);times=[];time(e){e in this.started&&Ze(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ze(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:a}of this.times)t=Math.max(a.length,t);for(const{name:a,start:s,end:i}of this.times)e.push(`${a.padEnd(t)} ${i-s}ms
`);return e.join("")}}function Kc(r,e){const t=e?URL.parse(r,e):URL.parse(r);return t?.protocol==="http:"||t?.protocol==="https:"}function ys(r){r.preventDefault()}function fr(r){r.preventDefault(),r.stopPropagation()}function pB(r){console.log("Deprecated API usage: "+r)}class Wg{static#e;static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const a=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let c=parseInt(t[5],10);c=c>=0&&c<=59?c:0;let u=parseInt(t[6],10);u=u>=0&&u<=59?u:0;const d=t[7]||"Z";let f=parseInt(t[8],10);f=f>=0&&f<=23?f:0;let g=parseInt(t[9],10)||0;return g=g>=0&&g<=59?g:0,d==="-"?(o+=f,c+=g):d==="+"&&(o-=f,c-=g),new Date(Date.UTC(a,s,i,o,c,u))}}function gB(r,{scale:e=1,rotation:t=0}){const{width:a,height:s}=r.attributes.style,i=[0,0,parseInt(a),parseInt(s)];return new Wu({viewBox:i,userUnit:1,scale:e,rotation:t})}function Xu(r){if(r.startsWith("#")){const e=parseInt(r.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(e=>parseInt(e)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ze(`Not a valid color format: "${r}"`),[0,0,0])}function mB(r){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of r.keys()){e.style.color=t;const a=window.getComputedStyle(e).color;r.set(t,Xu(a))}e.remove()}function ir(r){const{a:e,b:t,c:a,d:s,e:i,f:o}=r.getTransform();return[e,t,a,s,i,o]}function Ks(r){const{a:e,b:t,c:a,d:s,e:i,f:o}=r.getTransform().invertSelf();return[e,t,a,s,i,o]}function co(r,e,t=!1,a=!0){if(e instanceof Wu){const{pageWidth:s,pageHeight:i}=e.rawDims,{style:o}=r,c=jr.isCSSRoundSupported,u=`var(--total-scale-factor) * ${s}px`,d=`var(--total-scale-factor) * ${i}px`,f=c?`round(down, ${u}, var(--scale-round-x))`:`calc(${u})`,g=c?`round(down, ${d}, var(--scale-round-y))`:`calc(${d})`;!t||e.rotation%180===0?(o.width=f,o.height=g):(o.width=g,o.height=f)}a&&r.setAttribute("data-main-rotation",e.rotation)}class rn{constructor(){const{pixelRatio:e}=rn;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,a,s,i=-1){let o=1/0,c=1/0,u=1/0;a=rn.capPixels(a,i),a>0&&(o=Math.sqrt(a/(e*t))),s!==-1&&(c=s/e,u=s/t);const d=Math.min(o,c,u);return this.sx>d||this.sy>d?(this.sx=d,this.sy=d,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const a=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,a):a}return e}}const Xg=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class vB{static get isDarkMode(){return et(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class xB{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:a}=window.getComputedStyle(e);return e.remove(),et(this,"commentForegroundColor",Xu(a))}}function _B(r,e,t,a){a=Math.min(Math.max(a??1,0),1);const s=255*(1-a);return r=Math.round(r*a+s),e=Math.round(e*a+s),t=Math.round(t*a+s),[r,e,t]}function zb(r,e){const t=r[0]/255,a=r[1]/255,s=r[2]/255,i=Math.max(t,a,s),o=Math.min(t,a,s),c=(i+o)/2;if(i===o)e[0]=e[1]=0;else{const u=i-o;switch(e[1]=c<.5?u/(i+o):u/(2-i-o),i){case t:e[0]=((a-s)/u+(a<s?6:0))*60;break;case a:e[0]=((s-t)/u+2)*60;break;case s:e[0]=((t-a)/u+4)*60;break}}e[2]=c}function Yg(r,e){const t=r[0],a=r[1],s=r[2],i=(1-Math.abs(2*s-1))*a,o=i*(1-Math.abs(t/60%2-1)),c=s-i/2;switch(Math.floor(t/60)){case 0:e[0]=i+c,e[1]=o+c,e[2]=c;break;case 1:e[0]=o+c,e[1]=i+c,e[2]=c;break;case 2:e[0]=c,e[1]=i+c,e[2]=o+c;break;case 3:e[0]=c,e[1]=o+c,e[2]=i+c;break;case 4:e[0]=o+c,e[1]=c,e[2]=i+c;break;case 5:case 6:e[0]=i+c,e[1]=c,e[2]=o+c;break}}function Hb(r){return r<=.03928?r/12.92:((r+.055)/1.055)**2.4}function $b(r,e,t){Yg(r,t),t.map(Hb);const a=.2126*t[0]+.7152*t[1]+.0722*t[2];Yg(e,t),t.map(Hb);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];return a>s?(a+.05)/(s+.05):(s+.05)/(a+.05)}const Gb=new Map;function yB(r,e){const t=r[0]+r[1]*256+r[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let a=Gb.get(t);if(a)return a;const s=new Float32Array(9),i=s.subarray(0,3),o=s.subarray(3,6);zb(r,o);const c=s.subarray(6,9);zb(e,c);const u=c[2]<.5,d=u?12:4.5;if(o[2]=u?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),$b(o,c,i)<d){let f,g;u?(f=o[2],g=1):(f=0,g=o[2]);const v=.005;for(;g-f>v;){const x=o[2]=(f+g)/2;u===$b(o,c,i)<d?f=x:g=x}o[2]=u?g:f}return Yg(o,i),a=Le.makeHexColor(Math.round(i[0]*255),Math.round(i[1]*255),Math.round(i[2]*255)),Gb.set(t,a),a}function PA({html:r,dir:e,className:t},a){const s=document.createDocumentFragment();if(typeof r=="string"){const i=document.createElement("p");i.dir=e||"auto";const o=r.split(/(?:\r\n?|\n)/);for(let c=0,u=o.length;c<u;++c){const d=o[c];i.append(document.createTextNode(d)),c<u-1&&i.append(document.createElement("br"))}s.append(i)}else jA.render({xfaHtml:r,div:s,intent:"richText"});s.firstElementChild.classList.add("richText",t),a.append(s)}function BA(r){const e=new Path2D;if(!r)return e;for(let t=0,a=r.length;t<a;)switch(r[t++]){case Uc.moveTo:e.moveTo(r[t++],r[t++]);break;case Uc.lineTo:e.lineTo(r[t++],r[t++]);break;case Uc.curveTo:e.bezierCurveTo(r[t++],r[t++],r[t++],r[t++],r[t++],r[t++]);break;case Uc.quadraticCurveTo:e.quadraticCurveTo(r[t++],r[t++],r[t++],r[t++]);break;case Uc.closePath:e.closePath();break;default:Ze(`Unrecognized drawing path operator: ${r[t-1]}`);break}return e}class hu{#e=null;#t=null;#a;#r=null;#i=null;#n=null;#s=null;#o=null;static#c=null;constructor(e){this.#a=e,hu.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#a._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",ys,{signal:t}),e.addEventListener("pointerdown",hu.#l,{signal:t}));const a=this.#r=document.createElement("div");a.className="buttons",e.append(a);const s=this.#a.toolbarPosition;if(s){const{style:i}=e,o=this.#a._uiManager.direction==="ltr"?1-s[0]:s[0];i.insetInlineEnd=`${100*o}%`,i.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return this.#e}static#l(e){e.stopPropagation()}#d(e){this.#a._focusEventsAllowed=!1,fr(e)}#h(e){this.#a._focusEventsAllowed=!0,fr(e)}#f(e){const t=this.#a._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",ys,{signal:t}),!0)}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#i?.shown(),this.#n?.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=this.#a,a=document.createElement("button");a.classList.add("basic","deleteButton"),a.tabIndex=0,a.setAttribute("data-l10n-id",hu.#c[e]),this.#f(a)&&a.addEventListener("click",s=>{t.delete()},{signal:t._signal}),this.#r.append(a)}get#m(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#f(t),this.#r.append(t,this.#m),this.#i=e}addComment(e,t=null){if(this.#n)return;const a=e.renderForToolbar();if(!a)return;this.#f(a);const s=this.#s=this.#m;t?(this.#r.insertBefore(a,t),this.#r.insertBefore(s,t)):this.#r.append(a,s),this.#n=e,e.toolbar=this}addColorPicker(e){if(this.#t)return;this.#t=e;const t=e.renderButton();this.#f(t),this.#r.append(t,this.#m)}async addEditSignatureButton(e){const t=this.#o=await e.renderEditButton(this.#a);this.#f(t),this.#r.append(t,this.#m)}removeButton(e){e==="comment"&&(this.#n?.removeToolbarCommentButton(),this.#n=null,this.#s?.remove(),this.#s=null)}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,a){if(!t&&e==="comment")return;const s=this.#r.querySelector(a);s&&e==="comment"&&this.addComment(t,s)}updateEditSignatureButton(e){this.#o&&(this.#o.title=e)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class bB{#e=null;#t=null;#a;constructor(e){this.#a=e}#r(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar");const t=this.#a._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",ys,{signal:t});const a=this.#e=document.createElement("div");return a.className="buttons",e.append(a),this.#a.hasCommentManager()&&this.#n("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#a.commentSelection("floating_button")}),this.#n("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#a.highlightSelection("floating_button")}),e}#i(e,t){let a=0,s=0;for(const i of e){const o=i.y+i.height;if(o<a)continue;const c=i.x+(t?i.width:0);if(o>a){s=c,a=o;continue}t?c>s&&(s=c):c<s&&(s=c)}return[t?1-s:s,a]}show(e,t,a){const[s,i]=this.#i(t,a),{style:o}=this.#t||=this.#r();e.append(this.#t),o.insetInlineEnd=`${100*s}%`,o.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#n(e,t,a,s){const i=document.createElement("button");i.classList.add("basic",e),i.tabIndex=0,i.setAttribute("data-l10n-id",t);const o=document.createElement("span");i.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",a);const c=this.#a._signal;c instanceof AbortSignal&&!c.aborted&&(i.addEventListener("contextmenu",ys,{signal:c}),i.addEventListener("click",s,{signal:c})),this.#e.append(i)}}function UA(r,e,t){for(const a of t)e.addEventListener(a,r[a].bind(r))}class Ct{static#e=NaN;static#t=null;static#a=NaN;static#r=null;static initializeAndAddPointerId(e){(Ct.#t||=new Set).add(e)}static setPointer(e,t){Ct.#e||=t,Ct.#r??=e}static setTimeStamp(e){Ct.#a=e}static isSamePointerId(e){return Ct.#e===e}static isSamePointerIdOrRemove(e){return Ct.#e===e?!0:(Ct.#t?.delete(e),!1)}static isSamePointerType(e){return Ct.#r===e}static isInitializedAndDifferentPointerType(e){return Ct.#r!==null&&!Ct.isSamePointerType(e)}static isSameTimeStamp(e){return Ct.#a===e}static isUsingMultiplePointers(){return Ct.#t?.size>=1}static clearPointerType(){Ct.#r=null}static clearPointerIds(){Ct.#e=NaN,Ct.#t=null}static clearTimeStamp(){Ct.#a=NaN}}class wB{#e=0;get id(){return`${ku}${this.#e++}`}}class Xm{#e=LA();#t=0;#a=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',a=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const i=s.decode().then(()=>(a.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(a.getImageData(0,0,1,1).data.buffer)[0]===0));return et(this,"_isSVGFittingCanvas",i)}async#r(e,t){this.#a||=new Map;let a=this.#a.get(e);if(a===null)return null;if(a?.bitmap)return a.refCounter+=1,a;try{a||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let s;if(typeof t=="string"?(a.url=t,s=await qu(t,"blob")):t instanceof File?s=a.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const i=Xm._isSVGFittingCanvas,o=new FileReader,c=new Image,u=new Promise((d,f)=>{c.onload=()=>{a.bitmap=c,a.isSvg=!0,d()},o.onload=async()=>{const g=a.svgUrl=o.result;c.src=await i?`${g}#svgView(preserveAspectRatio(none))`:g},c.onerror=o.onerror=f});o.readAsDataURL(s),await u}else a.bitmap=await createImageBitmap(s);a.refCounter=1}catch(s){Ze(s),a=null}return this.#a.set(e,a),a&&this.#a.set(a.id,a),a}async getFromFile(e){const{lastModified:t,name:a,size:s,type:i}=e;return this.#r(`${t}_${a}_${s}_${i}`,e)}async getFromUrl(e){return this.#r(e,e)}async getFromBlob(e,t){const a=await t;return this.#r(e,a)}async getFromId(e){this.#a||=new Map;const t=this.#a.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:a}=t;return delete t.blobPromise,this.getFromBlob(t.id,a)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#a||=new Map;let a=this.#a.get(e);if(a?.bitmap)return a.refCounter+=1,a;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),a={bitmap:s.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#a.set(e,a),this.#a.set(a.id,a),a}getSvgUrl(e){const t=this.#a.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#a||=new Map;const t=this.#a.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:a}=t;if(!t.url&&!t.file){const s=new OffscreenCanvas(a.width,a.height);s.getContext("bitmaprenderer").transferFromImageBitmap(a),t.blobPromise=s.convertToBlob()}a.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class EB{#e=[];#t=!1;#a;#r=-1;constructor(e=128){this.#a=e}add({cmd:e,undo:t,post:a,mustExec:s,type:i=NaN,overwriteIfSameType:o=!1,keepUndo:c=!1}){if(s&&e(),this.#t)return;const u={cmd:e,undo:t,post:a,type:i};if(this.#r===-1){this.#e.length>0&&(this.#e.length=0),this.#r=0,this.#e.push(u);return}if(o&&this.#e[this.#r].type===i){c&&(u.undo=this.#e[this.#r].undo),this.#e[this.#r]=u;return}const d=this.#r+1;d===this.#a?this.#e.splice(0,1):(this.#r=d,d<this.#e.length&&this.#e.splice(d)),this.#e.push(u)}undo(){if(this.#r===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#r];e(),t?.(),this.#t=!1,this.#r-=1}redo(){if(this.#r<this.#e.length-1){this.#r+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#r];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#r!==-1}hasSomethingToRedo(){return this.#r<this.#e.length-1}cleanType(e){if(this.#r!==-1){for(let t=this.#r;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#r-t),this.#r=t;return}this.#e.length=0,this.#r=-1}}destroy(){this.#e=null}}class Yu{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=jr.platform;for(const[a,s,i={}]of e)for(const o of a){const c=o.startsWith("mac+");t&&c?(this.callbacks.set(o.slice(4),{callback:s,options:i}),this.allKeys.add(o.split("+").at(-1))):!t&&!c&&(this.callbacks.set(o,{callback:s,options:i}),this.allKeys.add(o.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const a=this.callbacks.get(this.#e(t));if(!a)return;const{callback:s,options:{bubbles:i=!1,args:o=[],checker:c=null}}=a;c&&!c(e,t)||(s.bind(e,...o,t)(),i||fr(t))}}class Ym{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return mB(e),et(this,"_colors",e)}convert(e){const t=Xu(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[a,s]of this._colors)if(s.every((i,o)=>i===t[o]))return Ym._colorsMapping.get(a);return t}getHexCode(e){const t=this._colors.get(e);return t?Le.makeHexColor(...t):e}}class bi{#e=new AbortController;#t=null;#a=null;#r=new Map;#i=new Map;#n=null;#s=null;#o=null;#c=new EB;#l=null;#d=null;#h=null;#f=0;#m=new Set;#g=null;#u=null;#p=new Set;_editorUndoBar=null;#v=!1;#_=!1;#x=!1;#S=null;#E=null;#b=null;#C=null;#y=!1;#A=null;#R=new wB;#k=!1;#N=!1;#j=!1;#D=null;#M=null;#P=null;#L=null;#G=null;#T=tt.NONE;#w=new Set;#F=null;#B=null;#z=null;#W=null;#q=null;#X={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#I=null;#V=null;#Q=null;#Z=null;#U=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=bi.prototype,t=o=>o.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),a=(o,{target:c})=>{if(c instanceof HTMLInputElement){const{type:u}=c;return u!=="text"&&u!=="number"}return!0},s=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return et(this,"_keyboardManager",new Yu([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:a}],[["ctrl+z","mac+meta+z"],e.undo,{checker:a}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:a}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:a}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:c})=>!(c instanceof HTMLButtonElement)&&o.#V.contains(c)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:c})=>!(c instanceof HTMLButtonElement)&&o.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}]]))}constructor(e,t,a,s,i,o,c,u,d,f,g,v,x,y,_,w){const A=this._signal=this.#e.signal;this.#V=e,this.#Q=t,this.#Z=a,this.#n=s,this.#l=i,this.#B=o,this.#q=u,this._eventBus=c,c._on("editingaction",this.onEditingAction.bind(this),{signal:A}),c._on("pagechanging",this.onPageChanging.bind(this),{signal:A}),c._on("scalechanging",this.onScaleChanging.bind(this),{signal:A}),c._on("rotationchanging",this.onRotationChanging.bind(this),{signal:A}),c._on("setpreference",this.onSetPreference.bind(this),{signal:A}),c._on("switchannotationeditorparams",T=>this.updateParams(T.type,T.value),{signal:A}),window.addEventListener("pointerdown",()=>{this.#N=!0},{capture:!0,signal:A}),window.addEventListener("pointerup",()=>{this.#N=!1},{capture:!0,signal:A}),this.#ie(),this.#de(),this.#te(),this.#s=u.annotationStorage,this.#S=u.filterFactory,this.#z=d,this.#C=f||null,this.#v=g,this.#_=v,this.#x=x,this.#G=y||null,this.viewParameters={realScale:Pl.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=_||null,this._supportsPinchToZoom=w!==!1,i?.setSidebarUiManager(this)}destroy(){this.#U?.resolve(),this.#U=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#i.values())e.destroy();this.#i.clear(),this.#r.clear(),this.#p.clear(),this.#L?.clear(),this.#t=null,this.#w.clear(),this.#c.destroy(),this.#n?.destroy(),this.#l?.destroy(),this.#B?.destroy(),this.#A?.hide(),this.#A=null,this.#P?.destroy(),this.#P=null,this.#a=null,this.#E&&(clearTimeout(this.#E),this.#E=null),this.#I&&(clearTimeout(this.#I),this.#I=null),this._editorUndoBar?.destroy(),this.#q=null}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#G}get useNewAltTextFlow(){return this.#_}get useNewAltTextWhenAddingImage(){return this.#x}get hcmFilter(){return et(this,"hcmFilter",this.#z?this.#S.addHCMFilter(this.#z.foreground,this.#z.background):"none")}get direction(){return et(this,"direction",getComputedStyle(this.#V).direction)}get _highlightColors(){return et(this,"_highlightColors",this.#C?new Map(this.#C.split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return et(this,"highlightColors",null);const t=new Map,a=!!this.#z;for(const[s,i]of e){const o=s.endsWith("_HCM");if(a&&o){t.set(s.replace("_HCM",""),i);continue}!a&&!o&&t.set(s,i)}return et(this,"highlightColors",t)}get highlightColorNames(){return et(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=e}setMainHighlightColorPicker(e){this.#P=e}editAltText(e,t=!1){this.#n?.editAltText(this,e,t)}hasCommentManager(){return!!this.#l}editComment(e,t,a,s){this.#l?.showDialog(this,e,t,a,s)}selectComment(e,t){this.#i.get(e)?.getEditorByUID(t)?.toggleComment(!0,!0)}updateComment(e){this.#l?.updateComment(e.getData())}updatePopupColor(e){this.#l?.updatePopupColor(e)}removeComment(e){this.#l?.removeComments([e.uid])}toggleComment(e,t,a=void 0){this.#l?.toggleCommentPopup(e,t,a)}makeCommentColor(e,t){return e&&this.#l?.makeCommentColor(e,t)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(e){if(this.#i.has(e-1))return;const{resolve:t,promise:a}=Promise.withResolvers(),s=i=>{i.pageNumber===e&&(this._eventBus._off("editorsrendered",s),t())};this._eventBus.on("editorsrendered",s),await a}getSignature(e){this.#B?.getSignature({uiManager:this,editor:e})}get signatureManager(){return this.#B}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){e==="enableNewAltTextWhenAddingImage"&&(this.#x=t)}onPageChanging({pageNumber:e}){this.#f=e-1}focusMainContainer(){this.#V.focus()}findParent(e,t){for(const a of this.#i.values()){const{x:s,y:i,width:o,height:c}=a.div.getBoundingClientRect();if(e>=s&&e<=s+o&&t>=i&&t<=i+c)return a}return null}disableUserSelect(e=!1){this.#Q.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#p.add(e)}removeShouldRescale(e){this.#p.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*Pl.PDF_TO_CSS_UNITS;for(const t of this.#p)t.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#J({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#ee(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const a of this.#i.values())if(a.hasTextLayer(e))return a;return null}highlightSelection(e="",t=!1){const a=document.getSelection();if(!a||a.isCollapsed)return;const{anchorNode:s,anchorOffset:i,focusNode:o,focusOffset:c}=a,u=a.toString(),f=this.#J(a).closest(".textLayer"),g=this.getSelectionBoxes(f);if(!g)return;a.empty();const v=this.#ee(f),x=this.#T===tt.NONE,y=()=>{const _=v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:g,anchorNode:s,anchorOffset:i,focusNode:o,focusOffset:c,text:u});x&&this.showAllEditors("highlight",!0,!0),t&&_?.editComment()};if(x){this.switchToMode(tt.HIGHLIGHT,y);return}y()}commentSelection(e=""){this.highlightSelection(e,!0)}#se(){const e=document.getSelection();if(!e||e.isCollapsed)return;const a=this.#J(e).closest(".textLayer"),s=this.getSelectionBoxes(a);s&&(this.#A||=new bB(this),this.#A.show(a,s,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(e){if(!this.#s)return null;const t=`${ku}${e}`,a=this.#s.getRawValue(t);return a&&this.#s.remove(t),a}addToAnnotationStorage(e){!e.isEmpty()&&this.#s&&!this.#s.has(e.id)&&this.#s.setValue(e.id,e)}a11yAlert(e,t=null){const a=this.#Z;a&&(a.setAttribute("data-l10n-id",e),t?a.setAttribute("data-l10n-args",JSON.stringify(t)):a.removeAttribute("data-l10n-args"))}#ne(){const e=document.getSelection();if(!e||e.isCollapsed){this.#F&&(this.#A?.hide(),this.#F=null,this.#O({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#F)return;const s=this.#J(e).closest(".textLayer");if(!s){this.#F&&(this.#A?.hide(),this.#F=null,this.#O({hasSelectedText:!1}));return}if(this.#A?.hide(),this.#F=t,this.#O({hasSelectedText:!0}),!(this.#T!==tt.HIGHLIGHT&&this.#T!==tt.NONE)&&(this.#T===tt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#y=this.isShiftKeyDown,!this.isShiftKeyDown)){const i=this.#T===tt.HIGHLIGHT?this.#ee(s):null;if(i?.toggleDrawing(),this.#N){const o=new AbortController,c=this.combinedSignal(o),u=d=>{d.type==="pointerup"&&d.button!==0||(o.abort(),i?.toggleDrawing(!0),d.type==="pointerup"&&this.#Y("main_toolbar"))};window.addEventListener("pointerup",u,{signal:c}),window.addEventListener("blur",u,{signal:c})}else i?.toggleDrawing(!0),this.#Y("main_toolbar")}}#Y(e=""){this.#T===tt.HIGHLIGHT?this.highlightSelection(e):this.#v&&this.#se()}#ie(){document.addEventListener("selectionchange",this.#ne.bind(this),{signal:this._signal})}#oe(){if(this.#b)return;this.#b=new AbortController;const e=this.combinedSignal(this.#b);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#le(){this.#b?.abort(),this.#b=null}blur(){if(this.isShiftKeyDown=!1,this.#y&&(this.#y=!1,this.#Y("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#w)if(t.div.contains(e)){this.#M=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#M)return;const[e,t]=this.#M;this.#M=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#te(){if(this.#D)return;this.#D=new AbortController;const e=this.combinedSignal(this.#D);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#ce(){this.#D?.abort(),this.#D=null}#ue(){if(this.#d)return;this.#d=new AbortController;const e=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#he(){this.#d?.abort(),this.#d=null}#de(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#te(),this.setEditingState(!0)}removeEditListeners(){this.#ce(),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const a of this.#u)if(a.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const a of this.#u)if(a.isHandlingMimeForPasting(t.type)){a.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const a of this.#w){const s=a.serialize(!0);s&&t.push(s)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const i of t.items)for(const o of this.#u)if(o.isHandlingMimeForPasting(i.type)){o.paste(i,this.currentLayer);return}let a=t.getData("application/pdfjs");if(!a)return;try{a=JSON.parse(a)}catch(i){Ze(`paste: "${i.message}".`);return}if(!Array.isArray(a))return;this.unselectAll();const s=this.currentLayer;try{const i=[];for(const u of a){const d=await s.deserialize(u);if(!d)return;i.push(d)}const o=()=>{for(const u of i)this.#re(u);this.#ae(i)},c=()=>{for(const u of i)u.remove()};this.addCommands({cmd:o,undo:c,mustExec:!0})}catch(i){Ze(`paste: "${i.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==tt.NONE&&!this.isEditorHandlingKeyboard&&bi._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#y&&(this.#y=!1,this.#Y("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#O(e){Object.entries(e).some(([a,s])=>this.#X[a]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#X,e)}),this.#T===tt.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#$([[gt.HIGHLIGHT_FREE,!0]]))}#$(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#oe(),this.#ue(),this.#O({isEditing:this.#T!==tt.NONE,isEmpty:this.#K(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#le(),this.#he(),this.#O({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#u){this.#u=e;for(const t of this.#u)this.#$(t.defaultPropertiesToUpdate)}}getId(){return this.#R.id}get currentLayer(){return this.#i.get(this.#f)}getLayer(e){return this.#i.get(e)}get currentPageIndex(){return this.#f}addLayer(e){this.#i.set(e.pageIndex,e),this.#k?e.enable():e.disable()}removeLayer(e){this.#i.delete(e.pageIndex)}async updateMode(e,t=null,a=!1,s=!1,i=!1,o=!1){if(this.#T!==e&&!(this.#U&&(await this.#U.promise,!this.#U))){if(this.#U=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#T===tt.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#T=e,e===tt.NONE){this.setEditingState(!1),this.#pe();for(const c of this.#r.values())c.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#U.resolve();return}for(const c of this.#r.values())c.addStandaloneCommentButton();e===tt.SIGNATURE&&await this.#B?.loadSignatures(),a&&Ct.clearPointerType(),this.setEditingState(!0),await this.#fe(),this.unselectAll();for(const c of this.#i.values())c.updateMode(e);if(e===tt.POPUP){this.#a||=await this.#q.getAnnotationsByType(new Set(this.#u.map(d=>d._editorType)));const c=new Set,u=[];for(const d of this.#r.values()){const{annotationElementId:f,hasComment:g,deleted:v}=d;f&&c.add(f),g&&!v&&u.push(d.getData())}for(const d of this.#a){const{id:f,popupRef:g,contentsObj:v}=d;g&&v?.str&&!c.has(f)&&!this.#m.has(f)&&u.push(d)}this.#l?.showSidebar(u)}if(!t){s&&this.addNewEditorFromKeyboard(),this.#U.resolve();return}for(const c of this.#r.values())c.uid===t?(this.setSelected(c),o?c.editComment():i?c.enterInEditMode():c.focus()):c.unselect();this.#U.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(this.#u){switch(e){case gt.CREATE:this.currentLayer.addNewEditor(t);return;case gt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#W||=new Map).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const a of this.#w)a.updateParams(e,t);else for(const a of this.#u)a.updateDefaultParams(e,t)}}showAllEditors(e,t,a=!1){for(const i of this.#r.values())i.editorType===e&&i.show(t);(this.#W?.get(gt.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#$([[gt.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#j!==e){this.#j=e;for(const t of this.#i.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#fe(){if(!this.#k){this.#k=!0;const e=[];for(const t of this.#i.values())e.push(t.enable());await Promise.all(e);for(const t of this.#r.values())t.enable()}}#pe(){if(this.unselectAll(),this.#k){this.#k=!1;for(const e of this.#i.values())e.disable();for(const e of this.#r.values())e.disable()}}*getEditors(e){for(const t of this.#r.values())t.pageIndex===e&&(yield t)}getEditor(e){return this.#r.get(e)}addEditor(e){this.#r.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#E&&clearTimeout(this.#E),this.#E=setTimeout(()=>{this.focusMainContainer(),this.#E=null},0)),this.#r.delete(e.id),e.annotationElementId&&this.#L?.delete(e.annotationElementId),this.unselect(e),(!e.annotationElementId||!this.#m.has(e.annotationElementId))&&this.#s?.remove(e.id)}addDeletedAnnotationElement(e){this.#m.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#m.has(e)}removeDeletedAnnotationElement(e){this.#m.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#re(e){const t=this.#i.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#$(e.propertiesToUpdate))}get#ge(){let e=null;for(e of this.#w);return e}updateUI(e){this.#ge===e&&this.#$(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#$(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#w.has(e)){this.#w.delete(e),e.unselect(),this.#O({hasSelectedEditor:this.hasSelection});return}this.#w.add(e),e.select(),this.#$(e.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}setSelected(e){this.updateToolbar({mode:e.mode,editId:e.uid}),this.#h?.commitOrRemove();for(const t of this.#w)t!==e&&t.unselect();this.#w.clear(),this.#w.add(e),e.select(),this.#$(e.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}isSelected(e){return this.#w.has(e)}get firstSelectedEditor(){return this.#w.values().next().value}unselect(e){e.unselect(),this.#w.delete(e),this.#O({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#w.size!==0}get isEnterHandled(){return this.#w.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#O({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#K()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#K()})}addCommands(e){this.#c.add(e),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#K()})}cleanUndoStack(e){this.#c.cleanType(e)}#K(){if(this.#r.size===0)return!0;if(this.#r.size===1)for(const e of this.#r.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#w],a=()=>{this._editorUndoBar?.show(s,t.length===1?t[0].editorType:t.length);for(const i of t)i.remove()},s=()=>{for(const i of t)this.#re(i)};this.addCommands({cmd:a,undo:s,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#ae(e){for(const t of this.#w)t.unselect();this.#w.clear();for(const t of e)t.isEmpty()||(this.#w.add(t),t.select());this.#O({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#w)e.commit();this.#ae(this.#r.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#T!==tt.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const e of this.#w)e.unselect();this.#w.clear(),this.#O({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,a=!1){if(a||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=e,this.#H[1]+=t;const[s,i]=this.#H,o=[...this.#w],c=1e3;this.#I&&clearTimeout(this.#I),this.#I=setTimeout(()=>{this.#I=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const u of o)this.#r.has(u.id)&&(u.translateInPage(s,i),u.translationDone())},undo:()=>{for(const u of o)this.#r.has(u.id)&&(u.translateInPage(-s,-i),u.translationDone())},mustExec:!1})},c);for(const u of o)u.translateInPage(e,t),u.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#g=new Map;for(const e of this.#w)this.#g.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#g)return!1;this.disableUserSelect(!1);const e=this.#g;this.#g=null;let t=!1;for(const[{x:s,y:i,pageIndex:o},c]of e)c.newX=s,c.newY=i,c.newPageIndex=o,t||=s!==c.savedX||i!==c.savedY||o!==c.savedPageIndex;if(!t)return!1;const a=(s,i,o,c)=>{if(this.#r.has(s.id)){const u=this.#i.get(c);u?s._setParentAndPosition(u,i,o):(s.pageIndex=c,s.x=i,s.y=o)}};return this.addCommands({cmd:()=>{for(const[s,{newX:i,newY:o,newPageIndex:c}]of e)a(s,i,o,c)},undo:()=>{for(const[s,{savedX:i,savedY:o,savedPageIndex:c}]of e)a(s,i,o,c)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#g)for(const a of this.#g.keys())a.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#w.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#T}isEditingMode(){return this.#T!==tt.NONE}get imageManager(){return et(this,"imageManager",new Xm)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let d=0,f=t.rangeCount;d<f;d++)if(!e.contains(t.getRangeAt(d).commonAncestorContainer))return null;const{x:a,y:s,width:i,height:o}=e.getBoundingClientRect();let c;switch(e.getAttribute("data-main-rotation")){case"90":c=(d,f,g,v)=>({x:(f-s)/o,y:1-(d+g-a)/i,width:v/o,height:g/i});break;case"180":c=(d,f,g,v)=>({x:1-(d+g-a)/i,y:1-(f+v-s)/o,width:g/i,height:v/o});break;case"270":c=(d,f,g,v)=>({x:1-(f+v-s)/o,y:(d-a)/i,width:v/o,height:g/i});break;default:c=(d,f,g,v)=>({x:(d-a)/i,y:(f-s)/o,width:g/i,height:v/o});break}const u=[];for(let d=0,f=t.rangeCount;d<f;d++){const g=t.getRangeAt(d);if(!g.collapsed)for(const{x:v,y:x,width:y,height:_}of g.getClientRects())y===0||_===0||u.push(c(v,x,y,_))}return u.length===0?null:u}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#o||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#o?.delete(e)}renderAnnotationElement(e){const t=this.#o?.get(e.data.id);if(!t)return;const a=this.#s.getRawValue(t);a&&(this.#T===tt.NONE&&!a.hasBeenModified||a.renderAnnotationElement(e))}setMissingCanvas(e,t,a){const s=this.#L?.get(e);s&&(s.setCanvas(t,a),this.#L.delete(e))}addMissingCanvas(e,t){(this.#L||=new Map).set(e,t)}}class en{#e=null;#t=!1;#a=null;#r=null;#i=null;#n=null;#s=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(e){this.#c=e,this.#h=e._uiManager.useNewAltTextFlow,en.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){en._l10n??=e}async render(){const e=this.#a=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#r=document.createElement("span");e.append(t),this.#h?(e.classList.add("new"),e.setAttribute("data-l10n-id",en.#f.missing),t.setAttribute("data-l10n-id",en.#f["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const a=this.#c._uiManager._signal;e.addEventListener("contextmenu",ys,{signal:a}),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:a});const s=i=>{i.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return e.addEventListener("click",s,{capture:!0,signal:a}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(this.#s=!0,s(i))},{signal:a}),await this.#g(),e}get#m(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#a&&(this.#a.focus({focusVisible:this.#s}),this.#s=!1)}isEmpty(){return this.#h?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#h?this.#e!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(e){this.#e===null&&(this.#l=e,this.#d=await en._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#g())}toggleAltTextBadge(e=!1){if(!this.#h||this.#e){this.#o?.remove(),this.#o=null;return}if(!this.#o){const t=this.#o=document.createElement("div");t.className="noAltTextBadge",this.#c.div.append(t)}this.#o.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#l===t&&(t=this.#d),{altText:t,decorative:this.#t,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:a,textWithDisclaimer:s,cancel:i=!1}){a&&(this.#l=a,this.#d=s),!(this.#e===e&&this.#t===t)&&(i||(this.#e=e,this.#t=t),this.#g())}toggle(e=!1){this.#a&&(!e&&this.#n&&(clearTimeout(this.#n),this.#n=null),this.#a.disabled=!e)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#a?.remove(),this.#a=null,this.#r=null,this.#i=null,this.#o?.remove(),this.#o=null}async#g(){const e=this.#a;if(!e)return;if(this.#h){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",en.#f[this.#m]),this.#r?.setAttribute("data-l10n-id",en.#f[`${this.#m}-label`]),!this.#e){this.#i?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#i?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#i;if(!t){this.#i=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#c.id}`;const s=100,i=this.#c._uiManager._signal;i.addEventListener("abort",()=>{clearTimeout(this.#n),this.#n=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#n=setTimeout(()=>{this.#n=null,this.#i.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},s)},{signal:i}),e.addEventListener("mouseleave",()=>{this.#n&&(clearTimeout(this.#n),this.#n=null),this.#i?.classList.remove("show")},{signal:i})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#c.getElementForAltText()?.setAttribute("aria-describedby",t.id)}}class kd{#e=null;#t=null;#a=!1;#r=null;#i=null;#n=null;#s=null;#o=null;#c=!1;#l=null;constructor(e){this.#r=e}renderForToolbar(){const e=this.#t=document.createElement("button");return e.className="comment",this.#d(e,!1)}renderForStandalone(){const e=this.#e=document.createElement("button");e.className="annotationCommentButton";const t=this.#r.commentButtonPosition;if(t){const{style:a}=e;a.insetInlineEnd=`calc(${100*(this.#r._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,a.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const s=this.#r.commentButtonColor;s&&(a.backgroundColor=s)}return this.#d(e,!0)}focusButton(){setTimeout(()=>{(this.#e??this.#t)?.focus()},0)}onUpdatedColor(){if(!this.#e)return;const e=this.#r.commentButtonColor;e&&(this.#e.style.backgroundColor=e),this.#r._uiManager.updatePopupColor(this.#r)}get commentButtonWidth(){return(this.#e?.getBoundingClientRect().width??0)/this.#r.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#e)return null;const{x:e,y:t,height:a}=this.#e.getBoundingClientRect(),{x:s,y:i,width:o,height:c}=this.#r.parent.boundingClientRect;return[(e-s)/o,(t+a-i)/c]}set commentPopupPositionInLayer(e){this.#l=e}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#e?.remove(),this.#e=null}removeToolbarCommentButton(){this.#t?.remove(),this.#t=null}setCommentButtonStates({selected:e,hasPopup:t}){this.#e&&(this.#e.classList.toggle("selected",e),this.#e.ariaExpanded=t)}#d(e,t){if(!this.#r._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[this.#r._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const a=this.#r._uiManager._signal;if(!(a instanceof AbortSignal)||a.aborted)return e;e.addEventListener("contextmenu",ys,{signal:a}),t&&(e.addEventListener("focusin",i=>{this.#r._focusEventsAllowed=!1,fr(i)},{capture:!0,signal:a}),e.addEventListener("focusout",i=>{this.#r._focusEventsAllowed=!0,fr(i)},{capture:!0,signal:a})),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:a});const s=i=>{i.preventDefault(),e===this.#t?this.edit():this.#r.toggleComment(!0)};return e.addEventListener("click",s,{capture:!0,signal:a}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(this.#a=!0,s(i))},{signal:a}),e.addEventListener("pointerenter",()=>{this.#r.toggleComment(!1,!0)},{signal:a}),e.addEventListener("pointerleave",()=>{this.#r.toggleComment(!1,!1)},{signal:a}),e}edit(e){const t=this.commentPopupPositionInLayer;let a,s;if(t)[a,s]=t;else{[a,s]=this.#r.commentButtonPosition;const{width:f,height:g,x:v,y:x}=this.#r;a=v+a*f,s=x+s*g}const i=this.#r.parent.boundingClientRect,{x:o,y:c,width:u,height:d}=i;this.#r._uiManager.editComment(this.#r,o+a*u,c+s*d,{...e,parentDimensions:i})}finish(){this.#t&&(this.#t.focus({focusVisible:this.#a}),this.#a=!1)}isDeleted(){return this.#c||this.#s===""}isEmpty(){return this.#s===null}hasBeenEdited(){return this.isDeleted()||this.#s!==this.#i}serialize(){return this.data}get data(){return{text:this.#s,richText:this.#n,date:this.#o,deleted:this.isDeleted()}}set data(e){if(e!==this.#s&&(this.#n=null),e===null){this.#s="",this.#c=!0;return}this.#s=e,this.#o=new Date,this.#c=!1}setInitialText(e,t=null){this.#i=e,this.data=e,this.#o=null,this.#n=t}shown(){}destroy(){this.#t?.remove(),this.#t=null,this.#e?.remove(),this.#e=null,this.#s="",this.#n=null,this.#o=null,this.#r=null,this.#a=!1,this.#c=!1}}class Ef{#e;#t=!1;#a=null;#r;#i;#n;#s;#o=null;#c;#l=null;#d;#h=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:a=null,onPinchStart:s=null,onPinching:i=null,onPinchEnd:o=null,signal:c}){this.#e=e,this.#a=a,this.#r=t,this.#i=s,this.#n=i,this.#s=o,this.#d=new AbortController,this.#c=AbortSignal.any([c,this.#d.signal]),e.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/rn.pixelRatio}#f(e){if(this.#r?.())return;if(e.touches.length===1){if(this.#o)return;const s=this.#o=new AbortController,i=AbortSignal.any([this.#c,s.signal]),o=this.#e,c={capture:!0,signal:i,passive:!1},u=d=>{d.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};o.addEventListener("pointerdown",d=>{d.pointerType==="touch"&&(fr(d),u(d))},c),o.addEventListener("pointerup",u,c),o.addEventListener("pointercancel",u,c);return}if(!this.#h){this.#h=new AbortController;const s=AbortSignal.any([this.#c,this.#h.signal]),i=this.#e,o={signal:s,capture:!1,passive:!1};i.addEventListener("touchmove",this.#m.bind(this),o);const c=this.#g.bind(this);i.addEventListener("touchend",c,o),i.addEventListener("touchcancel",c,o),o.capture=!0,i.addEventListener("pointerdown",fr,o),i.addEventListener("pointermove",fr,o),i.addEventListener("pointercancel",fr,o),i.addEventListener("pointerup",fr,o),this.#i?.()}if(fr(e),e.touches.length!==2||this.#a?.()){this.#l=null;return}let[t,a]=e.touches;t.identifier>a.identifier&&([t,a]=[a,t]),this.#l={touch0X:t.screenX,touch0Y:t.screenY,touch1X:a.screenX,touch1Y:a.screenY}}#m(e){if(!this.#l||e.touches.length!==2)return;fr(e);let[t,a]=e.touches;t.identifier>a.identifier&&([t,a]=[a,t]);const{screenX:s,screenY:i}=t,{screenX:o,screenY:c}=a,u=this.#l,{touch0X:d,touch0Y:f,touch1X:g,touch1Y:v}=u,x=g-d,y=v-f,_=o-s,w=c-i,A=Math.hypot(_,w)||1,T=Math.hypot(x,y)||1;if(!this.#t&&Math.abs(T-A)<=Ef.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(u.touch0X=s,u.touch0Y=i,u.touch1X=o,u.touch1Y=c,!this.#t){this.#t=!0;return}const S=[(s+o)/2,(i+c)/2];this.#n?.(S,T,A)}#g(e){e.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#s?.()),this.#l&&(fr(e),this.#l=null,this.#t=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class Ve{#e=null;#t=null;#a=null;#r=null;#i=null;#n=!1;#s=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#m="";#g=!1;#u=null;#p=!1;#v=!1;#_=!1;#x=null;#S=0;#E=0;#b=null;#C=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#y=!1;#A=Ve._zIndex++;static _borderLineWidth=-1;static _colorManager=new Ym;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=Ve.prototype._resizeWithKeyboard,t=bi.TRANSLATE_SMALL,a=bi.TRANSLATE_BIG;return et(this,"_resizerKeyboardManager",new Yu([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-a,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[a,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-a]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,a]}],[["Escape","mac+Escape"],Ve.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:a,pageHeight:s,pageX:i,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[a,s],this.pageTranslation=[i,o];const[c,u]=this.parentDimensions;this.x=e.x/c,this.y=e.y/u,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return et(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new AB({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Ve._l10n??=e,Ve._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Ve._borderLineWidth!==-1)return;const a=getComputedStyle(document.documentElement);Ve._borderLineWidth=parseFloat(a.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Pt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#y}set _isDraggable(e){this.#y=e,this.div?.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#A}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(this.#I(),this.#h?.remove(),this.#h=null),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,a,s){const[i,o]=this.parentDimensions;[a,s]=this.screenToPageTranslation(a,s),this.x=(e+a)/i,this.y=(t+s)/o,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[a,s]=this.parentDimensions;this.setAt(e*a,t*s,this.width*a,this.height*s),this._onTranslated()}#R([e,t],a,s){[a,s]=this.screenToPageTranslation(a,s),this.x+=a/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#R(this.parentDimensions,e,t)}translateInPage(e,t){this.#u||=[this.x,this.y,this.width,this.height],this.#R(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){this.#u||=[this.x,this.y,this.width,this.height];const{div:a,parentDimensions:[s,i]}=this;if(this.x+=e/s,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:g,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,g,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:c}=this;const[u,d]=this.getBaseTranslation();o+=u,c+=d;const{style:f}=a;f.left=`${(100*o).toFixed(2)}%`,f.top=`${(100*c).toFixed(2)}%`,this._onTranslating(o,c),a.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:a}=Ve,s=a/e,i=a/t;switch(this.rotation){case 90:return[-s,i];case 180:return[s,i];case 270:return[s,-i];default:return[-s,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[a,s]}=this;let{x:i,y:o,width:c,height:u}=this;if(c*=a,u*=s,i*=a,o*=s,this._mustFixPosition)switch(e){case 0:i=da(i,0,a-c),o=da(o,0,s-u);break;case 90:i=da(i,0,a-u),o=da(o,c,s);break;case 180:i=da(i,c,a),o=da(o,u,s);break;case 270:i=da(i,u,a),o=da(o,0,s-c);break}this.x=i/=a,this.y=o/=s;const[d,f]=this.getBaseTranslation();i+=d,o+=f,t.left=`${(100*i).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}static#k(e,t,a){switch(a){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return Ve.#k(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return Ve.#k(e,t,360-this.parentRotation)}#N(e){switch(e){case 90:{const[t,a]=this.pageDimensions;return[0,-t/a,a/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,a]=this.pageDimensions;return[0,t/a,-a/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,a]}=this;return[t*e,a*e]}setDims(){const{div:{style:e},width:t,height:a}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*a).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#j(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const a of e){const s=document.createElement("div");this.#c.append(s),s.classList.add("resizer",a),s.setAttribute("data-resizer-name",a),s.addEventListener("pointerdown",this.#D.bind(this,a),{signal:t}),s.addEventListener("contextmenu",ys,{signal:t}),s.tabIndex=-1}this.div.prepend(this.#c)}#D(e,t){t.preventDefault();const{isMac:a}=jr.platform;if(t.button!==0||t.ctrlKey&&a)return;this.#a?.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,this.#l=[t.screenX,t.screenY];const i=new AbortController,o=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#L.bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",fr,{passive:!1,signal:o}),window.addEventListener("contextmenu",ys,{signal:o}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const c=this.parent.div.style.cursor,u=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const d=()=>{i.abort(),this.parent.togglePointerEvents(!0),this.#a?.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=c,this.div.style.cursor=u,this.#P()};window.addEventListener("pointerup",d,{signal:o}),window.addEventListener("blur",d,{signal:o})}#M(e,t,a,s){this.width=a,this.height=s,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#P(){if(!this.#d)return;const{savedX:e,savedY:t,savedWidth:a,savedHeight:s}=this.#d;this.#d=null;const i=this.x,o=this.y,c=this.width,u=this.height;i===e&&o===t&&c===a&&u===s||this.addCommands({cmd:this.#M.bind(this,i,o,c,u),undo:this.#M.bind(this,e,t,a,s),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#L(e,t){const[a,s]=this.parentDimensions,i=this.x,o=this.y,c=this.width,u=this.height,d=Ve.MIN_SIZE/a,f=Ve.MIN_SIZE/s,g=this.#N(this.rotation),v=(U,te)=>[g[0]*U+g[2]*te,g[1]*U+g[3]*te],x=this.#N(360-this.rotation),y=(U,te)=>[x[0]*U+x[2]*te,x[1]*U+x[3]*te];let _,w,A=!1,T=!1;switch(e){case"topLeft":A=!0,_=(U,te)=>[0,0],w=(U,te)=>[U,te];break;case"topMiddle":_=(U,te)=>[U/2,0],w=(U,te)=>[U/2,te];break;case"topRight":A=!0,_=(U,te)=>[U,0],w=(U,te)=>[0,te];break;case"middleRight":T=!0,_=(U,te)=>[U,te/2],w=(U,te)=>[0,te/2];break;case"bottomRight":A=!0,_=(U,te)=>[U,te],w=(U,te)=>[0,0];break;case"bottomMiddle":_=(U,te)=>[U/2,te],w=(U,te)=>[U/2,0];break;case"bottomLeft":A=!0,_=(U,te)=>[0,te],w=(U,te)=>[U,0];break;case"middleLeft":T=!0,_=(U,te)=>[0,te/2],w=(U,te)=>[U,te/2];break}const S=_(c,u),N=w(c,u);let R=v(...N);const O=Ve._round(i+R[0]),C=Ve._round(o+R[1]);let j=1,I=1,W,H;if(t.fromKeyboard)({deltaX:W,deltaY:H}=t);else{const{screenX:U,screenY:te}=t,[be,se]=this.#l;[W,H]=this.screenToPageTranslation(U-be,te-se),this.#l[0]=U,this.#l[1]=te}if([W,H]=y(W/a,H/s),A){const U=Math.hypot(c,u);j=I=Math.max(Math.min(Math.hypot(N[0]-S[0]-W,N[1]-S[1]-H)/U,1/c,1/u),d/c,f/u)}else T?j=da(Math.abs(N[0]-S[0]-W),d,1)/c:I=da(Math.abs(N[1]-S[1]-H),f,1)/u;const D=Ve._round(c*j),z=Ve._round(u*I);R=v(...w(D,z));const ne=O-R[0],re=C-R[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=D,this.height=z,this.x=ne,this.y=re,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#a?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#v)return this._editToolbar;this._editToolbar=new hu(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,a]of e)await this._editToolbar.addButton(t,a);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#a?.destroy()}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#a||(en.initialize(Ve._l10n),this.#a=new en(this),this.#e&&(this.#a.data=this.#e,this.#e=null)),this.#a}get altTextData(){return this.#a?.data}set altTextData(e){this.#a&&(this.#a.data=e)}get guessedAltText(){return this.#a?.guessedText}async setGuessedAltText(e){await this.#a?.setGuessedText(e)}serializeAltText(e){return this.#a?.serialize(e)}hasAltText(){return!!this.#a&&!this.#a.isEmpty()}hasAltTextData(){return this.#a?.hasData()??!1}focusCommentButton(){this.#r?.focusButton()}addCommentButton(){return this.canAddComment?this.#r||=new kd(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#i){this._uiManager.isEditingMode()&&this.#i.classList.remove("hidden");return}this.hasComment&&(this.#i=this.#r.renderForStandalone(),this.div.append(this.#i))}}removeStandaloneCommentButton(){this.#r.removeStandaloneCommentButton(),this.#i=null}hideStandaloneCommentButton(){this.#i?.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:a,deleted:s}}=this.#r;return{text:t,richText:e,date:a,deleted:s,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){this.#r||=new kd(this),this.#r.data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:a}){if(!t||(this.#r||=new kd(this),this.#r.setInitialText(e,a),!this.annotationElementId))return;const s=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);s&&this.updateFromAnnotationLayer(s)}get hasEditedComment(){return this.#r?.hasBeenEdited()}get hasDeletedComment(){return this.#r?.isDeleted()}get hasComment(){return!!this.#r&&!this.#r.isEmpty()&&!this.#r.isDeleted()}async editComment(e){this.#r||=new kd(this),this.#r.edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){this.#r.setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,s]=e.rect,[i]=this.pageDimensions,[o]=this.pageTranslation,c=o+i+1,u=s-100,d=c+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[c,u,d,s]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){this.#r.data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=this.#n?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),this.#z();const[t,a]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*a/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/a).toFixed(2)}%`);const[s,i]=this.getInitialTranslation();return this.translate(s,i),UA(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#C||=new Ef({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#G.bind(this),onPinching:this.#T.bind(this),onPinchEnd:this.#w.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),e}#G(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#a?.toggle(!1),this.parent.togglePointerEvents(!1)}#T(e,t,a){let i=.7*(a/t)+1-.7;if(i===1)return;const o=this.#N(this.rotation),c=(O,C)=>[o[0]*O+o[2]*C,o[1]*O+o[3]*C],[u,d]=this.parentDimensions,f=this.x,g=this.y,v=this.width,x=this.height,y=Ve.MIN_SIZE/u,_=Ve.MIN_SIZE/d;i=Math.max(Math.min(i,1/v,1/x),y/v,_/x);const w=Ve._round(v*i),A=Ve._round(x*i);if(w===v&&A===x)return;this.#u||=[f,g,v,x];const T=c(v/2,x/2),S=Ve._round(f+T[0]),N=Ve._round(g+T[1]),R=c(w/2,A/2);this.x=S-R[0],this.y=N-R[1],this.width=w,this.height=A,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#w(){this.#a?.toggle(!0),this.parent.togglePointerEvents(!0),this.#P()}pointerdown(e){const{isMac:t}=jr.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#B(e);return}this.#F(e)}#F(e){const{isMac:t}=jr.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#B(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let a=!1;const s=new AbortController,i=this._uiManager.combinedSignal(s),o={capture:!0,passive:!1,signal:i},c=d=>{s.abort(),this.#s=null,this.#g=!1,this._uiManager.endDragSession()||this.#F(d),a&&this._onStopDragging()};t&&(this.#S=e.clientX,this.#E=e.clientY,this.#s=e.pointerId,this.#o=e.pointerType,window.addEventListener("pointermove",d=>{a||(a=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:f,clientY:g,pointerId:v}=d;if(v!==this.#s){fr(d);return}const[x,y]=this.screenToPageTranslation(f-this.#S,g-this.#E);this.#S=f,this.#E=g,this._uiManager.dragSelectedEditors(x,y)},o),window.addEventListener("touchmove",fr,o),window.addEventListener("pointerdown",d=>{d.pointerType===this.#o&&(this.#C||d.isPrimary)&&c(d),fr(d)},o));const u=d=>{if(!this.#s||this.#s===d.pointerId){c(d);return}fr(d)};window.addEventListener("pointerup",u,{signal:i}),window.addEventListener("blur",u,{signal:i})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.#x=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,a){e.changeParent(this),this.x=t,this.y=a,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,a=this.rotation){const s=this.parentScale,[i,o]=this.pageDimensions,[c,u]=this.pageTranslation,d=e/s,f=t/s,g=this.x*i,v=this.y*o,x=this.width*i,y=this.height*o;switch(a){case 0:return[g+d+c,o-v-f-y+u,g+d+x+c,o-v-f+u];case 90:return[g+f+c,o-v+d+u,g+f+y+c,o-v+d+x+u];case 180:return[g-d-x+c,o-v+f+u,g-d+c,o-v+f+y+u];case 270:return[g-f-y+c,o-v-d-x+u,g-f+c,o-v-d+u];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[a,s,i,o]=e,c=i-a,u=o-s;switch(this.rotation){case 0:return[a,t-o,c,u];case 90:return[a,t-s,u,c];case 180:return[i,t-s,c,u];case 270:return[i,t-o,u,c];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Ve._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#r?.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:a,opacity:s,deleted:i,richText:o},uid:c,pageIndex:u,creationDate:d,modificationDate:f}=this;return{id:c,pageIndex:u,rect:this.getPDFRect(),richText:o,contentsObj:{str:e},creationDate:d,modificationDate:a||f,popupRef:!i,color:t,opacity:s}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#v=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#v=!1,!0):!1}isInEditMode(){return this.#v}shouldGetKeyboardEvents(){return this.#_}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:a,right:s}=this.getClientDimensions(),{innerHeight:i,innerWidth:o}=window;return t<o&&s>0&&e<i&&a>0}#z(){if(this.#f||!this.div)return;this.#f=new AbortController;const e=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#z()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(e,t,a){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:a,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});s.rotation=e.rotation,s.#e=e.accessibilityData,s._isCopy=e.isCopy||!1;const[i,o]=s.pageDimensions,[c,u,d,f]=s.getRectInCurrentCoords(e.rect,o);return s.x=c/i,s.y=u/o,s.width=d/i,s.height=f/o,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#x&&(clearTimeout(this.#x),this.#x=null),this.#I(),this.removeEditToolbar(),this.#b){for(const e of this.#b.values())clearTimeout(e);this.#b=null}this.parent=null,this.#C?.destroy(),this.#C=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#j(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[a,s,i,o]=this.getPDFRect();return[Ve._round(a+(i-a)*e),Ve._round(s+(o-s)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#r.commentPopupPositionInLayer}set commentPopupPosition(e){this.#r.commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return this.#r.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#r.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){this.#r?.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#c.children;if(!this.#t){this.#t=Array.from(t);const o=this.#W.bind(this),c=this.#q.bind(this),u=this._uiManager._signal;for(const d of this.#t){const f=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",o,{signal:u}),d.addEventListener("blur",c,{signal:u}),d.addEventListener("focus",this.#X.bind(this,f),{signal:u}),d.setAttribute("data-l10n-id",Ve._l10nResizer[f])}}const a=this.#t[0];let s=0;for(const o of t){if(o===a)break;s++}const i=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(i!==s){if(i<s)for(let c=0;c<s-i;c++)this.#c.append(this.#c.firstElementChild);else if(i>s)for(let c=0;c<i-s;c++)this.#c.firstElementChild.before(this.#c.lastElementChild);let o=0;for(const c of t){const d=this.#t[o++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",Ve._l10nResizer[d])}}this.#H(0),this.#_=!0,this.#c.firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#W(e){Ve._resizerKeyboardManager.exec(this,e)}#q(e){this.#_&&e.relatedTarget?.parentNode!==this.#c&&this.#I()}#X(e){this.#m=this.#_?e:""}#H(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#_&&this.#L(this.#m,{deltaX:e,deltaY:t,fromKeyboard:!0})}#I(){this.#_=!1,this.#H(-1),this.#P()}_stopResizingWithKeyboard(){this.#I(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#a?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#a?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(e){this.#p=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#b||=new Map;const{action:a}=e;let s=this.#b.get(a);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),this.#b.delete(a),this.#b.size===0&&(this.#b=null)},Ve._telemetryTimeout),this.#b.set(a,s);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#n=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#n=!0}updateFakeAnnotationElement(e){if(!this.#h&&!this.deleted){this.#h=e.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const a=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),a.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class AB extends Ve{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Vb=3285377520,ds=4294901760,Js=65535;class zA{constructor(e){this.h1=e?e&4294967295:Vb,this.h2=e?e&4294967295:Vb}update(e){let t,a;if(typeof e=="string"){t=new Uint8Array(e.length*2),a=0;for(let _=0,w=e.length;_<w;_++){const A=e.charCodeAt(_);A<=255?t[a++]=A:(t[a++]=A>>>8,t[a++]=A&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),a=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=a>>2,i=a-s*4,o=new Uint32Array(t.buffer,0,s);let c=0,u=0,d=this.h1,f=this.h2;const g=3432918353,v=461845907,x=g&Js,y=v&Js;for(let _=0;_<s;_++)_&1?(c=o[_],c=c*g&ds|c*x&Js,c=c<<15|c>>>17,c=c*v&ds|c*y&Js,d^=c,d=d<<13|d>>>19,d=d*5+3864292196):(u=o[_],u=u*g&ds|u*x&Js,u=u<<15|u>>>17,u=u*v&ds|u*y&Js,f^=u,f=f<<13|f>>>19,f=f*5+3864292196);switch(c=0,i){case 3:c^=t[s*4+2]<<16;case 2:c^=t[s*4+1]<<8;case 1:c^=t[s*4],c=c*g&ds|c*x&Js,c=c<<15|c>>>17,c=c*v&ds|c*y&Js,s&1?d^=c:f^=c}this.h1=d,this.h2=f}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&ds|e*36045&Js,t=t*4283543511&ds|((t<<16|e>>>16)*2950163797&ds)>>>16,e^=t>>>1,e=e*444984403&ds|e*60499&Js,t=t*3301882366&ds|((t<<16|e>>>16)*3120437893&ds)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Kg=Object.freeze({map:null,hash:"",transfer:void 0});class Km{#e=!1;#t=null;#a=null;#r=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const a=this.#r.get(e);return a===void 0?t:Object.assign(t,a)}getRawValue(e){return this.#r.get(e)}remove(e){const t=this.#r.get(e);if(t!==void 0&&(t instanceof Ve&&this.#a.delete(t.annotationElementId),this.#r.delete(e),this.#r.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const a of this.#r.values())if(a instanceof Ve)return;this.onAnnotationEditor(null)}}setValue(e,t){const a=this.#r.get(e);let s=!1;if(a!==void 0)for(const[i,o]of Object.entries(t))a[i]!==o&&(s=!0,a[i]=o);else s=!0,this.#r.set(e,t);s&&this.#i(),t instanceof Ve&&((this.#a||=new Map).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return this.#r.has(e)}get size(){return this.#r.size}#i(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new HA(this)}get serializable(){if(this.#r.size===0)return Kg;const e=new Map,t=new zA,a=[],s=Object.create(null);let i=!1;for(const[o,c]of this.#r){const u=c instanceof Ve?c.serialize(!1,s):c;u&&(e.set(o,u),t.update(`${o}:${JSON.stringify(u)}`),i||=!!u.bitmap)}if(i)for(const o of e.values())o.bitmap&&a.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:a}:Kg}get editorStats(){let e=null;const t=new Map;let a=0,s=0;for(const i of this.#r.values()){if(!(i instanceof Ve)){i.popup&&(i.popup.deleted?s+=1:a+=1);continue}i.isCommentDeleted?s+=1:i.hasEditedComment&&(a+=1);const o=i.telemetryFinalData;if(!o)continue;const{type:c}=o;t.has(c)||t.set(c,Object.getPrototypeOf(i).constructor),e||=Object.create(null);const u=e[c]||=new Map;for(const[d,f]of Object.entries(o)){if(d==="type")continue;let g=u.get(d);g||(g=new Map,u.set(d,g));const v=g.get(f)??0;g.set(f,v+1)}}if((s>0||a>0)&&(e||=Object.create(null),e.comments={deleted:s,edited:a}),!e)return null;for(const[i,o]of t)e[i]=o.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){this.#t=null}updateEditor(e,t){const a=this.#a?.get(e);return a?(a.updateFromAnnotationLayer(t),!0):!1}getEditor(e){return this.#a?.get(e)||null}get modifiedIds(){if(this.#t)return this.#t;const e=[];if(this.#a)for(const t of this.#a.values())t.serialize()&&e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}[Symbol.iterator](){return this.#r.entries()}}class HA extends Km{#e;constructor(e){super();const{map:t,hash:a,transfer:s}=e.serializable,i=structuredClone(t,s?{transfer:s}:null);this.#e={map:i,hash:a,transfer:s}}get print(){Pt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return et(this,"modifiedIds",{ids:new Set,hash:""})}}class SB{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:a}){if(!(!e||this.#e.has(e.loadedName))){if(mt(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:i,style:o}=e,c=new FontFace(s,i,o);this.addNativeFontFace(c);try{await c.load(),this.#e.add(s),a?.(e)}catch{Ze(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}Pt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const a=e.createNativeFontFace();if(a){this.addNativeFontFace(a);try{await a.loaded}catch(s){throw Ze(`Failed to load font '${a.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(a=>{const s=this._queueLoadingCallback(a);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return et(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return et(this,"isSyncFontLoadingSupported",ha||jr.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(mt(!s.done,"completeRequest() cannot be called twice."),s.done=!0;a.length>0&&a[0].done;){const i=a.shift();setTimeout(i.callback,0)}}const{loadingRequests:a}=this,s={done:!1,complete:t,callback:e};return a.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return et(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function a(N,R){return N.charCodeAt(R)<<24|N.charCodeAt(R+1)<<16|N.charCodeAt(R+2)<<8|N.charCodeAt(R+3)&255}function s(N,R,O,C){const j=N.substring(0,R),I=N.substring(R+O);return j+C+I}let i,o;const c=this._document.createElement("canvas");c.width=1,c.height=1;const u=c.getContext("2d");let d=0;function f(N,R){if(++d>30){Ze("Load test font never loaded."),R();return}if(u.font="30px "+N,u.fillText(".",0,20),u.getImageData(0,0,1,1).data[3]>0){R();return}setTimeout(f.bind(null,N,R))}const g=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=s(v,976,g.length,g);const y=16,_=1482184792;let w=a(v,y);for(i=0,o=g.length-3;i<o;i+=4)w=w-_+a(g,i)|0;i<g.length&&(w=w-_+a(g+"XXX",i)|0),v=s(v,y,4,nB(w));const A=`url(data:font/opentype;base64,${btoa(v)});`,T=`@font-face {font-family:"${g}";src:${A}}`;this.insertRule(T);const S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(const N of[e.loadedName,g]){const R=this._document.createElement("span");R.textContent="Hi",R.style.fontFamily=N,S.append(R)}this._document.body.append(S),f(g,()=>{S.remove(),t.complete()})}}class TB{#e;constructor(e,t=null,a,s){this.compiledGlyphs=Object.create(null),this.#e=e,this._inspectFont=t,a&&Object.assign(this,a),s&&(this.charProcOperatorList=s)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${IA(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let a=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(a+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${a}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const a=this.loadedName+"_path_"+t;let s;try{s=e.get(a)}catch(o){Ze(`getPathGenerator - ignoring character: "${o}".`)}const i=BA(s?.path);return this.fontExtraProperties||e.delete(a),this.compiledGlyphs[t]=i}get black(){return this.#e.black}get bold(){return this.#e.bold}get disableFontFace(){return this.#e.disableFontFace??!1}set disableFontFace(e){et(this,"disableFontFace",!!e)}get fontExtraProperties(){return this.#e.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#e.isInvalidPDFjsFont}get isType3Font(){return this.#e.isType3Font}get italic(){return this.#e.italic}get missingFile(){return this.#e.missingFile}get remeasure(){return this.#e.remeasure}get vertical(){return this.#e.vertical}get ascent(){return this.#e.ascent}get defaultWidth(){return this.#e.defaultWidth}get descent(){return this.#e.descent}get bbox(){return this.#e.bbox}set bbox(e){et(this,"bbox",e)}get fontMatrix(){return this.#e.fontMatrix}get fallbackName(){return this.#e.fallbackName}get loadedName(){return this.#e.loadedName}get mimetype(){return this.#e.mimetype}get name(){return this.#e.name}get data(){return this.#e.data}clearData(){this.#e.clearData()}get cssFontInfo(){return this.#e.cssFontInfo}get systemFontInfo(){return this.#e.systemFontInfo}get defaultVMetrics(){return this.#e.defaultVMetrics}}class Dl{#e;#t;#a;static strings=["fontFamily","fontWeight","italicAngle"];static write(e){const t=new TextEncoder,a={};let s=0;for(const d of Dl.strings){const f=t.encode(e[d]);a[d]=f,s+=4+f.length}const i=new ArrayBuffer(s),o=new Uint8Array(i),c=new DataView(i);let u=0;for(const d of Dl.strings){const f=a[d],g=f.length;c.setUint32(u,g),o.set(f,u+4),u+=4+g}return mt(u===i.byteLength,"CssFontInfo.write: Buffer overflow"),i}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#a=new TextDecoder}#r(e){mt(e<Dl.strings.length,"Invalid string index");let t=0;for(let s=0;s<e;s++)t+=this.#t.getUint32(t)+4;const a=this.#t.getUint32(t);return this.#a.decode(new Uint8Array(this.#e,t+4,a))}get fontFamily(){return this.#r(0)}get fontWeight(){return this.#r(1)}get italicAngle(){return this.#r(2)}}class Fl{#e;#t;#a;static strings=["css","loadedName","baseFontName","src"];static write(e){const t=new TextEncoder,a={};let s=0;for(const v of Fl.strings){const x=t.encode(e[v]);a[v]=x,s+=4+x.length}s+=4;let i,o,c=1+s;e.style&&(i=t.encode(e.style.style),o=t.encode(e.style.weight),c+=4+i.length+4+o.length);const u=new ArrayBuffer(c),d=new Uint8Array(u),f=new DataView(u);let g=0;f.setUint8(g++,e.guessFallback?1:0),f.setUint32(g,0),g+=4,s=0;for(const v of Fl.strings){const x=a[v],y=x.length;s+=4+y,f.setUint32(g,y),d.set(x,g+4),g+=4+y}return f.setUint32(g-s-4,s),e.style&&(f.setUint32(g,i.length),d.set(i,g+4),g+=4+i.length,f.setUint32(g,o.length),d.set(o,g+4),g+=4+o.length),mt(g<=u.byteLength,"SubstitionInfo.write: Buffer overflow"),u.transferToFixedLength(g)}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#a=new TextDecoder}get guessFallback(){return this.#t.getUint8(0)!==0}#r(e){mt(e<Fl.strings.length,"Invalid string index");let t=5;for(let s=0;s<e;s++)t+=this.#t.getUint32(t)+4;const a=this.#t.getUint32(t);return this.#a.decode(new Uint8Array(this.#e,t+4,a))}get css(){return this.#r(0)}get loadedName(){return this.#r(1)}get baseFontName(){return this.#r(2)}get src(){return this.#r(3)}get style(){let e=1;e+=4+this.#t.getUint32(e);const t=this.#t.getUint32(e),a=this.#a.decode(new Uint8Array(this.#e,e+4,t));e+=4+t;const s=this.#t.getUint32(e),i=this.#a.decode(new Uint8Array(this.#e,e+4,s));return{style:a,weight:i}}}class Ft{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#e=Math.ceil(this.bools.length*2/8);static#t=this.#e+this.numbers.length*8;static#a=this.#t+1+8;static#r=this.#a+1+48;static#i=this.#r+1+6;#n;#s;#o;constructor({data:e,extra:t}){this.#n=e,this.#s=new TextDecoder,this.#o=new DataView(this.#n),t&&Object.assign(this,t)}#c(e){mt(e<Ft.bools.length,"Invalid boolean index");const t=Math.floor(e/4),a=e*2%8,s=this.#o.getUint8(t)>>a&3;return s===0?void 0:s===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(e){return mt(e<Ft.numbers.length,"Invalid number index"),this.#o.getFloat64(Ft.#e+e*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let e=Ft.#t;if(this.#o.getUint8(e)===0)return;e+=1;const a=[];for(let s=0;s<4;s++)a.push(this.#o.getInt16(e,!0)),e+=2;return a}get fontMatrix(){let e=Ft.#a;if(this.#o.getUint8(e)===0)return;e+=1;const a=[];for(let s=0;s<6;s++)a.push(this.#o.getFloat64(e,!0)),e+=8;return a}get defaultVMetrics(){let e=Ft.#r;if(this.#o.getUint8(e)===0)return;e+=1;const a=[];for(let s=0;s<3;s++)a.push(this.#o.getInt16(e,!0)),e+=2;return a}#d(e){mt(e<Ft.strings.length,"Invalid string index");let t=Ft.#i+4;for(let i=0;i<e;i++)t+=this.#o.getUint32(t)+4;const a=this.#o.getUint32(t),s=new Uint8Array(a);return s.set(new Uint8Array(this.#n,t+4,a)),this.#s.decode(s)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let e=Ft.#i;const t=this.#o.getUint32(e);e+=4+t;const a=this.#o.getUint32(e);e+=4+a;const s=this.#o.getUint32(e);e+=4+s;const i=this.#o.getUint32(e);if(i!==0)return new Uint8Array(this.#n,e+4,i)}clearData(){let e=Ft.#i;const t=this.#o.getUint32(e);e+=4+t;const a=this.#o.getUint32(e);e+=4+a;const s=this.#o.getUint32(e);e+=4+s;const i=this.#o.getUint32(e);new Uint8Array(this.#n,e+4,i).fill(0),this.#o.setUint32(e,0)}get cssFontInfo(){let e=Ft.#i;const t=this.#o.getUint32(e);e+=4+t;const a=this.#o.getUint32(e);e+=4+a;const s=this.#o.getUint32(e);if(s===0)return null;const i=new Uint8Array(s);return i.set(new Uint8Array(this.#n,e+4,s)),new Dl(i.buffer)}get systemFontInfo(){let e=Ft.#i;const t=this.#o.getUint32(e);e+=4+t;const a=this.#o.getUint32(e);if(a===0)return null;const s=new Uint8Array(a);return s.set(new Uint8Array(this.#n,e+4,a)),new Fl(s.buffer)}static write(e){const t=e.systemFontInfo?Fl.write(e.systemFontInfo):null,a=e.cssFontInfo?Dl.write(e.cssFontInfo):null,s=new TextEncoder,i={};let o=0;for(const _ of Ft.strings)i[_]=s.encode(e[_]),o+=4+i[_].length;const c=Ft.#i+4+o+4+(t?t.byteLength:0)+4+(a?a.byteLength:0)+4+(e.data?e.data.length:0),u=new ArrayBuffer(c),d=new Uint8Array(u),f=new DataView(u);let g=0;const v=Ft.bools.length;let x=0,y=0;for(let _=0;_<v;_++){const w=e[Ft.bools[_]];x|=(w===void 0?0:w?2:1)<<y,y+=2,(y===8||_===v-1)&&(f.setUint8(g++,x),x=0,y=0)}mt(g===Ft.#e,"FontInfo.write: Boolean properties offset mismatch");for(const _ of Ft.numbers)f.setFloat64(g,e[_]),g+=8;if(mt(g===Ft.#t,"FontInfo.write: Number properties offset mismatch"),e.bbox){f.setUint8(g++,4);for(const _ of e.bbox)f.setInt16(g,_,!0),g+=2}else f.setUint8(g++,0),g+=8;if(mt(g===Ft.#a,"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){f.setUint8(g++,6);for(const _ of e.fontMatrix)f.setFloat64(g,_,!0),g+=8}else f.setUint8(g++,0),g+=48;if(mt(g===Ft.#r,"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){f.setUint8(g++,1);for(const _ of e.defaultVMetrics)f.setInt16(g,_,!0),g+=2}else f.setUint8(g++,0),g+=6;mt(g===Ft.#i,"FontInfo.write: DefaultVMetrics properties offset mismatch"),f.setUint32(Ft.#i,0),g+=4;for(const _ of Ft.strings){const w=i[_],A=w.length;f.setUint32(g,A),d.set(w,g+4),g+=4+A}if(f.setUint32(Ft.#i,g-Ft.#i-4),!t)f.setUint32(g,0),g+=4;else{const _=t.byteLength;f.setUint32(g,_),mt(g+4+_<=u.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),d.set(new Uint8Array(t),g+4),g+=4+_}if(!a)f.setUint32(g,0),g+=4;else{const _=a.byteLength;f.setUint32(g,_),mt(g+4+_<=u.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),d.set(new Uint8Array(a),g+4),g+=4+_}return e.data===void 0?(f.setUint32(g,0),g+=4):(f.setUint32(g,e.data.length),d.set(e.data,g+4),g+=4+e.data.length),mt(g<=u.byteLength,"FontInfo.write: Buffer overflow"),u.transferToFixedLength(g)}}class Br{static#e=0;static#t=1;static#a=2;static#r=3;static#i=4;static#n=8;static#s=12;static#o=16;constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,a=null,s=[],i=[],o=[],c=[],u=null,d=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,a=e[2],o=e[3],t===1?s.push(...e[4],...e[5]):s.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,u=e[1],s=e[2],i=e[3],c=e[4]||[],a=e[6],d=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const f=Math.floor(s.length/2),g=Math.floor(i.length/3),v=o.length,x=c.length;let y=0;for(const R of c)y+=1,y=Math.ceil(y/4)*4,y+=4+R.coords.length*4,y+=4+R.colors.length*4,R.verticesPerRow!==void 0&&(y+=4);const _=20+f*8+g*3+v*8+(a?16:0)+(d?3:0)+y,w=new ArrayBuffer(_),A=new DataView(w),T=new Uint8Array(w);A.setUint8(Br.#e,t),A.setUint8(Br.#t,a?1:0),A.setUint8(Br.#a,d?1:0),A.setUint8(Br.#r,u),A.setUint32(Br.#i,f,!0),A.setUint32(Br.#n,g,!0),A.setUint32(Br.#s,v,!0),A.setUint32(Br.#o,x,!0);let S=20;new Float32Array(w,S,f*2).set(s),S+=f*8,T.set(i,S),S+=g*3;for(const[R,O]of o)A.setFloat32(S,R,!0),S+=4,A.setUint32(S,parseInt(O.slice(1),16),!0),S+=4;if(a)for(const R of a)A.setFloat32(S,R,!0),S+=4;d&&(T.set(d,S),S+=3);for(let R=0;R<c.length;R++){const O=c[R];A.setUint8(S,O.type),S+=1,S=Math.ceil(S/4)*4,A.setUint32(S,O.coords.length,!0),S+=4,new Int32Array(w,S,O.coords.length).set(O.coords),S+=O.coords.length*4,A.setUint32(S,O.colors.length,!0),S+=4,new Int32Array(w,S,O.colors.length).set(O.colors),S+=O.colors.length*4,O.verticesPerRow!==void 0&&(A.setUint32(S,O.verticesPerRow,!0),S+=4)}return w}getIR(){const e=this.view,t=this.data[Br.#e],a=!!this.data[Br.#t],s=!!this.data[Br.#a],i=e.getUint32(Br.#i,!0),o=e.getUint32(Br.#n,!0),c=e.getUint32(Br.#s,!0),u=e.getUint32(Br.#o,!0);let d=20;const f=new Float32Array(this.buffer,d,i*2);d+=i*8;const g=new Uint8Array(this.buffer,d,o*3);d+=o*3;const v=[];for(let w=0;w<c;++w){const A=e.getFloat32(d,!0);d+=4;const T=e.getUint32(d,!0);d+=4,v.push([A,`#${T.toString(16).padStart(6,"0")}`])}let x=null;if(a){x=[];for(let w=0;w<4;++w)x.push(e.getFloat32(d,!0)),d+=4}let y=null;s&&(y=new Uint8Array(this.buffer,d,3),d+=3);const _=[];for(let w=0;w<u;++w){const A=e.getUint8(d);d+=1,d=Math.ceil(d/4)*4;const T=e.getUint32(d,!0);d+=4;const S=new Int32Array(this.buffer,d,T);d+=T*4;const N=e.getUint32(d,!0);d+=4;const R=new Int32Array(this.buffer,d,N);d+=N*4;const O={type:A,coords:S,colors:R};A===Vg.LATTICE&&(O.verticesPerRow=e.getUint32(d,!0),d+=4),_.push(O)}if(t===1)return["RadialAxial","axial",x,v,Array.from(f.slice(0,2)),Array.from(f.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",x,v,[f[0],f[1]],[f[3],f[4]],f[2],f[5]];if(t===3){const w=this.data[Br.#r];let A=null;if(f.length>0){let T=f[0],S=f[0],N=f[1],R=f[1];for(let O=0;O<f.length;O+=2){const C=f[O],j=f[O+1];T=T>C?C:T,N=N>j?j:N,S=S<C?C:S,R=R<j?j:R}A=[T,N,S,R]}return["Mesh",w,f,g,_,A,x,y]}throw new Error(`Unsupported pattern kind: ${t}`)}}class CB{static write(e){let t,a;return jr.isFloat16ArraySupported?(a=new ArrayBuffer(e.length*2),t=new Float16Array(a)):(a=new ArrayBuffer(e.length*4),t=new Float32Array(a)),t.set(e),a}#e;constructor(e){this.#e=e}get path(){return jr.isFloat16ArraySupported?new Float16Array(this.#e):new Float32Array(this.#e)}}function kB(r){if(r instanceof URL)return r.href;if(typeof r=="string"){if(ha)return r;const e=URL.parse(r,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function NB(r){if(ha&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return Vu(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r?.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Nd(r){if(typeof r!="string")return null;if(r.endsWith("/"))return r;throw new Error(`Invalid factory url: "${r}" must include trailing slash.`)}const Jg=r=>typeof r=="object"&&Number.isInteger(r?.num)&&r.num>=0&&Number.isInteger(r?.gen)&&r.gen>=0,RB=r=>typeof r=="object"&&typeof r?.name=="string",OB=uB.bind(null,Jg,RB);class DB{#e=new Map;#t=Promise.resolve();postMessage(e,t){const a={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[s]of this.#e)s.call(this,a)})}addEventListener(e,t,a=null){let s=null;if(a?.signal instanceof AbortSignal){const{signal:i}=a;if(i.aborted){Ze("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);s=()=>i.removeEventListener("abort",o),i.addEventListener("abort",o)}this.#e.set(t,s)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}const Rd={DATA:1,ERROR:2},Tr={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function qb(){}function Ra(r){if(r instanceof yi||r instanceof qg||r instanceof Pb||r instanceof nf||r instanceof dg)return r;switch(r instanceof Error||typeof r=="object"&&r!==null||Pt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new yi(r.message);case"InvalidPDFException":return new qg(r.message);case"PasswordException":return new Pb(r.message,r.code);case"ResponseException":return new nf(r.message,r.status,r.missing);case"UnknownErrorException":return new dg(r.message,r.details)}return new dg(r.message,r.toString())}class Jc{#e=new AbortController;constructor(e,t,a){this.sourceName=e,this.targetName=t,this.comObj=a,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),a.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#r(e);return}if(e.callback){const a=e.callbackId,s=this.callbackCapabilities[a];if(!s)throw new Error(`Cannot resolve callback ${a}`);if(delete this.callbackCapabilities[a],e.callback===Rd.DATA)s.resolve(e.data);else if(e.callback===Rd.ERROR)s.reject(Ra(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const a=this.sourceName,s=e.sourceName,i=this.comObj;Promise.try(t,e.data).then(function(o){i.postMessage({sourceName:a,targetName:s,callback:Rd.DATA,callbackId:e.callbackId,data:o})},function(o){i.postMessage({sourceName:a,targetName:s,callback:Rd.ERROR,callbackId:e.callbackId,reason:Ra(o)})});return}if(e.streamId){this.#a(e);return}t(e.data)}on(e,t){const a=this.actionHandler;if(a[e])throw new Error(`There is already an actionName called "${e}"`);a[e]=t}send(e,t,a){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},a)}sendWithPromise(e,t,a){const s=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[s]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},a)}catch(o){i.reject(o)}return i.promise}sendWithStream(e,t,a,s){const i=this.streamId++,o=this.sourceName,c=this.targetName,u=this.comObj;return new ReadableStream({start:d=>{const f=Promise.withResolvers();return this.streamControllers[i]={controller:d,startCall:f,pullCall:null,cancelCall:null,isClosed:!1},u.postMessage({sourceName:o,targetName:c,action:e,streamId:i,data:t,desiredSize:d.desiredSize},s),f.promise},pull:d=>{const f=Promise.withResolvers();return this.streamControllers[i].pullCall=f,u.postMessage({sourceName:o,targetName:c,stream:Tr.PULL,streamId:i,desiredSize:d.desiredSize}),f.promise},cancel:d=>{mt(d instanceof Error,"cancel must have a valid reason");const f=Promise.withResolvers();return this.streamControllers[i].cancelCall=f,this.streamControllers[i].isClosed=!0,u.postMessage({sourceName:o,targetName:c,stream:Tr.CANCEL,streamId:i,reason:Ra(d)}),f.promise}},a)}#a(e){const t=e.streamId,a=this.sourceName,s=e.sourceName,i=this.comObj,o=this,c=this.actionHandler[e.action],u={enqueue(d,f=1,g){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=f,v>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:a,targetName:s,stream:Tr.ENQUEUE,streamId:t,chunk:d},g)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:a,targetName:s,stream:Tr.CLOSE,streamId:t}),delete o.streamSinks[t])},error(d){mt(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:a,targetName:s,stream:Tr.ERROR,streamId:t,reason:Ra(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};u.sinkCapability.resolve(),u.ready=u.sinkCapability.promise,this.streamSinks[t]=u,Promise.try(c,e.data,u).then(function(){i.postMessage({sourceName:a,targetName:s,stream:Tr.START_COMPLETE,streamId:t,success:!0})},function(d){i.postMessage({sourceName:a,targetName:s,stream:Tr.START_COMPLETE,streamId:t,reason:Ra(d)})})}#r(e){const t=e.streamId,a=this.sourceName,s=e.sourceName,i=this.comObj,o=this.streamControllers[t],c=this.streamSinks[t];switch(e.stream){case Tr.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(Ra(e.reason));break;case Tr.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(Ra(e.reason));break;case Tr.PULL:if(!c){i.postMessage({sourceName:a,targetName:s,stream:Tr.PULL_COMPLETE,streamId:t,success:!0});break}c.desiredSize<=0&&e.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=e.desiredSize,Promise.try(c.onPull||qb).then(function(){i.postMessage({sourceName:a,targetName:s,stream:Tr.PULL_COMPLETE,streamId:t,success:!0})},function(d){i.postMessage({sourceName:a,targetName:s,stream:Tr.PULL_COMPLETE,streamId:t,reason:Ra(d)})});break;case Tr.ENQUEUE:if(mt(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case Tr.CLOSE:if(mt(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#i(o,t);break;case Tr.ERROR:mt(o,"error should have stream controller"),o.controller.error(Ra(e.reason)),this.#i(o,t);break;case Tr.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(Ra(e.reason)),this.#i(o,t);break;case Tr.CANCEL:if(!c)break;const u=Ra(e.reason);Promise.try(c.onCancel||qb,u).then(function(){i.postMessage({sourceName:a,targetName:s,stream:Tr.CANCEL_COMPLETE,streamId:t,success:!0})},function(d){i.postMessage({sourceName:a,targetName:s,stream:Tr.CANCEL_COMPLETE,streamId:t,reason:Ra(d)})}),c.sinkCapability.reject(u),c.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#i(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class $A{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const a=this._createCanvas(e,t);return{canvas:a,context:a.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,a){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||a<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=a}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Pt("Abstract method `_createCanvas` called.")}}class FB extends $A{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const a=this._document.createElement("canvas");return a.width=e,a.height=t,a}}class GA{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(a=>({cMapData:a,isCompressed:this.isCompressed})).catch(a=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Pt("Abstract method `_fetch` called.")}}class Wb extends GA{async _fetch(e){const t=await qu(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Vu(t)}}class VA{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,a,s,i){return"none"}destroy(e=!1){}}class MB extends VA{#e;#t;#a;#r;#i;#n;#s=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#r=e,this.#i=t}get#o(){return this.#t||=new Map}get#c(){return this.#n||=new Map}get#l(){if(!this.#a){const e=this.#i.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const a=this.#i.createElementNS(An,"svg");a.setAttribute("width",0),a.setAttribute("height",0),this.#a=this.#i.createElementNS(An,"defs"),e.append(a),a.append(this.#a),this.#i.body.append(e)}return this.#a}#d(e){if(e.length===1){const u=e[0],d=new Array(256);for(let g=0;g<256;g++)d[g]=u[g]/255;const f=d.join(",");return[f,f,f]}const[t,a,s]=e,i=new Array(256),o=new Array(256),c=new Array(256);for(let u=0;u<256;u++)i[u]=t[u]/255,o[u]=a[u]/255,c[u]=s[u]/255;return[i.join(","),o.join(","),c.join(",")]}#h(e){if(this.#e===void 0){this.#e="";const t=this.#i.URL;t!==this.#i.baseURI&&(wf(t)?Ze('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=FA(t,""))}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#o.get(e);if(t)return t;const[a,s,i]=this.#d(e),o=e.length===1?a:`${a}${s}${i}`;if(t=this.#o.get(o),t)return this.#o.set(e,t),t;const c=`g_${this.#r}_transfer_map_${this.#s++}`,u=this.#h(c);this.#o.set(e,u),this.#o.set(o,u);const d=this.#g(c);return this.#p(a,s,i,d),u}addHCMFilter(e,t){const a=`${e}-${t}`,s="base";let i=this.#c.get(s);if(i?.key===a||(i?(i.filter?.remove(),i.key=a,i.url="none",i.filter=null):(i={key:a,url:"none",filter:null},this.#c.set(s,i)),!e||!t))return i.url;const o=this.#_(e);e=Le.makeHexColor(...o);const c=this.#_(t);if(t=Le.makeHexColor(...c),this.#l.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return i.url;const u=new Array(256);for(let x=0;x<=255;x++){const y=x/255;u[x]=y<=.03928?y/12.92:((y+.055)/1.055)**2.4}const d=u.join(","),f=`g_${this.#r}_hcm_filter`,g=i.filter=this.#g(f);this.#p(d,d,d,g),this.#m(g);const v=(x,y)=>{const _=o[x]/255,w=c[x]/255,A=new Array(y+1);for(let T=0;T<=y;T++)A[T]=_+T/y*(w-_);return A.join(",")};return this.#p(v(0,5),v(1,5),v(2,5),g),i.url=this.#h(f),i.url}addAlphaFilter(e){let t=this.#o.get(e);if(t)return t;const[a]=this.#d([e]),s=`alpha_${a}`;if(t=this.#o.get(s),t)return this.#o.set(e,t),t;const i=`g_${this.#r}_alpha_map_${this.#s++}`,o=this.#h(i);this.#o.set(e,o),this.#o.set(s,o);const c=this.#g(i);return this.#v(a,c),o}addLuminosityFilter(e){let t=this.#o.get(e||"luminosity");if(t)return t;let a,s;if(e?([a]=this.#d([e]),s=`luminosity_${a}`):s="luminosity",t=this.#o.get(s),t)return this.#o.set(e,t),t;const i=`g_${this.#r}_luminosity_map_${this.#s++}`,o=this.#h(i);this.#o.set(e,o),this.#o.set(s,o);const c=this.#g(i);return this.#f(c),e&&this.#v(a,c),o}addHighlightHCMFilter(e,t,a,s,i){const o=`${t}-${a}-${s}-${i}`;let c=this.#c.get(e);if(c?.key===o||(c?(c.filter?.remove(),c.key=o,c.url="none",c.filter=null):(c={key:o,url:"none",filter:null},this.#c.set(e,c)),!t||!a))return c.url;const[u,d]=[t,a].map(this.#_.bind(this));let f=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),g=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[v,x]=[s,i].map(this.#_.bind(this));g<f&&([f,g,v,x]=[g,f,x,v]),this.#l.style.color="";const y=(A,T,S)=>{const N=new Array(256),R=(g-f)/S,O=A/255,C=(T-A)/(255*S);let j=0;for(let I=0;I<=S;I++){const W=Math.round(f+I*R),H=O+I*C;for(let D=j;D<=W;D++)N[D]=H;j=W+1}for(let I=j;I<256;I++)N[I]=N[j-1];return N.join(",")},_=`g_${this.#r}_hcm_${e}_filter`,w=c.filter=this.#g(_);return this.#m(w),this.#p(y(v[0],x[0],5),y(v[1],x[1],5),y(v[2],x[2],5),w),c.url=this.#h(_),c.url}destroy(e=!1){e&&this.#n?.size||(this.#a?.parentNode.parentNode.remove(),this.#a=null,this.#t?.clear(),this.#t=null,this.#n?.clear(),this.#n=null,this.#s=0)}#f(e){const t=this.#i.createElementNS(An,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#m(e){const t=this.#i.createElementNS(An,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#g(e){const t=this.#i.createElementNS(An,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#l.append(t),t}#u(e,t,a){const s=this.#i.createElementNS(An,t);s.setAttribute("type","discrete"),s.setAttribute("tableValues",a),e.append(s)}#p(e,t,a,s){const i=this.#i.createElementNS(An,"feComponentTransfer");s.append(i),this.#u(i,"feFuncR",e),this.#u(i,"feFuncG",t),this.#u(i,"feFuncB",a)}#v(e,t){const a=this.#i.createElementNS(An,"feComponentTransfer");t.append(a),this.#u(a,"feFuncA",e)}#_(e){return this.#l.style.color=e,Xu(getComputedStyle(this.#l).getPropertyValue("color"))}}class qA{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(a=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Pt("Abstract method `_fetch` called.")}}class Xb extends qA{async _fetch(e){const t=await qu(e,"arraybuffer");return new Uint8Array(t)}}class WA{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(a=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){Pt("Abstract method `_fetch` called.")}}class Yb extends WA{async _fetch(e){const t=await qu(e,"arraybuffer");return new Uint8Array(t)}}ha&&Ze("Please use the `legacy` build in Node.js environments.");async function Jm(r){const t=await process.getBuiltinModule("fs").promises.readFile(r);return new Uint8Array(t)}class LB extends VA{}class IB extends $A{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class jB extends GA{async _fetch(e){return Jm(e)}}class PB extends qA{async _fetch(e){return Jm(e)}}class BB extends WA{async _fetch(e){return Jm(e)}}const pl="__forcedDependency",{floor:Kb,ceil:Jb}=Math;function Od(r,e,t,a,s,i){r[e*4+0]=Math.min(r[e*4+0],t),r[e*4+1]=Math.min(r[e*4+1],a),r[e*4+2]=Math.max(r[e*4+2],s),r[e*4+3]=Math.max(r[e*4+3],i)}const Qg=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class UB{#e;#t;constructor(e,t){this.#e=e,this.#t=t}get length(){return this.#e.length}isEmpty(e){return this.#e[e]===Qg}minX(e){return this.#t[e*4+0]/256}minY(e){return this.#t[e*4+1]/256}maxX(e){return(this.#t[e*4+2]+1)/256}maxY(e){return(this.#t[e*4+3]+1)/256}}const Dd=(r,e)=>{if(!r)return;let t=r.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},r.set(e,t)),t};class zB{#e={__proto__:null};#t={__proto__:null,transform:[],moveText:[],sameLineText:[],[pl]:[]};#a=new Map;#r=[];#i=[];#n=[[1,0,0,1,0,0]];#s=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#m;#g;#u;#p;constructor(e,t,a=!1){this.#f=e.width,this.#m=e.height,this.#v(t),a&&(this.#p=new Map)}growOperationsCount(e){e>=this.#u.length&&this.#v(e,this.#u)}#v(e,t){const a=new ArrayBuffer(e*4);this.#g=new Uint8ClampedArray(a),this.#u=new Uint32Array(a),t&&t.length>0?(this.#u.set(t),this.#u.fill(Qg,t.length)):this.#u.fill(Qg)}save(e){return this.#e={__proto__:this.#e},this.#t={__proto__:this.#t,transform:{__proto__:this.#t.transform},moveText:{__proto__:this.#t.moveText},sameLineText:{__proto__:this.#t.sameLineText},[pl]:{__proto__:this.#t[pl]}},this.#s={__proto__:this.#s},this.#r.push(e),this}restore(e){const t=Object.getPrototypeOf(this.#e);if(t===null)return this;this.#e=t,this.#t=Object.getPrototypeOf(this.#t),this.#s=Object.getPrototypeOf(this.#s);const a=this.#r.pop();return a!==void 0&&(Dd(this.#p,e)?.dependencies.add(a),this.#u[e]=this.#u[a]),this}recordOpenMarker(e){return this.#r.push(e),this}getOpenMarker(){return this.#r.length===0?null:this.#r.at(-1)}recordCloseMarker(e){const t=this.#r.pop();return t!==void 0&&(Dd(this.#p,e)?.dependencies.add(t),this.#u[e]=this.#u[t]),this}beginMarkedContent(e){return this.#i.push(e),this}endMarkedContent(e){const t=this.#i.pop();return t!==void 0&&(Dd(this.#p,e)?.dependencies.add(t),this.#u[e]=this.#u[t]),this}pushBaseTransform(e){return this.#n.push(Le.multiplyByDOMMatrix(this.#n.at(-1),e.getTransform())),this}popBaseTransform(){return this.#n.length>1&&this.#n.pop(),this}recordSimpleData(e,t){return this.#e[e]=t,this}recordIncrementalData(e,t){return this.#t[e].push(t),this}resetIncrementalData(e,t){return this.#t[e].length=0,this}recordNamedData(e,t){return this.#a.set(e,t),this}recordSimpleDataFromNamed(e,t,a){this.#e[e]=this.#a.get(t)??a}recordFutureForcedDependency(e,t){return this.recordIncrementalData(pl,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in this.#e&&this.recordFutureForcedDependency(t,this.#e[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of this.#l)this.recordFutureForcedDependency(pl,e);return this}resetBBox(e){return this.#c!==e&&(this.#c=e,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(e,t,a,s,i,o){const c=Le.multiplyByDOMMatrix(this.#n.at(-1),t.getTransform()),u=[1/0,1/0,-1/0,-1/0];Le.axialAlignedBoundingBox([a,i,s,o],c,u);const d=Le.intersect(this.#s,u);return d?(this.#s[0]=d[0],this.#s[1]=d[1],this.#s[2]=d[2],this.#s[3]=d[3]):(this.#s[0]=this.#s[1]=1/0,this.#s[2]=this.#s[3]=-1/0),this}recordBBox(e,t,a,s,i,o){const c=this.#s;if(c[0]===1/0)return this;const u=Le.multiplyByDOMMatrix(this.#n.at(-1),t.getTransform());if(c[0]===-1/0)return Le.axialAlignedBoundingBox([a,i,s,o],u,this.#o),this;const d=[1/0,1/0,-1/0,-1/0];return Le.axialAlignedBoundingBox([a,i,s,o],u,d),this.#o[0]=Math.min(this.#o[0],Math.max(d[0],c[0])),this.#o[1]=Math.min(this.#o[1],Math.max(d[1],c[1])),this.#o[2]=Math.max(this.#o[2],Math.min(d[2],c[2])),this.#o[3]=Math.max(this.#o[3],Math.min(d[3],c[3])),this}recordCharacterBBox(e,t,a,s=1,i=0,o=0,c){const u=a.bbox;let d,f;if(u&&(d=u[2]!==u[0]&&u[3]!==u[1]&&this.#h.get(a),d!==!1&&(f=[0,0,0,0],Le.axialAlignedBoundingBox(u,a.fontMatrix,f),(s!==1||i!==0||o!==0)&&Le.scaleMinMax([s,0,0,-s,i,o],f),d)))return this.recordBBox(e,t,f[0],f[2],f[1],f[3]);if(!c)return this.recordFullPageBBox(e);const g=c();return u&&f&&d===void 0&&(d=f[0]<=i-g.actualBoundingBoxLeft&&f[2]>=i+g.actualBoundingBoxRight&&f[1]<=o-g.actualBoundingBoxAscent&&f[3]>=o+g.actualBoundingBoxDescent,this.#h.set(a,d),d)?this.recordBBox(e,t,f[0],f[2],f[1],f[3]):this.recordBBox(e,t,i-g.actualBoundingBoxLeft,i+g.actualBoundingBoxRight,o-g.actualBoundingBoxAscent,o+g.actualBoundingBoxDescent)}recordFullPageBBox(e){return this.#o[0]=Math.max(0,this.#s[0]),this.#o[1]=Math.max(0,this.#s[1]),this.#o[2]=Math.min(this.#f,this.#s[2]),this.#o[3]=Math.min(this.#m,this.#s[3]),this}getSimpleIndex(e){return this.#e[e]}recordDependencies(e,t){const a=this.#l,s=this.#e,i=this.#t;for(const o of t)o in this.#e?a.add(s[o]):o in i&&i[o].forEach(a.add,a);return this}recordNamedDependency(e,t){return this.#a.has(t)&&this.#l.add(this.#a.get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[pl]),this.#p){const a=Dd(this.#p,e),{dependencies:s}=a;this.#l.forEach(s.add,s),this.#r.forEach(s.add,s),this.#i.forEach(s.add,s),s.delete(e),a.isRenderingOperation=!0}if(this.#c===e){const a=Kb(this.#o[0]*256/this.#f),s=Kb(this.#o[1]*256/this.#m),i=Jb(this.#o[2]*256/this.#f),o=Jb(this.#o[3]*256/this.#m);Od(this.#g,e,a,s,i,o);for(const c of this.#l)c!==e&&Od(this.#g,c,a,s,i,o);for(const c of this.#r)c!==e&&Od(this.#g,c,a,s,i,o);for(const c of this.#i)c!==e&&Od(this.#g,c,a,s,i,o);t||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(e,t=!1){const a=Array.from(this.#l);this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const s of a)this.recordIncrementalData("sameLineText",s);return this}bboxToClipBoxDropOperation(e,t=!1){return this.#c===e&&(this.#c=-1,this.#s[0]=Math.max(this.#s[0],this.#o[0]),this.#s[1]=Math.max(this.#s[1],this.#o[1]),this.#s[2]=Math.min(this.#s[2],this.#o[2]),this.#s[3]=Math.min(this.#s[3],this.#o[3]),t||this.#l.clear()),this}_takePendingDependencies(){const e=this.#l;return this.#l=new Set,e}_extractOperation(e){const t=this.#d.get(e);return this.#d.delete(e),t}_pushPendingDependencies(e){for(const t of e)this.#l.add(t)}take(){return this.#h.clear(),new UB(this.#u,this.#g)}takeDebugMetadata(){return this.#p}}class of{#e;#t;#a;#r=0;#i=0;constructor(e,t,a){if(e instanceof of&&e.#a===!!a)return e;this.#e=e,this.#t=t,this.#a=!!a}growOperationsCount(){throw new Error("Unreachable")}save(e){return this.#i++,this.#e.save(this.#t),this}restore(e){return this.#i>0&&(this.#e.restore(this.#t),this.#i--),this}recordOpenMarker(e){return this.#r++,this}getOpenMarker(){return this.#r>0?this.#t:this.#e.getOpenMarker()}recordCloseMarker(e){return this.#r--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return this.#e.pushBaseTransform(e),this}popBaseTransform(){return this.#e.popBaseTransform(),this}recordSimpleData(e,t){return this.#e.recordSimpleData(e,this.#t),this}recordIncrementalData(e,t){return this.#e.recordIncrementalData(e,this.#t),this}resetIncrementalData(e,t){return this.#e.resetIncrementalData(e,this.#t),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,a){return this.#e.recordSimpleDataFromNamed(e,t,this.#t),this}recordFutureForcedDependency(e,t){return this.#e.recordFutureForcedDependency(e,this.#t),this}inheritSimpleDataAsFutureForcedDependencies(e){return this.#e.inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#e.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return this.#a||this.#e.resetBBox(this.#t),this}recordClipBox(e,t,a,s,i,o){return this.#a||this.#e.recordClipBox(this.#t,t,a,s,i,o),this}recordBBox(e,t,a,s,i,o){return this.#a||this.#e.recordBBox(this.#t,t,a,s,i,o),this}recordCharacterBBox(e,t,a,s,i,o,c){return this.#a||this.#e.recordCharacterBBox(this.#t,t,a,s,i,o,c),this}recordFullPageBBox(e){return this.#a||this.#e.recordFullPageBBox(this.#t),this}getSimpleIndex(e){return this.#e.getSimpleIndex(e)}recordDependencies(e,t){return this.#e.recordDependencies(this.#t,t),this}recordNamedDependency(e,t){return this.#e.recordNamedDependency(this.#t,t),this}recordOperation(e){return this.#e.recordOperation(this.#t,!0),this}recordShowTextOperation(e){return this.#e.recordShowTextOperation(this.#t,!0),this}bboxToClipBoxDropOperation(e){return this.#a||this.#e.bboxToClipBoxDropOperation(this.#t,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const fs={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Kr={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Zg(r,e){if(!e)return;const t=e[2]-e[0],a=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,a),r.clip(s)}class Qm{isModifyingCurrentTransform(){return!1}getPattern(){Pt("Abstract method `getPattern` called.")}}class HB extends Qm{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(e,t=null){let a,s=this._p0,i=this._p1;if(t&&(s=s.slice(),i=i.slice(),Le.applyTransform(s,t),Le.applyTransform(i,t)),this._type==="axial")a=e.createLinearGradient(s[0],s[1],i[0],i[1]);else if(this._type==="radial"){let o=this._r0,c=this._r1;if(t){const u=new Float32Array(2);Le.singularValueDecompose2dScale(t,u),o*=u[0],c*=u[0]}a=e.createRadialGradient(s[0],s[1],o,i[0],i[1],c)}for(const o of this._colorStops)a.addColorStop(o[0],o[1]);return a}getPattern(e,t,a,s){let i;if(s===Kr.STROKE||s===Kr.FILL){if(this.isOriginBased()){let v=Le.transform(a,t.baseTransform);this.matrix&&(v=Le.transform(v,this.matrix));const x=.001,y=Math.hypot(v[0],v[1]),_=Math.hypot(v[2],v[3]),w=(v[0]*v[2]+v[1]*v[3])/(y*_);if(Math.abs(w)<x)if(this.isRadial()){if(Math.abs(y-_)<x)return this._createGradient(e,v)}else return this._createGradient(e,v)}const o=t.current.getClippedPathBoundingBox(s,ir(e))||[0,0,0,0],c=Math.ceil(o[2]-o[0])||1,u=Math.ceil(o[3]-o[1])||1,d=t.cachedCanvases.getCanvas("pattern",c,u),f=d.context;f.clearRect(0,0,f.canvas.width,f.canvas.height),f.beginPath(),f.rect(0,0,f.canvas.width,f.canvas.height),f.translate(-o[0],-o[1]),a=Le.transform(a,[1,0,0,1,o[0],o[1]]),f.transform(...t.baseTransform),this.matrix&&f.transform(...this.matrix),Zg(f,this._bbox),f.fillStyle=this._createGradient(f),f.fill(),i=e.createPattern(d.canvas,"no-repeat");const g=new DOMMatrix(a);i.setTransform(g)}else Zg(e,this._bbox),i=this._createGradient(e);return i}}function gg(r,e,t,a,s,i,o,c){const u=e.coords,d=e.colors,f=r.data,g=r.width*4;let v;u[t+1]>u[a+1]&&(v=t,t=a,a=v,v=i,i=o,o=v),u[a+1]>u[s+1]&&(v=a,a=s,s=v,v=o,o=c,c=v),u[t+1]>u[a+1]&&(v=t,t=a,a=v,v=i,i=o,o=v);const x=(u[t]+e.offsetX)*e.scaleX,y=(u[t+1]+e.offsetY)*e.scaleY,_=(u[a]+e.offsetX)*e.scaleX,w=(u[a+1]+e.offsetY)*e.scaleY,A=(u[s]+e.offsetX)*e.scaleX,T=(u[s+1]+e.offsetY)*e.scaleY;if(y>=T)return;const S=d[i],N=d[i+1],R=d[i+2],O=d[o],C=d[o+1],j=d[o+2],I=d[c],W=d[c+1],H=d[c+2],D=Math.round(y),z=Math.round(T);let ne,re,U,te,be,se,ke,q;for(let F=D;F<=z;F++){if(F<w){const ve=F<y?0:(y-F)/(y-w);ne=x-(x-_)*ve,re=S-(S-O)*ve,U=N-(N-C)*ve,te=R-(R-j)*ve}else{let ve;F>T?ve=1:w===T?ve=0:ve=(w-F)/(w-T),ne=_-(_-A)*ve,re=O-(O-I)*ve,U=C-(C-W)*ve,te=j-(j-H)*ve}let J;F<y?J=0:F>T?J=1:J=(y-F)/(y-T),be=x-(x-A)*J,se=S-(S-I)*J,ke=N-(N-W)*J,q=R-(R-H)*J;const K=Math.round(Math.min(ne,be)),Y=Math.round(Math.max(ne,be));let oe=g*F+K*4;for(let ve=K;ve<=Y;ve++)J=(ne-ve)/(ne-be),J<0?J=0:J>1&&(J=1),f[oe++]=re-(re-se)*J|0,f[oe++]=U-(U-ke)*J|0,f[oe++]=te-(te-q)*J|0,f[oe++]=255}}function $B(r,e,t){const a=e.coords,s=e.colors;let i,o;switch(e.type){case Vg.LATTICE:const c=e.verticesPerRow,u=Math.floor(a.length/c)-1,d=c-1;for(i=0;i<u;i++){let f=i*c;for(let g=0;g<d;g++,f++)gg(r,t,a[f],a[f+1],a[f+c],s[f],s[f+1],s[f+c]),gg(r,t,a[f+c+1],a[f+1],a[f+c],s[f+c+1],s[f+1],s[f+c])}break;case Vg.TRIANGLES:for(i=0,o=a.length;i<o;i+=3)gg(r,t,a[i],a[i+1],a[i+2],s[i],s[i+1],s[i+2]);break;default:throw new Error("illegal figure")}}class GB extends Qm{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,a){const c=Math.floor(this._bounds[0]),u=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-c,f=Math.ceil(this._bounds[3])-u,g=Math.min(Math.ceil(Math.abs(d*e[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(f*e[1]*1.1)),3e3),x=d/g,y=f/v,_={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-u,scaleX:1/x,scaleY:1/y},w=g+4,A=v+4,T=a.getCanvas("mesh",w,A),S=T.context,N=S.createImageData(g,v);if(t){const O=N.data;for(let C=0,j=O.length;C<j;C+=4)O[C]=t[0],O[C+1]=t[1],O[C+2]=t[2],O[C+3]=255}for(const O of this._figures)$B(N,O,_);return S.putImageData(N,2,2),{canvas:T.canvas,offsetX:c-2*x,offsetY:u-2*y,scaleX:x,scaleY:y}}isModifyingCurrentTransform(){return!0}getPattern(e,t,a,s){Zg(e,this._bbox);const i=new Float32Array(2);if(s===Kr.SHADING)Le.singularValueDecompose2dScale(ir(e),i);else if(this.matrix){Le.singularValueDecompose2dScale(this.matrix,i);const[c,u]=i;Le.singularValueDecompose2dScale(t.baseTransform,i),i[0]*=c,i[1]*=u}else Le.singularValueDecompose2dScale(t.baseTransform,i);const o=this._createMeshCanvas(i,s===Kr.SHADING?null:this._background,t.cachedCanvases);return s!==Kr.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class VB extends Qm{getPattern(){return"hotpink"}}function qB(r){switch(r[0]){case"RadialAxial":return new HB(r);case"Mesh":return new GB(r);case"Dummy":return new VB}throw new Error(`Unknown IR type: ${r[0]}`)}const Qb={COLORED:1,UNCOLORED:2};class Zm{static MAX_PATTERN_SIZE=3e3;constructor(e,t,a,s){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=a,this.baseTransform=s}createPatternCanvas(e,t){const{bbox:a,operatorList:s,paintType:i,tilingType:o,color:c,canvasGraphicsFactory:u}=this;let{xstep:d,ystep:f}=this;d=Math.abs(d),f=Math.abs(f),bf("TilingType: "+o);const g=a[0],v=a[1],x=a[2],y=a[3],_=x-g,w=y-v,A=new Float32Array(2);Le.singularValueDecompose2dScale(this.matrix,A);const[T,S]=A;Le.singularValueDecompose2dScale(this.baseTransform,A);const N=T*A[0],R=S*A[1];let O=_,C=w,j=!1,I=!1;const W=Math.ceil(d*N),H=Math.ceil(f*R),D=Math.ceil(_*N),z=Math.ceil(w*R);W>=D?O=d:j=!0,H>=z?C=f:I=!0;const ne=this.getSizeAndScale(O,this.ctx.canvas.width,N),re=this.getSizeAndScale(C,this.ctx.canvas.height,R),U=e.cachedCanvases.getCanvas("pattern",ne.size,re.size),te=U.context,be=u.createCanvasGraphics(te,t);if(be.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(be,i,c),te.translate(-ne.scale*g,-re.scale*v),be.transform(0,ne.scale,0,0,re.scale,0,0),te.save(),be.dependencyTracker?.save(),this.clipBbox(be,g,v,x,y),be.baseTransform=ir(be.ctx),be.executeOperatorList(s),be.endDrawing(),be.dependencyTracker?.restore(),te.restore(),j||I){const se=U.canvas;j&&(O=d),I&&(C=f);const ke=this.getSizeAndScale(O,this.ctx.canvas.width,N),q=this.getSizeAndScale(C,this.ctx.canvas.height,R),F=ke.size,J=q.size,K=e.cachedCanvases.getCanvas("pattern-workaround",F,J),Y=K.context,oe=j?Math.floor(_/d):0,ve=I?Math.floor(w/f):0;for(let Ne=0;Ne<=oe;Ne++)for(let Ee=0;Ee<=ve;Ee++)Y.drawImage(se,F*Ne,J*Ee,F,J,0,0,F,J);return{canvas:K.canvas,scaleX:ke.scale,scaleY:q.scale,offsetX:g,offsetY:v}}return{canvas:U.canvas,scaleX:ne.scale,scaleY:re.scale,offsetX:g,offsetY:v}}getSizeAndScale(e,t,a){const s=Math.max(Zm.MAX_PATTERN_SIZE,t);let i=Math.ceil(e*a);return i>=s?i=s:a=i/e,{scale:a,size:i}}clipBbox(e,t,a,s,i){const o=s-t,c=i-a;e.ctx.rect(t,a,o,c),Le.axialAlignedBoundingBox([t,a,s,i],ir(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,a){const s=e.ctx,i=e.current;switch(t){case Qb.COLORED:const{fillStyle:o,strokeStyle:c}=this.ctx;s.fillStyle=i.fillColor=o,s.strokeStyle=i.strokeColor=c;break;case Qb.UNCOLORED:s.fillStyle=s.strokeStyle=a,i.fillColor=i.strokeColor=a;break;default:throw new sB(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,a,s,i){let o=a;s!==Kr.SHADING&&(o=Le.transform(o,t.baseTransform),this.matrix&&(o=Le.transform(o,this.matrix)));const c=this.createPatternCanvas(t,i);let u=new DOMMatrix(o);u=u.translate(c.offsetX,c.offsetY),u=u.scale(1/c.scaleX,1/c.scaleY);const d=e.createPattern(c.canvas,"repeat");return d.setTransform(u),d}}function WB({src:r,srcPos:e=0,dest:t,width:a,height:s,nonBlackColor:i=4294967295,inverseDecode:o=!1}){const c=jr.isLittleEndian?4278190080:255,[u,d]=o?[i,c]:[c,i],f=a>>3,g=a&7,v=r.length;t=new Uint32Array(t.buffer);let x=0;for(let y=0;y<s;y++){for(const w=e+f;e<w;e++){const A=e<v?r[e]:255;t[x++]=A&128?d:u,t[x++]=A&64?d:u,t[x++]=A&32?d:u,t[x++]=A&16?d:u,t[x++]=A&8?d:u,t[x++]=A&4?d:u,t[x++]=A&2?d:u,t[x++]=A&1?d:u}if(g===0)continue;const _=e<v?r[e++]:255;for(let w=0;w<g;w++)t[x++]=_&1<<7-w?d:u}return{srcPos:e,destPos:x}}const Zb=16,ew=100,XB=15,tw=10,Da=16,mg=new DOMMatrix,Va=new Float32Array(2),Tl=new Float32Array([1/0,1/0,-1/0,-1/0]);function YB(r,e){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){e.save(),this.__originalSave()},r.restore=function(){e.restore(),this.__originalRestore()},r.translate=function(t,a){e.translate(t,a),this.__originalTranslate(t,a)},r.scale=function(t,a){e.scale(t,a),this.__originalScale(t,a)},r.transform=function(t,a,s,i,o,c){e.transform(t,a,s,i,o,c),this.__originalTransform(t,a,s,i,o,c)},r.setTransform=function(t,a,s,i,o,c){e.setTransform(t,a,s,i,o,c),this.__originalSetTransform(t,a,s,i,o,c)},r.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},r.rotate=function(t){e.rotate(t),this.__originalRotate(t)},r.clip=function(t){e.clip(t),this.__originalClip(t)},r.moveTo=function(t,a){e.moveTo(t,a),this.__originalMoveTo(t,a)},r.lineTo=function(t,a){e.lineTo(t,a),this.__originalLineTo(t,a)},r.bezierCurveTo=function(t,a,s,i,o,c){e.bezierCurveTo(t,a,s,i,o,c),this.__originalBezierCurveTo(t,a,s,i,o,c)},r.rect=function(t,a,s,i){e.rect(t,a,s,i),this.__originalRect(t,a,s,i)},r.closePath=function(){e.closePath(),this.__originalClosePath()},r.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class KB{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,a){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,a)):(s=this.canvasFactory.create(t,a),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Fd(r,e,t,a,s,i,o,c,u,d){const[f,g,v,x,y,_]=ir(r);if(g===0&&v===0){const T=o*f+y,S=Math.round(T),N=c*x+_,R=Math.round(N),O=(o+u)*f+y,C=Math.abs(Math.round(O)-S)||1,j=(c+d)*x+_,I=Math.abs(Math.round(j)-R)||1;return r.setTransform(Math.sign(f),0,0,Math.sign(x),S,R),r.drawImage(e,t,a,s,i,0,0,C,I),r.setTransform(f,g,v,x,y,_),[C,I]}if(f===0&&x===0){const T=c*v+y,S=Math.round(T),N=o*g+_,R=Math.round(N),O=(c+d)*v+y,C=Math.abs(Math.round(O)-S)||1,j=(o+u)*g+_,I=Math.abs(Math.round(j)-R)||1;return r.setTransform(0,Math.sign(g),Math.sign(v),0,S,R),r.drawImage(e,t,a,s,i,0,0,I,C),r.setTransform(f,g,v,x,y,_),[I,C]}r.drawImage(e,t,a,s,i,o,c,u,d);const w=Math.hypot(f,g),A=Math.hypot(v,x);return[w*u,A*d]}class rw{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Gg;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Dr.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(e,t,a){a?.(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Tl.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Kr.FILL,t=null){const a=this.minMax.slice();if(e===Kr.STROKE){t||Pt("Stroke bounding box must include transform."),Le.singularValueDecompose2dScale(t,Va);const s=Va[0]*this.lineWidth/2,i=Va[1]*this.lineWidth/2;a[0]-=s,a[1]-=i,a[2]+=s,a[3]+=i}return a}updateClipFromPath(){const e=Le.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Tl,0)}getClippedPathBoundingBox(e=Kr.FILL,t=null){return Le.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function aw(r,e){if(e instanceof ImageData){r.putImageData(e,0,0);return}const t=e.height,a=e.width,s=t%Da,i=(t-s)/Da,o=s===0?i:i+1,c=r.createImageData(a,Da);let u=0,d;const f=e.data,g=c.data;let v,x,y,_;if(e.kind===Ud.GRAYSCALE_1BPP){const w=f.byteLength,A=new Uint32Array(g.buffer,0,g.byteLength>>2),T=A.length,S=a+7>>3,N=4294967295,R=jr.isLittleEndian?4278190080:255;for(v=0;v<o;v++){for(y=v<i?Da:s,d=0,x=0;x<y;x++){const O=w-u;let C=0;const j=O>S?a:O*8-7,I=j&-8;let W=0,H=0;for(;C<I;C+=8)H=f[u++],A[d++]=H&128?N:R,A[d++]=H&64?N:R,A[d++]=H&32?N:R,A[d++]=H&16?N:R,A[d++]=H&8?N:R,A[d++]=H&4?N:R,A[d++]=H&2?N:R,A[d++]=H&1?N:R;for(;C<j;C++)W===0&&(H=f[u++],W=128),A[d++]=H&W?N:R,W>>=1}for(;d<T;)A[d++]=0;r.putImageData(c,0,v*Da)}}else if(e.kind===Ud.RGBA_32BPP){for(x=0,_=a*Da*4,v=0;v<i;v++)g.set(f.subarray(u,u+_)),u+=_,r.putImageData(c,0,x),x+=Da;v<o&&(_=a*s*4,g.set(f.subarray(u,u+_)),r.putImageData(c,0,x))}else if(e.kind===Ud.RGB_24BPP)for(y=Da,_=a*y,v=0;v<o;v++){for(v>=i&&(y=s,_=a*y),d=0,x=_;x--;)g[d++]=f[u++],g[d++]=f[u++],g[d++]=f[u++],g[d++]=255;r.putImageData(c,0,v*Da)}else throw new Error(`bad image kind: ${e.kind}`)}function sw(r,e){if(e.bitmap){r.drawImage(e.bitmap,0,0);return}const t=e.height,a=e.width,s=t%Da,i=(t-s)/Da,o=s===0?i:i+1,c=r.createImageData(a,Da);let u=0;const d=e.data,f=c.data;for(let g=0;g<o;g++){const v=g<i?Da:s;({srcPos:u}=WB({src:d,srcPos:u,dest:f,width:a,height:v,nonBlackColor:0})),r.putImageData(c,0,g*Da)}}function zc(r,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const a of t)r[a]!==void 0&&(e[a]=r[a]);r.setLineDash!==void 0&&(e.setLineDash(r.getLineDash()),e.lineDashOffset=r.lineDashOffset)}function Md(r){r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0);const{filter:e}=r;e!=="none"&&e!==""&&(r.filter="none")}function nw(r,e){if(e)return!0;Le.singularValueDecompose2dScale(r,Va);const t=Math.fround(rn.pixelRatio*Pl.PDF_TO_CSS_UNITS);return Va[0]<=t&&Va[1]<=t}const JB=["butt","round","square"],QB=["miter","round","bevel"],ZB={},iw={};class Ml{constructor(e,t,a,s,i,{optionalContentConfig:o,markedContentStack:c=null},u,d,f){this.ctx=e,this.current=new rw(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=a,this.canvasFactory=s,this.filterFactory=i,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=o,this.cachedCanvases=new KB(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=u,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=f??null}getObject(e,t,a=null){return typeof t=="string"?(this.dependencyTracker?.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):a}beginDrawing({transform:e,viewport:t,transparency:a=!1,background:s=null}){const i=this.ctx.canvas.width,o=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,i,o),this.ctx.fillStyle=c,a){const u=this.cachedCanvases.getCanvas("transparent",i,o);this.compositeCtx=this.ctx,this.transparentCanvas=u.canvas,this.ctx=u.context,this.ctx.save(),this.ctx.transform(...ir(this.compositeCtx))}this.ctx.save(),Md(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=ir(this.ctx)}executeOperatorList(e,t,a,s,i){const o=e.argsArray,c=e.fnArray;let u=t||0;const d=o.length;if(d===u)return u;const f=d-u>tw&&typeof a=="function",g=f?Date.now()+XB:0;let v=0;const x=this.commonObjs,y=this.objs;let _,w;for(;;){if(s!==void 0&&u===s.nextBreakPoint)return s.breakIt(u,a),u;if(!i||i(u))if(_=c[u],w=o[u]??null,_!==Nu.dependency)w===null?this[_](u):this[_](u,...w);else for(const A of w){this.dependencyTracker?.recordNamedData(A,u);const T=A.startsWith("g_")?x:y;if(!T.has(A))return T.get(A,a),u}if(u++,u===d)return u;if(f&&++v>tw){if(Date.now()>g)return a(),u;v=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const a=e.width??e.displayWidth,s=e.height??e.displayHeight;let i=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),c=a,u=s,d="prescale1",f,g;for(;i>2&&c>1||o>2&&u>1;){let v=c,x=u;i>2&&c>1&&(v=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),i/=c/v),o>2&&u>1&&(x=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u)/2,o/=u/x),f=this.cachedCanvases.getCanvas(d,v,x),g=f.context,g.clearRect(0,0,v,x),g.drawImage(e,0,0,c,u,0,0,v,x),e=f.canvas,c=v,u=x,d=d==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:c,paintHeight:u}}_createMaskCanvas(e,t){const a=this.ctx,{width:s,height:i}=t,o=this.current.fillColor,c=this.current.patternFill,u=ir(a);let d,f,g,v;if((t.bitmap||t.data)&&t.count>1){const W=t.bitmap||t.data.buffer;f=JSON.stringify(c?u:[u.slice(0,4),o]),d=this._cachedBitmapsMap.get(W),d||(d=new Map,this._cachedBitmapsMap.set(W,d));const H=d.get(f);if(H&&!c){const D=Math.round(Math.min(u[0],u[2])+u[4]),z=Math.round(Math.min(u[1],u[3])+u[5]);return this.dependencyTracker?.recordDependencies(e,fs.transformAndFill),{canvas:H,offsetX:D,offsetY:z}}g=H}g||(v=this.cachedCanvases.getCanvas("maskCanvas",s,i),sw(v.context,t));let x=Le.transform(u,[1/s,0,0,-1/i,0,0]);x=Le.transform(x,[1,0,0,1,0,-i]);const y=Tl.slice();Le.axialAlignedBoundingBox([0,0,s,i],x,y);const[_,w,A,T]=y,S=Math.round(A-_)||1,N=Math.round(T-w)||1,R=this.cachedCanvases.getCanvas("fillCanvas",S,N),O=R.context,C=_,j=w;O.translate(-C,-j),O.transform(...x),g||(g=this._scaleImage(v.canvas,Ks(O)),g=g.img,d&&c&&d.set(f,g)),O.imageSmoothingEnabled=nw(ir(O),t.interpolate),Fd(O,g,0,0,g.width,g.height,0,0,s,i),O.globalCompositeOperation="source-in";const I=Le.transform(Ks(O),[1,0,0,1,-C,-j]);return O.fillStyle=c?o.getPattern(a,this,I,Kr.FILL,e):o,O.fillRect(0,0,s,i),d&&!c&&(this.cachedCanvases.delete("fillCanvas"),d.set(f,R.canvas)),this.dependencyTracker?.recordDependencies(e,fs.transformAndFill),{canvas:R.canvas,offsetX:Math.round(C),offsetY:Math.round(j)}}setLineWidth(e,t){this.dependencyTracker?.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){this.dependencyTracker?.recordSimpleData("lineCap",e),this.ctx.lineCap=JB[t]}setLineJoin(e,t){this.dependencyTracker?.recordSimpleData("lineJoin",e),this.ctx.lineJoin=QB[t]}setMiterLimit(e,t){this.dependencyTracker?.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,a){this.dependencyTracker?.recordSimpleData("dash",e);const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(t),s.lineDashOffset=a)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){for(const[a,s]of t)switch(a){case"LW":this.setLineWidth(e,s);break;case"LC":this.setLineCap(e,s);break;case"LJ":this.setLineJoin(e,s);break;case"ML":this.setMiterLimit(e,s);break;case"D":this.setDash(e,s[0],s[1]);break;case"RI":this.setRenderingIntent(e,s);break;case"FL":this.setFlatness(e,s);break;case"Font":this.setFont(e,s[0],s[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=s;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=s;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=s;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",e),this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,a=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(s,t,a);this.suspendedCtx=this.ctx;const o=this.ctx=i.context;o.setTransform(this.suspendedCtx.getTransform()),zc(this.suspendedCtx,o),YB(o,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),zc(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,a=this.suspendedCtx;this.composeSMask(a,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,a,s){const i=s[0],o=s[1],c=s[2]-i,u=s[3]-o;c===0||u===0||(this.genericComposeSMask(t.context,a,c,u,t.subtype,t.backdrop,t.transferMap,i,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(a.canvas,0,0),e.restore())}genericComposeSMask(e,t,a,s,i,o,c,u,d,f,g){let v=e.canvas,x=u-f,y=d-g;if(o)if(x<0||y<0||x+a>v.width||y+s>v.height){const w=this.cachedCanvases.getCanvas("maskExtension",a,s),A=w.context;A.drawImage(v,-x,-y),A.globalCompositeOperation="destination-atop",A.fillStyle=o,A.fillRect(0,0,a,s),A.globalCompositeOperation="source-over",v=w.canvas,x=y=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const w=new Path2D;w.rect(x,y,a,s),e.clip(w),e.globalCompositeOperation="destination-atop",e.fillStyle=o,e.fillRect(x,y,a,s),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),i==="Alpha"&&c?t.filter=this.filterFactory.addAlphaFilter(c):i==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(c));const _=new Path2D;_.rect(u,d,a,s),t.clip(_),t.globalCompositeOperation="destination-in",t.drawImage(v,x,y,a,s,u,d,a,s),t.restore()}save(e){this.inSMaskMode&&zc(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),this.dependencyTracker?.save(e)}restore(e){if(this.dependencyTracker?.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&zc(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,a,s,i,o,c){this.dependencyTracker?.recordIncrementalData("transform",e),this.ctx.transform(t,a,s,i,o,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,a,s){let[i]=a;if(!s){i||=a[0]=new Path2D,this[t](e,i);return}if(this.dependencyTracker!==null){const o=t===Nu.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,s[0]-o,s[2]+o,s[1]-o,s[3]+o).recordDependencies(e,["transform"])}i instanceof Path2D||(i=a[0]=BA(i)),Le.axialAlignedBoundingBox(s,ir(this.ctx),this.current.minMax),this[t](e,i),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,a=!0){const s=this.ctx,i=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof i=="object"&&i?.getPattern){const o=i.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=i.getPattern(s,this,Ks(s),Kr.STROKE,e),o){const c=new Path2D;c.addPath(t,s.getTransform().invertSelf().multiplySelf(o)),t=c}this.rescaleAndStroke(t,!1),s.restore()}else this.rescaleAndStroke(t,!0);this.dependencyTracker?.recordDependencies(e,fs.stroke),a&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(Kr.STROKE,ir(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,a=!0){const s=this.ctx,i=this.current.fillColor,o=this.current.patternFill;let c=!1;if(o){const d=i.isModifyingCurrentTransform()?s.getTransform():null;if(this.dependencyTracker?.save(e),s.save(),s.fillStyle=i.getPattern(s,this,Ks(s),Kr.FILL,e),d){const f=new Path2D;f.addPath(t,s.getTransform().invertSelf().multiplySelf(d)),t=f}c=!0}const u=this.current.getClippedPathBoundingBox();this.contentVisible&&u!==null&&(this.pendingEOFill?(s.fill(t,"evenodd"),this.pendingEOFill=!1):s.fill(t)),this.dependencyTracker?.recordDependencies(e,fs.fill),c&&(s.restore(),this.dependencyTracker?.restore(e)),a&&this.consumePath(e,t,u)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){this.ctx.fill(t),this.dependencyTracker?.recordDependencies(e,fs.rawFillPath).recordOperation(e)}clip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=ZB}eoClip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=iw}beginText(e){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,a=this.ctx;if(this.dependencyTracker){const{dependencyTracker:s}=this;t!==void 0&&s.recordFutureForcedDependency("textClip",s.getOpenMarker()).recordFutureForcedDependency("textClip",e),s.recordCloseMarker(e)}if(t!==void 0){const s=new Path2D,i=a.getTransform().invertSelf();for(const{transform:o,x:c,y:u,fontSize:d,path:f}of t)f&&s.addPath(f,new DOMMatrix(o).preMultiplySelf(i).translate(c,u).scale(d,-d));a.clip(s)}delete this.pendingTextPaths}setCharSpacing(e,t){this.dependencyTracker?.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){this.dependencyTracker?.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){this.dependencyTracker?.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){this.dependencyTracker?.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,a){this.dependencyTracker?.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const s=this.commonObjs.get(t),i=this.current;if(!s)throw new Error(`Can't find font for ${t}`);if(i.fontMatrix=s.fontMatrix||Gg,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&Ze("Invalid font matrix for font "+t),a<0?(a=-a,i.fontDirection=-1):i.fontDirection=1,this.current.font=s,this.current.fontSize=a,s.isType3Font)return;const o=s.loadedName||"sans-serif",c=s.systemFontInfo?.css||`"${o}", ${s.fallbackName}`;let u="normal";s.black?u="900":s.bold&&(u="bold");const d=s.italic?"italic":"normal";let f=a;a<Zb?f=Zb:a>ew&&(f=ew),this.current.fontSizeScale=a/f,this.ctx.font=`${d} ${u} ${f}px ${c}`}setTextRenderingMode(e,t){this.dependencyTracker?.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){this.dependencyTracker?.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,a){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=a}setLeadingMoveText(e,t,a){this.setLeading(e,-a),this.moveText(e,t,a)}setTextMatrix(e,t){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:a}=this;a.textMatrix=t,a.textMatrixScale=Math.hypot(t[0],t[1]),a.x=a.lineX=0,a.y=a.lineY=0}nextLine(e){this.moveText(e,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}#a(e,t,a){const s=new Path2D;return s.addPath(e,new DOMMatrix(a).invertSelf().multiplySelf(t)),s}paintChar(e,t,a,s,i,o){const c=this.ctx,u=this.current,d=u.font,f=u.textRenderingMode,g=u.fontSize/u.fontSizeScale,v=f&Dr.FILL_STROKE_MASK,x=!!(f&Dr.ADD_TO_PATH_FLAG),y=u.patternFill&&!d.missingFile,_=u.patternStroke&&!d.missingFile;let w;if((d.disableFontFace||x||y||_)&&!d.missingFile&&(w=d.getPathGenerator(this.commonObjs,t)),w&&(d.disableFontFace||y||_)){c.save(),c.translate(a,s),c.scale(g,-g),this.dependencyTracker?.recordCharacterBBox(e,c,d);let A;if(v===Dr.FILL||v===Dr.FILL_STROKE)if(i){A=c.getTransform(),c.setTransform(...i);const T=this.#a(w,A,i);c.fill(T)}else c.fill(w);if(v===Dr.STROKE||v===Dr.FILL_STROKE)if(o){A||=c.getTransform(),c.setTransform(...o);const{a:T,b:S,c:N,d:R}=A,O=Le.inverseTransform(o),C=Le.transform([T,S,N,R,0,0],O);Le.singularValueDecompose2dScale(C,Va),c.lineWidth*=Math.max(Va[0],Va[1])/g,c.stroke(this.#a(w,A,o))}else c.lineWidth/=g,c.stroke(w);c.restore()}else(v===Dr.FILL||v===Dr.FILL_STROKE)&&(c.fillText(t,a,s),this.dependencyTracker?.recordCharacterBBox(e,c,d,g,a,s,()=>c.measureText(t))),(v===Dr.STROKE||v===Dr.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(e,c,d,g,a,s,()=>c.measureText(t)).recordDependencies(e,fs.stroke),c.strokeText(t,a,s));x&&((this.pendingTextPaths||=[]).push({transform:ir(c),x:a,y:s,fontSize:g,path:w}),this.dependencyTracker?.recordCharacterBBox(e,c,d,g,a,s))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let a=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){a=!0;break}return et(this,"isFontSubpixelAAEnabled",a)}showText(e,t){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,fs.showText).resetBBox(e),this.current.textRenderingMode&Dr.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const a=this.current,s=a.font;if(s.isType3Font){this.showType3Text(e,t),this.dependencyTracker?.recordShowTextOperation(e);return}const i=a.fontSize;if(i===0){this.dependencyTracker?.recordOperation(e);return}const o=this.ctx,c=a.fontSizeScale,u=a.charSpacing,d=a.wordSpacing,f=a.fontDirection,g=a.textHScale*f,v=t.length,x=s.vertical,y=x?1:-1,_=s.defaultVMetrics,w=i*a.fontMatrix[0],A=a.textRenderingMode===Dr.FILL&&!s.disableFontFace&&!a.patternFill;o.save(),a.textMatrix&&o.transform(...a.textMatrix),o.translate(a.x,a.y+a.textRise),f>0?o.scale(g,-1):o.scale(g,1);let T,S;const N=a.textRenderingMode&Dr.FILL_STROKE_MASK,R=N===Dr.FILL||N===Dr.FILL_STROKE,O=N===Dr.STROKE||N===Dr.FILL_STROKE;if(R&&a.patternFill){o.save();const H=a.fillColor.getPattern(o,this,Ks(o),Kr.FILL,e);T=ir(o),o.restore(),o.fillStyle=H}if(O&&a.patternStroke){o.save();const H=a.strokeColor.getPattern(o,this,Ks(o),Kr.STROKE,e);S=ir(o),o.restore(),o.strokeStyle=H}let C=a.lineWidth;const j=a.textMatrixScale;if(j===0||C===0?O&&(C=this.getSinglePixelWidth()):C/=j,c!==1&&(o.scale(c,c),C/=c),o.lineWidth=C,s.isInvalidPDFjsFont){const H=[];let D=0;for(const ne of t)H.push(ne.unicode),D+=ne.width;const z=H.join("");if(o.fillText(z,0,0),this.dependencyTracker!==null){const ne=o.measureText(z);this.dependencyTracker.recordBBox(e,this.ctx,-ne.actualBoundingBoxLeft,ne.actualBoundingBoxRight,-ne.actualBoundingBoxAscent,ne.actualBoundingBoxDescent).recordShowTextOperation(e)}a.x+=D*w*g,o.restore(),this.compose();return}let I=0,W;for(W=0;W<v;++W){const H=t[W];if(typeof H=="number"){I+=y*H*i/1e3;continue}let D=!1;const z=(H.isSpace?d:0)+u,ne=H.fontChar,re=H.accent;let U,te,be=H.width;if(x){const q=H.vmetric||_,F=-(H.vmetric?q[1]:be*.5)*w,J=q[2]*w;be=q?-q[0]:be,U=F/c,te=(I+J)/c}else U=I/c,te=0;let se;if(s.remeasure&&be>0){se=o.measureText(ne);const q=se.width*1e3/i*c;if(be<q&&this.isFontSubpixelAAEnabled){const F=be/q;D=!0,o.save(),o.scale(F,1),U/=F}else be!==q&&(U+=(be-q)/2e3*i/c)}if(this.contentVisible&&(H.isInFont||s.missingFile)){if(A&&!re)o.fillText(ne,U,te),this.dependencyTracker?.recordCharacterBBox(e,o,se?{bbox:null}:s,i/c,U,te,()=>se??o.measureText(ne));else if(this.paintChar(e,ne,U,te,T,S),re){const q=U+i*re.offset.x/c,F=te-i*re.offset.y/c;this.paintChar(e,re.fontChar,q,F,T,S)}}const ke=x?be*w-z*f:be*w+z*f;I+=ke,D&&o.restore()}x?a.y-=I:a.x+=I*g,o.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(e)}showType3Text(e,t){const a=this.ctx,s=this.current,i=s.font,o=s.fontSize,c=s.fontDirection,u=i.vertical?1:-1,d=s.charSpacing,f=s.wordSpacing,g=s.textHScale*c,v=s.fontMatrix||Gg,x=t.length,y=s.textRenderingMode===Dr.INVISIBLE;let _,w,A,T;if(y||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,a.save(),s.textMatrix&&a.transform(...s.textMatrix),a.translate(s.x,s.y+s.textRise),a.scale(g,c);const S=this.dependencyTracker;for(this.dependencyTracker=S?new of(S,e):null,_=0;_<x;++_){if(w=t[_],typeof w=="number"){T=u*w*o/1e3,this.ctx.translate(T,0),s.x+=T*g;continue}const N=(w.isSpace?f:0)+d,R=i.charProcOperatorList[w.operatorListId];R?this.contentVisible&&(this.save(),a.scale(o,o),a.transform(...v),this.executeOperatorList(R),this.restore()):Ze(`Type3 character "${w.operatorListId}" is not available.`);const O=[w.width,0];Le.applyTransform(O,v),A=O[0]*o+N,a.translate(A,0),s.x+=A*g}a.restore(),S&&(this.dependencyTracker=S)}setCharWidth(e,t,a){}setCharWidthAndBounds(e,t,a,s,i,o,c){const u=new Path2D;u.rect(s,i,o-s,c-i),this.ctx.clip(u),this.dependencyTracker?.recordBBox(e,this.ctx,s,o,i,c).recordClipBox(e,this.ctx,s,o,i,c),this.endPath(e)}getColorN_Pattern(e,t){let a;if(t[0]==="TilingPattern"){const s=this.baseTransform||ir(this.ctx),i={createCanvasGraphics:(o,c)=>new Ml(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new of(this.dependencyTracker,c,!0):null)};a=new Zm(t,this.ctx,i,s)}else a=this._getPattern(e,t[1],t[2]);return a}setStrokeColorN(e,...t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,a=null){let s;return this.cachedPatterns.has(t)?s=this.cachedPatterns.get(t):(s=qB(this.getObject(e,t)),this.cachedPatterns.set(t,s)),a&&(s.matrix=a),s}shadingFill(e,t){if(!this.contentVisible)return;const a=this.ctx;this.save(e);const s=this._getPattern(e,t);a.fillStyle=s.getPattern(a,this,Ks(a),Kr.SHADING,e);const i=Ks(a);if(i){const{width:o,height:c}=a.canvas,u=Tl.slice();Le.axialAlignedBoundingBox([0,0,o,c],i,u);const[d,f,g,v]=u;this.ctx.fillRect(d,f,g-d,v-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,fs.transform).recordDependencies(e,fs.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){Pt("Should not call beginInlineImage")}beginImageData(){Pt("Should not call beginImageData")}paintFormXObjectBegin(e,t,a){if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=ir(this.ctx),a)){Le.axialAlignedBoundingBox(a,this.baseTransform,this.current.minMax);const[s,i,o,c]=a,u=new Path2D;u.rect(s,i,o-s,c-i),this.ctx.clip(u),this.dependencyTracker?.recordClipBox(e,this.ctx,s,o,i,c),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const a=this.ctx;t.isolated||bf("TODO: Support non-isolated groups."),t.knockout&&Ze("Knockout groups not supported.");const s=ir(a);if(t.matrix&&a.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=Tl.slice();Le.axialAlignedBoundingBox(t.bbox,ir(a),i);const o=[0,0,a.canvas.width,a.canvas.height];i=Le.intersect(i,o)||[0,0,0,0];const c=Math.floor(i[0]),u=Math.floor(i[1]),d=Math.max(Math.ceil(i[2])-c,1),f=Math.max(Math.ceil(i[3])-u,1);this.current.startNewPathAndClipBox([0,0,d,f]);let g="groupAt"+this.groupLevel;t.smask&&(g+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(g,d,f),x=v.context;x.translate(-c,-u),x.transform(...s);let y=new Path2D;const[_,w,A,T]=t.bbox;if(y.rect(_,w,A-_,T-w),t.matrix){const S=new Path2D;S.addPath(y,new DOMMatrix(t.matrix)),y=S}x.clip(y),t.smask&&this.smaskStack.push({canvas:v.canvas,context:x,offsetX:c,offsetY:u,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(a.setTransform(1,0,0,1,0,0),a.translate(c,u),a.save()),zc(a,x),this.ctx=x,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(a),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(a),this.groupLevel++}endGroup(e,t){if(!this.contentVisible)return;this.groupLevel--;const a=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const i=ir(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...i);const o=Tl.slice();Le.axialAlignedBoundingBox([0,0,a.canvas.width,a.canvas.height],i,o),this.ctx.drawImage(a.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(e,t,a,s,i,o){if(this.#e(),Md(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),a){const c=a[2]-a[0],u=a[3]-a[1];if(o&&this.annotationCanvasMap){s=s.slice(),s[4]-=a[0],s[5]-=a[1],a=a.slice(),a[0]=a[1]=0,a[2]=c,a[3]=u,Le.singularValueDecompose2dScale(ir(this.ctx),Va);const{viewportScale:d}=this,f=Math.ceil(c*this.outputScaleX*d),g=Math.ceil(u*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(f,g);const{canvas:v,context:x}=this.annotationCanvas;this.annotationCanvasMap.set(t,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=x,this.ctx.save(),this.ctx.setTransform(Va[0],0,0,-Va[1],0,u*Va[1]),Md(this.ctx)}else{Md(this.ctx),this.endPath(e);const d=new Path2D;d.rect(a[0],a[1],c,u),this.ctx.clip(d)}}this.current=new rw(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...s),this.transform(e,...i)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){if(!this.contentVisible)return;const a=t.count;t=this.getObject(e,t.data,t),t.count=a;const s=this.ctx,i=this._createMaskCanvas(e,t),o=i.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(o,i.offsetX,i.offsetY),this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,i.offsetX,i.offsetX+o.width,i.offsetY,i.offsetY+o.height).recordOperation(e),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,a,s=0,i=0,o,c){if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const u=this.ctx;u.save();const d=ir(u);u.transform(a,s,i,o,0,0);const f=this._createMaskCanvas(e,t);u.setTransform(1,0,0,1,f.offsetX-d[4],f.offsetY-d[5]),this.dependencyTracker?.resetBBox(e);for(let g=0,v=c.length;g<v;g+=2){const x=Le.transform(d,[a,s,i,o,c[g],c[g+1]]);u.drawImage(f.canvas,x[4],x[5]),this.dependencyTracker?.recordBBox(e,this.ctx,x[4],x[4]+f.canvas.width,x[5],x[5]+f.canvas.height)}u.restore(),this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageMaskXObjectGroup(e,t){if(!this.contentVisible)return;const a=this.ctx,s=this.current.fillColor,i=this.current.patternFill;this.dependencyTracker?.resetBBox(e).recordDependencies(e,fs.transformAndFill);for(const o of t){const{data:c,width:u,height:d,transform:f}=o,g=this.cachedCanvases.getCanvas("maskCanvas",u,d),v=g.context;v.save();const x=this.getObject(e,c,o);sw(v,x),v.globalCompositeOperation="source-in",v.fillStyle=i?s.getPattern(v,this,Ks(a),Kr.FILL,e):s,v.fillRect(0,0,u,d),v.restore(),a.save(),a.transform(...f),a.scale(1,-1),Fd(a,g.canvas,0,0,u,d,0,-1,1,1),this.dependencyTracker?.recordBBox(e,a,0,u,0,d),a.restore()}this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const a=this.getObject(e,t);if(!a){Ze("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,a)}paintImageXObjectRepeat(e,t,a,s,i){if(!this.contentVisible)return;const o=this.getObject(e,t);if(!o){Ze("Dependent image isn't ready yet");return}const c=o.width,u=o.height,d=[];for(let f=0,g=i.length;f<g;f+=2)d.push({transform:[a,0,0,s,i[f],i[f+1]],x:0,y:0,w:c,h:u});this.paintInlineImageXObjectGroup(e,o,d)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:a,height:s}=e,i=this.cachedCanvases.getCanvas("inlineImage",a,s),o=i.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",i.canvas}paintInlineImageXObject(e,t){if(!this.contentVisible)return;const a=t.width,s=t.height,i=this.ctx;this.save(e);const{filter:o}=i;o!=="none"&&o!==""&&(i.filter="none"),i.scale(1/a,-1/s);let c;if(t.bitmap)c=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)c=t;else{const f=this.cachedCanvases.getCanvas("inlineImage",a,s).context;aw(f,t),c=this.applyTransferMapsToCanvas(f)}const u=this._scaleImage(c,Ks(i));i.imageSmoothingEnabled=nw(ir(i),t.interpolate),this.dependencyTracker?.resetBBox(e).recordBBox(e,i,0,a,-s,0).recordDependencies(e,fs.imageXObject).recordOperation(e),Fd(i,u.img,0,0,u.paintWidth,u.paintHeight,0,-s,a,s),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,a){if(!this.contentVisible)return;const s=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const o=t.width,c=t.height,d=this.cachedCanvases.getCanvas("inlineImage",o,c).context;aw(d,t),i=this.applyTransferMapsToCanvas(d)}this.dependencyTracker?.resetBBox(e);for(const o of a)s.save(),s.transform(...o.transform),s.scale(1,-1),Fd(s,i,o.x,o.y,o.w,o.h,0,-1,1,1),this.dependencyTracker?.recordBBox(e,s,0,1,-1,0),s.restore();this.dependencyTracker?.recordOperation(e),this.compose()}paintSolidColorImageMask(e){this.contentVisible&&(this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,fs.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,a){}beginMarkedContent(e,t){this.dependencyTracker?.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,a){this.dependencyTracker?.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(a)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){this.dependencyTracker?.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,a){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(a);const i=this.ctx;this.pendingClip?(s||(this.pendingClip===iw?i.clip(t,"evenodd"):i.clip(t)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):this.dependencyTracker?.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=ir(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),a=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(a,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:a,c:s,d:i}=this.ctx.getTransform();let o,c;if(a===0&&s===0){const u=Math.abs(t),d=Math.abs(i);if(u===d)if(e===0)o=c=1/u;else{const f=u*e;o=c=f<1?1/f:1}else if(e===0)o=1/u,c=1/d;else{const f=u*e,g=d*e;o=f<1?1/f:1,c=g<1?1/g:1}}else{const u=Math.abs(t*i-a*s),d=Math.hypot(t,a),f=Math.hypot(s,i);if(e===0)o=f/u,c=d/u;else{const g=e*u;o=f>g?f/g:1,c=d>g?d/g:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:a,current:{lineWidth:s}}=this,[i,o]=this.getScaleForStroking();if(i===o){a.lineWidth=(s||1)*i,a.stroke(e);return}const c=a.getLineDash();t&&a.save(),a.scale(i,o),mg.a=1/i,mg.d=1/o;const u=new Path2D;if(u.addPath(e,mg),c.length>0){const d=Math.max(i,o);a.setLineDash(c.map(f=>f/d)),a.lineDashOffset/=d}a.lineWidth=s||1,a.stroke(u),t&&a.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const r in Nu)Ml.prototype[r]!==void 0&&(Ml.prototype[Nu[r]]=Ml.prototype[r]);class no{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class e5{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}[Symbol.iterator](){return this.#e.entries()}}const bl=Symbol("INTERNAL");class t5{#e=!1;#t=!1;#a=!1;#r=!0;constructor(e,{name:t,intent:a,usage:s,rbGroups:i}){this.#e=!!(e&$a.DISPLAY),this.#t=!!(e&$a.PRINT),this.name=t,this.intent=a,this.usage=s,this.rbGroups=i}get visible(){if(this.#a)return this.#r;if(!this.#r)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,a=!1){e!==bl&&Pt("Internal method `_setVisible` called."),this.#a=a,this.#r=t}}class r5{#e=null;#t=new Map;#a=null;#r=null;constructor(e,t=$a.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#r=e.order;for(const a of e.groups)this.#t.set(a.id,new t5(t,a));if(e.baseState==="OFF")for(const a of this.#t.values())a._setVisible(bl,!1);for(const a of e.on)this.#t.get(a)._setVisible(bl,!0);for(const a of e.off)this.#t.get(a)._setVisible(bl,!1);this.#a=this.getHash()}}#i(e){const t=e.length;if(t<2)return!0;const a=e[0];for(let s=1;s<t;s++){const i=e[s];let o;if(Array.isArray(i))o=this.#i(i);else if(this.#t.has(i))o=this.#t.get(i).visible;else return Ze(`Optional content group not found: ${i}`),!0;switch(a){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return a==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return bf("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(Ze(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#i(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return Ze(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return Ze(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return Ze(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return Ze(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return Ze(`Unknown optional content policy ${e.policy}.`),!0}return Ze(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,a=!0){const s=this.#t.get(e);if(!s){Ze(`Optional content group not found: ${e}`);return}if(a&&t&&s.rbGroups.length)for(const i of s.rbGroups)for(const o of i)o!==e&&this.#t.get(o)?._setVisible(bl,!1,!0);s._setVisible(bl,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let a;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":a=s;continue}const i=this.#t.get(s);if(i)switch(a){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!i.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#a===null||this.getHash()===this.#a}getOrder(){return this.#t.size?this.#r?this.#r.slice():[...this.#t.keys()]:null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new zA;for(const[t,a]of this.#t)e.update(`${t}:${a.visible}`);return this.#e=e.hexdigest()}[Symbol.iterator](){return this.#t.entries()}}class a5{constructor(e,{disableRange:t=!1,disableStream:a=!1}){mt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:i,progressiveDone:o,contentDispositionFilename:c}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=c,i?.length>0){const u=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(u)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!a,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((u,d)=>{this._onReceiveData({begin:u,chunk:d})}),e.addProgressListener((u,d)=>{this._onProgress({loaded:u,total:d})}),e.addProgressiveReadListener(u=>{this._onReceiveData({chunk:u})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const a=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(a):this._queuedChunks.push(a);else{const s=this._rangeReaders.some(function(i){return i._begin!==e?!1:(i._enqueue(a),!0)});mt(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){mt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new s5(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const a=new n5(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(a),a}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class s5{constructor(e,t,a=!1,s=null){this._stream=e,this._done=a||!1,this._filename=Wm(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class n5{constructor(e,t,a){this._stream=e,this._begin=t,this._end=a,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const a of this._requests)a.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function i5(r){let e=!0,t=a("filename\\*","i").exec(r);if(t){t=t[1];let f=c(t);return f=unescape(f),f=u(f),f=d(f),i(f)}if(t=o(r),t){const f=d(t);return i(f)}if(t=a("filename","i").exec(r),t){t=t[1];let f=c(t);return f=d(f),i(f)}function a(f,g){return new RegExp("(?:^|;)\\s*"+f+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function s(f,g){if(f){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const v=new TextDecoder(f,{fatal:!0}),x=Vu(g);g=v.decode(x),e=!1}catch{}}return g}function i(f){return e&&/[\x80-\xff]/.test(f)&&(f=s("utf-8",f),e&&(f=s("iso-8859-1",f))),f}function o(f){const g=[];let v;const x=a("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=x.exec(f))!==null;){let[,_,w,A]=v;if(_=parseInt(_,10),_ in g){if(_===0)break;continue}g[_]=[w,A]}const y=[];for(let _=0;_<g.length&&_ in g;++_){let[w,A]=g[_];A=c(A),w&&(A=unescape(A),_===0&&(A=u(A))),y.push(A)}return y.join("")}function c(f){if(f.startsWith('"')){const g=f.slice(1).split('\\"');for(let v=0;v<g.length;++v){const x=g[v].indexOf('"');x!==-1&&(g[v]=g[v].slice(0,x),g.length=v+1),g[v]=g[v].replaceAll(/\\(.)/g,"$1")}f=g.join('"')}return f}function u(f){const g=f.indexOf("'");if(g===-1)return f;const v=f.slice(0,g),y=f.slice(g+1).replace(/^[^']*'/,"");return s(v,y)}function d(f){return!f.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(f)?f:f.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,v,x,y){if(x==="q"||x==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(_,w){return String.fromCharCode(parseInt(w,16))}),s(v,y);try{y=atob(y)}catch{}return s(v,y)})}return""}function XA(r,e){const t=new Headers;if(!r||!e||typeof e!="object")return t;for(const a in e){const s=e[a];s!==void 0&&t.append(a,s)}return t}function Af(r){return URL.parse(r)?.origin??null}function YA({responseHeaders:r,isHttp:e,rangeChunkSize:t,disableRange:a}){const s={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(r.get("Content-Length"),10);return!Number.isInteger(i)||(s.suggestedLength=i,i<=2*t)||a||!e||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function KA(r){const e=r.get("Content-Disposition");if(e){let t=i5(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Wm(t))return t}return null}function Ku(r,e){return new nf(`Unexpected server response (${r}) while retrieving PDF "${e}".`,r,r===404||r===0&&e.startsWith("file:"))}function JA(r){return r===200||r===206}function QA(r,e,t){return{method:"GET",headers:r,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function ZA(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(Ze(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class o5{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=XA(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return mt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new l5(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const a=new c5(this,e,t);return this._rangeRequestReaders.push(a),a}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class l5{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const a=new Headers(e.headers),s=t.url;fetch(s,QA(a,this._withCredentials,this._abortController)).then(i=>{if(e._responseOrigin=Af(i.url),!JA(i.status))throw Ku(i.status,s);this._reader=i.body.getReader(),this._headersCapability.resolve();const o=i.headers,{allowRangeRequests:c,suggestedLength:u}=YA({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=u||this._contentLength,this._filename=KA(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new yi("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:ZA(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class c5{constructor(e,t,a){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const i=new Headers(e.headers);i.append("Range",`bytes=${t}-${a-1}`);const o=s.url;fetch(o,QA(i,this._withCredentials,this._abortController)).then(c=>{const u=Af(c.url);if(u!==e._responseOrigin)throw new Error(`Expected range response-origin "${u}" to match "${e._responseOrigin}".`);if(!JA(c.status))throw Ku(c.status,o);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:ZA(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const vg=200,xg=206;function u5(r){const e=r.response;return typeof e!="string"?e:Vu(e).buffer}class h5{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:a}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=XA(this.isHttp,t),this.withCredentials=a||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,a=this.currXhrId++,s=this.pendingRequests[a]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[i,o]of this.headers)t.setRequestHeader(i,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=xg):s.expectedStatus=vg,t.responseType="arraybuffer",mt(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,a),t.onprogress=this.onProgress.bind(this,a),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),a}onProgress(e,t){const a=this.pendingRequests[e];a&&a.onProgress?.(t)}onStateChange(e,t){const a=this.pendingRequests[e];if(!a)return;const s=a.xhr;if(s.readyState>=2&&a.onHeadersReceived&&(a.onHeadersReceived(),delete a.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){a.onError(s.status);return}const i=s.status||vg;if(!(i===vg&&a.expectedStatus===xg)&&i!==a.expectedStatus){a.onError(s.status);return}const c=u5(s);if(i===xg){const u=s.getResponseHeader("Content-Range"),d=/bytes (\d+)-(\d+)\/(\d+)/.exec(u);d?a.onDone({begin:parseInt(d[1],10),chunk:c}):(Ze('Missing or invalid "Content-Range" header.'),a.onError(0))}else c?a.onDone({begin:0,chunk:c}):a.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class d5{constructor(e){this._source=e,this._manager=new h5(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return mt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new f5(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const a=new p5(this._manager,e,t);return a.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(a),a}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class f5{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Af(t.responseURL);const a=t.getAllResponseHeaders(),s=new Headers(a?a.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[u,...d]=c.split(": ");return[u,d.join(": ")]}):[]),{allowRangeRequests:i,suggestedLength:o}=YA({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=KA(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Ku(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class p5{constructor(e,t,a){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:a,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=Af(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const a of this._requests)a.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=Ku(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const g5=/^[a-z][a-z0-9\-+.]+:/i;function m5(r){if(g5.test(r))return new URL(r);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(r))}class v5{constructor(e){this.source=e,this.url=m5(e.url),mt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return mt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new x5(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const a=new _5(this,e,t);return this._rangeRequestReaders.push(a),a}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class x5{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const a=process.getBuiltinModule("fs");a.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(a.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=Ku(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new yi("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class _5{constructor(e,t,a){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:a-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Hc=Symbol("INITIAL_DATA");class e2{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:Hc}}get(e,t=null){if(t){const s=this.#t(e);return s.promise.then(()=>t(s.data)),null}const a=this.#e[e];if(!a||a.data===Hc)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return a.data}has(e){const t=this.#e[e];return!!t&&t.data!==Hc}delete(e){const t=this.#e[e];return!t||t.data===Hc?!1:(delete this.#e[e],!0)}resolve(e,t=null){const a=this.#t(e);a.data=t,a.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==Hc&&(yield[e,t])}}}const y5=1e5,ow=30;class Ga{#e=Promise.withResolvers();#t=null;#a=!1;#r=!!globalThis.FontInspector?.enabled;#i=null;#n=null;#s=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#m=[];#g=null;#u=[];#p=new WeakMap;#v=null;static#_=new Map;static#x=new Map;static#S=new WeakMap;static#E=null;static#b=new Set;constructor({textContentSource:e,container:t,viewport:a}){if(e instanceof ReadableStream)this.#g=e;else if(typeof e=="object")this.#g=new ReadableStream({start(u){u.enqueue(e),u.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#l=t,this.#h=a.scale*rn.pixelRatio,this.#d=a.rotation,this.#n={div:null,properties:null,ctx:null};const{pageWidth:s,pageHeight:i,pageX:o,pageY:c}=a.rawDims;this.#v=[1,0,0,-1,-o,c+i],this.#o=s,this.#s=i,Ga.#N(),t.style.setProperty("--min-font-size",Ga.#E),co(t,a),this.#e.promise.finally(()=>{Ga.#b.delete(this),this.#n=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=jr.platform;return et(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#c.read().then(({value:t,done:a})=>{if(a){this.#e.resolve();return}this.#i??=t.lang,Object.assign(this.#f,t.styles),this.#C(t.items),e()},this.#e.reject)};return this.#c=this.#g.getReader(),Ga.#b.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const a=e.scale*rn.pixelRatio,s=e.rotation;if(s!==this.#d&&(t?.(),this.#d=s,co(this.#l,{rotation:s})),a!==this.#h){t?.(),this.#h=a;const i={div:null,properties:null,ctx:Ga.#R(this.#i)};for(const o of this.#u)i.properties=this.#p.get(o),i.div=o,this.#A(i)}}cancel(){const e=new yi("TextLayer task cancelled.");this.#c?.cancel(e).catch(()=>{}),this.#c=null,this.#e.reject(e)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#m}#C(e){if(this.#a)return;this.#n.ctx??=Ga.#R(this.#i);const t=this.#u,a=this.#m;for(const s of e){if(t.length>y5){Ze("Ignoring additional textDivs for performance reasons."),this.#a=!0;return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const i=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),s.id&&this.#t.setAttribute("id",`${s.id}`),i.append(this.#t)}else s.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}a.push(s.str),this.#y(s)}}#y(e){const t=document.createElement("span"),a={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#u.push(t);const s=Le.transform(this.#v,e.transform);let i=Math.atan2(s[1],s[0]);const o=this.#f[e.fontName];o.vertical&&(i+=Math.PI/2);let c=this.#r&&o.fontSubstitution||o.fontFamily;c=Ga.fontFamilyMap.get(c)||c;const u=Math.hypot(s[2],s[3]),d=u*Ga.#j(c,o,this.#i);let f,g;i===0?(f=s[4],g=s[5]-d):(f=s[4]+d*Math.sin(i),g=s[5]-d*Math.cos(i));const v=t.style;v.left=`${(100*f/this.#o).toFixed(2)}%`,v.top=`${(100*g/this.#s).toFixed(2)}%`,v.setProperty("--font-height",`${u.toFixed(2)}px`),v.fontFamily=c,a.fontSize=u,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#r&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),i!==0&&(a.angle=i*(180/Math.PI));let x=!1;if(e.str.length>1)x=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const y=Math.abs(e.transform[0]),_=Math.abs(e.transform[3]);y!==_&&Math.max(y,_)/Math.min(y,_)>1.5&&(x=!0)}if(x&&(a.canvasWidth=o.vertical?e.height:e.width),this.#p.set(t,a),this.#n.div=t,this.#n.properties=a,this.#A(this.#n),a.hasText&&this.#t.append(t),a.hasEOL){const y=document.createElement("br");y.setAttribute("role","presentation"),this.#t.append(y)}}#A(e){const{div:t,properties:a,ctx:s}=e,{style:i}=t;if(a.canvasWidth!==0&&a.hasText){const{fontFamily:o}=i,{canvasWidth:c,fontSize:u}=a;Ga.#k(s,u*this.#h,o);const{width:d}=s.measureText(t.textContent);d>0&&i.setProperty("--scale-x",c*this.#h/d)}a.angle!==0&&i.setProperty("--rotate",`${a.angle}deg`)}static cleanup(){if(!(this.#b.size>0)){this.#_.clear();for(const{canvas:e}of this.#x.values())e.remove();this.#x.clear()}}static#R(e=null){let t=this.#x.get(e||="");if(!t){const a=document.createElement("canvas");a.className="hiddenCanvasElement",a.lang=e,document.body.append(a),t=a.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#x.set(e,t),this.#S.set(t,{size:0,family:""})}return t}static#k(e,t,a){const s=this.#S.get(e);t===s.size&&a===s.family||(e.font=`${t}px ${a}`,s.size=t,s.family=a)}static#N(){if(this.#E!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#E=e.getBoundingClientRect().height,e.remove()}static#j(e,t,a){const s=this.#_.get(e);if(s)return s;const i=this.#R(a);i.canvas.width=i.canvas.height=ow,this.#k(i,ow,e);const o=i.measureText(""),c=o.fontBoundingBoxAscent,u=Math.abs(o.fontBoundingBoxDescent);i.canvas.width=i.canvas.height=0;let d=.8;return c?d=c/(c+u):(jr.platform.isFirefox&&Ze("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?d=t.ascent:t.descent&&(d=1+t.descent)),this.#_.set(e,d),d}}const b5=100;function ev(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});const e=new tv,{docId:t}=e,a=r.url?kB(r.url):null,s=r.data?NB(r.data):null,i=r.httpHeaders||null,o=r.withCredentials===!0,c=r.password??null,u=r.range instanceof t2?r.range:null,d=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:2**16;let f=r.worker instanceof Ou?r.worker:null;const g=r.verbosity,v=typeof r.docBaseUrl=="string"&&!wf(r.docBaseUrl)?r.docBaseUrl:null,x=Nd(r.cMapUrl),y=r.cMapPacked!==!1,_=r.CMapReaderFactory||(ha?jB:Wb),w=Nd(r.iccUrl),A=Nd(r.standardFontDataUrl),T=r.StandardFontDataFactory||(ha?PB:Xb),S=Nd(r.wasmUrl),N=r.WasmFactory||(ha?BB:Yb),R=r.stopAtErrors!==!0,O=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,C=r.isEvalSupported!==!1,j=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!ha,I=typeof r.isImageDecoderSupported=="boolean"?r.isImageDecoderSupported:!ha&&(jr.platform.isFirefox||!globalThis.chrome),W=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,H=typeof r.disableFontFace=="boolean"?r.disableFontFace:ha,D=r.fontExtraProperties===!0,z=r.enableXfa===!0,ne=r.ownerDocument||globalThis.document,re=r.disableRange===!0,U=r.disableStream===!0,te=r.disableAutoFetch===!0,be=r.pdfBug===!0,se=r.CanvasFactory||(ha?IB:FB),ke=r.FilterFactory||(ha?LB:MB),q=r.enableHWA===!0,F=r.useWasm!==!1,J=u?u.length:r.length??NaN,K=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!ha&&!H,Y=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:!!(_===Wb&&T===Xb&&N===Yb&&x&&A&&S&&Kc(x,document.baseURI)&&Kc(A,document.baseURI)&&Kc(S,document.baseURI)),oe=null;tB(g);const ve={canvasFactory:new se({ownerDocument:ne,enableHWA:q}),filterFactory:new ke({docId:t,ownerDocument:ne}),cMapReaderFactory:Y?null:new _({baseUrl:x,isCompressed:y}),standardFontDataFactory:Y?null:new T({baseUrl:A}),wasmFactory:Y?null:new N({baseUrl:S})};f||(f=Ou.create({verbosity:g,port:no.workerPort}),e._worker=f);const Ne={docId:t,apiVersion:"5.4.530",data:s,password:c,disableAutoFetch:te,rangeChunkSize:d,length:J,docBaseUrl:v,enableXfa:z,evaluatorOptions:{maxImageSize:O,disableFontFace:H,ignoreErrors:R,isEvalSupported:C,isOffscreenCanvasSupported:j,isImageDecoderSupported:I,canvasMaxAreaInBytes:W,fontExtraProperties:D,useSystemFonts:K,useWasm:F,useWorkerFetch:Y,cMapUrl:x,iccUrl:w,standardFontDataUrl:A,wasmUrl:S}},Ee={ownerDocument:ne,pdfBug:be,styleElement:oe,loadingParams:{disableAutoFetch:te,enableXfa:z}};return f.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(f.destroyed)throw new Error("Worker was destroyed");const Ae=f.messageHandler.sendWithPromise("GetDocRequest",Ne,s?[s.buffer]:null);let rt;if(u)rt=new a5(u,{disableRange:re,disableStream:U});else if(!s){if(!a)throw new Error("getDocument - no `url` parameter provided.");const Z=Kc(a)?o5:ha?v5:d5;rt=new Z({url:a,length:J,httpHeaders:i,withCredentials:o,rangeChunkSize:d,disableRange:re,disableStream:U})}return Ae.then(Z=>{if(e.destroyed)throw new Error("Loading aborted");if(f.destroyed)throw new Error("Worker was destroyed");const Mt=new Jc(t,Z,f.port),at=new A5(Mt,e,rt,Ee,ve,q);e._transport=at,Mt.send("Ready",null)})}).catch(e._capability.reject),e}class tv{static#e=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${tv.#e++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class t2{#e=Promise.withResolvers();#t=[];#a=[];#r=[];#i=[];constructor(e,t,a=!1,s=null){this.length=e,this.initialData=t,this.progressiveDone=a,this.contentDispositionFilename=s}addRangeListener(e){this.#i.push(e)}addProgressListener(e){this.#r.push(e)}addProgressiveReadListener(e){this.#a.push(e)}addProgressiveDoneListener(e){this.#t.push(e)}onDataRange(e,t){for(const a of this.#i)a(e,t)}onDataProgress(e,t){this.#e.promise.then(()=>{for(const a of this.#r)a(e,t)})}onDataProgressiveRead(e){this.#e.promise.then(()=>{for(const t of this.#a)t(e)})}onDataProgressiveDone(){this.#e.promise.then(()=>{for(const e of this.#t)e()})}transportReady(){this.#e.resolve()}requestDataRange(e,t){Pt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class w5{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return et(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class E5{#e=!1;constructor(e,t,a,s=!1){this._pageIndex=e,this._pageInfo=t,this._transport=a,this._stats=s?new Ub:null,this._pdfBug=s,this.commonObjs=a.commonObjs,this.objs=new e2,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:a=0,offsetY:s=0,dontFlip:i=!1}={}){return new Wu({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:a,offsetY:s,dontFlip:i})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return et(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,canvas:t=e.canvas,viewport:a,intent:s="display",annotationMode:i=fi.ENABLE,transform:o=null,background:c=null,optionalContentConfigPromise:u=null,annotationCanvasMap:d=null,pageColors:f=null,printAnnotationStorage:g=null,isEditing:v=!1,recordOperations:x=!1,operationsFilter:y=null}){this._stats?.time("Overall");const _=this._transport.getRenderingIntent(s,i,g,v),{renderingIntent:w,cacheKey:A}=_;this.#e=!1,u||=this._transport.getOptionalContentConfig(w);let T=this._intentStates.get(A);T||(T=Object.create(null),this._intentStates.set(A,T)),T.streamReaderCancelTimeout&&(clearTimeout(T.streamReaderCancelTimeout),T.streamReaderCancelTimeout=null);const S=!!(w&$a.PRINT);T.displayReadyCapability||(T.displayReadyCapability=Promise.withResolvers(),T.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(_));const N=!!(this._pdfBug&&globalThis.StepperManager?.enabled),R=!this.recordedBBoxes&&(x||N),O=I=>{if(T.renderTasks.delete(C),R){const W=C.gfx?.dependencyTracker.take();W&&(C.stepper&&C.stepper.setOperatorBBoxes(W,C.gfx.dependencyTracker.takeDebugMetadata()),x&&(this.recordedBBoxes=W))}S&&(this.#e=!0),this.#t(),I?(C.capability.reject(I),this._abortOperatorList({intentState:T,reason:I instanceof Error?I:new Error(I)})):C.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},C=new Cl({callback:O,params:{canvas:t,canvasContext:e,dependencyTracker:R?new zB(t,T.operatorList.length,N):null,viewport:a,transform:o,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:d,operatorList:T.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!S,pdfBug:this._pdfBug,pageColors:f,enableHWA:this._transport.enableHWA,operationsFilter:y});(T.renderTasks||=new Set).add(C);const j=C.task;return Promise.all([T.displayReadyCapability.promise,u]).then(([I,W])=>{if(this.destroyed){O();return}if(this._stats?.time("Rendering"),!(W.renderingIntent&w))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");C.initializeGraphics({transparency:I,optionalContentConfig:W}),C.operatorListChanged()}).catch(O),j}getOperatorList({intent:e="display",annotationMode:t=fi.ENABLE,printAnnotationStorage:a=null,isEditing:s=!1}={}){function i(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(u))}const o=this._transport.getRenderingIntent(e,t,a,s,!0);let c=this._intentStates.get(o.cacheKey);c||(c=Object.create(null),this._intentStates.set(o.cacheKey,c));let u;return c.opListReadCapability||(u=Object.create(null),u.operatorListChanged=i,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||=new Set).add(u),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(a=>Ru.textContent(a));const t=this.streamTextContent(e);return new Promise(function(a,s){function i(){o.read().then(function({value:u,done:d}){if(d){a(c);return}c.lang??=u.lang,Object.assign(c.styles,u.styles),c.items.push(...u.items),i()},s)}const o=t.getReader(),c={items:[],styles:Object.create(null),lang:null};i()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const a of t.renderTasks)e.push(a.completed),a.cancel();return this.objs.clear(),this.#e=!1,Promise.all(e)}cleanup(e=!1){this.#e=!0;const t=this.#t();return e&&t&&(this._stats&&=new Ub),t}#t(){if(!this.#e||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}_startRenderPage(e,t){const a=this._intentStates.get(t);a&&(this._stats?.timeEnd("Page Request"),a.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let a=0,s=e.length;a<s;a++)t.operatorList.fnArray.push(e.fnArray[a]),t.operatorList.argsArray.push(e.argsArray[a]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const a of t.renderTasks)a.operatorListChanged();e.lastChunk&&this.#t()}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:a,modifiedIds:s}){const{map:i,transfer:o}=a,u=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:i,modifiedIds:s},o).getReader(),d=this._intentStates.get(t);d.streamReader=u;const f=()=>{u.read().then(({value:g,done:v})=>{if(v){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(g,d),f())},g=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(const v of d.renderTasks)v.operatorListChanged();this.#t()}if(d.displayReadyCapability)d.displayReadyCapability.reject(g);else if(d.opListReadCapability)d.opListReadCapability.reject(g);else throw g}})};f()}_abortOperatorList({intentState:e,reason:t,force:a=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!a){if(e.renderTasks.size>0)return;if(t instanceof qm){let s=b5;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new yi(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,i]of this._intentStates)if(i===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}var pi,Ms,Cn,eo,cf,to,ro,ma,zd,r2,a2,Qc,Ll,Hd;const tr=class tr{constructor({name:e=null,port:t=null,verbosity:a=rB()}={}){Ws(this,ma);Ws(this,pi,Promise.withResolvers());Ws(this,Ms,null);Ws(this,Cn,null);Ws(this,eo,null);if(this.name=e,this.destroyed=!1,this.verbosity=a,t){if(Qt(tr,ro).has(t))throw new Error("Cannot use more than one PDFWorker per port.");Qt(tr,ro).set(t,this),Xs(this,ma,r2).call(this,t)}else Xs(this,ma,a2).call(this)}get promise(){return Qt(this,pi).promise}get port(){return Qt(this,Cn)}get messageHandler(){return Qt(this,Ms)}destroy(){this.destroyed=!0,Qt(this,eo)?.terminate(),ka(this,eo,null),Qt(tr,ro).delete(Qt(this,Cn)),ka(this,Cn,null),Qt(this,Ms)?.destroy(),ka(this,Ms,null)}static create(e){const t=Qt(this,ro).get(e?.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new tr(e)}static get workerSrc(){if(no.workerSrc)return no.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return et(this,"_setupFakeWorkerGlobal",(async()=>Qt(this,Ll,Hd)?Qt(this,Ll,Hd):(await import(this.workerSrc)).WorkerMessageHandler)())}};pi=new WeakMap,Ms=new WeakMap,Cn=new WeakMap,eo=new WeakMap,cf=new WeakMap,to=new WeakMap,ro=new WeakMap,ma=new WeakSet,zd=function(){Qt(this,pi).resolve(),Qt(this,Ms).send("configure",{verbosity:this.verbosity})},r2=function(e){ka(this,Cn,e),ka(this,Ms,new Jc("main","worker",e)),Qt(this,Ms).on("ready",()=>{}),Xs(this,ma,zd).call(this)},a2=function(){if(Qt(tr,to)||Qt(tr,Ll,Hd)){Xs(this,ma,Qc).call(this);return}let{workerSrc:e}=tr;try{tr._isSameOrigin(window.location,e)||(e=tr._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),a=new Jc("main","worker",t),s=()=>{i.abort(),a.destroy(),t.terminate(),this.destroyed?Qt(this,pi).reject(new Error("Worker was destroyed")):Xs(this,ma,Qc).call(this)},i=new AbortController;t.addEventListener("error",()=>{Qt(this,eo)||s()},{signal:i.signal}),a.on("test",c=>{if(i.abort(),this.destroyed||!c){s();return}ka(this,Ms,a),ka(this,Cn,t),ka(this,eo,t),Xs(this,ma,zd).call(this)}),a.on("ready",c=>{if(i.abort(),this.destroyed){s();return}try{o()}catch{Xs(this,ma,Qc).call(this)}});const o=()=>{const c=new Uint8Array;a.send("test",c,[c.buffer])};o();return}catch{bf("The worker has been disabled.")}Xs(this,ma,Qc).call(this)},Qc=function(){Qt(tr,to)||(Ze("Setting up fake worker."),ka(tr,to,!0)),tr._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){Qt(this,pi).reject(new Error("Worker was destroyed"));return}const t=new DB;ka(this,Cn,t);const a=`fake${X_(tr,cf)._++}`,s=new Jc(a+"_worker",a,t);e.setup(s,t),ka(this,Ms,new Jc(a,a+"_worker",t)),Xs(this,ma,zd).call(this)}).catch(e=>{Qt(this,pi).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Ll=new WeakSet,Hd=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Ws(tr,Ll),Ws(tr,cf,0),Ws(tr,to,!1),Ws(tr,ro,new WeakMap),ha&&(ka(tr,to,!0),no.workerSrc||="./pdf.worker.mjs"),tr._isSameOrigin=(e,t)=>{const a=URL.parse(e);if(!a?.origin||a.origin==="null")return!1;const s=new URL(t,a);return a.origin===s.origin},tr._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},tr.fromPort=e=>{if(pB("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return tr.create(e)};let Ou=tr;class A5{#e=new Map;#t=new Map;#a=new Map;#r=new Map;#i=null;constructor(e,t,a,s,i,o){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new e2,this.fontLoader=new SB({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.wasmFactory=i.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=a,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=o,this.setupMessageHandler()}#n(e,t=null){const a=this.#e.get(e);if(a)return a;const s=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,s),s}get annotationStorage(){return et(this,"annotationStorage",new Km)}getRenderingIntent(e,t=fi.ENABLE,a=null,s=!1,i=!1){let o=$a.DISPLAY,c=Kg;switch(e){case"any":o=$a.ANY;break;case"display":break;case"print":o=$a.PRINT;break;default:Ze(`getRenderingIntent - invalid intent: ${e}`)}const u=o&$a.PRINT&&a instanceof HA?a:this.annotationStorage;switch(t){case fi.DISABLE:o+=$a.ANNOTATIONS_DISABLE;break;case fi.ENABLE:break;case fi.ENABLE_FORMS:o+=$a.ANNOTATIONS_FORMS;break;case fi.ENABLE_STORAGE:o+=$a.ANNOTATIONS_STORAGE,c=u.serializable;break;default:Ze(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(o+=$a.IS_EDITING),i&&(o+=$a.OPLIST);const{ids:d,hash:f}=u.modifiedIds,g=[o,c.hash,f];return{renderingIntent:o,cacheKey:g.join("_"),annotationStorageSerializable:c,modifiedIds:d}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#i?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const a of this.#t.values())e.push(a._destroy());this.#t.clear(),this.#a.clear(),this.#r.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),Ga.cleanup(),this._networkStream?.cancelAllRequests(new yi("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(a,s)=>{mt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=i=>{this._lastProgress={loaded:i.loaded,total:i.total}},s.onPull=()=>{this._fullReader.read().then(function({value:i,done:o}){if(o){s.close();return}mt(i instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{s.error(i)})},s.onCancel=i=>{this._fullReader.cancel(i),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async a=>{await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:i,contentLength:o}=this._fullReader;return(!s||!i)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=c=>{t.onProgress?.({loaded:c.loaded,total:c.total})}),{isStreamingSupported:s,isRangeSupported:i,contentLength:o}}),e.on("GetRangeReader",(a,s)=>{mt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(a.begin,a.end);if(!i){s.close();return}s.onPull=()=>{i.read().then(function({value:o,done:c}){if(c){s.close();return}mt(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{i.cancel(o),s.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("GetDoc",({pdfInfo:a})=>{this._numPages=a.numPages,this._htmlForXfa=a.htmlForXfa,delete a.htmlForXfa,t._capability.resolve(new w5(a,this))}),e.on("DocException",a=>{t._capability.reject(Ra(a))}),e.on("PasswordRequest",a=>{this.#i=Promise.withResolvers();try{if(!t.onPassword)throw Ra(a);const s=i=>{i instanceof Error?this.#i.reject(i):this.#i.resolve({password:i})};t.onPassword(s,a.code)}catch(s){this.#i.reject(s)}return this.#i.promise}),e.on("DataLoaded",a=>{t.onProgress?.({loaded:a.length,total:a.length}),this.downloadInfoCapability.resolve(a)}),e.on("StartRenderPage",a=>{if(this.destroyed)return;this.#t.get(a.pageIndex)._startRenderPage(a.transparency,a.cacheKey)}),e.on("commonobj",([a,s,i])=>{if(this.destroyed||this.commonObjs.has(a))return null;switch(s){case"Font":if("error"in i){const g=i.error;Ze(`Error during font loading: ${g}`),this.commonObjs.resolve(a,g);break}const o=new Ft(i),c=this._params.pdfBug&&globalThis.FontInspector?.enabled?(g,v)=>globalThis.FontInspector.fontAdded(g,v):null,u=new TB(o,c,i.extra,i.charProcOperatorList);this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:a})).finally(()=>{!u.fontExtraProperties&&u.data&&u.clearData(),this.commonObjs.resolve(a,u)});break;case"CopyLocalImage":const{imageRef:d}=i;mt(d,"The imageRef must be defined.");for(const g of this.#t.values())for(const[,v]of g.objs)if(v?.ref===d)return v.dataLen?(this.commonObjs.resolve(a,structuredClone(v)),v.dataLen):null;break;case"FontPath":this.commonObjs.resolve(a,new CB(i));break;case"Image":this.commonObjs.resolve(a,i);break;case"Pattern":const f=new Br(i);this.commonObjs.resolve(a,f.getIR());break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([a,s,i,o])=>{if(this.destroyed)return;const c=this.#t.get(s);if(!c.objs.has(a)){if(c._intentStates.size===0){o?.bitmap?.close();return}switch(i){case"Image":case"Pattern":c.objs.resolve(a,o);break;default:throw new Error(`Got unknown object type ${i}`)}}}),e.on("DocProgress",a=>{this.destroyed||t.onProgress?.({loaded:a.loaded,total:a.total})}),e.on("FetchBinaryData",async a=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[a.type];if(!s)throw new Error(`${a.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(a)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Ze("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,a=this.#a.get(t);if(a)return a;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&this.#r.set(i.refStr,e);const o=new E5(t,i,this,this._params.pdfBug);return this.#t.set(t,o),o});return this.#a.set(t,s),s}getPageIndex(e){return Jg(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#n("GetFieldObjects")}hasJSActions(){return this.#n("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return this.#n("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#n("GetOptionalContentConfig").then(t=>new r5(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const a=this.messageHandler.sendWithPromise(e,null).then(s=>({info:s[0],metadata:s[1]?new e5(s[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null,hasStructTree:s[2]}));return this.#e.set(e,a),a}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),Ga.cleanup()}}cachedPageNumber(e){if(!Jg(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#r.get(t)??null}}class S5{#e=null;onContinue=null;onError=null;constructor(e){this.#e=e}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class Cl{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:a,commonObjs:s,annotationCanvasMap:i,operatorList:o,pageIndex:c,canvasFactory:u,filterFactory:d,useRequestAnimationFrame:f=!1,pdfBug:g=!1,pageColors:v=null,enableHWA:x=!1,operationsFilter:y=null}){this.callback=e,this.params=t,this.objs=a,this.commonObjs=s,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=c,this.canvasFactory=u,this.filterFactory=d,this._pdfBug=g,this.pageColors=v,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=f===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new S5(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=x,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=y}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(Cl.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Cl.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:a,transform:s,background:i,dependencyTracker:o}=this.params,c=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Ml(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:s,viewport:a,transparency:e,background:i}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),Cl.#t.delete(this._canvas),e||=new qm(`Rendering cancelled, page ${this._pageIndex+1}`,t),this.callback(e),this.task.onError?.(e)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Cl.#t.delete(this._canvas),this.callback())))}}const T5="5.4.530",C5="50cc4adac";class vs{#e=null;#t=null;#a;#r=null;#i=!1;#n=!1;#s=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return et(this,"_keyboardManager",new Yu([[["Escape","mac+Escape"],vs.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],vs.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],vs.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],vs.prototype._moveToPrevious],[["Home","mac+Home"],vs.prototype._moveToBeginning],[["End","mac+End"],vs.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#n=!1,this.#s=e):this.#n=!0,this.#l=e?._uiManager||t,this.#o=this.#l._eventBus,this.#a=e?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",vs.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",this.#s&&(e.ariaControls=`${this.#s.id}_colorpicker_dropdown`);const t=this.#l._signal;e.addEventListener("click",this.#g.bind(this),{signal:t}),e.addEventListener("keydown",this.#m.bind(this),{signal:t});const a=this.#t=document.createElement("span");return a.className="swatch",a.ariaHidden="true",a.style.backgroundColor=this.#a,e.append(a),e}renderMainDropdown(){const e=this.#r=this.#h();return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}#h(){const e=document.createElement("div"),t=this.#l._signal;e.addEventListener("contextmenu",ys,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#s&&(e.id=`${this.#s.id}_colorpicker_dropdown`);for(const[a,s]of this.#l.highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",s),i.title=a,i.setAttribute("data-l10n-id",vs.#d[a]);const o=document.createElement("span");i.append(o),o.className="swatch",o.style.backgroundColor=s,i.ariaSelected=s===this.#a,i.addEventListener("click",this.#f.bind(this,s),{signal:t}),e.append(i)}return e.addEventListener("keydown",this.#m.bind(this),{signal:t}),e}#f(e,t){t.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:gt.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#g(e);return}const t=e.target.getAttribute("data-color");t&&this.#f(t,e)}_moveToNext(e){if(!this.#p){this.#g(e);return}if(e.target===this.#e){this.#r.firstElementChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#r?.firstElementChild||e.target===this.#e){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#g(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#p){this.#g(e);return}this.#r.firstElementChild?.focus()}_moveToEnd(e){if(!this.#p){this.#g(e);return}this.#r.lastElementChild?.focus()}#m(e){vs._keyboardManager.exec(this,e)}#g(e){if(this.#p){this.hideDropdown();return}if(this.#i=e.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#e.ariaExpanded="true",this.#r){this.#r.classList.remove("hidden");return}const t=this.#r=this.#h();this.#e.append(t)}#u(e){this.#r?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#r?.classList.add("hidden"),this.#e.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#r&&!this.#r.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#n){if(!this.#p){this.#s?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#i})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#r)return;const t=this.#l.highlightColors.values();for(const a of this.#r.children)a.ariaSelected=t.next().value===e.toUpperCase()}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#r?.remove(),this.#r=null}}class Du{#e=null;#t=null;#a=null;static#r=null;constructor(e){this.#t=e,this.#a=e._uiManager,Du.#r||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#e)return this.#e;const{editorType:e,colorType:t,color:a}=this.#t,s=this.#e=document.createElement("input");return s.type="color",s.value=a||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",Du.#r[e]),s.addEventListener("input",()=>{this.#a.updateParams(t,s.value)},{signal:this.#a._signal}),s}update(e){this.#e&&(this.#e.value=e)}destroy(){this.#e?.remove(),this.#e=null}hideDropdown(){}}function lw(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function $c(r){return Math.max(0,Math.min(255,255*r))}class cw{static CMYK_G([e,t,a,s]){return["G",1-Math.min(1,.3*e+.59*a+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=$c(e),[e,e,e]}static G_HTML([e]){const t=lw(e);return`#${t}${t}${t}`}static RGB_G([e,t,a]){return["G",.3*e+.59*t+.11*a]}static RGB_rgb(e){return e.map($c)}static RGB_HTML(e){return`#${e.map(lw).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,a,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,a+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,a,s]){return[$c(1-Math.min(1,e+s)),$c(1-Math.min(1,a+s)),$c(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,a]){const s=1-e,i=1-t,o=1-a,c=Math.min(s,i,o);return["CMYK",s,i,o,c]}}class k5{create(e,t,a=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),a||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Pt("Abstract method `_createSVG` called.")}}class lf extends k5{_createSVG(e){return document.createElementNS(An,e)}}const N5=9,uo=new WeakSet,R5=new Date().getTimezoneOffset()*60*1e3;class _g{static create(e){switch(e.data.annotationType){case Cr.LINK:return new rv(e);case Cr.TEXT:return new D5(e);case Cr.WIDGET:switch(e.data.fieldType){case"Tx":return new F5(e);case"Btn":return e.data.radioButton?new s2(e):e.data.checkBox?new L5(e):new I5(e);case"Ch":return new j5(e);case"Sig":return new M5(e)}return new yo(e);case Cr.POPUP:return new em(e);case Cr.FREETEXT:return new n2(e);case Cr.LINE:return new B5(e);case Cr.SQUARE:return new U5(e);case Cr.CIRCLE:return new z5(e);case Cr.POLYLINE:return new i2(e);case Cr.CARET:return new $5(e);case Cr.INK:return new av(e);case Cr.POLYGON:return new H5(e);case Cr.HIGHLIGHT:return new o2(e);case Cr.UNDERLINE:return new G5(e);case Cr.SQUIGGLY:return new V5(e);case Cr.STRIKEOUT:return new q5(e);case Cr.STAMP:return new l2(e);case Cr.FILEATTACHMENT:return new W5(e);default:return new lr(e)}}}class lr{#e=null;#t=!1;#a=null;constructor(e,{isRenderable:t=!1,ignoreBorder:a=!1,createQuadrilaterals:s=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(a)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e?.str||t?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return lr._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:e}=this,t=this.annotationStorage?.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const e=this.annotationStorage?.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:a,rect:s}=this.data;let i=-1/0,o=-1/0;if(t?.length>=8){for(let c=0;c<t.length;c+=8)t[c+1]>o?(o=t[c+1],i=t[c+2]):t[c+1]===o&&(i=Math.max(i,t[c+2]));return[i,o]}if(a?.length>=1){for(const c of a)for(let u=0,d=c.length;u<d;u+=2)c[u+1]>o?(o=c[u+1],i=c[u]):c[u+1]===o&&(i=Math.max(i,c[u]));if(i!==1/0)return[i,o]}return s?[s[2],s[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:a,pageHeight:s,pageX:i,pageY:o}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-i)/a,e[1]=100*(e[1]-o)/s,e}get commentText(){const{data:e}=this;return this.annotationStorage.getRawValue(`${ku}${e.id}`)?.popup?.contents||e.contentsObj?.str||""}set commentText(e){const{data:t}=this,a={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:a})||this.annotationStorage.setValue(`${ku}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:a,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){(this.#a?.popup||this.popup)?.remove(),this.#a=this.popup=null}updateEdited(e){if(!this.container)return;e.rect&&(this.#e||={rect:this.data.rect.slice(0)});const{rect:t,popup:a}=e;t&&this.#r(t);let s=this.#a?.popup||this.popup;!s&&a?.text&&(this._createPopup(a),s=this.#a.popup),s&&(s.updateEdited(e),a?.deleted&&(s.remove(),this.#a=null,this.popup=null))}resetEdited(){this.#e&&(this.#r(this.#e.rect),this.#a?.popup.resetEdited(),this.#e=null)}#r(e){const{container:{style:t},data:{rect:a,rotation:s},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:o,pageX:c,pageY:u}}}}=this;a?.splice(0,4,...e),t.left=`${100*(e[0]-c)/i}%`,t.top=`${100*(o-e[3]+u)/o}%`,s===0?(t.width=`${100*(e[2]-e[0])/i}%`,t.height=`${100*(e[3]-e[1])/o}%`):this.setRotation(s)}_createContainer(e){const{data:t,parent:{page:a,viewport:s}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),!(this instanceof yo)&&!(this instanceof rv)&&(i.tabIndex=0);const{style:o}=i;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(i.title=t.alternativeText),t.noRotate&&i.classList.add("norotate"),!t.rect||this instanceof em){const{rotation:_}=t;return!t.hasOwnCanvas&&_!==0&&this.setRotation(_,i),i}const{width:c,height:u}=this;if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const _=t.borderStyle.horizontalCornerRadius,w=t.borderStyle.verticalCornerRadius;if(_>0||w>0){const T=`calc(${_}px * var(--total-scale-factor)) / calc(${w}px * var(--total-scale-factor))`;o.borderRadius=T}else if(this instanceof s2){const T=`calc(${c}px * var(--total-scale-factor)) / calc(${u}px * var(--total-scale-factor))`;o.borderRadius=T}switch(t.borderStyle.style){case yl.SOLID:o.borderStyle="solid";break;case yl.DASHED:o.borderStyle="dashed";break;case yl.BEVELED:Ze("Unimplemented border style: beveled");break;case yl.INSET:Ze("Unimplemented border style: inset");break;case yl.UNDERLINE:o.borderBottomStyle="solid";break}const A=t.borderColor||null;A?(this.#t=!0,o.borderColor=Le.makeHexColor(A[0]|0,A[1]|0,A[2]|0)):o.borderWidth=0}const d=Le.normalizeRect([t.rect[0],a.view[3]-t.rect[1]+a.view[1],t.rect[2],a.view[3]-t.rect[3]+a.view[1]]),{pageWidth:f,pageHeight:g,pageX:v,pageY:x}=s.rawDims;o.left=`${100*(d[0]-v)/f}%`,o.top=`${100*(d[1]-x)/g}%`;const{rotation:y}=t;return t.hasOwnCanvas||y===0?(o.width=`${100*c/f}%`,o.height=`${100*u/g}%`):this.setRotation(y,i),i}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:a,pageHeight:s}=this.parent.viewport.rawDims;let{width:i,height:o}=this;e%180!==0&&([i,o]=[o,i]),t.style.width=`${100*i/a}%`,t.style.height=`${100*o/s}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,a,s)=>{const i=s.detail[t],o=i[0],c=i.slice(1);s.target.style[a]=cw[`${o}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[a]:cw[`${o}_rgb`](c)})};return et(this,"_commonActions",{display:t=>{const{display:a}=t.detail,s=a%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:a===1||a===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:a}=t.detail;this.container.style.visibility=a?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:a,noView:a})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const a=t.detail.rotation;this.setRotation(a),this.annotationStorage.setValue(this.data.id,{rotation:a})}})}_dispatchEventFromSandbox(e,t){const a=this._commonActions;for(const s of Object.keys(t.detail))(e[s]||a[s])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const a=this._commonActions;for(const[s,i]of Object.entries(t)){const o=a[s];if(o){const c={detail:{[s]:i},target:e};o(c),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,a,s,i]=this.data.rect.map(_=>Math.fround(_));if(e.length===8){const[_,w,A,T]=e.subarray(2,6);if(s===_&&i===w&&t===A&&a===T)return}const{style:o}=this.container;let c;if(this.#t){const{borderColor:_,borderWidth:w}=o;o.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${_}" stroke-width="${w}">`],this.container.classList.add("hasBorder")}const u=s-t,d=i-a,{svgFactory:f}=this,g=f.createElement("svg");g.classList.add("quadrilateralsContainer"),g.setAttribute("width",0),g.setAttribute("height",0),g.role="none";const v=f.createElement("defs");g.append(v);const x=f.createElement("clipPath"),y=`clippath_${this.data.id}`;x.setAttribute("id",y),x.setAttribute("clipPathUnits","objectBoundingBox"),v.append(x);for(let _=2,w=e.length;_<w;_+=8){const A=e[_],T=e[_+1],S=e[_+2],N=e[_+3],R=f.createElement("rect"),O=(S-t)/u,C=(i-T)/d,j=(A-S)/u,I=(T-N)/d;R.setAttribute("x",O),R.setAttribute("y",C),R.setAttribute("width",j),R.setAttribute("height",I),x.append(R),c?.push(`<rect vector-effect="non-scaling-stroke" x="${O}" y="${C}" width="${j}" height="${I}"/>`)}this.#t&&(c.push("</g></svg>')"),o.backgroundImage=c.join("")),this.container.append(g),this.container.style.clipPath=`url(#${y})`}_createPopup(e=null){const{data:t}=this;let a,s;e?(a={str:e.text},s=e.date):(a=t.contentsObj,s=t.modificationDate),this.#a=new em({data:{color:t.color,titleObj:t.titleObj,modificationDate:s,contentsObj:a,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#a||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#a}render(){Pt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const a=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:i,id:o,exportValues:c}of s){if(i===-1||o===t)continue;const u=typeof c=="string"?c:null,d=document.querySelector(`[data-element-id="${o}"]`);if(d&&!uo.has(d)){Ze(`_getElementsByName - element not allowed: ${o}`);continue}a.push({id:o,exportValue:u,domElement:d})}return a}for(const s of document.getElementsByName(e)){const{exportValue:i}=s,o=s.getAttribute("data-element-id");o!==t&&uo.has(s)&&a.push({id:o,exportValue:i,domElement:s})}return a}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class O5 extends lr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class rv extends lr{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,a=document.createElement("a");a.setAttribute("data-element-id",e.id);let s=!1;return e.url?(t.addLinkAttributes(a,e.url,e.newWindow),s=!0):e.action?(this._bindNamedAction(a,e.action,e.overlaidText),s=!0):e.attachment?(this.#t(a,e.attachment,e.overlaidText,e.attachmentDest),s=!0):e.setOCGState?(this.#a(a,e.setOCGState,e.overlaidText),s=!0):e.dest?(this._bindLink(a,e.dest,e.overlaidText),s=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(a,e),s=!0),e.resetForm?(this._bindResetFormAction(a,e.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(a,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&(this.contentElement=a,this.container.append(a)),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t,a=""){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e(),a&&(e.title=a)}_bindNamedAction(e,t,a=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),a&&(e.title=a),this.#e()}#t(e,t,a="",s=null){e.href=this.linkService.getAnchorUrl(""),t.description?e.title=t.description:a&&(e.title=a),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,s),!1),this.#e()}#a(e,t,a=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),a&&(e.title=a),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const a=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(t.actions)){const i=a.get(s);i&&(e[i]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:s}}),!1))}t.overlaidText&&(e.title=t.overlaidText),e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const a=e.onclick;if(a||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){Ze('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),a||(e.onclick=()=>!1);return}e.onclick=()=>{a?.();const{fields:s,refs:i,include:o}=t,c=[];if(s.length!==0||i.length!==0){const f=new Set(i);for(const g of s){const v=this._fieldObjects[g]||[];for(const{id:x}of v)f.add(x)}for(const g of Object.values(this._fieldObjects))for(const v of g)f.has(v.id)===o&&c.push(v)}else for(const f of Object.values(this._fieldObjects))c.push(...f);const u=this.annotationStorage,d=[];for(const f of c){const{id:g}=f;switch(d.push(g),f.type){case"text":{const x=f.defaultValue||"";u.setValue(g,{value:x});break}case"checkbox":case"radiobutton":{const x=f.defaultValue===f.exportValues;u.setValue(g,{value:x});break}case"combobox":case"listbox":{const x=f.defaultValue||"";u.setValue(g,{value:x});break}default:continue}const v=document.querySelector(`[data-element-id="${g}"]`);if(v){if(!uo.has(v)){Ze(`_bindResetFormAction - element not allowed: ${g}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}}),!1}}}class D5 extends lr{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class yo extends lr{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return jr.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,a,s,i){a.includes("mouse")?e.addEventListener(a,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:i(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(a,o=>{if(a==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(a==="focus"){if(t.focused)return;t.focused=!0}i&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:i(o)}})})}_setEventListeners(e,t,a,s){for(const[i,o]of a)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,i,o,s),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Le.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:a}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||N5,i=e.style;let o;const c=2,u=d=>Math.round(10*d)/10;if(this.data.multiLine){const d=Math.abs(this.data.rect[3]-this.data.rect[1]-c),f=Math.round(d/(hg*s))||1,g=d/f;o=Math.min(s,u(g/hg))}else{const d=Math.abs(this.data.rect[3]-this.data.rect[1]-c);o=Math.min(s,u(d/hg))}i.fontSize=`calc(${o}px * var(--total-scale-factor))`,i.color=Le.makeHexColor(a[0],a[1],a[2]),this.data.textAlignment!==null&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class F5 extends yo{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,a,s){const i=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=a),i.setValue(o.id,{[s]:a})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let a=null;if(this.renderForms){const s=e.getValue(t,{value:this.data.fieldValue});let i=s.value||"";const o=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;o&&i.length>o&&(i=i.slice(0,o));let c=s.formattedValue||this.data.textContent?.join(`
`)||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const u={userValue:i,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(a=document.createElement("textarea"),a.textContent=c??i,this.data.doNotScroll&&(a.style.overflowY="hidden")):(a=document.createElement("input"),a.type=this.data.password?"password":"text",a.setAttribute("value",c??i),this.data.doNotScroll&&(a.style.overflowX="hidden")),this.data.hasOwnCanvas&&(a.hidden=!0),uo.add(a),this.contentElement=a,a.setAttribute("data-element-id",t),a.disabled=this.data.readOnly,a.name=this.data.fieldName,a.tabIndex=0;const{datetimeFormat:d,datetimeType:f,timeStep:g}=this.data,v=!!f&&this.enableScripting;d&&(a.title=d),this._setRequired(a,this.data.required),o&&(a.maxLength=o),a.addEventListener("input",y=>{e.setValue(t,{value:y.target.value}),this.setPropertyOnSiblings(a,"value",y.target.value,"value"),u.formattedValue=null}),a.addEventListener("resetform",y=>{const _=this.data.defaultFieldValue??"";a.value=u.userValue=_,u.formattedValue=null});let x=y=>{const{formattedValue:_}=u;_!=null&&(y.target.value=_),y.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){a.addEventListener("focus",_=>{if(u.focused)return;const{target:w}=_;if(v&&(w.type=f,g&&(w.step=g)),u.userValue){const A=u.userValue;if(v)if(f==="time"){const T=new Date(A),S=[T.getHours(),T.getMinutes(),T.getSeconds()];w.value=S.map(N=>N.toString().padStart(2,"0")).join(":")}else w.value=new Date(A-R5).toISOString().split(f==="date"?"T":".",1)[0];else w.value=A}u.lastCommittedValue=w.value,u.commitKey=1,this.data.actions?.Focus||(u.focused=!0)}),a.addEventListener("updatefromsandbox",_=>{this.showElementAndHideCanvas(_.target);const w={value(A){u.userValue=A.detail.value??"",v||e.setValue(t,{value:u.userValue.toString()}),A.target.value=u.userValue},formattedValue(A){const{formattedValue:T}=A.detail;u.formattedValue=T,T!=null&&A.target!==document.activeElement&&(A.target.value=T);const S={formattedValue:T};v&&(S.value=T),e.setValue(t,S)},selRange(A){A.target.setSelectionRange(...A.detail.selRange)},charLimit:A=>{const{charLimit:T}=A.detail,{target:S}=A;if(T===0){S.removeAttribute("maxLength");return}S.setAttribute("maxLength",T);let N=u.userValue;!N||N.length<=T||(N=N.slice(0,T),S.value=u.userValue=N,e.setValue(t,{value:N}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:N,willCommit:!0,commitKey:1,selStart:S.selectionStart,selEnd:S.selectionEnd}}))}};this._dispatchEventFromSandbox(w,_)}),a.addEventListener("keydown",_=>{u.commitKey=1;let w=-1;if(_.key==="Escape"?w=0:_.key==="Enter"&&!this.data.multiLine?w=2:_.key==="Tab"&&(u.commitKey=3),w===-1)return;const{value:A}=_.target;u.lastCommittedValue!==A&&(u.lastCommittedValue=A,u.userValue=A,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,willCommit:!0,commitKey:w,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}}))});const y=x;x=null,a.addEventListener("blur",_=>{if(!u.focused||!_.relatedTarget)return;this.data.actions?.Blur||(u.focused=!1);const{target:w}=_;let{value:A}=w;if(v){if(A&&f==="time"){const T=A.split(":").map(S=>parseInt(S,10));A=new Date(2e3,0,1,T[0],T[1],T[2]||0).valueOf(),w.step=""}else A.includes("T")||(A=`${A}T00:00`),A=new Date(A).valueOf();w.type="text"}u.userValue=A,u.lastCommittedValue!==A&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,willCommit:!0,commitKey:u.commitKey,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}}),y(_)}),this.data.actions?.Keystroke&&a.addEventListener("beforeinput",_=>{u.lastCommittedValue=null;const{data:w,target:A}=_,{value:T,selectionStart:S,selectionEnd:N}=A;let R=S,O=N;switch(_.inputType){case"deleteWordBackward":{const C=T.substring(0,S).match(/\w*[^\w]*$/);C&&(R-=C[0].length);break}case"deleteWordForward":{const C=T.substring(S).match(/^[^\w]*\w*/);C&&(O+=C[0].length);break}case"deleteContentBackward":S===N&&(R-=1);break;case"deleteContentForward":S===N&&(O+=1);break}_.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:T,change:w||"",willCommit:!1,selStart:R,selEnd:O}})}),this._setEventListeners(a,u,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],_=>_.target.value)}if(x&&a.addEventListener("blur",x),this.data.comb){const _=(this.data.rect[2]-this.data.rect[0])/o;a.classList.add("comb"),a.style.letterSpacing=`calc(${_}px * var(--total-scale-factor) - 1ch)`}}else a=document.createElement("div"),a.textContent=this.data.fieldValue,a.style.verticalAlign="middle",a.style.display="table-cell",this.data.hasOwnCanvas&&(a.hidden=!0);return this._setTextStyle(a),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class M5 extends yo{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class L5 extends yo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,a=t.id;let s=e.getValue(a,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(a,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return uo.add(i),i.setAttribute("data-element-id",a),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=t.fieldName,s&&i.setAttribute("checked",!0),i.setAttribute("exportValue",t.exportValue),i.tabIndex=0,i.addEventListener("change",o=>{const{name:c,checked:u}=o.target;for(const d of this._getElementsByName(c,a)){const f=u&&d.exportValue===t.exportValue;d.domElement&&(d.domElement.checked=f),e.setValue(d.id,{value:f})}e.setValue(a,{value:u})}),i.addEventListener("resetform",o=>{const c=t.defaultFieldValue||"Off";o.target.checked=c===t.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",o=>{const c={value(u){u.target.checked=u.detail.value!=="Off",e.setValue(a,{value:u.target.checked})}};this._dispatchEventFromSandbox(c,o)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class s2 extends yo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,a=t.id;let s=e.getValue(a,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(a,{value:s})),s)for(const o of this._getElementsByName(t.fieldName,a))e.setValue(o.id,{value:!1});const i=document.createElement("input");if(uo.add(i),i.setAttribute("data-element-id",a),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=t.fieldName,s&&i.setAttribute("checked",!0),i.tabIndex=0,i.addEventListener("change",o=>{const{name:c,checked:u}=o.target;for(const d of this._getElementsByName(c,a))e.setValue(d.id,{value:!1});e.setValue(a,{value:u})}),i.addEventListener("resetform",o=>{const c=t.defaultFieldValue;o.target.checked=c!=null&&c===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;i.addEventListener("updatefromsandbox",c=>{const u={value:d=>{const f=o===d.detail.value;for(const g of this._getElementsByName(d.target.name)){const v=f&&g.id===a;g.domElement&&(g.domElement.checked=v),e.setValue(g.id,{value:v})}}};this._dispatchEventFromSandbox(u,c)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class I5 extends rv{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",a=>{this._dispatchEventFromSandbox({},a)})),e}}class j5 extends yo{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,a=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");uo.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",f=>{const g=this.data.defaultFieldValue;for(const v of s.options)v.selected=v.value===g});for(const f of this.data.options){const g=document.createElement("option");g.textContent=f.displayValue,g.value=f.exportValue,a.value.includes(f.exportValue)&&(g.setAttribute("selected",!0),i=!1),s.append(g)}let o=null;if(i){const f=document.createElement("option");f.value=" ",f.setAttribute("hidden",!0),f.setAttribute("selected",!0),s.prepend(f),o=()=>{f.remove(),s.removeEventListener("input",o),o=null},s.addEventListener("input",o)}const c=f=>{const g=f?"value":"textContent",{options:v,multiple:x}=s;return x?Array.prototype.filter.call(v,y=>y.selected).map(y=>y[g]):v.selectedIndex===-1?null:v[v.selectedIndex][g]};let u=c(!1);const d=f=>{const g=f.target.options;return Array.prototype.map.call(g,v=>({displayValue:v.textContent,exportValue:v.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",f=>{const g={value(v){o?.();const x=v.detail.value,y=new Set(Array.isArray(x)?x:[x]);for(const _ of s.options)_.selected=y.has(_.value);e.setValue(t,{value:c(!0)}),u=c(!1)},multipleSelection(v){s.multiple=!0},remove(v){const x=s.options,y=v.detail.remove;x[y].selected=!1,s.remove(y),x.length>0&&Array.prototype.findIndex.call(x,w=>w.selected)===-1&&(x[0].selected=!0),e.setValue(t,{value:c(!0),items:d(v)}),u=c(!1)},clear(v){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),u=c(!1)},insert(v){const{index:x,displayValue:y,exportValue:_}=v.detail.insert,w=s.children[x],A=document.createElement("option");A.textContent=y,A.value=_,w?w.before(A):s.append(A),e.setValue(t,{value:c(!0),items:d(v)}),u=c(!1)},items(v){const{items:x}=v.detail;for(;s.length!==0;)s.remove(0);for(const y of x){const{displayValue:_,exportValue:w}=y,A=document.createElement("option");A.textContent=_,A.value=w,s.append(A)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:c(!0),items:d(v)}),u=c(!1)},indices(v){const x=new Set(v.detail.indices);for(const y of v.target.options)y.selected=x.has(y.index);e.setValue(t,{value:c(!0)}),u=c(!1)},editable(v){v.target.disabled=!v.detail.editable}};this._dispatchEventFromSandbox(g,f)}),s.addEventListener("input",f=>{const g=c(!0),v=c(!1);e.setValue(t,{value:g}),f.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:u,change:v,changeEx:g,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],f=>f.target.value)):s.addEventListener("input",function(f){e.setValue(t,{value:c(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class em extends lr{constructor(e){const{data:t,elements:a,parent:s}=e,i=!!s._commentManager;if(super(e,{isRenderable:!i&&lr._hasPopupData(t)}),this.elements=a,i&&lr._hasPopupData(t)){const o=this.popup=this.#e();for(const c of a)c.popup=o}else this.popup=null}#e(){return new P5({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=this.#e(),a=[];for(const s of this.elements)s.popup=t,s.container.ariaHasPopup="dialog",a.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",a.map(s=>`${Sl}${s}`).join(",")),this.container}}class P5{#e=null;#t=this.#G.bind(this);#a=this.#B.bind(this);#r=this.#F.bind(this);#i=this.#w.bind(this);#n=null;#s=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#m=null;#g=null;#u=null;#p=null;#v=null;#_=null;#x=null;#S=null;#E=null;#b=null;#C=!1;#y=null;#A=null;constructor({container:e,color:t,elements:a,titleObj:s,modificationDate:i,contentsObj:o,richText:c,parent:u,rect:d,parentRect:f,open:g,commentManager:v=null}){this.#s=e,this.#E=s,this.#o=o,this.#S=c,this.#d=u,this.#n=t,this.#x=d,this.#h=f,this.#l=a,this.#e=v,this.#y=a[0],this.#c=Wg.toDateObject(i),this.trigger=a.flatMap(x=>x.getElementsToTriggerPopup()),v||(this.#R(),this.#s.hidden=!0,g&&this.#w())}#R(){if(this.#g)return;this.#g=new AbortController;const{signal:e}=this.#g;for(const t of this.trigger)t.addEventListener("click",this.#i,{signal:e}),t.addEventListener("pointerenter",this.#r,{signal:e}),t.addEventListener("pointerleave",this.#a,{signal:e}),t.classList.add("popupTriggerArea");for(const t of this.#l)t.container?.addEventListener("keydown",this.#t,{signal:e})}#k(){const e=this.#l.find(t=>t.hasCommentButton);e&&(this.#v=e._normalizePoint(e.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#y.container.after(this.#p);return}if(this.#v||this.#k(),!this.#v)return;const{signal:e}=this.#g=new AbortController,t=this.#y.hasOwnCommentButton,a=()=>{this.#e.toggleCommentPopup(this,!0,void 0,!t)},s=()=>{this.#e.toggleCommentPopup(this,!1,!0,!t)},i=()=>{this.#e.toggleCommentPopup(this,!1,!1)};if(t){this.#p=this.#y.container;for(const o of this.trigger)o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.addEventListener("keydown",this.#t,{signal:e}),o.addEventListener("click",a,{signal:e}),o.addEventListener("pointerenter",s,{signal:e}),o.addEventListener("pointerleave",i,{signal:e}),o.classList.add("popupTriggerArea")}else{const o=this.#p=document.createElement("button");o.className="annotationCommentButton";const c=this.#y.container;o.style.zIndex=c.style.zIndex+1,o.tabIndex=0,o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#j(),this.#N(),o.addEventListener("keydown",this.#t,{signal:e}),o.addEventListener("click",a,{signal:e}),o.addEventListener("pointerenter",s,{signal:e}),o.addEventListener("pointerleave",i,{signal:e}),c.after(o)}}#N(){if(this.#y.extraPopupElement&&!this.#y.editor)return;this.#p||this.renderCommentButton();const[e,t]=this.#v,{style:a}=this.#p;a.left=`calc(${e}%)`,a.top=`calc(${t}% - var(--comment-button-dim))`}#j(){this.#y.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:e,opacity:t}=this.#y.commentData;return e?this.#d._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:e,color:t,opacity:a,creationDate:s,modificationDate:i}=this.#y.commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:a,creationDate:s,modificationDate:i}}get elementBeforePopup(){return this.#p}get comment(){return this.#A||=this.#y.commentText,this.#A}set comment(e){e!==this.comment&&(this.#y.commentText=this.#A=e)}focus(){this.#y.container?.focus()}get parentBoundingClientRect(){return this.#y.layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){this.#p&&(this.#p.classList.toggle("selected",e),this.#p.ariaExpanded=t)}setSelectedCommentButton(e){this.#p.classList.toggle("selected",e)}get commentPopupPosition(){if(this.#_)return this.#_;const{x:e,y:t,height:a}=this.#p.getBoundingClientRect(),{x:s,y:i,width:o,height:c}=this.#y.layer.getBoundingClientRect();return[(e-s)/o,(t+a-i)/c]}set commentPopupPosition(e){this.#_=e}hasDefaultPopupPosition(){return this.#_===null}get commentButtonPosition(){return this.#v}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,a]=this.#_||this.commentButtonPosition.map(d=>d/100),s=this.parentBoundingClientRect,{x:i,y:o,width:c,height:u}=s;this.#e.showDialog(null,this,i+t*c,o+a*u,{...e,parentDimensions:s})}render(){if(this.#m)return;const e=this.#m=document.createElement("div");if(e.className="popup",this.#n){const a=e.style.outlineColor=Le.makeHexColor(...this.#n);e.style.backgroundColor=`color-mix(in srgb, ${a} 30%, white)`}const t=document.createElement("span");if(t.className="header",this.#E?.str){const a=document.createElement("span");a.className="title",t.append(a),{dir:a.dir,str:a.textContent}=this.#E}if(e.append(t),this.#c){const a=document.createElement("time");a.className="popupDate",a.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),a.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),a.dateTime=this.#c.toISOString(),t.append(a)}PA({html:this.#D||this.#o.str,dir:this.#o?.dir,className:"popupContent"},e),this.#s.append(e)}get#D(){const e=this.#S,t=this.#o;return e?.str&&(!t?.str||t.str===e.str)&&this.#S.html||null}get#M(){return this.#D?.attributes?.style?.fontSize||0}get#P(){return this.#D?.attributes?.style?.color||null}#L(e){const t=[],a={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:this.#P,fontSize:this.#M?`calc(${this.#M}px * var(--total-scale-factor))`:""}};for(const i of e.split(`
`))t.push({name:"span",value:i,attributes:s});return a}#G(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#f)&&this.#w()}updateEdited({rect:e,popup:t,deleted:a}){if(this.#e){a?(this.remove(),this.#A=null):t&&(t.deleted?this.remove():(this.#j(),this.#A=t.text)),e&&(this.#v=null,this.#k(),this.#N());return}if(a||t?.deleted){this.remove();return}this.#R(),this.#b||={contentsObj:this.#o,richText:this.#S},e&&(this.#u=null),t&&t.text&&(this.#S=this.#L(t.text),this.#c=Wg.toDateObject(t.date),this.#o=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#b&&({contentsObj:this.#o,richText:this.#S}=this.#b,this.#b=null,this.#m?.remove(),this.#m=null,this.#u=null)}remove(){if(this.#g?.abort(),this.#g=null,this.#m?.remove(),this.#m=null,this.#C=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const e of this.trigger)e.classList.remove("popupTriggerArea")}#T(){if(this.#u!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:a,pageX:s,pageY:i}}}=this.#d;let o=!!this.#h,c=o?this.#h:this.#x;for(const y of this.#l)if(!c||Le.intersect(y.data.rect,c)!==null){c=y.data.rect,o=!0;break}const u=Le.normalizeRect([c[0],e[3]-c[1]+e[1],c[2],e[3]-c[3]+e[1]]),f=o?c[2]-c[0]+5:0,g=u[0]+f,v=u[1];this.#u=[100*(g-s)/t,100*(v-i)/a];const{style:x}=this.#s;x.left=`${this.#u[0]}%`,x.top=`${this.#u[1]}%`}#w(){if(this.#e){this.#e.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#F(),this.#s.addEventListener("click",this.#i),this.#s.addEventListener("keydown",this.#t)):(this.#B(),this.#s.removeEventListener("click",this.#i),this.#s.removeEventListener("keydown",this.#t))}#F(){this.#m||this.render(),this.isVisible?this.#f&&this.#s.classList.add("focused"):(this.#T(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#B(){this.#s.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#C=this.isVisible,this.#C&&(this.#s.hidden=!0)}maybeShow(){this.#e||(this.#R(),this.#C&&(this.#m||this.#F(),this.#C=!1,this.#s.hidden=!1))}get isVisible(){return this.#e?!1:this.#s.hidden===!1}}class n2 extends lr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=tt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const a=document.createElement("span");a.textContent=t,e.append(a)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class B5 extends lr{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:a}=this,s=this.svgFactory.create(t,a,!0),i=this.#e=this.svgFactory.createElement("svg:line");return i.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),i.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),i.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),i.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),i.setAttribute("stroke-width",e.borderStyle.width||1),i.setAttribute("stroke","transparent"),i.setAttribute("fill","transparent"),s.append(i),this.container.append(s),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class U5 extends lr{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:a}=this,s=this.svgFactory.create(t,a,!0),i=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",i/2),o.setAttribute("y",i/2),o.setAttribute("width",t-i),o.setAttribute("height",a-i),o.setAttribute("stroke-width",i||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class z5 extends lr{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:a}=this,s=this.svgFactory.create(t,a,!0),i=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",t/2),o.setAttribute("cy",a/2),o.setAttribute("rx",t/2-i/2),o.setAttribute("ry",a/2-i/2),o.setAttribute("stroke-width",i||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class i2 extends lr{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:a,popupRef:s},width:i,height:o}=this;if(!t)return this.container;const c=this.svgFactory.create(i,o,!0);let u=[];for(let f=0,g=t.length;f<g;f+=2){const v=t[f]-e[0],x=e[3]-t[f+1];u.push(`${v},${x}`)}u=u.join(" ");const d=this.#e=this.svgFactory.createElement(this.svgElementName);return d.setAttribute("points",u),d.setAttribute("stroke-width",a.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),c.append(d),this.container.append(c),!s&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class H5 extends i2{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class $5 extends lr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class av extends lr{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?tt.HIGHLIGHT:tt.INK}#a(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:a,borderStyle:s,popupRef:i}}=this,{transform:o,width:c,height:u}=this.#a(t,e),d=this.svgFactory.create(c,u,!0),f=this.#e=this.svgFactory.createElement("svg:g");d.append(f),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",o);for(let g=0,v=a.length;g<v;g++){const x=this.svgFactory.createElement(this.svgElementName);this.#t.push(x),x.setAttribute("points",a[g].join(",")),f.append(x)}return!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:a,rect:s}=e,i=this.#e;if(t>=0&&i.setAttribute("stroke-width",t||1),a)for(let o=0,c=this.#t.length;o<c;o++)this.#t[o].setAttribute("points",a[o].join(","));if(s){const{transform:o,width:c,height:u}=this.#a(this.data.rotation,s);i.parentElement.setAttribute("viewBox",`0 0 ${c} ${u}`),i.setAttribute("transform",o)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class o2 extends lr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=tt.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const a=document.createElement("mark");a.classList.add("overlaidText"),a.textContent=e,this.container.append(a)}return this.container}}class G5 extends lr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const a=document.createElement("u");a.classList.add("overlaidText"),a.textContent=e,this.container.append(a)}return this.container}}class V5 extends lr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const a=document.createElement("u");a.classList.add("overlaidText"),a.textContent=e,this.container.append(a)}return this.container}}class q5 extends lr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const a=document.createElement("s");a.classList.add("overlaidText"),a.textContent=e,this.container.append(a)}return this.container}}class l2 extends lr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=tt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class W5 extends lr{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let a;t.hasAppearance||t.fillAlpha===0?a=document.createElement("div"):(a=document.createElement("img"),a.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(a.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),a.addEventListener("dblclick",this.#t.bind(this)),this.#e=a;const{isMac:s}=jr.platform;return e.addEventListener("keydown",i=>{i.key==="Enter"&&(s?i.metaKey:i.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):a.classList.add("popupTriggerArea"),e.append(a),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class sv{#e=null;#t=null;#a=null;#r=new Map;#i=null;#n=null;#s=[];#o=!1;constructor({div:e,accessibilityManager:t,annotationCanvasMap:a,annotationEditorUIManager:s,page:i,viewport:o,structTreeLayer:c,commentManager:u,linkService:d,annotationStorage:f}){this.div=e,this.#e=t,this.#t=a,this.#i=c||null,this.#n=d||null,this.#a=f||new Km,this.page=i,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=s,this._commentManager=u||null}hasEditableAnnotations(){return this.#r.size>0}async render(e){const{annotations:t}=e,a=this.div;co(a,this.viewport);const s=new Map,i=[],o={data:null,layer:a,linkService:this.#n,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new lf,annotationStorage:this.#a,enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const c of t){if(c.noHTML)continue;const u=c.annotationType===Cr.POPUP;if(u){const g=s.get(c.id);if(!g)continue;if(!this._commentManager){i.push(c);continue}o.elements=g}else if(c.rect[2]===c.rect[0]||c.rect[3]===c.rect[1])continue;o.data=c;const d=_g.create(o);if(!d.isRenderable)continue;if(!u&&(this.#s.push(d),c.popupRef)){const g=s.get(c.popupRef);g?g.push(d):s.set(c.popupRef,[d])}const f=d.render();c.hidden&&(f.style.visibility="hidden"),d._isEditable&&(this.#r.set(d.data.id,d),this._annotationEditorUIManager?.renderAnnotationElement(d))}await this.#c();for(const c of i){const u=o.elements=s.get(c.id);o.data=c;const d=_g.create(o);if(!d.isRenderable)continue;const f=d.render();d.contentElement.id=`${Sl}${c.id}`,c.hidden&&(f.style.visibility="hidden"),u.at(-1).container.after(f)}this.#l()}async#c(){if(this.#s.length===0)return;this.div.replaceChildren();const e=[];if(!this.#o){this.#o=!0;for(const{contentElement:a,data:{id:s}}of this.#s){const i=a.id=`${Sl}${s}`;e.push(this.#i?.getAriaAttributes(i).then(o=>{if(o)for(const[c,u]of o)a.setAttribute(c,u)}))}}this.#s.sort(({data:{rect:[a,s,i,o]}},{data:{rect:[c,u,d,f]}})=>{if(a===i&&s===o)return 1;if(c===d&&u===f)return-1;const g=o,v=s,x=(s+o)/2,y=f,_=u,w=(u+f)/2;if(x>=y&&w<=v)return-1;if(w>=g&&x<=_)return 1;const A=(a+i)/2,T=(c+d)/2;return A-T});const t=document.createDocumentFragment();for(const a of this.#s)t.append(a.container),this._commentManager?(a.extraPopupElement?.popup||a.popup)?.renderCommentButton():a.extraPopupElement&&t.append(a.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),this.#e)for(const a of this.#s)this.#e.addPointerInTextLayer(a.contentElement,!1)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:this.#n,svgFactory:new lf,parent:this};for(const a of e){a.borderStyle||=sv._defaultBorderStyle,t.data=a;const s=_g.create(t);s.isRenderable&&(s.render(),s.contentElement.id=`${Sl}${a.id}`,this.#s.push(s))}await this.#c()}update({viewport:e}){const t=this.div;this.viewport=e,co(t,{rotation:e.rotation}),this.#l(),t.hidden=!1}#l(){if(!this.#t)return;const e=this.div;for(const[t,a]of this.#t){const s=e.querySelector(`[data-annotation-id="${t}"]`);if(!s)continue;a.className="annotationContent";const{firstChild:i}=s;i?i.nodeName==="CANVAS"?i.replaceWith(a):i.classList.contains("annotationContent")?i.after(a):i.before(a):s.append(a);const o=this.#r.get(t);o&&(o._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(t,s.id,a),o._hasNoCanvas=!1):o.canvas=a)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#r.values())}getEditableAnnotation(e){return this.#r.get(e)}addFakeAnnotation(e){const{div:t}=this,{id:a,rotation:s}=e,i=new O5({data:{id:a,rect:e.getPDFRect(),rotation:s},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:this.#n,annotationStorage:this.#a});return i.render(),i.contentElement.id=`${Sl}${a}`,i.createOrUpdatePopup(),this.#s.push(i),i}removeAnnotation(e){const t=this.#s.findIndex(s=>s.data.id===e);if(t<0)return;const[a]=this.#s.splice(t,1);this.#e?.removePointerInTextLayer(a.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return et(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:yl.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const Ld=/\r\n?|\n/g;class Ur extends Ve{#e="";#t=`${this.id}-editor`;#a=null;#r;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=Ur.prototype,t=i=>i.isEmpty(),a=bi.TRANSLATE_SMALL,s=bi.TRANSLATE_BIG;return et(this,"_keyboardManager",new Yu([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-a,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[a,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-a],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,a],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}]]))}static _type="freetext";static _editorType=tt.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.color=e.color||Ur._defaultColor||Ve._defaultLineColor,this.#r=e.fontSize||Ur._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(e,t){Ve.initialize(e,t);const a=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(a.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case gt.FREETEXT_SIZE:Ur._defaultFontSize=t;break;case gt.FREETEXT_COLOR:Ur._defaultColor=t;break}}updateParams(e,t){switch(e){case gt.FREETEXT_SIZE:this.#i(t);break;case gt.FREETEXT_COLOR:this.#n(t);break}}static get defaultPropertiesToUpdate(){return[[gt.FREETEXT_SIZE,Ur._defaultFontSize],[gt.FREETEXT_COLOR,Ur._defaultColor||Ve._defaultLineColor]]}get propertiesToUpdate(){return[[gt.FREETEXT_SIZE,this.#r],[gt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new Du(this),[["colorPicker",this._colorPicker]]}get colorType(){return gt.FREETEXT_COLOR}#i(e){const t=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-this.#r)*this.parentScale),this.#r=s,this.#o()},a=this.#r;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:gt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#n(e){const t=s=>{this.color=s,this.onUpdatedColor()},a=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:gt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-Ur._internalPadding*e,-(Ur._internalPadding+this.#r)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#a=new AbortController;const e=this._uiManager.combinedSignal(this.#a);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#t),this._isDraggable=!0,this.#a?.abort(),this.#a=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#s(){const e=[];this.editorDiv.normalize();let t=null;for(const a of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&a.nodeName==="BR"||(e.push(Ur.#c(a)),t=a);return e.join(`
`)}#o(){const[e,t]=this.parentDimensions;let a;if(this.isAttachedToDOM)a=this.div.getBoundingClientRect();else{const{currentLayer:s,div:i}=this,o=i.style.display,c=i.classList.contains("hidden");i.classList.remove("hidden"),i.style.display="hidden",s.div.append(this.div),a=i.getBoundingClientRect(),i.remove(),i.style.display=o,i.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=a.width/e,this.height=a.height/t):(this.width=a.height/e,this.height=a.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#e,t=this.#e=this.#s().trimEnd();if(e===t)return;const a=s=>{if(this.#e=s,!s){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{a(t)},undo:()=>{a(e)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Ur._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#t),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:a}=this.editorDiv;if(a.fontSize=`calc(${this.#r}px * var(--total-scale-factor))`,a.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,i]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[c,u]=this.getInitialTranslation();[c,u]=this.pageTranslationToScreen(c,u);const[d,f]=this.pageDimensions,[g,v]=this.pageTranslation;let x,y;switch(this.rotation){case 0:x=e+(o[0]-g)/d,y=t+this.height-(o[1]-v)/f;break;case 90:x=e+(o[0]-g)/d,y=t-(o[1]-v)/f,[c,u]=[u,-c];break;case 180:x=e-this.width+(o[0]-g)/d,y=t-(o[1]-v)/f,[c,u]=[-c,-u];break;case 270:x=e+(o[0]-g-this.height*f)/d,y=t+(o[1]-v-this.width*d)/f,[c,u]=[-u,c];break}this.setAt(x*s,y*i,c,u)}else this._moveAfterPaste(e,t);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Ld,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:a}=t;if(a.length===1&&a[0]==="text/plain")return;e.preventDefault();const s=Ur.#h(t.getData("text")||"").replaceAll(Ld,`
`);if(!s)return;const i=window.getSelection();if(!i.rangeCount)return;this.editorDiv.normalize(),i.deleteFromDocument();const o=i.getRangeAt(0);if(!s.includes(`
`)){o.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),i.collapseToStart();return}const{startContainer:c,startOffset:u}=o,d=[],f=[];if(c.nodeType===Node.TEXT_NODE){const x=c.parentElement;if(f.push(c.nodeValue.slice(u).replaceAll(Ld,"")),x!==this.editorDiv){let y=d;for(const _ of this.editorDiv.childNodes){if(_===x){y=f;continue}y.push(Ur.#c(_))}}d.push(c.nodeValue.slice(0,u).replaceAll(Ld,""))}else if(c===this.editorDiv){let x=d,y=0;for(const _ of this.editorDiv.childNodes)y++===u&&(x=f),x.push(Ur.#c(_))}this.#e=`${d.join(`
`)}${s}${f.join(`
`)}`,this.#l();const g=new Range;let v=Math.sumPrecise(d.map(x=>x.length));for(const{firstChild:x}of this.editorDiv.childNodes)if(x.nodeType===Node.TEXT_NODE){const y=x.nodeValue.length;if(v<=y){g.setStart(x,v),g.setEnd(x,v);break}v-=y}i.removeAllRanges(),i.addRange(g)}#l(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const e of this.#e.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#d(){return this.#e.replaceAll(""," ")}static#h(e){return e.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const e=Ur._internalPadding*this.parentScale;return this.getRect(e,e)}static async deserialize(e,t,a){let s=null;if(e instanceof n2){const{data:{defaultAppearanceData:{fontSize:o,fontColor:c},rect:u,rotation:d,id:f,popupRef:g,richText:v,contentsObj:x,creationDate:y,modificationDate:_},textContent:w,textPosition:A,parent:{page:{pageNumber:T}}}=e;if(!w||w.length===0)return null;s=e={annotationType:tt.FREETEXT,color:Array.from(c),fontSize:o,value:w.join(`
`),position:A,pageIndex:T-1,rect:u.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:g,comment:x?.str||null,richText:v,creationDate:y,modificationDate:_}}const i=await super.deserialize(e,t,a);return i.#r=e.fontSize,i.color=Le.makeHexColor(...e.color),i.#e=Ur.#h(e.value),i._initialData=s,e.comment&&i.setCommentData(e),i}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=Ve._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),a=Object.assign(super.serialize(e),{color:t,fontSize:this.#r,value:this.#d()});return this.addComment(a),e?(a.isCopy=!0,a):this.annotationElementId&&!this.#f(a)?null:(a.id=this.annotationElementId,a)}#f(e){const{value:t,fontSize:a,color:s,pageIndex:i}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==t||e.fontSize!==a||e.color.some((o,c)=>o!==s[c])||e.pageIndex!==i}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(!t)return null;const{style:a}=t;a.fontSize=`calc(${this.#r}px * var(--total-scale-factor))`,a.color=this.color,t.replaceChildren();for(const s of this.#e.split(`
`)){const i=document.createElement("div");i.append(s?document.createTextNode(s):document.createElement("br")),t.append(i)}return e.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#e}}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class Ie{static PRECISION=1e-4;toSVGPath(){Pt("Abstract method `toSVGPath` must be implemented.")}get box(){Pt("Abstract getter `box` must be implemented.")}serialize(e,t){Pt("Abstract method `serialize` must be implemented.")}static _rescale(e,t,a,s,i,o){o||=new Float32Array(e.length);for(let c=0,u=e.length;c<u;c+=2)o[c]=t+e[c]*s,o[c+1]=a+e[c+1]*i;return o}static _rescaleAndSwap(e,t,a,s,i,o){o||=new Float32Array(e.length);for(let c=0,u=e.length;c<u;c+=2)o[c]=t+e[c+1]*s,o[c+1]=a+e[c]*i;return o}static _translate(e,t,a,s){s||=new Float32Array(e.length);for(let i=0,o=e.length;i<o;i+=2)s[i]=t+e[i],s[i+1]=a+e[i+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,a,s,i){switch(i){case 90:return[1-t/a,e/s];case 180:return[1-e/a,1-t/s];case 270:return[t/a,1-e/s];default:return[e/a,t/s]}}static _normalizePagePoint(e,t,a){switch(a){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,a,s,i,o){return[(e+5*a)/6,(t+5*s)/6,(5*a+i)/6,(5*s+o)/6,(a+i)/2,(s+o)/2]}}class Zi{#e;#t=[];#a;#r;#i=[];#n=new Float32Array(18);#s;#o;#c;#l;#d;#h;#f=[];static#m=8;static#g=2;static#u=Zi.#m+Zi.#g;constructor({x:e,y:t},a,s,i,o,c=0){this.#e=a,this.#h=i*s,this.#r=o,this.#n.set([NaN,NaN,NaN,NaN,e,t],6),this.#a=c,this.#l=Zi.#m*s,this.#c=Zi.#u*s,this.#d=s,this.#f.push(e,t)}isEmpty(){return isNaN(this.#n[8])}#p(){const e=this.#n.subarray(4,6),t=this.#n.subarray(16,18),[a,s,i,o]=this.#e;return[(this.#s+(e[0]-t[0])/2-a)/i,(this.#o+(e[1]-t[1])/2-s)/o,(this.#s+(t[0]-e[0])/2-a)/i,(this.#o+(t[1]-e[1])/2-s)/o]}add({x:e,y:t}){this.#s=e,this.#o=t;const[a,s,i,o]=this.#e;let[c,u,d,f]=this.#n.subarray(8,12);const g=e-d,v=t-f,x=Math.hypot(g,v);if(x<this.#c)return!1;const y=x-this.#l,_=y/x,w=_*g,A=_*v;let T=c,S=u;c=d,u=f,d+=w,f+=A,this.#f?.push(e,t);const N=-A/y,R=w/y,O=N*this.#h,C=R*this.#h;return this.#n.set(this.#n.subarray(2,8),0),this.#n.set([d+O,f+C],4),this.#n.set(this.#n.subarray(14,18),12),this.#n.set([d-O,f-C],16),isNaN(this.#n[6])?(this.#i.length===0&&(this.#n.set([c+O,u+C],2),this.#i.push(NaN,NaN,NaN,NaN,(c+O-a)/i,(u+C-s)/o),this.#n.set([c-O,u-C],14),this.#t.push(NaN,NaN,NaN,NaN,(c-O-a)/i,(u-C-s)/o)),this.#n.set([T,S,c,u,d,f],6),!this.isEmpty()):(this.#n.set([T,S,c,u,d,f],6),Math.abs(Math.atan2(S-u,T-c)-Math.atan2(A,w))<Math.PI/2?([c,u,d,f]=this.#n.subarray(2,6),this.#i.push(NaN,NaN,NaN,NaN,((c+d)/2-a)/i,((u+f)/2-s)/o),[c,u,T,S]=this.#n.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((T+c)/2-a)/i,((S+u)/2-s)/o),!0):([T,S,c,u,d,f]=this.#n.subarray(0,6),this.#i.push(((T+5*c)/6-a)/i,((S+5*u)/6-s)/o,((5*c+d)/6-a)/i,((5*u+f)/6-s)/o,((c+d)/2-a)/i,((u+f)/2-s)/o),[d,f,c,u,T,S]=this.#n.subarray(12,18),this.#t.push(((T+5*c)/6-a)/i,((S+5*u)/6-s)/o,((5*c+d)/6-a)/i,((5*u+f)/6-s)/o,((c+d)/2-a)/i,((u+f)/2-s)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#i,t=this.#t;if(isNaN(this.#n[6])&&!this.isEmpty())return this.#v();const a=[];a.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?a.push(`L${e[s+4]} ${e[s+5]}`):a.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);this.#x(a);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?a.push(`L${t[s+4]} ${t[s+5]}`):a.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return this.#_(a),a.join(" ")}#v(){const[e,t,a,s]=this.#e,[i,o,c,u]=this.#p();return`M${(this.#n[2]-e)/a} ${(this.#n[3]-t)/s} L${(this.#n[4]-e)/a} ${(this.#n[5]-t)/s} L${i} ${o} L${c} ${u} L${(this.#n[16]-e)/a} ${(this.#n[17]-t)/s} L${(this.#n[14]-e)/a} ${(this.#n[15]-t)/s} Z`}#_(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#x(e){const[t,a,s,i]=this.#e,o=this.#n.subarray(4,6),c=this.#n.subarray(16,18),[u,d,f,g]=this.#p();e.push(`L${(o[0]-t)/s} ${(o[1]-a)/i} L${u} ${d} L${f} ${g} L${(c[0]-t)/s} ${(c[1]-a)/i}`)}newFreeDrawOutline(e,t,a,s,i,o){return new c2(e,t,a,s,i,o)}getOutlines(){const e=this.#i,t=this.#t,a=this.#n,[s,i,o,c]=this.#e,u=new Float32Array((this.#f?.length??0)+2);for(let g=0,v=u.length-2;g<v;g+=2)u[g]=(this.#f[g]-s)/o,u[g+1]=(this.#f[g+1]-i)/c;if(u[u.length-2]=(this.#s-s)/o,u[u.length-1]=(this.#o-i)/c,isNaN(a[6])&&!this.isEmpty())return this.#S(u);const d=new Float32Array(this.#i.length+24+this.#t.length);let f=e.length;for(let g=0;g<f;g+=2){if(isNaN(e[g])){d[g]=d[g+1]=NaN;continue}d[g]=e[g],d[g+1]=e[g+1]}f=this.#b(d,f);for(let g=t.length-6;g>=6;g-=6)for(let v=0;v<6;v+=2){if(isNaN(t[g+v])){d[f]=d[f+1]=NaN,f+=2;continue}d[f]=t[g+v],d[f+1]=t[g+v+1],f+=2}return this.#E(d,f),this.newFreeDrawOutline(d,u,this.#e,this.#d,this.#a,this.#r)}#S(e){const t=this.#n,[a,s,i,o]=this.#e,[c,u,d,f]=this.#p(),g=new Float32Array(36);return g.set([NaN,NaN,NaN,NaN,(t[2]-a)/i,(t[3]-s)/o,NaN,NaN,NaN,NaN,(t[4]-a)/i,(t[5]-s)/o,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,(t[16]-a)/i,(t[17]-s)/o,NaN,NaN,NaN,NaN,(t[14]-a)/i,(t[15]-s)/o],0),this.newFreeDrawOutline(g,e,this.#e,this.#d,this.#a,this.#r)}#E(e,t){const a=this.#t;return e.set([NaN,NaN,NaN,NaN,a[4],a[5]],t),t+=6}#b(e,t){const a=this.#n.subarray(4,6),s=this.#n.subarray(16,18),[i,o,c,u]=this.#e,[d,f,g,v]=this.#p();return e.set([NaN,NaN,NaN,NaN,(a[0]-i)/c,(a[1]-o)/u,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,g,v,NaN,NaN,NaN,NaN,(s[0]-i)/c,(s[1]-o)/u],t),t+=24}}class c2 extends Ie{#e;#t=new Float32Array(4);#a;#r;#i;#n;#s;constructor(e,t,a,s,i,o){super(),this.#s=e,this.#i=t,this.#e=a,this.#n=s,this.#a=i,this.#r=o,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(o);const[c,u,d,f]=this.#t;for(let g=0,v=e.length;g<v;g+=2)e[g]=(e[g]-c)/d,e[g+1]=(e[g+1]-u)/f;for(let g=0,v=t.length;g<v;g+=2)t[g]=(t[g]-c)/d,t[g+1]=(t[g+1]-u)/f}toSVGPath(){const e=[`M${this.#s[4]} ${this.#s[5]}`];for(let t=6,a=this.#s.length;t<a;t+=6){if(isNaN(this.#s[t])){e.push(`L${this.#s[t+4]} ${this.#s[t+5]}`);continue}e.push(`C${this.#s[t]} ${this.#s[t+1]} ${this.#s[t+2]} ${this.#s[t+3]} ${this.#s[t+4]} ${this.#s[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,a,s],i){const o=a-e,c=s-t;let u,d;switch(i){case 0:u=Ie._rescale(this.#s,e,s,o,-c),d=Ie._rescale(this.#i,e,s,o,-c);break;case 90:u=Ie._rescaleAndSwap(this.#s,e,t,o,c),d=Ie._rescaleAndSwap(this.#i,e,t,o,c);break;case 180:u=Ie._rescale(this.#s,a,t,-o,c),d=Ie._rescale(this.#i,a,t,-o,c);break;case 270:u=Ie._rescaleAndSwap(this.#s,a,s,-o,-c),d=Ie._rescaleAndSwap(this.#i,a,s,-o,-c);break}return{outline:Array.from(u),points:[Array.from(d)]}}#o(e){const t=this.#s;let a=t[4],s=t[5];const i=[a,s,a,s];let o=a,c=s,u=a,d=s;const f=e?Math.max:Math.min,g=new Float32Array(4);for(let x=6,y=t.length;x<y;x+=6){const _=t[x+4],w=t[x+5];isNaN(t[x])?(Le.pointBoundingBox(_,w,i),c>w?(o=_,c=w):c===w&&(o=f(o,_)),d<w?(u=_,d=w):d===w&&(u=f(u,_))):(g[0]=g[1]=1/0,g[2]=g[3]=-1/0,Le.bezierBoundingBox(a,s,...t.slice(x,x+6),g),Le.rectBoundingBox(g[0],g[1],g[2],g[3],i),c>g[1]?(o=g[0],c=g[1]):c===g[1]&&(o=f(o,g[0])),d<g[3]?(u=g[2],d=g[3]):d===g[3]&&(u=f(u,g[2]))),a=_,s=w}const v=this.#t;v[0]=i[0]-this.#a,v[1]=i[1]-this.#a,v[2]=i[2]-i[0]+2*this.#a,v[3]=i[3]-i[1]+2*this.#a,this.firstPoint=[o,c],this.lastPoint=[u,d]}get box(){return this.#t}newOutliner(e,t,a,s,i,o=0){return new Zi(e,t,a,s,i,o)}getNewOutline(e,t){const[a,s,i,o]=this.#t,[c,u,d,f]=this.#e,g=i*d,v=o*f,x=a*d+c,y=s*f+u,_=this.newOutliner({x:this.#i[0]*g+x,y:this.#i[1]*v+y},this.#e,this.#n,e,this.#r,t??this.#a);for(let w=2;w<this.#i.length;w+=2)_.add({x:this.#i[w]*g+x,y:this.#i[w+1]*v+y});return _.getOutlines()}}class tm{#e;#t;#a;#r=[];#i=[];constructor(e,t=0,a=0,s=!0){const i=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:_,y:w,width:A,height:T}of e){const S=Math.floor((_-t)/o)*o,N=Math.ceil((_+A+t)/o)*o,R=Math.floor((w-t)/o)*o,O=Math.ceil((w+T+t)/o)*o,C=[S,R,O,!0],j=[N,R,O,!1];this.#r.push(C,j),Le.rectBoundingBox(S,R,N,O,i)}const c=i[2]-i[0]+2*a,u=i[3]-i[1]+2*a,d=i[0]-a,f=i[1]-a;let g=s?-1/0:1/0,v=1/0;const x=this.#r.at(s?-1:-2),y=[x[0],x[2]];for(const _ of this.#r){const[w,A,T,S]=_;!S&&s?A<v?(v=A,g=w):A===v&&(g=Math.max(g,w)):S&&!s&&(A<v?(v=A,g=w):A===v&&(g=Math.min(g,w))),_[0]=(w-d)/c,_[1]=(A-f)/u,_[2]=(T-f)/u}this.#e=new Float32Array([d,f,c,u]),this.#t=[g,v],this.#a=y}getOutlines(){this.#r.sort((t,a)=>t[0]-a[0]||t[1]-a[1]||t[2]-a[2]);const e=[];for(const t of this.#r)t[3]?(e.push(...this.#l(t)),this.#o(t)):(this.#c(t),e.push(...this.#l(t)));return this.#n(e)}#n(e){const t=[],a=new Set;for(const o of e){const[c,u,d]=o;t.push([c,u,o],[c,d,o])}t.sort((o,c)=>o[1]-c[1]||o[0]-c[0]);for(let o=0,c=t.length;o<c;o+=2){const u=t[o][2],d=t[o+1][2];u.push(d),d.push(u),a.add(u),a.add(d)}const s=[];let i;for(;a.size>0;){const o=a.values().next().value;let[c,u,d,f,g]=o;a.delete(o);let v=c,x=u;for(i=[c,d],s.push(i);;){let y;if(a.has(f))y=f;else if(a.has(g))y=g;else break;a.delete(y),[c,u,d,f,g]=y,v!==c&&(i.push(v,x,c,x===u?u:d),v=c),x=x===u?d:u}i.push(v,x)}return new X5(s,this.#e,this.#t,this.#a)}#s(e){const t=this.#i;let a=0,s=t.length-1;for(;a<=s;){const i=a+s>>1,o=t[i][0];if(o===e)return i;o<e?a=i+1:s=i-1}return s+1}#o([,e,t]){const a=this.#s(e);this.#i.splice(a,0,[e,t])}#c([,e,t]){const a=this.#s(e);for(let s=a;s<this.#i.length;s++){const[i,o]=this.#i[s];if(i!==e)break;if(i===e&&o===t){this.#i.splice(s,1);return}}for(let s=a-1;s>=0;s--){const[i,o]=this.#i[s];if(i!==e)break;if(i===e&&o===t){this.#i.splice(s,1);return}}}#l(e){const[t,a,s]=e,i=[[t,a,s]],o=this.#s(s);for(let c=0;c<o;c++){const[u,d]=this.#i[c];for(let f=0,g=i.length;f<g;f++){const[,v,x]=i[f];if(!(d<=v||x<=u)){if(v>=u){if(x>d)i[f][1]=d;else{if(g===1)return[];i.splice(f,1),f--,g--}continue}i[f][2]=u,x>d&&i.push([t,d,x])}}}return i}}class X5 extends Ie{#e;#t;constructor(e,t,a,s){super(),this.#t=e,this.#e=t,this.firstPoint=a,this.lastPoint=s}toSVGPath(){const e=[];for(const t of this.#t){let[a,s]=t;e.push(`M${a} ${s}`);for(let i=2;i<t.length;i+=2){const o=t[i],c=t[i+1];o===a?(e.push(`V${c}`),s=c):c===s&&(e.push(`H${o}`),a=o)}e.push("Z")}return e.join(" ")}serialize([e,t,a,s],i){const o=[],c=a-e,u=s-t;for(const d of this.#t){const f=new Array(d.length);for(let g=0;g<d.length;g+=2)f[g]=e+d[g]*c,f[g+1]=s-d[g+1]*u;o.push(f)}return o}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class rm extends Zi{newFreeDrawOutline(e,t,a,s,i,o){return new Y5(e,t,a,s,i,o)}}class Y5 extends c2{newOutliner(e,t,a,s,i,o=0){return new rm(e,t,a,s,i,o)}}class _r extends Ve{#e=null;#t=0;#a;#r=null;#i=null;#n=null;#s=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#m=null;#g=null;#u="";#p;#v="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=tt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=_r.prototype;return et(this,"_keyboardManager",new Yu([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||_r._defaultColor,this.#p=e.thickness||_r._defaultThickness,this.opacity=e.opacity||_r._defaultOpacity,this.#a=e.boxes||null,this.#v=e.methodOfCreation||"",this.#u=e.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(this.#h=!0,this.#x(e),this.#y()):this.#a&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#s=e.focusNode,this.#o=e.focusOffset,this.#_(),this.#y(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#v}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#_(){const e=new tm(this.#a,.001);this.#l=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const t=new tm(this.#a,.0025,.001,this._uiManager.direction==="ltr");this.#n=t.getOutlines();const{firstPoint:a}=this.#l;this.#f=[(a[0]-this.x)/this.width,(a[1]-this.y)/this.height];const{lastPoint:s}=this.#n;this.#m=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]}#x({highlightOutlines:e,highlightId:t,clipPathId:a}){this.#l=e;const s=1.5;if(this.#n=e.getNewOutline(this.#p/2+s,.0025),t>=0)this.#d=t,this.#r=a,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#g=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#n.box,path:{d:this.#n.toSVGPath()}},!0);else if(this.parent){const g=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:_r.#A(this.#l.box,(g-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#g,{bbox:_r.#A(this.#n.box,g),path:{d:this.#n.toSVGPath()}})}const[i,o,c,u]=e.box;switch(this.rotation){case 0:this.x=i,this.y=o,this.width=c,this.height=u;break;case 90:{const[g,v]=this.parentDimensions;this.x=o,this.y=1-i,this.width=c*v/g,this.height=u*g/v;break}case 180:this.x=1-i,this.y=1-o,this.width=c,this.height=u;break;case 270:{const[g,v]=this.parentDimensions;this.x=1-o,this.y=i,this.width=c*v/g,this.height=u*g/v;break}}const{firstPoint:d}=e;this.#f=[(d[0]-i)/c,(d[1]-o)/u];const{lastPoint:f}=this.#n;this.#m=[(f[0]-i)/c,(f[1]-o)/u]}static initialize(e,t){Ve.initialize(e,t),_r._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case gt.HIGHLIGHT_COLOR:_r._defaultColor=t;break;case gt.HIGHLIGHT_THICKNESS:_r._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(e,t){switch(e){case gt.HIGHLIGHT_COLOR:this.#S(t);break;case gt.HIGHLIGHT_THICKNESS:this.#E(t);break}}static get defaultPropertiesToUpdate(){return[[gt.HIGHLIGHT_COLOR,_r._defaultColor],[gt.HIGHLIGHT_THICKNESS,_r._defaultThickness]]}get propertiesToUpdate(){return[[gt.HIGHLIGHT_COLOR,this.color||_r._defaultColor],[gt.HIGHLIGHT_THICKNESS,this.#p||_r._defaultThickness],[gt.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#i?.updateColor(this.color),super.onUpdatedColor()}#S(e){const t=(i,o)=>{this.color=i,this.opacity=o,this.onUpdatedColor()},a=this.color,s=this.opacity;this.addCommands({cmd:t.bind(this,e,_r._defaultOpacity),undo:t.bind(this,a,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:gt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)}#E(e){const t=this.#p,a=s=>{this.#p=s,this.#b(s)};this.addCommands({cmd:a.bind(this,e),undo:a.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:gt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#i=new vs({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#N())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#N())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#y(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#C():e&&(this.#y(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#b(e){this.#h&&(this.#x({highlightOutlines:this.#l.getNewOutline(e/2)}),this.fixAndSetPosition(),this.setDims())}#C(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#g),this.#g=null)}#y(e=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#r}=e.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#g=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#n.box,path:{d:this.#n.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#r))}static#A([e,t,a,s],i){switch(i){case 90:return[1-t-s,e,s,a];case 180:return[1-e-a,1-t-s,a,s];case 270:return[t,1-e-a,s,a]}return[e,t,a,s]}rotate(e){const{drawLayer:t}=this.parent;let a;this.#h?(e=(e-this.rotation+360)%360,a=_r.#A(this.#l.box,e)):a=_r.#A([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#d,{bbox:a,root:{"data-main-rotation":e}}),t.updateProperties(this.#g,{bbox:_r.#A(this.#n.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#u&&(e.setAttribute("aria-label",this.#u),e.setAttribute("role","mark")),this.#h?e.classList.add("free"):this.div.addEventListener("keydown",this.#R.bind(this),{signal:this._uiManager._signal});const t=this.#c=document.createElement("div");return e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#r,this.setDims(),UA(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1}})}#R(e){_r._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#k(!0);break;case 1:case 3:this.#k(!1);break}}#k(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#s,this.#o)}select(){super.select(),this.#g&&this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#g&&(this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{selected:!1}}),this.#h||this.#k(!1))}get _mustFixPosition(){return!this.#h}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#g,{rootClass:{hidden:!e}}))}#N(){return this.#h?this.rotation:0}#j(){if(this.#h)return null;const[e,t]=this.pageDimensions,[a,s]=this.pageTranslation,i=this.#a,o=new Float32Array(i.length*8);let c=0;for(const{x:u,y:d,width:f,height:g}of i){const v=u*e+a,x=(1-d)*t+s;o[c]=o[c+4]=v,o[c+1]=o[c+3]=x,o[c+2]=o[c+6]=v+f*e,o[c+5]=o[c+7]=x-g*t,c+=8}return o}#D(e){return this.#l.serialize(e,this.#N())}static startHighlighting(e,t,{target:a,x:s,y:i}){const{x:o,y:c,width:u,height:d}=a.getBoundingClientRect(),f=new AbortController,g=e.combinedSignal(f),v=x=>{f.abort(),this.#P(e,x)};window.addEventListener("blur",v,{signal:g}),window.addEventListener("pointerup",v,{signal:g}),window.addEventListener("pointerdown",fr,{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",ys,{signal:g}),a.addEventListener("pointermove",this.#M.bind(this,e),{signal:g}),this._freeHighlight=new rm({x:s,y:i},[o,c,u,d],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#M(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#P(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,a){let s=null;if(e instanceof o2){const{data:{quadPoints:y,rect:_,rotation:w,id:A,color:T,opacity:S,popupRef:N,richText:R,contentsObj:O,creationDate:C,modificationDate:j},parent:{page:{pageNumber:I}}}=e;s=e={annotationType:tt.HIGHLIGHT,color:Array.from(T),opacity:S,quadPoints:y,boxes:null,pageIndex:I-1,rect:_.slice(0),rotation:w,annotationElementId:A,id:A,deleted:!1,popupRef:N,richText:R,comment:O?.str||null,creationDate:C,modificationDate:j}}else if(e instanceof av){const{data:{inkLists:y,rect:_,rotation:w,id:A,color:T,borderStyle:{rawWidth:S},popupRef:N,richText:R,contentsObj:O,creationDate:C,modificationDate:j},parent:{page:{pageNumber:I}}}=e;s=e={annotationType:tt.HIGHLIGHT,color:Array.from(T),thickness:S,inkLists:y,boxes:null,pageIndex:I-1,rect:_.slice(0),rotation:w,annotationElementId:A,id:A,deleted:!1,popupRef:N,richText:R,comment:O?.str||null,creationDate:C,modificationDate:j}}const{color:i,quadPoints:o,inkLists:c,opacity:u}=e,d=await super.deserialize(e,t,a);d.color=Le.makeHexColor(...i),d.opacity=u||1,c&&(d.#p=e.thickness),d._initialData=s,e.comment&&d.setCommentData(e);const[f,g]=d.pageDimensions,[v,x]=d.pageTranslation;if(o){const y=d.#a=[];for(let _=0;_<o.length;_+=8)y.push({x:(o[_]-v)/f,y:1-(o[_+1]-x)/g,width:(o[_+2]-o[_])/f,height:(o[_+1]-o[_+5])/g});d.#_(),d.#y(),d.rotate(d.rotation)}else if(c){d.#h=!0;const y=c[0],_={x:y[0]-v,y:g-(y[1]-x)},w=new rm(_,[0,0,f,g],1,d.#p/2,!0,.001);for(let S=0,N=y.length;S<N;S+=2)_.x=y[S]-v,_.y=g-(y[S+1]-x),w.add(_);const{id:A,clipPathId:T}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:w.toSVGPath()}},!0,!0);d.#x({highlightOutlines:w.getOutlines(),highlightId:A,clipPathId:T}),d.#y(),d.rotate(d.parentRotation)}return d}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=Ve._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),a=super.serialize(e);return Object.assign(a,{color:t,opacity:this.opacity,thickness:this.#p,quadPoints:this.#j(),outlines:this.#D(a.rect)}),this.addComment(a),this.annotationElementId&&!this.#L(a)?null:(a.id=this.annotationElementId,a)}#L(e){const{color:t}=this._initialData;return this.hasEditedComment||e.color.some((a,s)=>a!==t[s])}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class u2{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,a]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,a)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){Pt("Not implemented")}}class Tt extends Ve{#e=null;#t;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#a=null;static#r=null;static#i=null;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,this._addOutlines(e)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(e){e.drawOutlines&&(this.#n(e),this.#c())}#n({drawOutlines:e,drawId:t,drawingOptions:a}){this.#e=e,this._drawingOptions||=a,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#s(e,this.parent),this.#h(e.box)}#s(e,t){const{id:a}=t.drawLayer.draw(Tt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return a}static _mergeSVGProperties(e,t){const a=new Set(Object.keys(e));for(const[s,i]of Object.entries(t))a.has(s)?Object.assign(e[s],i):e[s]=i;return e}static getDefaultDrawingOptions(e){Pt("Not implemented")}static get typesMap(){Pt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const a=this.typesMap.get(e);a&&this._defaultDrawingOptions.updateProperty(a,t),this._currentParent&&(Tt.#a.updateProperty(a,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const a=this.constructor.typesMap.get(e);a&&this._updateProperty(e,a,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[a,s]of this.typesMap)e.push([a,t[s]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[a,s]of this.constructor.typesMap)e.push([a,t[s]]);return e}_updateProperty(e,t,a){const s=this._drawingOptions,i=s[t],o=c=>{s.updateProperty(t,c);const u=this.#e.updateProperty(t,c);u&&this.#h(u),this.parent?.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),e===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,a),undo:o.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Tt._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Tt._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Tt._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#o()):e&&(this._uiManager.addShouldRescale(this),this.#c(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#s(this.#e,e)}}#l([e,t,a,s]){const{parentDimensions:[i,o],rotation:c}=this;switch(c){case 90:return[t,1-e,a*(o/i),s*(i/o)];case 180:return[1-e,1-t,a,s];case 270:return[1-t,e,a*(o/i),s*(i/o)];default:return[e,t,a,s]}}#d(){const{x:e,y:t,width:a,height:s,parentDimensions:[i,o],rotation:c}=this;switch(c){case 90:return[1-t,e,a*(i/o),s*(o/i)];case 180:return[1-e,1-t,a,s];case 270:return[t,1-e,a*(i/o),s*(o/i)];default:return[e,t,a,s]}}#h(e){[this.x,this.y,this.width,this.height]=this.#l(e),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:e,y:t,width:a,height:s,rotation:i,parentRotation:o,parentDimensions:[c,u]}=this;switch((i*4+o)/90){case 1:return[1-t-s,e,s,a];case 2:return[1-e-a,1-t-s,a,s];case 3:return[t,1-e-a,s,a];case 4:return[e,t-a*(c/u),s*(u/c),a*(c/u)];case 5:return[1-t,e,a*(c/u),s*(u/c)];case 6:return[1-e-s*(u/c),1-t,s*(u/c),a*(c/u)];case 7:return[t-a*(c/u),1-e-s*(u/c),a*(c/u),s*(u/c)];case 8:return[e-a,t-s,a,s];case 9:return[1-t,e-a,s,a];case 10:return[1-e,1-t,a,s];case 11:return[t-s,1-e,s,a];case 12:return[e-s*(u/c),t,s*(u/c),a*(c/u)];case 13:return[1-t-a*(c/u),e-s*(u/c),a*(c/u),s*(u/c)];case 14:return[1-e,1-t-a*(c/u),s*(u/c),a*(c/u)];case 15:return[t,1-e,a*(c/u),s*(u/c)];default:return[e,t,a,s]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Tt._mergeSVGProperties({bbox:this.#f()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const a=super.render();a.classList.add("draw");const s=document.createElement("div");return a.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),a}static createDrawerInstance(e,t,a,s,i){Pt("Not implemented")}static startDrawing(e,t,a,s){const{target:i,offsetX:o,offsetY:c,pointerId:u,pointerType:d}=s;if(Ct.isInitializedAndDifferentPointerType(d))return;const{viewport:{rotation:f}}=e,{width:g,height:v}=i.getBoundingClientRect(),x=Tt.#r=new AbortController,y=e.combinedSignal(x);if(Ct.setPointer(d,u),window.addEventListener("pointerup",_=>{Ct.isSamePointerIdOrRemove(_.pointerId)&&this._endDraw(_)},{signal:y}),window.addEventListener("pointercancel",_=>{Ct.isSamePointerIdOrRemove(_.pointerId)&&this._currentParent.endDrawingSession()},{signal:y}),window.addEventListener("pointerdown",_=>{Ct.isSamePointerType(_.pointerType)&&(Ct.initializeAndAddPointerId(_.pointerId),Tt.#a.isCancellable()&&(Tt.#a.removeLastElement(),Tt.#a.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",ys,{signal:y}),i.addEventListener("pointermove",this._drawMove.bind(this),{signal:y}),i.addEventListener("touchmove",_=>{Ct.isSameTimeStamp(_.timeStamp)&&fr(_)},{signal:y}),e.toggleDrawing(),t._editorUndoBar?.hide(),Tt.#a){e.drawLayer.updateProperties(this._currentDrawId,Tt.#a.startNew(o,c,g,v,f));return}t.updateUIForDefaultProperties(this),Tt.#a=this.createDrawerInstance(o,c,g,v,f),Tt.#i=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(Tt.#i.toSVGProperties(),Tt.#a.defaultSVGProperties),!0,!1)}static _drawMove(e){if(Ct.isSameTimeStamp(e.timeStamp),!Tt.#a)return;const{offsetX:t,offsetY:a,pointerId:s}=e;if(Ct.isSamePointerId(s)){if(Ct.isUsingMultiplePointers()){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Tt.#a.add(t,a)),Ct.setTimeStamp(e.timeStamp),fr(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,Tt.#a=null,Tt.#i=null,Ct.clearTimeStamp()),Tt.#r&&(Tt.#r.abort(),Tt.#r=null,Ct.clearPointerIds())}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e?.target===t.div&&t.drawLayer.updateProperties(this._currentDrawId,Tt.#a.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const a=Tt.#a,s=this._currentDrawId,i=a.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(s,a.setLastElement(i))},undo:()=>{t.drawLayer.updateProperties(s,a.removeLastElement())},mustExec:!1,type:gt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(gt.DRAW_STEP),!Tt.#a.isEmpty()){const{pageDimensions:[a,s],scale:i}=t,o=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Tt.#a.getOutlines(a*i,s*i,i,this._INNER_MARGIN),drawingOptions:Tt.#i,mustBeCommitted:!e});return this._cleanup(!0),o}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,a,s,i,o){Pt("Not implemented")}static async deserialize(e,t,a){const{rawDims:{pageWidth:s,pageHeight:i,pageX:o,pageY:c}}=t.viewport,u=this.deserializeDraw(o,c,s,i,this._INNER_MARGIN,e),d=await super.deserialize(e,t,a);return d.createDrawingOptions(e),d.#n({drawOutlines:u}),d.#c(),d.onScaleChanging(),d.rotate(),d}serializeDraw(e){const[t,a]=this.pageTranslation,[s,i]=this.pageDimensions;return this.#e.serialize([t,a,s,i],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class K5{#e=new Float64Array(6);#t;#a;#r;#i;#n;#s="";#o=0;#c=new Ju;#l;#d;constructor(e,t,a,s,i,o){this.#l=a,this.#d=s,this.#r=i,this.#i=o,[e,t]=this.#h(e,t);const c=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#n=[e,t],this.#a=[{line:c,points:this.#n}],this.#e.set(c,0)}updateProperty(e,t){e==="stroke-width"&&(this.#i=t)}#h(e,t){return Ie._normalizePoint(e,t,this.#l,this.#d,this.#r)}isEmpty(){return!this.#a||this.#a.length===0}isCancellable(){return this.#n.length<=10}add(e,t){[e,t]=this.#h(e,t);const[a,s,i,o]=this.#e.subarray(2,6),c=e-i,u=t-o;return Math.hypot(this.#l*c,this.#d*u)<=2?null:(this.#n.push(e,t),isNaN(a)?(this.#e.set([i,o,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([a,s,i,o,e,t],0),this.#t.push(...Ie.createBezierPoints(a,s,i,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const a=this.add(e,t);return a||(this.#n.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,a,s,i){this.#l=a,this.#d=s,this.#r=i,[e,t]=this.#h(e,t);const o=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#n=[e,t];const c=this.#a.at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),this.#a.push({line:o,points:this.#n}),this.#e.set(o,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#a.at(-1)}setLastElement(e){return this.#a?(this.#a.push(e),this.#t=e.line,this.#n=e.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(e)}removeLastElement(){if(!this.#a)return this.#c.removeLastElement();this.#a.pop(),this.#s="";for(let e=0,t=this.#a.length;e<t;e++){const{line:a,points:s}=this.#a[e];this.#t=a,this.#n=s,this.#o=0,this.toSVGPath()}return{path:{d:this.#s}}}toSVGPath(){const e=Ie.svgRound(this.#t[4]),t=Ie.svgRound(this.#t[5]);if(this.#n.length===2)return this.#s=`${this.#s} M ${e} ${t} Z`,this.#s;if(this.#n.length<=6){const s=this.#s.lastIndexOf("M");this.#s=`${this.#s.slice(0,s)} M ${e} ${t}`,this.#o=6}if(this.#n.length===4){const s=Ie.svgRound(this.#t[10]),i=Ie.svgRound(this.#t[11]);return this.#s=`${this.#s} L ${s} ${i}`,this.#o=12,this.#s}const a=[];this.#o===0&&(a.push(`M ${e} ${t}`),this.#o=6);for(let s=this.#o,i=this.#t.length;s<i;s+=6){const[o,c,u,d,f,g]=this.#t.slice(s,s+6).map(Ie.svgRound);a.push(`C${o} ${c} ${u} ${d} ${f} ${g}`)}return this.#s+=a.join(" "),this.#o=this.#t.length,this.#s}getOutlines(e,t,a,s){const i=this.#a.at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),this.#c.build(this.#a,e,t,a,this.#r,this.#i,s),this.#e=null,this.#t=null,this.#a=null,this.#s=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Ju extends Ie{#e;#t=0;#a;#r;#i;#n;#s;#o;#c;build(e,t,a,s,i,o,c){this.#i=t,this.#n=a,this.#s=s,this.#o=i,this.#c=o,this.#a=c??0,this.#r=e,this.#h()}get thickness(){return this.#c}setLastElement(e){return this.#r.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#r.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#r){if(e.push(`M${Ie.svgRound(t[4])} ${Ie.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12&&isNaN(t[6])){e.push(`L${Ie.svgRound(t[10])} ${Ie.svgRound(t[11])}`);continue}for(let a=6,s=t.length;a<s;a+=6){const[i,o,c,u,d,f]=t.subarray(a,a+6).map(Ie.svgRound);e.push(`C${i} ${o} ${c} ${u} ${d} ${f}`)}}return e.join("")}serialize([e,t,a,s],i){const o=[],c=[],[u,d,f,g]=this.#d();let v,x,y,_,w,A,T,S,N;switch(this.#o){case 0:N=Ie._rescale,v=e,x=t+s,y=a,_=-s,w=e+u*a,A=t+(1-d-g)*s,T=e+(u+f)*a,S=t+(1-d)*s;break;case 90:N=Ie._rescaleAndSwap,v=e,x=t,y=a,_=s,w=e+d*a,A=t+u*s,T=e+(d+g)*a,S=t+(u+f)*s;break;case 180:N=Ie._rescale,v=e+a,x=t,y=-a,_=s,w=e+(1-u-f)*a,A=t+d*s,T=e+(1-u)*a,S=t+(d+g)*s;break;case 270:N=Ie._rescaleAndSwap,v=e+a,x=t+s,y=-a,_=-s,w=e+(1-d-g)*a,A=t+(1-u-f)*s,T=e+(1-d)*a,S=t+(1-u)*s;break}for(const{line:R,points:O}of this.#r)o.push(N(R,v,x,y,_,i?new Array(R.length):null)),c.push(N(O,v,x,y,_,i?new Array(O.length):null));return{lines:o,points:c,rect:[w,A,T,S]}}static deserialize(e,t,a,s,i,{paths:{lines:o,points:c},rotation:u,thickness:d}){const f=[];let g,v,x,y,_;switch(u){case 0:_=Ie._rescale,g=-e/a,v=t/s+1,x=1/a,y=-1/s;break;case 90:_=Ie._rescaleAndSwap,g=-t/s,v=-e/a,x=1/s,y=1/a;break;case 180:_=Ie._rescale,g=e/a+1,v=-t/s,x=-1/a,y=1/s;break;case 270:_=Ie._rescaleAndSwap,g=t/s+1,v=e/a+1,x=-1/s,y=-1/a;break}if(!o){o=[];for(const A of c){const T=A.length;if(T===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,A[0],A[1]]));continue}if(T===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,A[0],A[1],NaN,NaN,NaN,NaN,A[2],A[3]]));continue}const S=new Float32Array(3*(T-2));o.push(S);let[N,R,O,C]=A.subarray(0,4);S.set([NaN,NaN,NaN,NaN,N,R],0);for(let j=4;j<T;j+=2){const I=A[j],W=A[j+1];S.set(Ie.createBezierPoints(N,R,O,C,I,W),(j-2)*3),[N,R,O,C]=[O,C,I,W]}}}for(let A=0,T=o.length;A<T;A++)f.push({line:_(o[A].map(S=>S??NaN),g,v,x,y),points:_(c[A].map(S=>S??NaN),g,v,x,y)});const w=new this.prototype.constructor;return w.build(f,a,s,1,u,d,i),w}#l(e=this.#c){const t=this.#a+e/2*this.#s;return this.#o%180===0?[t/this.#i,t/this.#n]:[t/this.#n,t/this.#i]}#d(){const[e,t,a,s]=this.#e,[i,o]=this.#l(0);return[e+i,t+o,a-2*i,s-2*o]}#h(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:s}of this.#r){if(s.length<=12){for(let c=4,u=s.length;c<u;c+=6)Le.pointBoundingBox(s[c],s[c+1],e);continue}let i=s[4],o=s[5];for(let c=6,u=s.length;c<u;c+=6){const[d,f,g,v,x,y]=s.subarray(c,c+6);Le.bezierBoundingBox(i,o,d,f,g,v,x,y,e),i=x,o=y}}const[t,a]=this.#l();e[0]=da(e[0]-t,0,1),e[1]=da(e[1]-a,0,1),e[2]=da(e[2]+t,0,1),e[3]=da(e[3]+a,0,1),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#f(t):null}#f(e){const[t,a]=this.#l();this.#c=e;const[s,i]=this.#l(),[o,c]=[s-t,i-a],u=this.#e;return u[0]-=o,u[1]-=c,u[2]+=2*o,u[3]+=2*c,u}updateParentDimensions([e,t],a){const[s,i]=this.#l();this.#i=e,this.#n=t,this.#s=a;const[o,c]=this.#l(),u=o-s,d=c-i,f=this.#e;return f[0]-=u,f[1]-=d,f[2]+=2*u,f[3]+=2*d,f}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(Ie.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ie.svgRound(e)} ${Ie.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let a=0,s=0,i=0,o=0,c=0,u=0;switch(this.#t){case 90:s=t/e,i=-e/t,c=e;break;case 180:a=-1,o=-1,c=e,u=t;break;case 270:s=-t/e,i=e/t,u=t;break;default:return""}return`matrix(${a} ${s} ${i} ${o} ${Ie.svgRound(c)} ${Ie.svgRound(u)})`}getPathResizingSVGProperties([e,t,a,s]){const[i,o]=this.#l(),[c,u,d,f]=this.#e;if(Math.abs(d-i)<=Ie.PRECISION||Math.abs(f-o)<=Ie.PRECISION){const _=e+a/2-(c+d/2),w=t+s/2-(u+f/2);return{path:{"transform-origin":`${Ie.svgRound(e)} ${Ie.svgRound(t)}`,transform:`${this.rotationTransform} translate(${_} ${w})`}}}const g=(a-2*i)/(d-2*i),v=(s-2*o)/(f-2*o),x=d/a,y=f/s;return{path:{"transform-origin":`${Ie.svgRound(c)} ${Ie.svgRound(u)}`,transform:`${this.rotationTransform} scale(${x} ${y}) translate(${Ie.svgRound(i)} ${Ie.svgRound(o)}) scale(${g} ${v}) translate(${Ie.svgRound(-i)} ${Ie.svgRound(-o)})`}}}getPathResizedSVGProperties([e,t,a,s]){const[i,o]=this.#l(),c=this.#e,[u,d,f,g]=c;if(c[0]=e,c[1]=t,c[2]=a,c[3]=s,Math.abs(f-i)<=Ie.PRECISION||Math.abs(g-o)<=Ie.PRECISION){const w=e+a/2-(u+f/2),A=t+s/2-(d+g/2);for(const{line:T,points:S}of this.#r)Ie._translate(T,w,A,T),Ie._translate(S,w,A,S);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ie.svgRound(e)} ${Ie.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const v=(a-2*i)/(f-2*i),x=(s-2*o)/(g-2*o),y=-v*(u+i)+e+i,_=-x*(d+o)+t+o;if(v!==1||x!==1||y!==0||_!==0)for(const{line:w,points:A}of this.#r)Ie._rescale(w,y,_,v,x,w),Ie._rescale(A,y,_,v,x,A);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ie.svgRound(e)} ${Ie.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],a){const[s,i]=a,o=this.#e,c=e-o[0],u=t-o[1];if(this.#i===s&&this.#n===i)for(const{line:d,points:f}of this.#r)Ie._translate(d,c,u,d),Ie._translate(f,c,u,f);else{const d=this.#i/s,f=this.#n/i;this.#i=s,this.#n=i;for(const{line:g,points:v}of this.#r)Ie._rescale(g,c,u,d,f,g),Ie._rescale(v,c,u,d,f,v);o[2]*=d,o[3]*=f}return o[0]=e,o[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Ie.svgRound(e)} ${Ie.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Ie.svgRound(e[0])} ${Ie.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class Sf extends u2{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Ve._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Sf(this._viewParameters);return e.updateAll(this),e}}class nv extends Tt{static _type="ink";static _editorType=tt.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){Ve.initialize(e,t),this._defaultDrawingOptions=new Sf(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return et(this,"typesMap",new Map([[gt.INK_THICKNESS,"stroke-width"],[gt.INK_COLOR,"stroke"],[gt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,a,s,i){return new K5(e,t,a,s,i,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,a,s,i,o){return Ju.deserialize(e,t,a,s,i,o)}static async deserialize(e,t,a){let s=null;if(e instanceof av){const{data:{inkLists:o,rect:c,rotation:u,id:d,color:f,opacity:g,borderStyle:{rawWidth:v},popupRef:x,richText:y,contentsObj:_,creationDate:w,modificationDate:A},parent:{page:{pageNumber:T}}}=e;s=e={annotationType:tt.INK,color:Array.from(f),thickness:v,opacity:g,paths:{points:o},boxes:null,pageIndex:T-1,rect:c.slice(0),rotation:u,annotationElementId:d,id:d,deleted:!1,popupRef:x,richText:y,comment:_?.str||null,creationDate:w,modificationDate:A}}const i=await super.deserialize(e,t,a);return i._initialData=s,e.comment&&i.setCommentData(e),i}get toolbarButtons(){return this._colorPicker||=new Du(this),[["colorPicker",this._colorPicker]]}get colorType(){return gt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:a}=this;t.updateSVGProperty("stroke-width"),a.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:a}){this._drawingOptions=nv.getDefaultDrawingOptions({stroke:Le.makeHexColor(...e),"stroke-width":t,"stroke-opacity":a})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:a}=this.serializeDraw(e),{_drawingOptions:{stroke:s,"stroke-opacity":i,"stroke-width":o}}=this,c=Object.assign(super.serialize(e),{color:Ve._colorManager.convert(s),opacity:i,thickness:o,paths:{lines:t,points:a}});return this.addComment(c),e?(c.isCopy=!0,c):this.annotationElementId&&!this.#e(c)?null:(c.id=this.annotationElementId,c)}#e(e){const{color:t,thickness:a,opacity:s,pageIndex:i}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((o,c)=>o!==t[c])||e.thickness!==a||e.opacity!==s||e.pageIndex!==i}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;const{points:t,rect:a}=this.serializeDraw(!1);return e.updateEdited({rect:a,thickness:this._drawingOptions["stroke-width"],points:t,popup:this.comment}),null}}class am extends Ju{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Id=8,Gc=3;class wl{static#e={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#t(e,t,a,s){return a-=e,s-=t,a===0?s>0?0:4:a===1?s+6:2-s}static#a=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#r(e,t,a,s,i,o,c){const u=this.#t(a,s,i,o);for(let d=0;d<8;d++){const f=(-d+u-c+16)%8,g=this.#a[2*f],v=this.#a[2*f+1];if(e[(a+g)*t+(s+v)]!==0)return f}return-1}static#i(e,t,a,s,i,o,c){const u=this.#t(a,s,i,o);for(let d=0;d<8;d++){const f=(d+u+c+16)%8,g=this.#a[2*f],v=this.#a[2*f+1];if(e[(a+g)*t+(s+v)]!==0)return f}return-1}static#n(e,t,a,s){const i=e.length,o=new Int32Array(i);for(let f=0;f<i;f++)o[f]=e[f]<=s?1:0;for(let f=1;f<a-1;f++)o[f*t]=o[f*t+t-1]=0;for(let f=0;f<t;f++)o[f]=o[t*a-1-f]=0;let c=1,u;const d=[];for(let f=1;f<a-1;f++){u=1;for(let g=1;g<t-1;g++){const v=f*t+g,x=o[v];if(x===0)continue;let y=f,_=g;if(x===1&&o[v-1]===0)c+=1,_-=1;else if(x>=1&&o[v+1]===0)c+=1,_+=1,x>1&&(u=x);else{x!==1&&(u=Math.abs(x));continue}const w=[g,f],A=_===g+1,T={isHole:A,points:w,id:c,parent:0};d.push(T);let S;for(const H of d)if(H.id===u){S=H;break}S?S.isHole?T.parent=A?S.parent:u:T.parent=A?u:S.parent:T.parent=A?u:0;const N=this.#r(o,t,f,g,y,_,0);if(N===-1){o[v]=-c,o[v]!==1&&(u=Math.abs(o[v]));continue}let R=this.#a[2*N],O=this.#a[2*N+1];const C=f+R,j=g+O;y=C,_=j;let I=f,W=g;for(;;){const H=this.#i(o,t,I,W,y,_,1);R=this.#a[2*H],O=this.#a[2*H+1];const D=I+R,z=W+O;w.push(z,D);const ne=I*t+W;if(o[ne+1]===0?o[ne]=-c:o[ne]===1&&(o[ne]=c),D===f&&z===g&&I===C&&W===j){o[v]!==1&&(u=Math.abs(o[v]));break}else y=I,_=W,I=D,W=z}}}return d}static#s(e,t,a,s){if(a-t<=4){for(let C=t;C<a-2;C+=2)s.push(e[C],e[C+1]);return}const i=e[t],o=e[t+1],c=e[a-4]-i,u=e[a-3]-o,d=Math.hypot(c,u),f=c/d,g=u/d,v=f*o-g*i,x=u/c,y=1/d,_=Math.atan(x),w=Math.cos(_),A=Math.sin(_),T=y*(Math.abs(w)+Math.abs(A)),S=y*(1-T+T**2),N=Math.max(Math.atan(Math.abs(A+w)*S),Math.atan(Math.abs(A-w)*S));let R=0,O=t;for(let C=t+2;C<a-2;C+=2){const j=Math.abs(v-f*e[C+1]+g*e[C]);j>R&&(O=C,R=j)}R>(d*N)**2?(this.#s(e,t,O+2,s),this.#s(e,O,a,s)):s.push(i,o)}static#o(e){const t=[],a=e.length;return this.#s(e,0,a,t),t.push(e[a-2],e[a-1]),t.length<=4?null:t}static#c(e,t,a,s,i,o){const c=new Float32Array(o**2),u=-2*s**2,d=o>>1;for(let _=0;_<o;_++){const w=(_-d)**2;for(let A=0;A<o;A++)c[_*o+A]=Math.exp((w+(A-d)**2)/u)}const f=new Float32Array(256),g=-2*i**2;for(let _=0;_<256;_++)f[_]=Math.exp(_**2/g);const v=e.length,x=new Uint8Array(v),y=new Uint32Array(256);for(let _=0;_<a;_++)for(let w=0;w<t;w++){const A=_*t+w,T=e[A];let S=0,N=0;for(let O=0;O<o;O++){const C=_+O-d;if(!(C<0||C>=a))for(let j=0;j<o;j++){const I=w+j-d;if(I<0||I>=t)continue;const W=e[C*t+I],H=c[O*o+j]*f[Math.abs(W-T)];S+=W*H,N+=H}}const R=x[A]=Math.round(S/N);y[R]++}return[x,y]}static#l(e){const t=new Uint32Array(256);for(const a of e)t[a]++;return t}static#d(e){const t=e.length,a=new Uint8ClampedArray(t>>2);let s=-1/0,i=1/0;for(let c=0,u=a.length;c<u;c++){const d=a[c]=e[c<<2];s=Math.max(s,d),i=Math.min(i,d)}const o=255/(s-i);for(let c=0,u=a.length;c<u;c++)a[c]=(a[c]-i)*o;return a}static#h(e){let t,a=-1/0,s=-1/0;const i=e.findIndex(u=>u!==0);let o=i,c=i;for(t=i;t<256;t++){const u=e[t];u>a&&(t-o>s&&(s=t-o,c=t-1),a=u,o=t)}for(t=c-1;t>=0&&!(e[t]>e[t+1]);t--);return t}static#f(e){const t=e,{width:a,height:s}=e,{maxDim:i}=this.#e;let o=a,c=s;if(a>i||s>i){let v=a,x=s,y=Math.log2(Math.max(a,s)/i);const _=Math.floor(y);y=y===_?_-1:_;for(let A=0;A<y;A++){o=Math.ceil(v/2),c=Math.ceil(x/2);const T=new OffscreenCanvas(o,c);T.getContext("2d").drawImage(e,0,0,v,x,0,0,o,c),v=o,x=c,e!==t&&e.close(),e=T.transferToImageBitmap()}const w=Math.min(i/o,i/c);o=Math.round(o*w),c=Math.round(c*w)}const d=new OffscreenCanvas(o,c).getContext("2d",{willReadFrequently:!0});d.fillStyle="white",d.fillRect(0,0,o,c),d.filter="grayscale(1)",d.drawImage(e,0,0,e.width,e.height,0,0,o,c);const f=d.getImageData(0,0,o,c).data;return[this.#d(f),o,c]}static extractContoursFromText(e,{fontFamily:t,fontStyle:a,fontWeight:s},i,o,c,u){let d=new OffscreenCanvas(1,1),f=d.getContext("2d",{alpha:!1});const g=200,v=f.font=`${a} ${s} ${g}px ${t}`,{actualBoundingBoxLeft:x,actualBoundingBoxRight:y,actualBoundingBoxAscent:_,actualBoundingBoxDescent:w,fontBoundingBoxAscent:A,fontBoundingBoxDescent:T,width:S}=f.measureText(e),N=1.5,R=Math.ceil(Math.max(Math.abs(x)+Math.abs(y)||0,S)*N),O=Math.ceil(Math.max(Math.abs(_)+Math.abs(w)||g,Math.abs(A)+Math.abs(T)||g)*N);d=new OffscreenCanvas(R,O),f=d.getContext("2d",{alpha:!0,willReadFrequently:!0}),f.font=v,f.filter="grayscale(1)",f.fillStyle="white",f.fillRect(0,0,R,O),f.fillStyle="black",f.fillText(e,R*(N-1)/2,O*(3-N)/2);const C=this.#d(f.getImageData(0,0,R,O).data),j=this.#l(C),I=this.#h(j),W=this.#n(C,R,O,I);return this.processDrawnLines({lines:{curves:W,width:R,height:O},pageWidth:i,pageHeight:o,rotation:c,innerMargin:u,mustSmooth:!0,areContours:!0})}static process(e,t,a,s,i){const[o,c,u]=this.#f(e),[d,f]=this.#c(o,c,u,Math.hypot(c,u)*this.#e.sigmaSFactor,this.#e.sigmaR,this.#e.kernelSize),g=this.#h(f),v=this.#n(d,c,u,g);return this.processDrawnLines({lines:{curves:v,width:c,height:u},pageWidth:t,pageHeight:a,rotation:s,innerMargin:i,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:a,rotation:s,innerMargin:i,mustSmooth:o,areContours:c}){s%180!==0&&([t,a]=[a,t]);const{curves:u,width:d,height:f}=e,g=e.thickness??0,v=[],x=Math.min(t/d,a/f),y=x/t,_=x/a,w=[];for(const{points:T}of u){const S=o?this.#o(T):T;if(!S)continue;w.push(S);const N=S.length,R=new Float32Array(N),O=new Float32Array(3*(N===2?2:N-2));if(v.push({line:O,points:R}),N===2){R[0]=S[0]*y,R[1]=S[1]*_,O.set([NaN,NaN,NaN,NaN,R[0],R[1]],0);continue}let[C,j,I,W]=S;C*=y,j*=_,I*=y,W*=_,R.set([C,j,I,W],0),O.set([NaN,NaN,NaN,NaN,C,j],0);for(let H=4;H<N;H+=2){const D=R[H]=S[H]*y,z=R[H+1]=S[H+1]*_;O.set(Ie.createBezierPoints(C,j,I,W,D,z),(H-2)*3),[C,j,I,W]=[I,W,D,z]}}if(v.length===0)return null;const A=c?new am:new Ju;return A.build(v,t,a,1,s,c?0:g,i),{outline:A,newCurves:w,areContours:c,thickness:g,width:d,height:f}}static async compressSignature({outlines:e,areContours:t,thickness:a,width:s,height:i}){let o=1/0,c=-1/0,u=0;for(const S of e){u+=S.length;for(let N=2,R=S.length;N<R;N++){const O=S[N]-S[N-2];o=Math.min(o,O),c=Math.max(c,O)}}let d;o>=-128&&c<=127?d=Int8Array:o>=-32768&&c<=32767?d=Int16Array:d=Int32Array;const f=e.length,g=Id+Gc*f,v=new Uint32Array(g);let x=0;v[x++]=g*Uint32Array.BYTES_PER_ELEMENT+(u-2*f)*d.BYTES_PER_ELEMENT,v[x++]=0,v[x++]=s,v[x++]=i,v[x++]=t?0:1,v[x++]=Math.max(0,Math.floor(a??0)),v[x++]=f,v[x++]=d.BYTES_PER_ELEMENT;for(const S of e)v[x++]=S.length-2,v[x++]=S[0],v[x++]=S[1];const y=new CompressionStream("deflate-raw"),_=y.writable.getWriter();await _.ready,_.write(v);const w=d.prototype.constructor;for(const S of e){const N=new w(S.length-2);for(let R=2,O=S.length;R<O;R++)N[R-2]=S[R]-S[R-2];_.write(N)}_.close();const A=await new Response(y.readable).arrayBuffer(),T=new Uint8Array(A);return IA(T)}static async decompressSignature(e){try{const t=hB(e),{readable:a,writable:s}=new DecompressionStream("deflate-raw"),i=s.getWriter();await i.ready,i.write(t).then(async()=>{await i.ready,await i.close()}).catch(()=>{});let o=null,c=0;for await(const S of a)o||=new Uint8Array(new Uint32Array(S.buffer,0,4)[0]),o.set(S,c),c+=S.length;const u=new Uint32Array(o.buffer,0,o.length>>2),d=u[1];if(d!==0)throw new Error(`Invalid version: ${d}`);const f=u[2],g=u[3],v=u[4]===0,x=u[5],y=u[6],_=u[7],w=[],A=(Id+Gc*y)*Uint32Array.BYTES_PER_ELEMENT;let T;switch(_){case Int8Array.BYTES_PER_ELEMENT:T=new Int8Array(o.buffer,A);break;case Int16Array.BYTES_PER_ELEMENT:T=new Int16Array(o.buffer,A);break;case Int32Array.BYTES_PER_ELEMENT:T=new Int32Array(o.buffer,A);break}c=0;for(let S=0;S<y;S++){const N=u[Gc*S+Id],R=new Float32Array(N+2);w.push(R);for(let O=0;O<Gc-1;O++)R[O]=u[Gc*S+Id+O+1];for(let O=0;O<N;O++)R[O+2]=R[O]+T[c++]}return{areContours:v,thickness:x,outlines:w,width:f,height:g}}catch(t){return Ze(`decompressSignature: ${t}`),null}}}class iv extends u2{constructor(){super(),super.updateProperties({fill:Ve._defaultLineColor,"stroke-width":0})}clone(){const e=new iv;return e.updateAll(this),e}}class ov extends Sf{constructor(e){super(e),super.updateProperties({stroke:Ve._defaultLineColor,"stroke-width":1})}clone(){const e=new ov(this._viewParameters);return e.updateAll(this),e}}class Zs extends Tt{#e=!1;#t=null;#a=null;#r=null;static _type="signature";static _editorType=tt.SIGNATURE;static _defaultDrawingOptions=null;constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#a=e.signatureData||null,this.#t=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){Ve.initialize(e,t),this._defaultDrawingOptions=new iv,this._defaultDrawnSignatureOptions=new ov(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return et(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#t}}static computeTelemetryFinalData(e){const t=e.get("hasDescription");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:a}=this;if(a&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),this._drawId===null)if(this.#a){const{lines:s,mustSmooth:i,areContours:o,description:c,uuid:u,heightInPage:d}=this.#a,{rawDims:{pageWidth:f,pageHeight:g},rotation:v}=this.parent.viewport,x=wl.processDrawnLines({lines:s,pageWidth:f,pageHeight:g,rotation:v,innerMargin:Zs._INNER_MARGIN,mustSmooth:i,areContours:o});this.addSignature(x,d,c,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#t||""}));return a&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){this.#r=e,this.addEditToolbar()}getUuid(){return this.#r}get description(){return this.#t}set description(e){this.#t=e,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(t=>{t?.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:a,width:s,height:i}=this.#a,o=Math.max(s,i),c=wl.processDrawnLines({lines:{curves:e.map(u=>({points:u})),thickness:a,width:s,height:i},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t});return{areContours:t,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,a,s){const{x:i,y:o}=this,{outline:c}=this.#a=e;this.#e=c instanceof am,this.description=a;let u;this.#e?u=Zs.getDefaultDrawingOptions():(u=Zs._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:u});const[,d]=this.pageDimensions;let f=t/d;f=f>=1?.5:f,this.width*=f/this.height,this.width>=1&&(f*=.9/this.width,this.width=.9),this.height=f,this.setDims(),this.x=i,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!a}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:a},rotation:s}=this.parent.viewport;return wl.process(e,t,a,s,Zs._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:a,pageHeight:s},rotation:i}=this.parent.viewport;return wl.extractContoursFromText(e,t,a,s,i,Zs._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:a},rotation:s}=this.parent.viewport;return wl.processDrawnLines({lines:e,pageWidth:t,pageHeight:a,rotation:s,innerMargin:Zs._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:t}){e?this._drawingOptions=Zs.getDefaultDrawingOptions():(this._drawingOptions=Zs._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":t}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:t,points:a}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":s}}=this,i=Object.assign(super.serialize(e),{isSignature:!0,areContours:this.#e,color:[0,0,0],thickness:this.#e?0:s});return this.addComment(i),e?(i.paths={lines:t,points:a},i.uuid=this.#r,i.isCopy=!0):i.lines=t,this.#t&&(i.accessibilityData={type:"Figure",alt:this.#t}),i}static deserializeDraw(e,t,a,s,i,o){return o.areContours?am.deserialize(e,t,a,s,i,o):Ju.deserialize(e,t,a,s,i,o)}static async deserialize(e,t,a){const s=await super.deserialize(e,t,a);return s.#e=e.areContours,s.description=e.accessibilityData?.alt||"",s.#r=e.uuid,s}}class J5 extends Ve{#e=null;#t=null;#a=null;#r=null;#i=null;#n="";#s=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=tt.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#r=e.bitmapUrl,this.#i=e.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){Ve.initialize(e,t)}static isHandlingMimeForPasting(e){return Xg.includes(e)}static paste(e,t){t.pasteEditor({mode:tt.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#h(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#l=e.isSvg),e.file&&(this.#n=e.file.name),this.#g()}#f(){if(this.#a=null,this._uiManager.enableWaiting(!1),!!this.#s){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:a}=this._uiManager;if(!a)throw new Error("No ML.");if(!await a.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:i,height:o}=e||this.copyCanvas(null,null,!0).imageData,c=await a.guess({name:"altText",request:{data:s,width:i,height:o,channels:s.length/(i*o)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const u=c.output;return await this.setGuessedAltText(u),t&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}#m(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(a=>this.#h(a,!0)).finally(()=>this.#f());return}if(this.#r){const a=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#a=this._uiManager.imageManager.getFromUrl(a).then(s=>this.#h(s)).finally(()=>this.#f());return}if(this.#i){const a=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#a=this._uiManager.imageManager.getFromFile(a).then(s=>this.#h(s)).finally(()=>this.#f());return}const e=document.createElement("input");e.type="file",e.accept=Xg.join(",");const t=this._uiManager._signal;this.#a=new Promise(a=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(s)}a()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),a()},{signal:t})}).finally(()=>this.#f()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#s?.remove(),this.#s=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#m();return}super.rebuild(),this.div!==null&&(this.#t&&this.#s===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#a||this.#e||this.#r||this.#i||this.#t||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#e?this.#g():this.#m()),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:a,bitmap:s}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),a&&this._uiManager.imageManager.isValidId(a)&&(this.#t=a,s&&(this.#e=s),this.#o=!1,this.#g())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const e=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},e)}#g(){const{div:e}=this;let{width:t,height:a}=this.#e;const[s,i]=this.pageDimensions,o=.75;if(this.width)t=this.width*s,a=this.height*i;else if(t>o*s||a>o*i){const u=Math.min(o*s/t,o*i/a);t*=u,a*=u}this._uiManager.enableWaiting(!1);const c=this.#s=document.createElement("canvas");c.setAttribute("role","img"),this.addContainer(c),this.width=t/s,this.height=a/i,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#n&&this.div.setAttribute("aria-description",this.#n),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(e,t,a=!1){e||(e=224);const{width:s,height:i}=this.#e,o=new rn;let c=this.#e,u=s,d=i,f=null;if(t){if(s>t||i>t){const O=Math.min(t/s,t/i);u=Math.floor(s*O),d=Math.floor(i*O)}f=document.createElement("canvas");const v=f.width=Math.ceil(u*o.sx),x=f.height=Math.ceil(d*o.sy);this.#l||(c=this.#u(v,x));const y=f.getContext("2d");y.filter=this._uiManager.hcmFilter;let _="white",w="#cfcfd8";this._uiManager.hcmFilter!=="none"?w="black":vB.isDarkMode&&(_="#8f8f9d",w="#42414d");const A=15,T=A*o.sx,S=A*o.sy,N=new OffscreenCanvas(T*2,S*2),R=N.getContext("2d");R.fillStyle=_,R.fillRect(0,0,T*2,S*2),R.fillStyle=w,R.fillRect(0,0,T,S),R.fillRect(T,S,T,S),y.fillStyle=y.createPattern(N,"repeat"),y.fillRect(0,0,v,x),y.drawImage(c,0,0,c.width,c.height,0,0,v,x)}let g=null;if(a){let v,x;if(o.symmetric&&c.width<e&&c.height<e)v=c.width,x=c.height;else if(c=this.#e,s>e||i>e){const w=Math.min(e/s,e/i);v=Math.floor(s*w),x=Math.floor(i*w),this.#l||(c=this.#u(v,x))}const _=new OffscreenCanvas(v,x).getContext("2d",{willReadFrequently:!0});_.drawImage(c,0,0,c.width,c.height,0,0,v,x),g={width:v,height:x,data:_.getImageData(0,0,v,x).data}}return{canvas:f,width:u,height:d,imageData:g}}#u(e,t){const{width:a,height:s}=this.#e;let i=a,o=s,c=this.#e;for(;i>2*e||o>2*t;){const u=i,d=o;i>2*e&&(i=i>=16384?Math.floor(i/2)-1:Math.ceil(i/2)),o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const f=new OffscreenCanvas(i,o);f.getContext("2d").drawImage(c,0,0,u,d,0,0,i,o),c=f.transferToImageBitmap()}return c}#p(){const[e,t]=this.parentDimensions,{width:a,height:s}=this,i=new rn,o=Math.ceil(a*e*i.sx),c=Math.ceil(s*t*i.sy),u=this.#s;if(!u||u.width===o&&u.height===c)return;u.width=o,u.height=c;const d=this.#l?this.#e:this.#u(o,c),f=u.getContext("2d");f.filter=this._uiManager.hcmFilter,f.drawImage(d,0,0,d.width,d.height,0,0,o,c)}#v(e){if(e){if(this.#l){const s=this._uiManager.imageManager.getSvgUrl(this.#t);if(s)return s}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#l){const[t,a]=this.pageDimensions,s=Math.round(this.width*t*Pl.PDF_TO_CSS_UNITS),i=Math.round(this.height*a*Pl.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(s,i);return o.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,s,i),o.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,a){let s=null,i=!1;if(e instanceof l2){const{data:{rect:_,rotation:w,id:A,structParent:T,popupRef:S,richText:N,contentsObj:R,creationDate:O,modificationDate:C},container:j,parent:{page:{pageNumber:I}},canvas:W}=e;let H,D;W?(delete e.canvas,{id:H,bitmap:D}=a.imageManager.getFromCanvas(j.id,W),W.remove()):(i=!0,e._hasNoCanvas=!0);const z=(await t._structTree.getAriaAttributes(`${Sl}${A}`))?.get("aria-label")||"";s=e={annotationType:tt.STAMP,bitmapId:H,bitmap:D,pageIndex:I-1,rect:_.slice(0),rotation:w,annotationElementId:A,id:A,deleted:!1,accessibilityData:{decorative:!1,altText:z},isSvg:!1,structParent:T,popupRef:S,richText:N,comment:R?.str||null,creationDate:O,modificationDate:C}}const o=await super.deserialize(e,t,a),{rect:c,bitmap:u,bitmapUrl:d,bitmapId:f,isSvg:g,accessibilityData:v}=e;i?(a.addMissingCanvas(e.id,o),o.#o=!0):f&&a.imageManager.isValidId(f)?(o.#t=f,u&&(o.#e=u)):o.#r=d,o.#l=g;const[x,y]=o.pageDimensions;return o.width=(c[2]-c[0])/x,o.height=(c[3]-c[1])/y,v&&(o.altTextData=v),o._initialData=s,e.comment&&o.setCommentData(e),o.#d=!!s,o}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const a=Object.assign(super.serialize(e),{bitmapId:this.#t,isSvg:this.#l});if(this.addComment(a),e)return a.bitmapUrl=this.#v(!0),a.accessibilityData=this.serializeAltText(!0),a.isCopy=!0,a;const{decorative:s,altText:i}=this.serializeAltText(!1);if(!s&&i&&(a.accessibilityData={type:"Figure",alt:i}),this.annotationElementId){const c=this.#_(a);return c.isSame?null:(c.isSameAltText?delete a.accessibilityData:a.accessibilityData.structParent=this._initialData.structParent??-1,a.id=this.annotationElementId,delete a.bitmapId,a)}if(t===null)return a;t.stamps||=new Map;const o=this.#l?(a.rect[2]-a.rect[0])*(a.rect[3]-a.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:o,serialized:a}),a.bitmap=this.#v(!1);else if(this.#l){const c=t.stamps.get(this.#t);o>c.area&&(c.area=o,c.serialized.bitmap.close(),c.serialized.bitmap=this.#v(!1))}return a}#_(e){const{pageIndex:t,accessibilityData:{altText:a}}=this._initialData,s=e.pageIndex===t,i=(e.accessibilityData?.alt||"")===a;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&i,isSameAltText:i}}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class Tn{#e;#t=!1;#a=null;#r=null;#i=null;#n=new Map;#s=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#m=null;#g=-1;#u;static _initialized=!1;static#p=new Map([Ur,nv,J5,_r,Zs].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:a,structTreeLayer:s,accessibilityManager:i,annotationLayer:o,drawLayer:c,textLayer:u,viewport:d,l10n:f}){const g=[...Tn.#p.values()];if(!Tn._initialized){Tn._initialized=!0;for(const v of g)v.initialize(f,e)}e.registerEditorTypes(g),this.#u=e,this.pageIndex=t,this.div=a,this.#e=i,this.#a=o,this.viewport=d,this.#h=u,this.drawLayer=c,this._structTree=s,this.#u.addLayer(this)}get isEmpty(){return this.#n.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===tt.NONE}updateToolbar(e){this.#u.updateToolbar(e)}updateMode(e=this.#u.getMode()){switch(this.#b(),e){case tt.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case tt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case tt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===tt.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const a of Tn.#p.values())t.toggle(`${a._type}Editing`,e===a._editorType)}this.div.hidden=!1}hasTextLayer(e){return e===this.#h?.div}setEditingState(e){this.#u.setEditingState(e)}addCommands(e){this.#u.addCommands(e)}cleanUndoStack(e){this.#u.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#a?.togglePointerEvents(e)}get#v(){return this.#n.size!==0?this.#n.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const e=new Set;for(const a of this.#v)a.enableEditing(),a.show(!0),a.annotationElementId&&(this.#u.removeChangedExistingAnnotation(a),e.add(a.annotationElementId));const t=this.#a;if(t)for(const a of t.getEditableAnnotations()){if(a.hide(),this.#u.isDeletedAnnotationElement(a.data.id)||e.has(a.data.id))continue;const s=await this.deserialize(a);s&&(this.addOrRebuild(s),s.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#m){this.#m=new AbortController;const s=this.#u.combinedSignal(this.#m);this.#h.div.addEventListener("pointerdown",i=>{const{clientX:c,clientY:u,timeStamp:d}=i,f=this.#g;if(d-f>500){this.#g=d;return}this.#g=-1;const{classList:g}=this.div;g.toggle("getElements",!0);const v=document.elementsFromPoint(c,u);if(g.toggle("getElements",!1),!this.div.contains(v[0]))return;let x;const y=new RegExp(`^${ku}[0-9]+$`);for(const w of v)if(y.test(w.id)){x=w.id;break}if(!x)return;const _=this.#n.get(x);_?.annotationElementId===null&&(i.stopPropagation(),i.preventDefault(),_.dblclick(i))},{signal:s,capture:!0})}const e=this.#a,t=[];if(e){const s=new Map,i=new Map;for(const c of this.#v){if(c.disableEditing(),!c.annotationElementId){t.push(c);continue}if(c.serialize()!==null){s.set(c.annotationElementId,c);continue}else i.set(c.annotationElementId,c);this.getEditableAnnotation(c.annotationElementId)?.show(),c.remove()}const o=e.getEditableAnnotations();for(const c of o){const{id:u}=c.data;if(this.#u.isDeletedAnnotationElement(u)){c.updateEdited({deleted:!0});continue}let d=i.get(u);if(d){d.resetAnnotationElement(c),d.show(!1),c.show();continue}d=s.get(u),d&&(this.#u.addChangedExistingAnnotation(d),d.renderAnnotationElement(c)&&d.show(!1)),c.show()}}this.#b(),this.isEmpty&&(this.div.hidden=!0);const{classList:a}=this.div;for(const s of Tn.#p.values())a.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e?.updateFakeAnnotations(t),this.#o=!1}getEditableAnnotation(e){return this.#a?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#u.getActive()!==e&&this.#u.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const e=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#_.bind(this),{signal:e}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#_(e){this.#u.unselectAll();const{target:t}=e;if(t===this.#h.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#h.div.contains(t)){const{isMac:a}=jr.platform;if(e.button!==0||e.ctrlKey&&a)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),_r.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:e.x,y:e.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),e.preventDefault()}}enableClick(){if(this.#r)return;this.#r=new AbortController;const e=this.#u.combinedSignal(this.#r);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#r?.abort(),this.#r=null}attach(e){this.#n.set(e.id,e);const{annotationElementId:t}=e;t&&this.#u.isDeletedAnnotationElement(t)&&this.#u.removeDeletedAnnotationElement(e)}detach(e){this.#n.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#o&&e.annotationElementId&&this.#u.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#u.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#u.addDeletedAnnotationElement(e),Ve.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#u.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#c),this.#u.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#i&&(e._focusEventsAllowed=!1,this.#i=setTimeout(()=>{this.#i=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),a=()=>{e.remove()};this.addCommands({cmd:t,undo:a,mustExec:!1})}getEditorByUID(e){for(const t of this.#n.values())if(t.uid===e)return t;return null}getNextId(){return this.#u.getId()}get#x(){return Tn.#p.get(this.#u.getMode())}combinedSignal(e){return this.#u.combinedSignal(e)}#S(e){const t=this.#x;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#x?.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await this.#u.updateMode(e.mode);const{offsetX:a,offsetY:s}=this.#E(),i=this.getNextId(),o=this.#S({parent:this,id:i,x:a,y:s,uiManager:this.#u,isCentered:!0,...t});o&&this.add(o)}async deserialize(e){return await Tn.#p.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#u)||null}createAndAddNewEditor(e,t,a={}){const s=this.getNextId(),i=this.#S({parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:this.#u,isCentered:t,...a});return i&&this.add(i),i}get boundingClientRect(){return this.div.getBoundingClientRect()}#E(){const{x:e,y:t,width:a,height:s}=this.boundingClientRect,i=Math.max(0,e),o=Math.max(0,t),c=Math.min(window.innerWidth,e+a),u=Math.min(window.innerHeight,t+s),d=(i+c)/2-e,f=(o+u)/2-t,[g,v]=this.viewport.rotation%180===0?[d,f]:[f,d];return{offsetX:g,offsetY:v}}addNewEditor(e={}){this.createAndAddNewEditor(this.#E(),!0,e)}setSelected(e){this.#u.setSelected(e)}toggleSelected(e){this.#u.toggleSelected(e)}unselect(e){this.#u.unselect(e)}pointerup(e){const{isMac:t}=jr.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!this.#s||(this.#s=!1,this.#x?.isDrawer&&this.#x.supportMultipleDrawings))return;if(!this.#t){this.#t=!0;return}const a=this.#u.getMode();if(a===tt.STAMP||a===tt.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){if(this.#u.getMode()===tt.HIGHLIGHT&&this.enableTextSelection(),this.#s){this.#s=!1;return}const{isMac:t}=jr.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#s=!0,this.#x?.isDrawer){this.startDrawingSession(e);return}const a=this.#u.getActive();this.#t=!a||a.isEmpty()}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),this.#l){this.#x.startDrawing(this,this.#u,!1,e);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const t=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:a})=>{a&&!this.div.contains(a)&&(this.#d=null,this.commitOrRemove())},{signal:t}),this.#x.startDrawing(this,this.#u,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#d=t);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(e=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#x.endDrawing(e)):null}findNewParent(e,t,a){const s=this.#u.findParent(t,a);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#x.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#i&&(clearTimeout(this.#i),this.#i=null);for(const e of this.#n.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#n.clear(),this.#u.removeLayer(this)}#b(){for(const e of this.#n.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,co(this.div,e);for(const t of this.#u.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#u.commitOrRemove(),this.#b();const t=this.viewport.rotation,a=e.rotation;if(this.viewport=e,co(this.div,{rotation:a}),t!==a)for(const s of this.#n.values())s.rotate(a)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#u.viewParameters.realScale}}class Yr{#e=null;#t=new Map;#a=new Map;static#r=0;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#t.size>0)for(const t of this.#t.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return et(this,"_svgFactory",new lf)}static#i(e,[t,a,s,i]){const{style:o}=e;o.top=`${100*a}%`,o.left=`${100*t}%`,o.width=`${100*s}%`,o.height=`${100*i}%`}#n(){const e=Yr._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#s(e,t){const a=Yr._svgFactory.createElement("clipPath");e.append(a);const s=`clip_${t}`;a.setAttribute("id",s),a.setAttribute("clipPathUnits","objectBoundingBox");const i=Yr._svgFactory.createElement("use");return a.append(i),i.setAttribute("href",`#${t}`),i.classList.add("clip"),s}#o(e,t){for(const[a,s]of Object.entries(t))s===null?e.removeAttribute(a):e.setAttribute(a,s)}draw(e,t=!1,a=!1){const s=Yr.#r++,i=this.#n(),o=Yr._svgFactory.createElement("defs");i.append(o);const c=Yr._svgFactory.createElement("path");o.append(c);const u=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",u),c.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#a.set(s,c);const d=a?this.#s(o,u):null,f=Yr._svgFactory.createElement("use");return i.append(f),f.setAttribute("href",`#${u}`),this.updateProperties(i,e),this.#t.set(s,i),{id:s,clipPathId:`url(#${d})`}}drawOutline(e,t){const a=Yr.#r++,s=this.#n(),i=Yr._svgFactory.createElement("defs");s.append(i);const o=Yr._svgFactory.createElement("path");i.append(o);const c=`path_p${this.pageIndex}_${a}`;o.setAttribute("id",c),o.setAttribute("vector-effect","non-scaling-stroke");let u;if(t){const g=Yr._svgFactory.createElement("mask");i.append(g),u=`mask_p${this.pageIndex}_${a}`,g.setAttribute("id",u),g.setAttribute("maskUnits","objectBoundingBox");const v=Yr._svgFactory.createElement("rect");g.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const x=Yr._svgFactory.createElement("use");g.append(x),x.setAttribute("href",`#${c}`),x.setAttribute("stroke","none"),x.setAttribute("fill","black"),x.setAttribute("fill-rule","nonzero"),x.classList.add("mask")}const d=Yr._svgFactory.createElement("use");s.append(d),d.setAttribute("href",`#${c}`),u&&d.setAttribute("mask",`url(#${u})`);const f=d.cloneNode();return s.append(f),d.classList.add("mainOutline"),f.classList.add("secondaryOutline"),this.updateProperties(s,e),this.#t.set(a,s),a}finalizeDraw(e,t){this.#a.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:a,bbox:s,rootClass:i,path:o}=t,c=typeof e=="number"?this.#t.get(e):e;if(c){if(a&&this.#o(c,a),s&&Yr.#i(c,s),i){const{classList:u}=c;for(const[d,f]of Object.entries(i))u.toggle(d,f)}if(o){const d=c.firstElementChild.firstElementChild;this.#o(d,o)}}}updateParent(e,t){if(t===this)return;const a=this.#t.get(e);a&&(t.#e.append(a),this.#t.delete(e),t.#t.set(e,a))}remove(e){this.#a.delete(e),this.#e!==null&&(this.#t.get(e).remove(),this.#t.delete(e))}destroy(){this.#e=null;for(const e of this.#t.values())e.remove();this.#t.clear(),this.#a.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:tm};globalThis.pdfjsLib={AbortException:yi,AnnotationEditorLayer:Tn,AnnotationEditorParamsType:gt,AnnotationEditorType:tt,AnnotationEditorUIManager:bi,AnnotationLayer:sv,AnnotationMode:fi,AnnotationType:Cr,applyOpacity:_B,build:C5,ColorPicker:vs,createValidAbsoluteUrl:DA,CSSConstants:xB,DOMSVGFactory:lf,DrawLayer:Yr,FeatureTest:jr,fetchData:qu,findContrastColor:yB,getDocument:ev,getFilenameFromUrl:dB,getPdfFilenameFromUrl:fB,getRGB:Xu,getUuid:LA,getXfaPageViewport:gB,GlobalWorkerOptions:no,ImageKind:Ud,InvalidPDFException:qg,isDataScheme:wf,isPdfFile:Wm,isValidExplicitDest:OB,MathClamp:da,noContextMenu:ys,normalizeUnicode:cB,OPS:Nu,OutputScale:rn,PasswordResponses:eB,PDFDataRangeTransport:t2,PDFDateString:Wg,PDFWorker:Ou,PermissionFlag:Z8,PixelsPerInch:Pl,RenderingCancelledException:qm,renderRichText:PA,ResponseException:nf,setLayerDimensions:co,shadow:et,SignatureExtractor:wl,stopEvent:fr,SupportedImageMimeTypes:Xg,TextLayer:Ga,TouchManager:Ef,updateUrlHash:FA,Util:Le,VerbosityLevel:_f,version:T5,XfaLayer:jA};const h2="/Sistemafuncional/assets/pdf.worker-DjmdXq8j.mjs",Fu=r=>String(r||"").replace(/\u00A0/g," ").replace(/\s+/g," ").trim(),Q5=r=>{if(!r)return 0;if(typeof r=="number")return r;let e=String(r).trim();e=e.replace(/\./g,""),e=e.replace(",",".");const t=parseFloat(e);return isNaN(t)?0:t},d2=r=>{const e=/\b\d{1,3}(?:\.\d{3})*(?:,\d{2})\b|\b\d+(?:,\d{2})\b/g;return String(r||"").match(e)||[]},Z5=r=>{const e=d2(r);return e.length?Q5(e[e.length-1]):0},eU=r=>{const e=Fu(r),t=e.match(/\b\d{1,3}(?:\.\d{3})*(?:,\d{2})\b|\b\d+(?:,\d{2})\b/),a=t&&t.index?e.slice(0,t.index):e;return Fu(a.replace(/\bCantidad\b/ig,"").replace(/\bCdigo\b/ig,"").replace(/\bDescripcion\b/ig,"").replace(/\bDescripcin\b/ig,"").replace(/\bPrecio\s*unitario\b/ig,"").replace(/\bIVA\b/ig,"").replace(/\bBonif\.?\b/ig,"").replace(/\bImporte\b/ig,"").replace(/[-]\s*$/g,""))},tU=(r,e)=>{let t=eU(e);if(String(r||"").toUpperCase()==="HORV"){const a=t.toUpperCase().indexOf("NRO DE STRO:");a>=0&&(t=t.slice(a))}return Fu(t)||`tem ${r||""}`.trim()},rU=r=>{const e=Fu(r);let t=e;const a=e.toUpperCase().indexOf("CANTIDAD");a>=0&&(t=e.slice(a));const s=["PAG:","CAE:","IMPORTE NETO GRAVADO","IVA 21","IMPORTE TOTAL","SON PESOS","VENCIMIENTO CAE"];let i=t.length;for(const d of s){const f=t.toUpperCase().indexOf(d);f>=0&&(i=Math.min(i,f))}t=t.slice(0,i);const o=/(\d+)\s+([A-Z0-9]{1,8})\s+([\s\S]*?)(?=\s+\d+\s+[A-Z0-9]{1,8}\s+|$)/g,c=[];let u;for(;(u=o.exec(t))!==null;){const d=(u[2]||"").trim(),f=(u[3]||"").trim(),g=d2(f);if(!g||g.length===0)continue;const v=Z5(f),x=tU(d,f),y=f.match(/(\d{1,2}(?:,\d{1,2})?)\s*%/);let _=!0;if(y){const w=parseFloat(String(y[1]).replace(",","."));isNaN(w)||(_=w>0)}c.push({concepto:x,neto:v,aplicaIva:_})}return c},aU=r=>{const e=Fu(r),t={},a=e.match(/CAE\s*:?\s*(\d{14})/i);a&&(t.cae=a[1]);const s=e.match(/Fecha\s*:?\s*(\d{2})[\/\-](\d{2})[\/\-](\d{4})/i);s&&(t.fecha=`${s[3]}-${s[2]}-${s[1]}`);const i=e.match(/N[]\s*:?\s*(\d{1,5})\s*-\s*(\d{1,8})/i)||e.match(/(\d{4,5})\s*-\s*(\d{8})/);return i&&(t.pv=String(i[1]).padStart(4,"0"),t.nf=String(i[2]).padStart(8,"0")),t};no.workerSrc=h2;const uw=.21,sU=({nSiniestro:r,onSave:e})=>{const[t,a]=Q.useState(!0),[s,i]=Q.useState(!1),[o,c]=Q.useState(""),[u,d]=Q.useState(""),[f,g]=Q.useState(""),[v,x]=Q.useState(""),[y,_]=Q.useState([{concepto:"",neto:0,aplicaIva:!0}]);Q.useEffect(()=>{r&&w()},[r]);const w=async()=>{a(!0);const{data:W,error:H}=await qe.from("facturas").select("*").eq("n_siniestro",r).single();W?(c(W.punto_venta||""),d(W.numero_factura||""),g(W.fecha_emision||""),x(W.cae||""),Array.isArray(W.items)&&W.items.length>0&&_(W.items)):H&&H.code!=="PGRST116"&&console.error("Error loading invoice:",H),a(!1)},A=async()=>{i(!0);const{totalNeto:W,totalIva:H,totalGeneral:D}=C(),z=f||null,ne={n_siniestro:r,punto_venta:o,numero_factura:u,fecha_emision:z,cae:v,items:y,total_neto:W,total_iva:H,total_general:D,estado_pago:u&&z?"PENDIENTE":"SIN_FACTURAR"},{error:re}=await qe.from("facturas").upsert(ne,{onConflict:"n_siniestro"});i(!1),re?alert(`Error al guardar factura: ${re.message}`):(alert("Factura guardada correctamente."),e&&e())},T=()=>_([...y,{concepto:"",neto:0,aplicaIva:!0}]),S=W=>{const H=[...y];H.splice(W,1),H.length===0&&H.push({concepto:"",neto:0,aplicaIva:!0}),_(H)},N=(W,H,D)=>{const z=[...y];z[W]={...z[W],[H]:D},_(z)},R=W=>{if(typeof W=="number")return W;let H=String(W||"").trim().replace(/\./g,"").replace(",",".");return parseFloat(H)||0},O=W=>new Intl.NumberFormat("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(W),C=()=>{let W=0,H=0;return y.forEach(D=>{const z=R(D.neto);W+=z,D.aplicaIva&&(H+=z*uw)}),{totalNeto:W,totalIva:H,totalGeneral:W+H}},j=C(),I=async W=>{const H=W[0];if(H)try{a(!0);const D=await H.arrayBuffer(),z=await ev({data:D}).promise;let ne="";for(let te=1;te<=z.numPages;te++){const ke=(await(await z.getPage(te)).getTextContent()).items.map(q=>q.str);ne+=ke.join(" ")+" "}const re=aU(ne),U=rU(ne);re.pv&&c(re.pv),re.nf&&d(re.nf),re.fecha&&g(re.fecha),re.cae&&x(re.cae),U&&U.length>0?_([...U]):alert("No se detectaron tems en el PDF. Revisa el formato.")}catch(D){console.error("Error leyendo PDF:",D),alert(`Error al leer PDF: ${D.message}`)}finally{a(!1)}};return t?m.jsx("div",{style:{color:"var(--muted-color)",padding:"20px"},children:"Cargando..."}):m.jsxs("div",{className:jt.wrapper,children:[m.jsxs("div",{className:jt.pdfBox,style:{flexDirection:"column",alignItems:"stretch"},children:[m.jsx("span",{className:jt.pdfLabel,style:{marginBottom:"8px"},children:"Auto-completar desde PDF:"}),m.jsx(OA,{onFileSelect:I,label:"Arrastr tu factura aqu (PDF)",subLabel:"o click para seleccionar",accept:"application/pdf"})]}),m.jsxs("div",{className:jt.gridHeader,children:[m.jsxs("div",{className:jt.field,children:[m.jsx("span",{className:jt.label,children:"Punto de Venta"}),m.jsx("input",{className:jt.input,value:o,onChange:W=>c(W.target.value),placeholder:"0001"})]}),m.jsxs("div",{className:jt.field,children:[m.jsx("span",{className:jt.label,children:"Nro Factura"}),m.jsx("input",{className:jt.input,value:u,onChange:W=>d(W.target.value),placeholder:"12345678"})]}),m.jsxs("div",{className:jt.field,children:[m.jsx("span",{className:jt.label,children:"Fecha Emisin"}),m.jsx("input",{type:"date",className:jt.input,value:f,onChange:W=>g(W.target.value)})]}),m.jsxs("div",{className:jt.field,children:[m.jsx("span",{className:jt.label,children:"N CAE"}),m.jsx("input",{className:jt.input,value:v,onChange:W=>x(W.target.value)})]})]}),m.jsxs("div",{className:jt.sectionTitle,children:[m.jsx("span",{className:jt.titleText,children:"tems de Factura"}),m.jsx("button",{className:jt.btnAdd,onClick:T,children:"Agregar tem +"})]}),m.jsx("div",{className:jt.tableContainer,children:m.jsxs("table",{className:jt.table,children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{style:{width:"40%"},children:"Concepto"}),m.jsx("th",{style:{textAlign:"right"},children:"Neto"}),m.jsx("th",{style:{textAlign:"center"},children:"IVA?"}),m.jsx("th",{style:{textAlign:"right"},children:"IVA"}),m.jsx("th",{style:{textAlign:"right"},children:"Total"}),m.jsx("th",{style:{width:"40px"}})]})}),m.jsx("tbody",{children:y.map((W,H)=>{const D=R(W.neto),z=W.aplicaIva?D*uw:0;return m.jsxs("tr",{children:[m.jsx("td",{children:m.jsx("input",{className:jt.inputCell,value:W.concepto,onChange:ne=>N(H,"concepto",ne.target.value),placeholder:"Descripcin..."})}),m.jsx("td",{children:m.jsx("input",{className:jt.inputCell,style:{textAlign:"right"},value:W.neto,onChange:ne=>N(H,"neto",ne.target.value),placeholder:"0.00"})}),m.jsx("td",{style:{textAlign:"center"},children:m.jsx("input",{type:"checkbox",checked:W.aplicaIva,onChange:ne=>N(H,"aplicaIva",ne.target.checked)})}),m.jsxs("td",{style:{textAlign:"right"},children:["$ ",O(z)]}),m.jsxs("td",{style:{textAlign:"right"},children:["$ ",O(D+z)]}),m.jsx("td",{style:{textAlign:"center"},children:m.jsx("button",{className:jt.btnDel,onClick:()=>S(H),children:m.jsx(Hl,{size:14})})})]},H)})}),m.jsx("tfoot",{children:m.jsxs("tr",{className:jt.totalsRow,children:[m.jsx("td",{children:"Totales"}),m.jsxs("td",{style:{textAlign:"right"},children:["$ ",O(j.totalNeto)]}),m.jsx("td",{}),m.jsxs("td",{style:{textAlign:"right"},children:["$ ",O(j.totalIva)]}),m.jsxs("td",{style:{textAlign:"right"},children:["$ ",O(j.totalGeneral)]}),m.jsx("td",{})]})})]})}),m.jsx("div",{className:jt.actions,children:m.jsx("button",{className:jt.btnSave,onClick:A,disabled:s,children:s?"Guardando...":"Guardar Factura"})})]})},nU="_wrapper_jpg2z_1",iU="_uploadSection_jpg2z_9",oU="_filesGrid_jpg2z_13",lU="_fileCard_jpg2z_19",cU="_fileIconZone_jpg2z_36",uU="_fileName_jpg2z_48",hU="_fileMeta_jpg2z_58",dU="_actions_jpg2z_65",fU="_btnAction_jpg2z_71",pU="_btnDownload_jpg2z_85",gU="_btnDelete_jpg2z_95",mU="_emptyState_jpg2z_106",za={wrapper:nU,uploadSection:iU,filesGrid:oU,fileCard:lU,fileIconZone:cU,fileName:uU,fileMeta:hU,actions:dU,btnAction:fU,btnDownload:pU,btnDelete:gU,emptyState:mU},jd="documentos",vU=({nSiniestro:r})=>{const[e,t]=Q.useState([]),[a,s]=Q.useState(!0),[i,o]=Q.useState(!1);Q.useEffect(()=>{r&&c()},[r]);const c=async()=>{s(!0);const{data:x,error:y}=await qe.storage.from(jd).list(`casos/${r}`,{limit:100,offset:0,sortBy:{column:"name",order:"asc"}});y?console.error("Error fetching files:",y):t(x||[]),s(!1)},u=async x=>{o(!0);try{for(const y of x){const _=y.name.replace(/[^a-zA-Z0-9.\-_]/g,"_"),w=`casos/${r}/${Date.now()}_${_}`,{error:A}=await qe.storage.from(jd).upload(w,y,{cacheControl:"3600",upsert:!1});A&&(console.error("Error uploading file:",y.name,A),alert(`Error al subir ${y.name}: ${A.message}`))}c()}catch(y){console.error("General upload error",y)}finally{o(!1)}},d=async x=>{try{const{data:y,error:_}=await qe.storage.from(jd).download(`casos/${r}/${x}`);if(_)throw _;const w=URL.createObjectURL(y),A=document.createElement("a");A.href=w,A.download=x.split("_").slice(1).join("_"),x.indexOf("_")===-1&&(A.download=x),document.body.appendChild(A),A.click(),URL.revokeObjectURL(w),document.body.removeChild(A)}catch(y){alert(`Error al descargar: ${y.message}`)}},f=async x=>{if(confirm("Ests seguro de eliminar este archivo?"))try{const{error:y}=await qe.storage.from(jd).remove([`casos/${r}/${x}`]);if(y)throw y;c()}catch(y){alert(`Error al eliminar: ${y.message}`)}},g=x=>{if(x===0)return"0 B";const y=1024,_=["B","KB","MB","GB"],w=Math.floor(Math.log(x)/Math.log(y));return parseFloat((x/Math.pow(y,w)).toFixed(1))+" "+_[w]},v=x=>x&&x.startsWith("image/");return m.jsxs("div",{className:za.wrapper,children:[m.jsx("div",{className:za.uploadSection,children:i?m.jsx("div",{style:{textAlign:"center",padding:"30px",border:"2px dashed var(--line-color)",borderRadius:"8px",color:"var(--primary-color)"},children:"Subiendo archivo..."}):m.jsx(OA,{onFileSelect:u,label:"Arrastr documentos aqu",subLabel:"PDF, JPG, PNG, Word...",multiple:!0})}),a&&m.jsx("div",{style:{textAlign:"center",color:"var(--muted-color)"},children:"Cargando documentos..."}),!a&&e.length===0&&m.jsx("div",{className:za.emptyState,children:"No hay documentos cargados para este caso."}),m.jsx("div",{className:za.filesGrid,children:e.map(x=>m.jsxs("div",{className:za.fileCard,children:[m.jsx("div",{className:za.fileIconZone,children:v(x.metadata?.mimetype)?m.jsx(gO,{size:32}):m.jsx(Fs,{size:32})}),m.jsx("div",{className:za.fileName,title:x.name,children:x.name.split("_").slice(1).join("_")||x.name}),m.jsxs("div",{className:za.fileMeta,children:[m.jsx("span",{children:g(x.metadata?.size)}),m.jsx("span",{children:new Date(x.updated_at).toLocaleDateString()})]}),m.jsxs("div",{className:za.actions,children:[m.jsxs("button",{className:`${za.btnAction} ${za.btnDownload}`,onClick:()=>d(x.name),children:[m.jsx(tu,{size:14})," Descargar"]}),m.jsx("button",{className:`${za.btnAction} ${za.btnDelete}`,onClick:()=>f(x.name),children:m.jsx(Hl,{size:14})})]})]},x.id))})]})},xU="_wrapper_uaj5m_1",_U="_inputSection_uaj5m_6",yU="_input_uaj5m_6",bU="_btnSend_uaj5m_32",wU="_list_uaj5m_50",EU="_comment_uaj5m_56",AU="_me_uaj5m_63",SU="_header_uaj5m_68",TU="_author_uaj5m_75",CU="_date_uaj5m_80",kU="_text_uaj5m_84",NU="_empty_uaj5m_91",ps={wrapper:xU,inputSection:_U,input:yU,btnSend:bU,list:wU,comment:EU,me:AU,header:SU,author:TU,date:CU,text:kU,empty:NU},RU=({nSiniestro:r})=>{const{user:e}=Pu(),[t,a]=Q.useState([]),[s,i]=Q.useState(""),[o,c]=Q.useState(!0),[u,d]=Q.useState(!1);Q.useEffect(()=>{r&&f()},[r]);const f=async()=>{c(!0);const{data:x,error:y}=await qe.from("comentarios").select("*").eq("n_siniestro",r).order("creado_en",{ascending:!1});y?console.error("Error fetching comments:",y):a(x||[]),c(!1)},g=async()=>{if(!s.trim())return;d(!0);const x=e?.user_metadata?.nombre||e?.email||"Usuario",{error:y}=await qe.from("comentarios").insert({n_siniestro:r,texto:s,nombre_autor:x,creado_por:e?.id});d(!1),y?alert(`Error al enviar comentario: ${y.message}`):(i(""),f())},v=x=>{x.key==="Enter"&&!x.shiftKey&&(x.preventDefault(),g())};return m.jsxs("div",{className:ps.wrapper,children:[m.jsxs("div",{className:ps.inputSection,children:[m.jsx("textarea",{className:ps.input,placeholder:"Escrib un comentario...",value:s,onChange:x=>i(x.target.value),onKeyDown:v,disabled:u}),m.jsxs("button",{className:ps.btnSend,onClick:g,disabled:u||!s.trim(),children:[m.jsx(kO,{size:16}),u?"Enviando...":"Comentar"]})]}),m.jsxs("div",{className:ps.list,children:[o&&m.jsx("div",{style:{textAlign:"center",color:"var(--muted-color)"},children:"Cargando comentarios..."}),!o&&t.length===0&&m.jsx("div",{className:ps.empty,children:"No hay comentarios an. S el primero."}),t.map(x=>m.jsxs("div",{className:`${ps.comment} ${x.creado_por===e?.id?ps.me:""}`,children:[m.jsxs("div",{className:ps.header,children:[m.jsx("span",{className:ps.author,children:x.nombre_autor}),m.jsx("span",{className:ps.date,children:new Date(x.creado_en).toLocaleString("es-AR")})]}),m.jsx("div",{className:ps.text,children:x.texto})]},x.id))]})]})},OU="_wrapper_oi6us_1",DU="_grid_oi6us_6",FU="_col_oi6us_12",MU="_title_oi6us_21",LU="_buttons_oi6us_32",IU="_btn_oi6us_38",nr={wrapper:OU,grid:DU,col:FU,title:MU,buttons:LU,btn:IU},jU=({nSiniestro:r,id:e})=>{const t=ho(),a=s=>{if(s==="Generar Informe"){t(`/informe/${e}`);return}if(s==="Informe Desiste"){t(`/informe-desiste/${e}`);return}alert(`Accin "${s}" para el siniestro ${r} an no implementada.`)};return m.jsx("div",{className:nr.wrapper,children:m.jsxs("div",{className:nr.grid,children:[m.jsxs("div",{className:nr.col,children:[m.jsx("div",{className:nr.title,children:"Informes"}),m.jsxs("div",{className:nr.buttons,children:[m.jsxs("button",{className:nr.btn,onClick:()=>a("Generar Informe"),children:[m.jsx("span",{children:"INFORME"})," ",m.jsx(xm,{size:16})]}),m.jsxs("button",{className:nr.btn,onClick:()=>a("Informe Desiste"),children:[m.jsx("span",{children:"INFORME DESISTE"})," ",m.jsx(Fs,{size:16})]}),m.jsxs("button",{className:nr.btn,onClick:()=>a("Preinforme"),children:[m.jsx("span",{children:"PREINFORME"})," ",m.jsx(Fs,{size:16})]})]})]}),m.jsxs("div",{className:nr.col,children:[m.jsx("div",{className:nr.title,children:"Notas"}),m.jsxs("div",{className:nr.buttons,children:[m.jsxs("button",{className:nr.btn,onClick:()=>a("Nota Desiste"),children:[m.jsx("span",{children:"NOTA DESISTE"})," ",m.jsx(Fs,{size:16})]}),m.jsxs("button",{className:nr.btn,onClick:()=>a("Nota Desiste C/Pliza"),children:[m.jsx("span",{children:"NOTA DESISTE C/PLIZA"})," ",m.jsx(Fs,{size:16})]}),m.jsxs("button",{className:nr.btn,onClick:()=>a("Nota Orden de Compra"),children:[m.jsx("span",{children:"NOTA ORDEN DE COMPRA"})," ",m.jsx(Fs,{size:16})]}),m.jsxs("button",{className:nr.btn,onClick:()=>a("Nota Efectivo"),children:[m.jsx("span",{children:"NOTA EFECTIVO"})," ",m.jsx(Fs,{size:16})]})]})]}),m.jsxs("div",{className:nr.col,children:[m.jsx("div",{className:nr.title,children:"Gestin"}),m.jsxs("div",{className:nr.buttons,children:[m.jsxs("button",{className:nr.btn,onClick:()=>a("Enviar a Informes"),children:[m.jsx("span",{children:"ENVIAR A INFORMES"})," ",m.jsx(XR,{size:16})]}),m.jsxs("button",{className:nr.btn,onClick:()=>a("Mail a OnCity"),children:[m.jsx("span",{children:"MAIL A ONCITY"})," ",m.jsx(bO,{size:16})]}),m.jsxs("button",{className:nr.btn,onClick:()=>a("Declaracin"),children:[m.jsx("span",{children:"DECLARACIN"})," ",m.jsx(dO,{size:16})]}),m.jsxs("button",{className:nr.btn,onClick:()=>a("Interrupcin de Plazos"),children:[m.jsx("span",{children:"INTERRUPCIN DE PLAZOS"})," ",m.jsx(Fs,{size:16})]}),m.jsxs("button",{className:nr.btn,onClick:()=>a("Consulta de Antecedentes"),children:[m.jsx("span",{children:"CONSULTA DE ANTECEDENTES"})," ",m.jsx(Fs,{size:16})]})]})]})]})})},PU="_grid_g6rd0_1",BU="_summaryBox_g6rd0_14",UU="_sectionTitle_g6rd0_28",zU="_field_g6rd0_42",HU="_label_g6rd0_48",$U="_input_g6rd0_58",GU="_select_g6rd0_59",VU="_checkboxLabel_g6rd0_82",qU="_btnSave_g6rd0_102",WU="_toggleBtn_g6rd0_130",Te={grid:PU,summaryBox:BU,sectionTitle:UU,field:zU,label:HU,input:$U,select:GU,checkboxLabel:VU,btnSave:qU,toggleBtn:WU},XU=({caso:r,catalogs:e,onUpdate:t})=>{const[a,s]=Q.useState(r||{}),[i,o]=Q.useState(!1),[c,u]=Q.useState(!1),d=Q.useRef(null);Q.useEffect(()=>{s(r||{})},[r]);const f=(y,_)=>{s(w=>({...w,[y]:_}))},g=y=>{y.target.checked&&s(_=>({..._,calle_riesgo:_.calle,nro_r:_.nro,piso_r:_.piso,localidad_r:_.localidad,provincia_r:_.provincia}))},v=async()=>{await t(a)},x=async y=>{const _=y.target.files?.[0];if(!_)return;u(!0);const w=new FormData;w.append("file",_);try{const A=await fetch("http://localhost:5000/api/transcribe",{method:"POST",body:w}),T=await A.json();if(!A.ok)throw new Error(T.error||"Error en servidor de transcripcin");const S=`
[Transcripcin ${_.name}]:
${T.text}`;s(N=>({...N,entrevista:(N.entrevista||"")+S}))}catch(A){console.error("Transcription failed:",A),alert("Error al transcribir: "+A.message+`

Asegrate de que el servidor backend est corriendo (cd server && npm start) y la API KEY configurada.`)}finally{u(!1),d.current&&(d.current.value="")}};return m.jsxs("div",{className:Te.grid,children:[m.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",flexDirection:"column",gap:"20px"},children:[m.jsxs("div",{className:Te.summaryBox,children:[m.jsxs("div",{children:[m.jsx("div",{className:Te.label,children:"N Siniestro"}),m.jsx("div",{style:{fontWeight:600},children:a.n_siniestro})]}),m.jsxs("div",{children:[m.jsx("div",{className:Te.label,children:"Asegurado"}),m.jsx("div",{style:{fontWeight:600},children:a.asegurado})]}),m.jsxs("div",{children:[m.jsx("div",{className:Te.label,children:"Compaa"}),m.jsx("div",{children:a.cia})]}),m.jsxs("div",{children:[m.jsx("div",{className:Te.label,children:"Telfono"}),m.jsx("div",{children:a.telefono||"-"})]}),m.jsxs("div",{children:[m.jsx("div",{className:Te.label,children:"Mail"}),m.jsx("div",{children:a.mail||"-"})]})]}),a.motivo_derivacion&&m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,style:{fontSize:"14px",color:"#86efac"},children:"Comentarios de Derivacin (Inicial)"}),m.jsx("textarea",{className:Te.input,style:{minHeight:"80px",lineHeight:"1.5",resize:"none",opacity:.7,cursor:"not-allowed"},value:a.motivo_derivacion||"",readOnly:!0})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,style:{fontSize:"14px",color:"var(--primary-color)"},children:"Comentarios de Entrevista (Transcripcin)"}),m.jsx("textarea",{className:Te.input,style:{minHeight:"120px",lineHeight:"1.5",resize:"vertical"},value:a.entrevista||"",onChange:y=>f("entrevista",y.target.value),placeholder:"Escriba los comentarios o cargue un audio para transcribir..."}),m.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"5px"},children:[m.jsx("input",{type:"file",accept:"audio/*,video/*",ref:d,onChange:x,style:{display:"none"}}),m.jsxs("button",{className:Te.btnSave,style:{width:"auto",background:"var(--secondary-color)",fontSize:"13px",display:"flex",alignItems:"center",gap:"6px"},onClick:()=>d.current?.click(),disabled:c,children:[c?"Transcribiendo...":"Importar Audio/Video",m.jsx(LO,{size:14})]})]})]}),m.jsx("button",{className:Te.btnSave,onClick:v,style:{background:"var(--secondary-color)"},children:"Guardar Cambios Principales"}),m.jsxs("div",{className:Te.toggleBtn,onClick:()=>o(!i),children:[i?"Ocultar Datos Completos":"Modificar / Ver Datos Completos",i?m.jsx(aO,{size:16}):m.jsx(ZR,{size:16})]})]}),i&&m.jsxs(m.Fragment,{children:[m.jsx("div",{className:Te.sectionTitle,children:"Datos Completos del Caso"}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"Analista"}),m.jsxs("select",{className:Te.select,value:a.analista||"",onChange:y=>f("analista",y.target.value),children:[m.jsx("option",{value:"",children:"Seleccionar..."}),e.analistas?.map(y=>m.jsx("option",{value:y.nombre,children:y.nombre},y.id||y.nombre))]})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"Asegurado"}),m.jsx("input",{className:Te.input,value:a.asegurado||"",onChange:y=>f("asegurado",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"DNI"}),m.jsx("input",{className:Te.input,value:a.dni||"",onChange:y=>f("dni",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"Telfono"}),m.jsx("input",{className:Te.input,value:a.telefono||"",onChange:y=>f("telefono",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"Mail"}),m.jsx("input",{className:Te.input,value:a.mail||"",onChange:y=>f("mail",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"N Siniestro"}),m.jsx("input",{className:Te.input,value:a.n_siniestro||"",onChange:y=>f("n_siniestro",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"Pliza"}),m.jsx("input",{className:Te.input,value:a.poliza||"",onChange:y=>f("poliza",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"Ramo"}),m.jsx("input",{className:Te.input,value:a.ramo||"",onChange:y=>f("ramo",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"Causa"}),m.jsx("input",{className:Te.input,value:a.causa||"",onChange:y=>f("causa",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"Tramitador"}),m.jsx("input",{className:Te.input,value:a.tramitador||"",onChange:y=>f("tramitador",y.target.value)})]}),m.jsx("div",{className:Te.sectionTitle,children:"Fechas"}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"F. Contratacin"}),m.jsx("input",{type:"date",className:Te.input,value:a.fecha_contratacion||"",onChange:y=>f("fecha_contratacion",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"Vigencia Hasta"}),m.jsx("input",{type:"date",className:Te.input,value:a.vigencia_hasta||"",onChange:y=>f("vigencia_hasta",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"F. Siniestro"}),m.jsx("input",{type:"date",className:Te.input,value:a.fecha_siniestro||"",onChange:y=>f("fecha_siniestro",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"F. Denuncia"}),m.jsx("input",{type:"date",className:Te.input,value:a.fecha_denuncia||"",onChange:y=>f("fecha_denuncia",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"F. Asignacin"}),m.jsx("input",{type:"date",className:Te.input,value:a.fecha_ingreso||"",onChange:y=>f("fecha_ingreso",y.target.value)})]}),m.jsx("div",{className:Te.sectionTitle,children:"Domicilio Asegurado"}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"Calle"}),m.jsx("input",{className:Te.input,value:a.calle||"",onChange:y=>f("calle",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"N"}),m.jsx("input",{className:Te.input,value:a.nro||"",onChange:y=>f("nro",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"Piso"}),m.jsx("input",{className:Te.input,value:a.piso||"",onChange:y=>f("piso",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"Localidad"}),m.jsx("input",{className:Te.input,value:a.localidad||"",onChange:y=>f("localidad",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"Provincia"}),m.jsx("input",{className:Te.input,value:a.provincia||"",onChange:y=>f("provincia",y.target.value)})]}),m.jsx("div",{className:Te.sectionTitle,children:"Domicilio Riesgo"}),m.jsxs("label",{className:Te.checkboxLabel,children:[m.jsx("input",{type:"checkbox",onChange:g})," Copiar Domicilio"]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"Calle (R)"}),m.jsx("input",{className:Te.input,value:a.calle_riesgo||"",onChange:y=>f("calle_riesgo",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"N (R)"}),m.jsx("input",{className:Te.input,value:a.nro_r||"",onChange:y=>f("nro_r",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"Piso (R)"}),m.jsx("input",{className:Te.input,value:a.piso_r||"",onChange:y=>f("piso_r",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"Localidad (R)"}),m.jsx("input",{className:Te.input,value:a.localidad_r||"",onChange:y=>f("localidad_r",y.target.value)})]}),m.jsxs("div",{className:Te.field,children:[m.jsx("label",{className:Te.label,children:"Provincia (R)"}),m.jsx("input",{className:Te.input,value:a.provincia_r||"",onChange:y=>f("provincia_r",y.target.value)})]}),m.jsx("button",{className:Te.btnSave,onClick:v,style:{marginTop:"20px",background:"var(--secondary-color)"},children:"Guardar Todos los Cambios"})]})]})},YU=()=>{const{id:r}=lm(),[e,t]=Q.useState("info"),[a,s]=Q.useState(null),[i,o]=Q.useState(!0),[c,u]=Q.useState(!1),[d,f]=Q.useState({analistas:[],companias:[]});Q.useEffect(()=>{r&&(v(r),g())},[r]);const g=async()=>{try{const[A,T]=await Promise.all([qe.from("analistas").select("nombre"),qe.from("companias").select("nombre")]);f({analistas:A.data||[],companias:T.data||[]})}catch(A){console.error("Error fetching catalogs:",A)}},v=async A=>{o(!0);try{const{data:T,error:S}=await qe.from("casos").select("*").eq("id",A).single();if(S)throw S;s(T)}catch(T){console.error("Error fetching case:",T)}finally{o(!1)}},x=async A=>{const T={...a,tabla_daos:A};s(T),u(!0);try{const{error:S}=await qe.from("casos").update({tabla_daos:A}).eq("id",a.id);if(S)throw S}catch(S){console.error("Error al guardar tabla de daos:",S),alert("Error al guardar cambios. Por favor revisa tu conexin.")}finally{u(!1)}},y=async A=>{const T={...a,checklist:A};s(T),u(!0);try{const{error:S}=await qe.from("casos").update({checklist:A}).eq("id",a.id);if(S)throw S}catch(S){console.error("Error saving checklist:",S)}finally{u(!1)}},_=async A=>{const T={...a,estado:A};s(T),u(!0);try{const{error:S}=await qe.from("casos").update({estado:A}).eq("id",a.id);if(S)throw S}catch(S){console.error("Error saving status:",S),alert("Error al actualizar estado.")}finally{u(!1)}},w=async A=>{const{id:T,...S}=A;s(A),u(!0);try{const{error:N}=await qe.from("casos").update(S).eq("id",a.id);if(N)throw N}catch(N){console.error("Error saving info:",N),alert("Error al guardar cambios de informacin.")}finally{u(!1)}};return i?m.jsx(Rn,{children:m.jsx("div",{style:{color:"var(--muted-color)",padding:"20px"},children:"Cargando detalle del caso..."})}):a?m.jsxs(Rn,{children:[m.jsxs("div",{className:Wt.topBar,children:[m.jsxs("div",{children:[m.jsxs("h1",{children:["Detalle del Caso #",a.n_siniestro]}),m.jsxs(Iu,{to:"/lista",className:Wt.backLink,children:[m.jsx(tO,{size:16})," Volver al listado"]})]}),m.jsxs("div",{style:{textAlign:"right",display:"flex",alignItems:"center",gap:"10px"},children:[c&&m.jsx("span",{style:{fontSize:"12px",color:"var(--accent-color)"},children:"Guardando..."}),m.jsx("select",{className:Wt.statusSelect,value:a.estado||"SIN ASIGNAR",onChange:A=>_(A.target.value),style:{padding:"6px 12px",borderRadius:"20px",border:"none",backgroundColor:"#e1f0ff",color:"#3699ff",fontWeight:"600",cursor:"pointer",outline:"none"},children:["SIN ASIGNAR","EN PROCESO","PENDIENTE","CERRADO"].map(A=>m.jsx("option",{value:A,children:A},A))})]})]}),m.jsxs("div",{className:Wt.container,children:[m.jsxs("div",{className:Wt.caseHeader,children:[m.jsxs("div",{className:Wt.headerItem,children:[m.jsx("span",{className:Wt.headerLabel,children:"ASEGURADO"}),m.jsx("span",{className:Wt.headerValue,children:a.asegurado})]}),m.jsxs("div",{className:Wt.headerItem,children:[m.jsx("span",{className:Wt.headerLabel,children:"COMPAA"}),m.jsx("span",{className:Wt.headerValue,children:a.cia})]}),m.jsxs("div",{className:Wt.headerItem,children:[m.jsx("span",{className:Wt.headerLabel,children:"DNI"}),m.jsx("span",{className:Wt.headerValue,children:a.dni||"-"})]}),m.jsxs("div",{className:Wt.headerItem,children:[m.jsx("span",{className:Wt.headerLabel,children:"PLIZA"}),m.jsx("span",{className:Wt.headerValue,children:a.poliza||"-"})]}),m.jsxs("div",{className:Wt.headerItem,children:[m.jsx("span",{className:Wt.headerLabel,children:"RAMO"}),m.jsx("span",{className:Wt.headerValue,children:a.ramo||"-"})]})]}),m.jsxs("div",{className:Wt.tabsContainer,children:[m.jsx("div",{className:Wt.tabsHeader,children:["info","checklist","documentacion","tareas","comentarios","tabla-danos","factura","gestion"].map(A=>m.jsx("button",{className:`${Wt.tabBtn} ${e===A?Wt.activeTab:""}`,onClick:()=>t(A),children:A.toUpperCase().replace("-"," ")},A))}),m.jsxs("div",{className:Wt.tabContent,children:[e==="info"&&m.jsx(XU,{caso:a,catalogs:d,onUpdate:w}),e==="checklist"&&m.jsx(d8,{data:a.checklist||[],causa:a.causa,onUpdate:y}),e==="tabla-danos"&&m.jsx(Y6,{data:a.tabla_daos||[],onUpdate:x}),e==="documentacion"&&m.jsx(vU,{nSiniestro:a.n_siniestro}),e==="tareas"&&m.jsx(N8,{nSiniestro:a.n_siniestro,defaultAssignee:a.analista}),e==="factura"&&m.jsx(sU,{nSiniestro:a.n_siniestro}),e==="comentarios"&&m.jsx(RU,{nSiniestro:a.n_siniestro}),e==="gestion"&&m.jsx(jU,{nSiniestro:a.n_siniestro,id:a.id})]})]})]})]}):m.jsx(Rn,{children:m.jsx("div",{style:{color:"var(--danger-color)",padding:"20px"},children:"Caso no encontrado."})})},KU="_panel_1ihpz_1",JU="_filtros_1ihpz_9",QU="_input_1ihpz_17",ZU="_select_1ihpz_18",e7="_btnReset_1ihpz_33",t7="_tablaWrapper_1ihpz_46",r7="_table_1ihpz_53",a7="_thead_1ihpz_59",s7="_th_1ihpz_59",n7="_td_1ihpz_66",i7="_tr_1ihpz_79",o7="_estadoPill_1ihpz_83",l7="_estadoPendiente_1ihpz_92",c7="_estadoHecha_1ihpz_98",u7="_linkCaso_1ihpz_104",h7="_sinRegistros_1ihpz_114",d7="_resumen_1ihpz_120",f7="_checkbox_1ihpz_126",Et={panel:KU,filtros:JU,input:QU,select:ZU,btnReset:e7,tablaWrapper:t7,table:r7,thead:a7,th:s7,td:n7,tr:i7,estadoPill:o7,estadoPendiente:l7,estadoHecha:c7,linkCaso:u7,sinRegistros:h7,resumen:d7,checkbox:f7},p7=()=>{const{user:r,profile:e}=Pu(),[t,a]=Q.useState([]),[s,i]=Q.useState(!0),[o,c]=Q.useState(""),[u,d]=Q.useState("pendientes"),[f,g]=Q.useState(!0),[v,x]=Q.useState("fecha"),[y,_]=Q.useState(!0),w=e?.nombre||r?.user_metadata?.nombre||r?.email||"";Q.useEffect(()=>{A()},[]);const A=async()=>{i(!0);try{const{data:C,error:j}=await qe.from("tareas").select(`
                    *,
                    casos (
                        id,
                        asegurado,
                        analista
                    )
                `);if(j)throw j;a(C||[])}catch(C){console.error("Error fetching tasks:",C)}finally{i(!1)}},T=async(C,j)=>{a(W=>W.map(H=>H.id===C?{...H,hecha:!j}:H));const{error:I}=await qe.from("tareas").update({hecha:!j}).eq("id",C);I&&(alert("Error al actualizar tarea"),a(W=>W.map(H=>H.id===C?{...H,hecha:j}:H)))},S=Q.useMemo(()=>t.filter(C=>{const j=o.toLowerCase();if(!(C.texto?.toLowerCase().includes(j)||String(C.n_siniestro).includes(j)||C.casos?.asegurado?.toLowerCase().includes(j)||C.casos?.analista?.toLowerCase().includes(j)||C.asignado_a?.toLowerCase().includes(j))||u==="pendientes"&&C.hecha||u==="hechas"&&!C.hecha)return!1;if(f&&w){const W=w.toLowerCase(),H=C.asignado_a||C.casos?.analista||"";if(!H.toLowerCase().includes(W)&&!W.includes(H.toLowerCase()))return!1}return!0}),[t,o,u,f,w]),N=Q.useMemo(()=>[...S].sort((C,j)=>{let I=C[v],W=j[v];return v==="estado"?(I=C.hecha?1:0,W=j.hecha?1:0):v==="asegurado"?(I=C.casos?.asegurado||"",W=j.casos?.asegurado||""):v==="analista"&&(I=C.asignado_a||C.casos?.analista||"",W=j.asignado_a||j.casos?.analista||""),I<W?y?-1:1:I>W?y?1:-1:0}),[S,v,y]),R=C=>{v===C?_(!y):(x(C),_(!0))},O=C=>{if(!C)return"-";const[j,I,W]=C.split("-");return`${W}/${I}/${j}`};return m.jsxs(Rn,{children:[m.jsxs("div",{className:Et.topBar,children:[m.jsx("h2",{children:"Tareas Pendientes"}),m.jsx("p",{style:{color:"var(--muted-color)",fontSize:"14px"},children:"Gestin global de tareas asignadas"})]}),m.jsx("div",{className:Et.panel,children:m.jsxs("div",{className:Et.filtros,children:[m.jsx("input",{type:"text",className:Et.input,placeholder:"Buscar tareas...",value:o,onChange:C=>c(C.target.value),style:{minWidth:"300px"}}),m.jsxs("select",{className:Et.select,value:u,onChange:C=>d(C.target.value),children:[m.jsx("option",{value:"pendientes",children:"Solo Pendientes"}),m.jsx("option",{value:"hechas",children:"Solo Hechas"}),m.jsx("option",{value:"todas",children:"Todas"})]}),m.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",cursor:"pointer"},children:[m.jsx("input",{type:"checkbox",className:Et.checkbox,checked:f,onChange:C=>g(C.target.checked)}),m.jsx("span",{children:"Solo mis casos"})]}),m.jsx("button",{className:Et.btnReset,onClick:()=>{c(""),d("pendientes"),g(!0)},children:"Limpiar"})]})}),m.jsx("div",{className:Et.tablaWrapper,children:m.jsxs("table",{className:Et.table,children:[m.jsx("thead",{className:Et.thead,children:m.jsxs("tr",{children:[m.jsxs("th",{className:Et.th,onClick:()=>R("n_siniestro"),children:["Siniestro ",m.jsx(ul,{size:12})]}),m.jsxs("th",{className:Et.th,onClick:()=>R("asegurado"),children:["Asegurado ",m.jsx(ul,{size:12})]}),m.jsxs("th",{className:Et.th,onClick:()=>R("analista"),children:["Analista ",m.jsx(ul,{size:12})]}),m.jsxs("th",{className:Et.th,onClick:()=>R("texto"),children:["Tarea ",m.jsx(ul,{size:12})]}),m.jsxs("th",{className:Et.th,onClick:()=>R("fecha"),children:["Fecha ",m.jsx(ul,{size:12})]}),m.jsxs("th",{className:Et.th,onClick:()=>R("estado"),children:["Estado ",m.jsx(ul,{size:12})]}),m.jsx("th",{className:Et.th,children:"Acciones"})]})}),m.jsxs("tbody",{children:[s&&m.jsx("tr",{children:m.jsx("td",{colSpan:7,style:{textAlign:"center",padding:"20px"},children:"Cargando tareas..."})}),!s&&N.length===0&&m.jsx("tr",{children:m.jsx("td",{colSpan:7,className:Et.sinRegistros,children:"No se encontraron tareas con los filtros actuales."})}),!s&&N.map(C=>m.jsxs("tr",{className:Et.tr,children:[m.jsx("td",{className:Et.td,children:C.n_siniestro}),m.jsx("td",{className:Et.td,children:C.casos?.asegurado||"-"}),m.jsx("td",{className:Et.td,children:C.asignado_a||C.casos?.analista||"-"}),m.jsx("td",{className:Et.td,children:C.texto}),m.jsxs("td",{className:Et.td,children:[m.jsx("div",{children:O(C.fecha)}),m.jsx("div",{style:{fontSize:"11px",color:"var(--muted-color)"},children:C.hora})]}),m.jsx("td",{className:Et.td,children:m.jsx("span",{className:`${Et.estadoPill} ${C.hecha?Et.estadoHecha:Et.estadoPendiente}`,children:C.hecha?"HECHA":"PENDIENTE"})}),m.jsx("td",{className:Et.td,children:m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[m.jsx("input",{type:"checkbox",className:Et.checkbox,checked:C.hecha,onChange:()=>T(C.id,C.hecha),title:"Marcar como hecha/pendiente"}),m.jsx(Iu,{to:`/detalle/${C.casos?.id}`,className:Et.linkCaso,children:"Ver Caso"})]})})]},C.id))]})]})}),m.jsxs("div",{className:Et.resumen,children:["Mostrando ",N.length," tarea(s). Total registradas: ",t.length,"."]})]})},g7="_panel_aiqb3_1",m7="_panelTitle_aiqb3_9",v7="_filtros_aiqb3_15",x7="_field_aiqb3_22",_7="_label_aiqb3_28",y7="_input_aiqb3_33",b7="_select_aiqb3_34",w7="_btnAction_aiqb3_49",E7="_btnApply_aiqb3_64",A7="_tablaWrapper_aiqb3_74",S7="_table_aiqb3_81",T7="_thead_aiqb3_87",C7="_th_aiqb3_87",k7="_td_aiqb3_94",N7="_tr_aiqb3_107",R7="_trSelected_aiqb3_111",O7="_colNum_aiqb3_115",D7="_linkCaso_aiqb3_119",F7="_estadoPill_aiqb3_129",M7="_estadoSin_aiqb3_139",L7="_estadoPendiente_aiqb3_144",I7="_estadoPagada_aiqb3_150",j7="_inputInline_aiqb3_156",P7="_selectInline_aiqb3_157",B7="_resumen_aiqb3_166",Me={panel:g7,panelTitle:m7,filtros:v7,field:x7,label:_7,input:y7,select:b7,btnAction:w7,btnApply:E7,tablaWrapper:A7,table:S7,thead:T7,th:C7,td:k7,tr:N7,trSelected:R7,colNum:O7,linkCaso:D7,estadoPill:F7,estadoSin:M7,estadoPendiente:L7,estadoPagada:I7,inputInline:j7,selectInline:P7,resumen:B7},U7=()=>{const[r,e]=Q.useState([]),[t,a]=Q.useState(!0),[s,i]=Q.useState(""),[o,c]=Q.useState(""),[u,d]=Q.useState(""),[f,g]=Q.useState(""),[v,x]=Q.useState(""),[y,_]=Q.useState(new Set),[w,A]=Q.useState(""),[T,S]=Q.useState(""),[N,R]=Q.useState("");Q.useEffect(()=>{O()},[]);const O=async()=>{a(!0);try{const{data:z,error:ne}=await qe.from("facturas").select(`
                    *,
                    casos (
                        id,
                        asegurado,
                        cia,
                        analista
                    )
                `);if(ne)throw ne;e(z||[])}catch(z){console.error("Error fetching invoices:",z)}finally{a(!1)}},C=async(z,ne)=>{e(re=>re.map(U=>U.id===z?{...U,...ne}:U));try{const{error:re}=await qe.from("facturas").update(ne).eq("id",z);if(re)throw re}catch(re){console.error("Error updating invoice:",re),O()}},j=async()=>{if(y.size===0)return alert("Seleccion al menos una factura.");if(!confirm(`Actualizar ${y.size} facturas?`))return;const z={};if(w&&(z.orden_pago=w),T&&(z.fecha_cobro=T),N&&(z.estado_pago=N),Object.keys(z).length===0)return alert("Ingres algn dato para actualizar.");try{const ne=Array.from(y),{error:re}=await qe.from("facturas").update(z).in("id",ne);if(re)throw re;_(new Set),A(""),S(""),R(""),O()}catch(ne){alert("Error actualizacin masiva: "+ne.message)}},I=Q.useMemo(()=>r.filter(z=>{const ne=s.toLowerCase(),re=[String(z.n_siniestro),z.casos?.asegurado,z.casos?.cia,z.casos?.analista,z.punto_venta,z.numero_factura,z.orden_pago].join(" ").toLowerCase();return!(ne&&!re.includes(ne)||o&&z.estado_pago!==o||u&&!z.fecha_emision?.startsWith(u)||f&&!z.casos?.analista?.toLowerCase().includes(f.toLowerCase())||v&&!z.casos?.cia?.toLowerCase().includes(v.toLowerCase()))}),[r,s,o,u,f,v]),W=z=>{const ne=new Set(y);ne.has(z)?ne.delete(z):ne.add(z),_(ne)},D=(z=>{const ne=z.reduce((te,be)=>te+(be.total_general||0),0),re=z.filter(te=>te.estado_pago==="PENDIENTE").reduce((te,be)=>te+(be.total_general||0),0),U=z.filter(te=>te.estado_pago==="PAGADA").reduce((te,be)=>te+(be.total_general||0),0);return{total:ne,pendiente:re,pagado:U}})(I);return m.jsxs(Rn,{children:[m.jsxs("div",{className:Me.topBar,children:[m.jsx("h2",{children:"Facturacin"}),m.jsx("p",{style:{color:"var(--muted-color)",fontSize:"14px"},children:"Control de facturas, pagos y cobranzas."})]}),m.jsxs("div",{className:Me.panel,children:[m.jsx("div",{className:Me.panelTitle,children:"Filtros"}),m.jsxs("div",{className:Me.filtros,children:[m.jsxs("div",{className:Me.field,children:[m.jsx("label",{className:Me.label,children:"Buscar"}),m.jsx("input",{className:Me.input,placeholder:"Siniestro, asegurado, OP...",value:s,onChange:z=>i(z.target.value)})]}),m.jsxs("div",{className:Me.field,children:[m.jsx("label",{className:Me.label,children:"Estado"}),m.jsxs("select",{className:Me.select,value:o,onChange:z=>c(z.target.value),children:[m.jsx("option",{value:"",children:"(Todos)"}),m.jsx("option",{value:"SIN_FACTURAR",children:"Sin facturar"}),m.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),m.jsx("option",{value:"PAGADA",children:"Pagada"})]})]}),m.jsxs("div",{className:Me.field,children:[m.jsx("label",{className:Me.label,children:"Perodo"}),m.jsx("input",{type:"month",className:Me.input,value:u,onChange:z=>d(z.target.value)})]}),m.jsxs("div",{className:Me.field,children:[m.jsx("label",{className:Me.label,children:"Analista"}),m.jsx("input",{className:Me.input,placeholder:"Nombre...",value:f,onChange:z=>g(z.target.value)})]}),m.jsxs("div",{className:Me.field,children:[m.jsx("label",{className:Me.label,children:"Compaa"}),m.jsx("input",{className:Me.input,placeholder:"Compaa...",value:v,onChange:z=>x(z.target.value)})]}),m.jsx("button",{className:Me.btnAction,onClick:()=>{i(""),c(""),d(""),g(""),x("")},children:"Limpiar"}),m.jsxs("button",{className:Me.btnAction,children:[m.jsx(tu,{size:16})," Exportar"]})]})]}),m.jsxs("div",{className:Me.panel,children:[m.jsx("div",{className:Me.panelTitle,children:"Acciones Masivas"}),m.jsxs("div",{className:Me.filtros,children:[m.jsxs("div",{className:Me.field,children:[m.jsx("label",{className:Me.label,children:"Orden de Pago"}),m.jsx("input",{className:Me.input,value:w,onChange:z=>A(z.target.value),placeholder:"OP-XXXX"})]}),m.jsxs("div",{className:Me.field,children:[m.jsx("label",{className:Me.label,children:"Fecha Cobro"}),m.jsx("input",{type:"date",className:Me.input,value:T,onChange:z=>S(z.target.value)})]}),m.jsxs("div",{className:Me.field,children:[m.jsx("label",{className:Me.label,children:"Estado"}),m.jsxs("select",{className:Me.select,value:N,onChange:z=>R(z.target.value),children:[m.jsx("option",{value:"",children:"(No cambiar)"}),m.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),m.jsx("option",{value:"PAGADA",children:"Pagada"})]})]}),m.jsxs("button",{className:`${Me.btnAction} ${Me.btnApply}`,onClick:j,children:["Aplicar a ",y.size," seleccionados"]})]})]}),m.jsx("div",{className:Me.tablaWrapper,children:m.jsxs("table",{className:Me.table,children:[m.jsx("thead",{className:Me.thead,children:m.jsxs("tr",{children:[m.jsx("th",{className:Me.th,style:{textAlign:"center",width:"30px"},children:m.jsx("input",{type:"checkbox",onChange:z=>{z.target.checked?_(new Set(I.map(ne=>ne.id))):_(new Set)},checked:I.length>0&&y.size===I.length})}),m.jsx("th",{className:Me.th,children:"N Sin."}),m.jsx("th",{className:Me.th,children:"Asegurado"}),m.jsx("th",{className:Me.th,children:"Compaa"}),m.jsx("th",{className:Me.th,children:"Analista"}),m.jsx("th",{className:Me.th,children:"F. Emisin"}),m.jsx("th",{className:Me.th,children:"Factura"}),m.jsx("th",{className:`${Me.th} ${Me.colNum}`,children:"Total"}),m.jsx("th",{className:Me.th,children:"Estado"}),m.jsx("th",{className:Me.th,children:"Cobro / OP"})]})}),m.jsxs("tbody",{children:[t&&m.jsx("tr",{children:m.jsx("td",{colSpan:10,style:{textAlign:"center",padding:"20px"},children:"Cargando..."})}),!t&&I.length===0&&m.jsx("tr",{children:m.jsx("td",{colSpan:10,style:{textAlign:"center",padding:"30px",color:"var(--muted-color)"},children:"No hay facturas."})}),!t&&I.map(z=>m.jsxs("tr",{className:`${Me.tr} ${y.has(z.id)?Me.trSelected:""}`,children:[m.jsx("td",{className:Me.td,style:{textAlign:"center"},children:m.jsx("input",{type:"checkbox",checked:y.has(z.id),onChange:()=>W(z.id)})}),m.jsx("td",{className:Me.td,children:m.jsx(Iu,{to:`/detalle/${z.casos?.id}`,className:Me.linkCaso,children:z.n_siniestro})}),m.jsx("td",{className:Me.td,children:z.casos?.asegurado||"-"}),m.jsx("td",{className:Me.td,children:z.casos?.cia||"-"}),m.jsx("td",{className:Me.td,children:z.casos?.analista||"-"}),m.jsx("td",{className:Me.td,children:z.fecha_emision?new Date(z.fecha_emision).toLocaleDateString():"-"}),m.jsxs("td",{className:Me.td,children:[z.punto_venta,"-",z.numero_factura]}),m.jsxs("td",{className:`${Me.td} ${Me.colNum}`,children:["$ ",z.total_general?.toLocaleString("es-AR",{minimumFractionDigits:2})]}),m.jsx("td",{className:Me.td,children:m.jsx("span",{className:`${Me.estadoPill} ${z.estado_pago==="PAGADA"?Me.estadoPagada:z.estado_pago==="PENDIENTE"?Me.estadoPendiente:Me.estadoSin}`,children:z.estado_pago||"SIN FACTURAR"})}),m.jsx("td",{className:Me.td,children:m.jsxs("div",{style:{display:"flex",gap:"6px"},children:[m.jsx("input",{className:Me.inputInline,value:z.orden_pago||"",placeholder:"OP",onChange:ne=>C(z.id,{orden_pago:ne.target.value}),style:{width:"80px"}}),m.jsxs("select",{className:Me.selectInline,value:z.estado_pago||"SIN_FACTURAR",onChange:ne=>C(z.id,{estado_pago:ne.target.value}),children:[m.jsx("option",{value:"SIN_FACTURAR",children:"S/F"}),m.jsx("option",{value:"PENDIENTE",children:"Pend."}),m.jsx("option",{value:"PAGADA",children:"Pagada"})]})]})})]},z.id))]})]})}),m.jsxs("div",{className:Me.resumen,children:["Facturas listadas: ",m.jsx("strong",{children:I.length})," | Total facturado: ",m.jsxs("strong",{children:["$ ",D.total.toLocaleString("es-AR",{minimumFractionDigits:2})]})," | Pendiente: ",m.jsxs("strong",{children:["$ ",D.pendiente.toLocaleString("es-AR",{minimumFractionDigits:2})]})," | Cobrado: ",m.jsxs("strong",{children:["$ ",D.pagado.toLocaleString("es-AR",{minimumFractionDigits:2})]})]})]})},z7="_grid_1qgid_1",H7="_card_1qgid_8",$7="_filters_1qgid_30",G7="_field_1qgid_37",V7="_label_1qgid_43",q7="_input_1qgid_48",W7="_select_1qgid_49",X7="_btnAction_1qgid_64",Y7="_metricsGrid_1qgid_90",K7="_metricBox_1qgid_96",J7="_metricLabel_1qgid_104",Q7="_metricValue_1qgid_109",Z7="_metricSub_1qgid_116",e9="_analystGrid_1qgid_125",t9="_analystCard_1qgid_132",r9="_acHeader_1qgid_150",a9="_acName_1qgid_157",s9="_acRow_1qgid_162",n9="_acValue_1qgid_175",i9="_valDanger_1qgid_180",o9="_valWarning_1qgid_184",l9="_valSuccess_1qgid_188",c9="_tableWrapper_1qgid_194",u9="_table_1qgid_194",h9="_colNum_1qgid_222",Ue={grid:z7,card:H7,filters:$7,field:G7,label:V7,input:q7,select:W7,btnAction:X7,metricsGrid:Y7,metricBox:K7,metricLabel:J7,metricValue:Q7,metricSub:Z7,analystGrid:e9,analystCard:t9,acHeader:r9,acName:a9,acRow:s9,acValue:n9,valDanger:i9,valWarning:o9,valSuccess:l9,tableWrapper:c9,table:u9,colNum:h9},d9=()=>{const[r,e]=Q.useState(!0),[t,a]=Q.useState([]),[s,i]=Q.useState(""),[o,c]=Q.useState(""),[u,d]=Q.useState(""),[f,g]=Q.useState([]);Q.useEffect(()=>{v()},[]);const v=async()=>{e(!0);try{const[N,R]=await Promise.all([qe.from("casos").select("*"),qe.from("estados").select("*").eq("activo",1)]);a(N.data||[]),g(R.data||[])}catch(N){console.error(N)}finally{e(!1)}},x=Q.useMemo(()=>t.filter(N=>!(s&&!N.cia?.toLowerCase().includes(s.toLowerCase())||o&&!N.analista?.toLowerCase().includes(o.toLowerCase())||u&&N.estado!==u)),[t,s,o,u]),y=Q.useMemo(()=>{const N=x.length,R=x.filter(C=>C.estado==="CERRADO").length,O=new Set(x.map(C=>C.estado)).size;return{total:N,cerrados:R,uniqueStates:O}},[x]),_=(N,R)=>{const O={};return N.forEach(C=>{const j=C[R]||"Sin definir";O[j]=(O[j]||0)+1}),Object.entries(O).sort((C,j)=>j[1]-C[1])},w=Q.useMemo(()=>_(x,"estado"),[x]),A=Q.useMemo(()=>_(x,"analista"),[x]),T=Q.useMemo(()=>_(x,"cia"),[x]),S=Q.useMemo(()=>{const N=Array.from(new Set(x.map(C=>C.analista).filter(Boolean))),R=new Date;return new Date().setMonth(R.getMonth()-1),N.map(C=>{const j=x.filter(D=>D.analista===C),I=j.filter(D=>D.estado==="Ingresado"||D.estado==="ASIGNADO").length,W=j.filter(D=>D.estado!=="CERRADO"&&D.estado!=="Ingresado"&&D.estado!=="ASIGNADO").length,H=j.filter(D=>D.estado==="CERRADO").length;return{name:C,sinContactar:I,pendientes:W,cerradosMes:H}})},[x]);return r?m.jsx(Rn,{children:m.jsx("div",{style:{padding:"40px",textAlign:"center",color:"var(--muted-color)"},children:"Cargando mtricas..."})}):m.jsxs(Rn,{children:[m.jsxs("div",{className:Ue.topBar,children:[m.jsx("h2",{children:"Reportes y Mtricas"}),m.jsx("p",{style:{color:"var(--muted-color)",fontSize:"14px"},children:"Visin general del estado de la cartera."})]}),m.jsx("h3",{style:{marginTop:"20px"},children:"Gestin por Analista"}),m.jsxs("div",{className:Ue.analystGrid,children:[S.length===0&&m.jsx("div",{style:{padding:"20px",color:"gray"},children:"No hay datos con los filtros actuales."}),S.map(N=>m.jsxs("div",{className:Ue.analystCard,children:[m.jsx("div",{className:Ue.acHeader,children:m.jsx("span",{className:Ue.acName,children:N.name})}),m.jsxs("div",{className:Ue.acRow,children:[m.jsx("span",{children:"Sin Contactar"}),m.jsx("span",{className:`${Ue.acValue} ${Ue.valDanger}`,children:N.sinContactar})]}),m.jsxs("div",{className:Ue.acRow,children:[m.jsx("span",{children:"En Gestin (Pend.)"}),m.jsx("span",{className:`${Ue.acValue} ${Ue.valWarning}`,children:N.pendientes})]}),m.jsxs("div",{className:Ue.acRow,children:[m.jsx("span",{children:"Cerrados (Global)"}),m.jsx("span",{className:`${Ue.acValue} ${Ue.valSuccess}`,children:N.cerradosMes})]})]},N.name))]}),m.jsxs("div",{className:Ue.card,style:{marginTop:"20px"},children:[m.jsx("h3",{children:"Filtros de Reporte"}),m.jsxs("div",{className:Ue.filters,children:[m.jsxs("div",{className:Ue.field,children:[m.jsx("label",{className:Ue.label,children:"Compaa"}),m.jsx("input",{className:Ue.input,value:s,onChange:N=>i(N.target.value),placeholder:"Contiene..."})]}),m.jsxs("div",{className:Ue.field,children:[m.jsx("label",{className:Ue.label,children:"Analista"}),m.jsx("input",{className:Ue.input,value:o,onChange:N=>c(N.target.value),placeholder:"Contiene..."})]}),m.jsxs("div",{className:Ue.field,children:[m.jsx("label",{className:Ue.label,children:"Estado"}),m.jsxs("select",{className:Ue.select,value:u,onChange:N=>d(N.target.value),children:[m.jsx("option",{value:"",children:"(Todos)"}),f.map(N=>m.jsx("option",{value:N.nombre,children:N.nombre},N.id))]})]}),m.jsx("button",{className:Ue.btnAction,onClick:()=>{i(""),c(""),d("")},children:"Limpiar Filtros"}),m.jsxs("button",{className:Ue.btnAction,onClick:v,children:[m.jsx(SO,{size:14,style:{marginRight:"6px"}})," Recalcular"]})]})]}),m.jsxs("div",{className:Ue.metricsGrid,style:{marginTop:"20px"},children:[m.jsxs("div",{className:Ue.metricBox,children:[m.jsx("div",{className:Ue.metricLabel,children:"Total Casos"}),m.jsx("div",{className:Ue.metricValue,children:y.total}),m.jsx("div",{className:Ue.metricSub,children:"En scope actual"})]}),m.jsxs("div",{className:Ue.metricBox,children:[m.jsx("div",{className:Ue.metricLabel,children:"Cerrados"}),m.jsx("div",{className:Ue.metricValue,style:{color:"#86efac"},children:y.cerrados}),m.jsxs("div",{className:Ue.metricSub,children:[((y.cerrados/y.total||0)*100).toFixed(1),"% del total"]})]}),m.jsxs("div",{className:Ue.metricBox,children:[m.jsx("div",{className:Ue.metricLabel,children:"Estados Activos"}),m.jsx("div",{className:Ue.metricValue,children:y.uniqueStates})]})]}),m.jsxs("div",{className:Ue.grid,children:[m.jsxs("div",{className:Ue.card,children:[m.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[m.jsx("h3",{children:"Casos por Estado"}),m.jsx("button",{className:Ue.btnAction,style:{padding:"4px 8px",height:"auto"},children:m.jsx(tu,{size:14})})]}),m.jsx("div",{className:Ue.tableWrapper,children:m.jsxs("table",{className:Ue.table,children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{children:"Estado"}),m.jsx("th",{className:Ue.colNum,children:"Cant."})]})}),m.jsx("tbody",{children:w.map(([N,R])=>m.jsxs("tr",{children:[m.jsx("td",{children:N}),m.jsx("td",{className:Ue.colNum,children:R})]},N))})]})})]}),m.jsxs("div",{className:Ue.card,children:[m.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[m.jsx("h3",{children:"Casos por Analista"}),m.jsx("button",{className:Ue.btnAction,style:{padding:"4px 8px",height:"auto"},children:m.jsx(tu,{size:14})})]}),m.jsx("div",{className:Ue.tableWrapper,children:m.jsxs("table",{className:Ue.table,children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{children:"Analista"}),m.jsx("th",{className:Ue.colNum,children:"Cant."})]})}),m.jsx("tbody",{children:A.map(([N,R])=>m.jsxs("tr",{children:[m.jsx("td",{children:N}),m.jsx("td",{className:Ue.colNum,children:R})]},N))})]})})]}),m.jsxs("div",{className:Ue.card,children:[m.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[m.jsx("h3",{children:"Casos por Ca"}),m.jsx("button",{className:Ue.btnAction,style:{padding:"4px 8px",height:"auto"},children:m.jsx(tu,{size:14})})]}),m.jsx("div",{className:Ue.tableWrapper,children:m.jsxs("table",{className:Ue.table,children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{children:"Compaa"}),m.jsx("th",{className:Ue.colNum,children:"Cant."})]})}),m.jsx("tbody",{children:T.map(([N,R])=>m.jsxs("tr",{children:[m.jsx("td",{children:N}),m.jsx("td",{className:Ue.colNum,children:R})]},N))})]})})]})]})]})},f9="_container_qrb0k_1",p9="_titleSection_qrb0k_5",g9="_tabs_qrb0k_21",m9="_tabBtn_qrb0k_30",v9="_active_qrb0k_45",x9="_grid_qrb0k_53",_9="_card_qrb0k_67",y9="_muted_qrb0k_81",b9="_formGrid_qrb0k_90",w9="_formGroup_qrb0k_96",E9="_input_qrb0k_108",A9="_select_qrb0k_109",S9="_textarea_qrb0k_110",T9="_primaryBtn_qrb0k_138",C9="_secondaryBtn_qrb0k_157",k9="_dangerBtn_qrb0k_171",N9="_editBtn_qrb0k_185",R9="_toolbar_qrb0k_201",O9="_actions_qrb0k_210",D9="_tableContainer_qrb0k_216",F9="_table_qrb0k_216",M9="_activeTag_qrb0k_262",L9="_inactiveTag_qrb0k_273",I9="_colorPill_qrb0k_284",nt={container:f9,titleSection:p9,tabs:g9,tabBtn:m9,active:v9,grid:x9,card:_9,muted:y9,formGrid:b9,formGroup:w9,input:E9,select:A9,textarea:S9,primaryBtn:T9,secondaryBtn:C9,dangerBtn:k9,editBtn:N9,toolbar:R9,actions:O9,tableContainer:D9,table:F9,activeTag:M9,inactiveTag:L9,colorPill:I9},j9=()=>{const[r,e]=Q.useState("companias"),[,t]=Q.useState(!1),[a,s]=Q.useState({companias:[],analistas:[],causas:[],coberturas:[],estados:[],usuarios:[]}),[i,o]=Q.useState({companias:{id:null,nombre:"",cuit:"",activo:"1",notas:""},analistas:{id:null,nombre:"",email:"",tel:"",activo:"1"},causas:{id:null,nombre:"",tipo:"",activo:"1"},coberturas:{id:null,nombre:"",ramo:"",activo:"1"},estados:{id:null,nombre:"",color:"",activo:"1"},usuarios:{id:null,nombre:"",email:"",password:"",rol:"user",activo:"1"}}),c=Q.useRef({});Q.useEffect(()=>{f(r)},[r]);const u=[{key:"companias",label:"Compaas"},{key:"analistas",label:"Analistas"},{key:"causas",label:"Causas"},{key:"coberturas",label:"Coberturas"},{key:"estados",label:"Estados"},{key:"usuarios",label:"Usuarios"}],d={companias:"companias",analistas:"analistas",causas:"causas",coberturas:"coberturas",estados:"estados",usuarios:"perfiles"},f=async D=>{t(!0);try{const z=d[D],{data:ne,error:re}=await qe.from(z).select("*").order("id",{ascending:!0});if(re)throw re;s(U=>({...U,[D]:ne||[]}))}catch(z){console.error("Error loading "+D,z)}finally{t(!1)}},g=async D=>{const z=i[D],ne=d[D];if(!z.nombre)return alert("El nombre es requerido");if(D==="usuarios"&&!z.email)return alert("El email es requerido");t(!0);try{if(D==="usuarios"&&!z.id){if((z.password||"").length<6)return t(!1),alert("La contrasea debe tener al menos 6 caracteres");const{data:re,error:U}=await qe.auth.signUp({email:z.email,password:z.password,options:{data:{nombre:z.nombre,rol:z.rol}}});if(U)throw U;if(re.user){const te={id:re.user.id,nombre:z.nombre,email:z.email,rol:z.rol,activo:parseInt(z.activo)};await qe.from("perfiles").upsert(te),alert("Usuario creado. ATENCIN: Es posible que su sesin haya cambiado a la del nuevo usuario.")}}else{const re={...z};if(delete re.password,delete re.id,z.id){const{error:U}=await qe.from(ne).update(re).eq("id",z.id);if(U)throw U}else{const{error:U}=await qe.from(ne).insert(re);if(U)throw U}}if(D==="usuarios"&&z.rol==="Analista")try{let{data:re}=await qe.from("analistas").select("id").or(`email.eq.${z.email},nombre.eq.${z.nombre}`).maybeSingle();const U={nombre:z.nombre,email:z.email,activo:parseInt(z.activo)};re?await qe.from("analistas").update(U).eq("id",re.id):await qe.from("analistas").insert(U)}catch(re){console.error("Error syncing analyst:",re)}alert("Guardado correctamente"),y(D),f(D)}catch(re){alert("Error: "+re.message)}finally{t(!1)}},v=async(D,z)=>{if(confirm("Ests seguro de eliminar este registro?"))try{const ne=d[D],{error:re}=await qe.from(ne).delete().eq("id",z);if(re)throw re;f(D)}catch(ne){alert("Error al eliminar: "+ne.message)}},x=(D,z)=>{const re={...i[D],...z,activo:String(z.activo)};D==="usuarios"&&(re.password=""),o(U=>({...U,[D]:re})),window.scrollTo({top:0,behavior:"smooth"})},y=D=>{o(z=>({...z,[D]:{...z[D],id:null,nombre:"",...D==="usuarios"?{email:"",password:""}:{}}}))},_=(D,z,ne)=>{o(re=>({...re,[D]:{...re[D],[z]:ne}}))},w=D=>{const z=JSON.stringify(a[D],null,2),ne=new Blob([z],{type:"application/json"}),re=URL.createObjectURL(ne),U=document.createElement("a");U.href=re,U.download=`master_${D}.json`,U.click()},A=D=>{c.current[D]?.click()},T=(D,z)=>{const ne=z.target.files?.[0];if(!ne)return;const re=new FileReader;re.onload=async U=>{try{const te=JSON.parse(U.target?.result);if(!Array.isArray(te))throw new Error("Format invalid: expected array");if(!confirm(`Se importarn ${te.length} registros en ${D}. Esto puede sobrescribir datos existentes.`))return;const be=d[D],{error:se}=await qe.from(be).upsert(te);if(se)throw se;alert("Importacin exitosa"),f(D)}catch(te){alert("Error importando: "+te.message)}finally{c.current[D]&&(c.current[D].value="")}},re.readAsText(ne)},S=()=>m.jsx("div",{className:nt.tabs,children:u.map(D=>m.jsx("button",{className:`${nt.tabBtn} ${r===D.key?nt.active:""}`,onClick:()=>e(D.key),children:D.label},D.key))}),N=(D,z)=>{const ne=i[D];return m.jsxs("div",{className:nt.card,children:[m.jsxs("h2",{children:[ne.id?"Editar":"Alta de"," ",u.find(re=>re.key===D)?.label]}),m.jsxs("div",{className:nt.formGrid,children:[z.map(re=>m.jsxs("div",{className:nt.formGroup,children:[m.jsx("label",{children:re.label}),re.type==="select"?m.jsx("select",{className:nt.select,value:ne[re.field],onChange:U=>_(D,re.field,U.target.value),children:re.options?.map(U=>m.jsx("option",{value:U.val,children:U.label},U.val))}):re.type==="textarea"?m.jsx("textarea",{className:nt.textarea,rows:3,placeholder:re.placeholder,value:ne[re.field],onChange:U=>_(D,re.field,U.target.value)}):m.jsx("input",{type:re.type||"text",className:nt.input,placeholder:re.placeholder,value:ne[re.field],onChange:U=>_(D,re.field,U.target.value),style:re.field==="password"&&ne.id?{display:"none"}:{}}),re.field==="password"&&ne.id&&m.jsx("small",{className:nt.muted,children:"La contrasea no se puede editar aqu."})]},re.field)),m.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"10px"},children:[m.jsx("button",{className:nt.primaryBtn,onClick:()=>g(D),children:ne.id?"Actualizar":"Guardar"}),ne.id&&m.jsx("button",{className:nt.secondaryBtn,onClick:()=>y(D),children:"Cancelar Edicin"})]})]})]})},R=(D,z)=>{const ne=a[D]||[];return m.jsxs("div",{className:nt.card,children:[m.jsxs("div",{className:nt.toolbar,children:[m.jsx("h2",{children:"Listado"}),m.jsxs("div",{className:nt.actions,children:[m.jsx("button",{className:nt.secondaryBtn,onClick:()=>w(D),children:"Exportar JSON"}),m.jsx("button",{className:nt.secondaryBtn,onClick:()=>A(D),children:"Importar JSON"}),m.jsx("input",{type:"file",style:{display:"none"},ref:re=>{c.current[D]=re},onChange:re=>T(D,re),accept:".json"})]})]}),m.jsx("div",{className:nt.tableContainer,children:m.jsxs("table",{className:nt.table,children:[m.jsx("thead",{children:m.jsxs("tr",{children:[z.map(re=>m.jsx("th",{children:re.header},re.field)),m.jsx("th",{children:"Acciones"})]})}),m.jsxs("tbody",{children:[ne.map(re=>m.jsxs("tr",{children:[z.map(U=>m.jsx("td",{children:U.render?U.render(re[U.field]):re[U.field]},U.field)),m.jsxs("td",{children:[m.jsx("button",{className:nt.editBtn,onClick:()=>x(D,re),children:"Editar"}),m.jsx("button",{className:nt.dangerBtn,onClick:()=>v(D,re.id),children:"Borrar"})]})]},re.id)),ne.length===0&&m.jsx("tr",{children:m.jsx("td",{colSpan:z.length+1,style:{textAlign:"center",padding:"20px"},children:"No hay datos"})})]})]})})]})},O=()=>m.jsxs("div",{className:nt.grid,children:[N("companias",[{label:"Nombre",field:"nombre",placeholder:"Ej: Life Seguros"},{label:"CUIT",field:"cuit",placeholder:"30-12345678-9"},{label:"Estado",field:"activo",type:"select",options:[{val:"1",label:"Activa"},{val:"0",label:"Inactiva"}]},{label:"Notas",field:"notas",type:"textarea"}]),R("companias",[{field:"id",header:"ID"},{field:"nombre",header:"Nombre"},{field:"cuit",header:"CUIT"},{field:"activo",header:"Activo",render:D=>D===1?m.jsx("span",{className:nt.activeTag,children:"S"}):m.jsx("span",{className:nt.inactiveTag,children:"No"})}])]}),C=()=>m.jsxs("div",{className:nt.grid,children:[N("analistas",[{label:"Nombre",field:"nombre",placeholder:"Ej: Juan Prez"},{label:"Email",field:"email",placeholder:"juan@estudio.com"},{label:"Telfono",field:"tel",placeholder:"11-1234-5678"},{label:"Estado",field:"activo",type:"select",options:[{val:"1",label:"Activo"},{val:"0",label:"Inactivo"}]}]),R("analistas",[{field:"id",header:"ID"},{field:"nombre",header:"Nombre"},{field:"email",header:"Email"},{field:"tel",header:"Telfono"},{field:"activo",header:"Activo",render:D=>D===1?m.jsx("span",{className:nt.activeTag,children:"S"}):m.jsx("span",{className:nt.inactiveTag,children:"No"})}])]}),j=()=>m.jsxs("div",{className:nt.grid,children:[N("causas",[{label:"Nombre",field:"nombre",placeholder:"Ej: Variacin de tensin"},{label:"Tipo",field:"tipo",placeholder:"Ej: Elctrica"},{label:"Estado",field:"activo",type:"select",options:[{val:"1",label:"Activa"},{val:"0",label:"Inactiva"}]}]),R("causas",[{field:"id",header:"ID"},{field:"nombre",header:"Nombre"},{field:"tipo",header:"Tipo"},{field:"activo",header:"Activo",render:D=>D===1?m.jsx("span",{className:nt.activeTag,children:"S"}):m.jsx("span",{className:nt.inactiveTag,children:"No"})}])]}),I=()=>m.jsxs("div",{className:nt.grid,children:[N("coberturas",[{label:"Nombre",field:"nombre",placeholder:"Ej: Dao por lquidos"},{label:"Ramo",field:"ramo",placeholder:"Ej: Hogar"},{label:"Estado",field:"activo",type:"select",options:[{val:"1",label:"Activa"},{val:"0",label:"Inactiva"}]}]),R("coberturas",[{field:"id",header:"ID"},{field:"nombre",header:"Nombre"},{field:"ramo",header:"Ramo"},{field:"activo",header:"Activo",render:D=>D===1?m.jsx("span",{className:nt.activeTag,children:"S"}):m.jsx("span",{className:nt.inactiveTag,children:"No"})}])]}),W=()=>m.jsxs("div",{className:nt.grid,children:[N("estados",[{label:"Nombre",field:"nombre",placeholder:"Ej: CONTACTAR"},{label:"Color",field:"color",placeholder:"Ej: #ff0000"},{label:"Estado",field:"activo",type:"select",options:[{val:"1",label:"Activo"},{val:"0",label:"Inactivo"}]}]),R("estados",[{field:"id",header:"ID"},{field:"nombre",header:"Nombre"},{field:"color",header:"Color",render:D=>D?m.jsx("span",{className:nt.colorPill,style:{background:D},children:D}):"-"},{field:"activo",header:"Activo",render:D=>D===1?m.jsx("span",{className:nt.activeTag,children:"S"}):m.jsx("span",{className:nt.inactiveTag,children:"No"})}])]}),H=()=>m.jsxs("div",{className:nt.grid,children:[N("usuarios",[{label:"Nombre y Apellido",field:"nombre",placeholder:"Ej: Ana Gomez"},{label:"Email",field:"email",placeholder:"ana@estudio.com",type:"email"},{label:"Contrasea (solo para alta)",field:"password",type:"password",placeholder:"Mnimo 6 caracteres"},{label:"Rol",field:"rol",type:"select",options:[{val:"Administrador",label:"Administrador"},{val:"Analista",label:"Analista"}]},{label:"Activo",field:"activo",type:"select",options:[{val:"1",label:"S"},{val:"0",label:"No"}]}]),R("usuarios",[{field:"id",header:"ID",render:D=>m.jsxs("span",{title:D,children:[D.substring(0,8),"..."]})},{field:"nombre",header:"Nombre"},{field:"email",header:"Email"},{field:"rol",header:"Rol"},{field:"activo",header:"Activo",render:D=>D===1?m.jsx("span",{className:nt.activeTag,children:"S"}):m.jsx("span",{className:nt.inactiveTag,children:"No"})}])]});return m.jsx(Rn,{children:m.jsxs("div",{className:nt.container,children:[m.jsxs("div",{className:nt.titleSection,children:[m.jsx("h1",{children:"Administracin del Sistema"}),m.jsx("p",{children:"Gestin de catlogos maestros y usuarios"})]}),S(),r==="companias"&&O(),r==="analistas"&&C(),r==="causas"&&j(),r==="coberturas"&&I(),r==="estados"&&W(),r==="usuarios"&&H()]})})},P9="_container_d3bt7_1",B9="_toolbar_d3bt7_9",U9="_btn_d3bt7_24",z9="_btnPrimary_d3bt7_36",H9="_btnDanger_d3bt7_45",$9="_page_d3bt7_54",G9="_table_d3bt7_65",V9="_noBorder_d3bt7_85",q9="_section_d3bt7_96",W9="_box_d3bt7_105",X9="_input_d3bt7_112",Y9="_textarea_d3bt7_113",K9="_bigline_d3bt7_130",ze={container:P9,toolbar:B9,btn:U9,btnPrimary:z9,btnDanger:H9,page:$9,table:G9,noBorder:V9,section:q9,box:W9,input:X9,textarea:Y9,bigline:K9},J9=()=>{const{id:r}=lm(),e=ho(),[t,a]=Q.useState(!0),[s,i]=Q.useState(null),[o,c]=Q.useState({}),[u,d]=Q.useState({suma:0,conv:0,indem:0});Q.useEffect(()=>{r&&f(r)},[r]);const f=async w=>{a(!0);try{const{data:A,error:T}=await qe.from("casos").select("*").eq("id",w).single();if(T)throw T;i(A),c(A.informe||{});let S=0,N=0,R=0;(A.tabla_daos||[]).forEach(O=>{let C=0,j=0;(O.items||[]).forEach(I=>{C+=Number(I.montoConvenido||0),j+=Number(I.montoIndemnizacion||0)}),S+=Number(O.suma||0),N+=C,R+=j}),d({suma:S,conv:N,indem:R})}catch(A){console.error("Error loading case:",A),alert("Error al cargar el caso."),e(-1)}finally{a(!1)}},g=async(w=!1)=>{try{const{error:A}=await qe.from("casos").update({informe:o}).eq("id",r);if(A)throw A;w||alert("Informe guardado.")}catch(A){alert("Error al guardar: "+A.message)}},v=async()=>{await g(!0),window.print()},x=async()=>{confirm("Borrar todo el contenido del informe?")&&(c({}),await g(!0))},y=(w,A)=>{c(T=>({...T,[w]:A}))},_=w=>w?.toLocaleString("es-AR",{minimumFractionDigits:2});return t?m.jsx("div",{className:ze.container,children:"Cargando..."}):s?m.jsxs("div",{className:ze.container,children:[m.jsxs("div",{className:ze.toolbar,children:[m.jsxs("button",{className:ze.btn,onClick:()=>e(-1),children:[m.jsx(Yw,{size:16})," Volver"]}),m.jsxs("button",{className:`${ze.btn} ${ze.btnDanger}`,onClick:x,children:[m.jsx(Hl,{size:16})," Borrar"]}),m.jsxs("button",{className:`${ze.btn} ${ze.btnPrimary}`,onClick:()=>g(!1),children:[m.jsx(Kw,{size:16})," Guardar"]}),m.jsxs("button",{className:`${ze.btn} ${ze.btnPrimary}`,onClick:v,children:[m.jsx(xm,{size:16})," Imprimir / PDF"]})]}),m.jsxs("div",{className:ze.page,children:[m.jsx("table",{className:ze.noBorder,children:m.jsx("tbody",{children:m.jsxs("tr",{children:[m.jsxs("td",{children:[m.jsx("b",{children:"H.M.Gibert"}),m.jsx("br",{}),"Fundado en 1955",m.jsx("br",{}),"CONTADOR PUBLICO NACIONAL",m.jsx("br",{}),"ESTUDIO DE LIQUIDACIN DE SINIESTROS"]}),m.jsx("td",{style:{textAlign:"right",fontWeight:700,fontSize:"14px"},children:s.cia?.toUpperCase()})]})})}),m.jsxs("table",{className:ze.table,children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{children:"SINIESTRO"}),m.jsx("th",{children:"POLIZA"}),m.jsx("th",{children:"ANALISTA"})]})}),m.jsx("tbody",{children:m.jsxs("tr",{children:[m.jsx("td",{children:s.n_siniestro}),m.jsx("td",{children:s.poliza}),m.jsx("td",{children:s.analista})]})})]}),m.jsx("div",{className:ze.section,children:" Datos personales del asegurado"}),m.jsxs("table",{className:ze.table,children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{children:"APELLIDO Y NOMBRE"}),m.jsx("th",{children:"DNI"})]})}),m.jsx("tbody",{children:m.jsxs("tr",{children:[m.jsx("td",{children:s.asegurado}),m.jsx("td",{children:s.dni})]})})]}),m.jsx("div",{className:ze.section,children:" Ubicacin del riesgo afectado"}),m.jsxs("table",{className:ze.table,children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{children:"CALLE"}),m.jsx("th",{children:"N"}),m.jsx("th",{children:"PISO"}),m.jsx("th",{children:"LOCALIDAD"}),m.jsx("th",{children:"PROVINCIA"})]})}),m.jsx("tbody",{children:m.jsxs("tr",{children:[m.jsx("td",{children:s.calle_riesgo||""}),m.jsx("td",{children:s.nro_r||""}),m.jsx("td",{children:s.piso_r||""}),m.jsx("td",{children:s.localidad_r||""}),m.jsx("td",{children:s.provincia_r||""})]})})]}),m.jsx("div",{className:ze.section,children:" Datos del siniestro"}),m.jsxs("table",{className:ze.table,children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{children:"FECHA SINIESTRO"}),m.jsx("th",{children:"FECHA DENUNCIA"}),m.jsx("th",{children:"FECHA CIERRE"})]})}),m.jsx("tbody",{children:m.jsxs("tr",{children:[m.jsx("td",{children:m.jsx("input",{className:ze.input,value:o.fecha_siniestro||s.fecha_siniestro||"",onChange:w=>y("fecha_siniestro",w.target.value)})}),m.jsx("td",{children:m.jsx("input",{className:ze.input,value:o.fecha_denuncia||s.fecha_denuncia||"",onChange:w=>y("fecha_denuncia",w.target.value)})}),m.jsx("td",{children:m.jsx("input",{className:ze.input,value:o.fecha_cierre||"",onChange:w=>y("fecha_cierre",w.target.value)})})]})})]}),m.jsx("div",{className:ze.section,children:" DENUNCIADO COMO OCURRIDO"}),m.jsx("div",{className:ze.box,children:m.jsx("textarea",{className:ze.textarea,value:o.txOcurrencia||"",onChange:w=>y("txOcurrencia",w.target.value)})}),m.jsx("div",{className:ze.section,children:" COBERTURAS AFECTADAS"}),m.jsxs("table",{className:ze.table,children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{children:"COBERTURA"}),m.jsx("th",{children:"SUMA ASEGURADA"}),m.jsx("th",{children:"DAOS CONVALIDADOS"}),m.jsx("th",{children:"MONTO INDEMNIZADO"})]})}),m.jsx("tbody",{children:(s.tabla_daos||[]).map((w,A)=>{let T=0,S=0;return(w.items||[]).forEach(N=>{T+=Number(N.montoConvenido||0),S+=Number(N.montoIndemnizacion||0)}),m.jsxs("tr",{children:[m.jsx("td",{children:w.nombre}),m.jsx("td",{children:_(w.suma)}),m.jsx("td",{children:_(T)}),m.jsx("td",{children:_(S)})]},A)})}),m.jsx("tfoot",{children:m.jsxs("tr",{children:[m.jsx("td",{children:m.jsx("b",{children:"TOTAL"})}),m.jsx("td",{children:_(u.suma)}),m.jsx("td",{children:_(u.conv)}),m.jsx("td",{children:_(u.indem)})]})})]}),m.jsx("div",{className:ze.section,children:" DETALLE DE LA LIQUIDACION"}),m.jsxs("table",{className:ze.table,children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{children:"DETALLE"}),m.jsx("th",{children:"MONTO CONVALIDADO"}),m.jsx("th",{children:"MONTO INDEMNIZADO"})]})}),m.jsxs("tbody",{children:[m.jsxs("tr",{children:[m.jsx("td",{children:""}),m.jsx("td",{children:""}),m.jsx("td",{children:_(u.indem)})]}),m.jsxs("tr",{children:[m.jsx("td",{children:m.jsx("b",{children:"TOTAL"})}),m.jsx("td",{colSpan:2,children:m.jsx("b",{children:_(u.indem)})})]})]})]}),m.jsx("div",{className:ze.section,children:" RESULTADOS DE LA VERIFICACIN"}),m.jsx("table",{className:ze.table,children:m.jsxs("tbody",{children:[m.jsxs("tr",{children:[m.jsx("th",{children:"OC"}),m.jsx("td",{children:m.jsx("input",{className:ze.input,value:o.inOC||"",onChange:w=>y("inOC",w.target.value)})}),m.jsx("th",{children:"AHORRO"}),m.jsx("td",{children:m.jsx("input",{className:ze.input,value:o.inAhorro||"",onChange:w=>y("inAhorro",w.target.value)})})]}),m.jsxs("tr",{children:[m.jsx("th",{children:"EFECTIVO"}),m.jsx("td",{children:m.jsx("input",{className:ze.input,value:o.inEfectivo||"",onChange:w=>y("inEfectivo",w.target.value)})}),m.jsx("th",{children:"TOTAL"}),m.jsx("td",{children:m.jsx("input",{className:ze.input,value:o.inTotal||_(u.indem),onChange:w=>y("inTotal",w.target.value)})})]})]})}),m.jsx("div",{className:ze.section,children:" MOTIVO DE LA DERIVACIN"}),m.jsx("div",{className:ze.box,children:m.jsx("textarea",{className:ze.textarea,value:o.txMotivo||"",onChange:w=>y("txMotivo",w.target.value)})}),m.jsx("div",{className:ze.section,children:" COMENTARIOS DE LOS HECHOS"}),m.jsx("div",{className:ze.box,children:m.jsx("textarea",{className:ze.textarea,value:o.txHechos||"",onChange:w=>y("txHechos",w.target.value)})}),m.jsx("div",{className:ze.section,children:" ANTECEDENTES DEL ASEGURADO"}),m.jsx("div",{className:ze.box,children:m.jsx("textarea",{className:ze.textarea,value:o.txAntecedentes||"",onChange:w=>y("txAntecedentes",w.target.value)})}),m.jsx("div",{className:ze.bigline,children:"Opinin___________________________________________________________"}),m.jsx("div",{className:ze.box,children:m.jsx("textarea",{className:ze.textarea,value:o.txContinuidad||"",onChange:w=>y("txContinuidad",w.target.value)})}),m.jsx("div",{className:ze.bigline,children:"Desarrollo________________________________________________________"}),m.jsx("div",{className:ze.section,children:"Tcnico"}),m.jsx("div",{className:ze.box,children:m.jsx("textarea",{className:ze.textarea,value:o.txTecnico||"",onChange:w=>y("txTecnico",w.target.value)})}),m.jsx("div",{className:ze.section,children:"Clima"}),m.jsx("div",{className:ze.box,children:m.jsx("textarea",{className:ze.textarea,value:o.txClima||"",onChange:w=>y("txClima",w.target.value)})}),m.jsx("div",{className:ze.section,children:"Conclusin"}),m.jsx("div",{className:ze.box,children:m.jsx("textarea",{className:ze.textarea,value:o.txConclusion||"",onChange:w=>y("txConclusion",w.target.value)})})]})]}):m.jsx("div",{className:ze.container,children:"Caso no encontrado."})},Q9="_container_1mb5j_1",Z9="_toolbar_1mb5j_7",ez="_btn_1mb5j_16",tz="_btnPrimary_1mb5j_28",rz="_page_1mb5j_38",az="_header_1mb5j_50",sz="_companyName_1mb5j_59",nz="_logoInfo_1mb5j_66",iz="_ahorroBox_1mb5j_72",oz="_ahorroBadge_1mb5j_78",lz="_ahorroValue_1mb5j_88",cz="_founding_1mb5j_93",uz="_logoCircle_1mb5j_98",hz="_labelBand_1mb5j_111",dz="_mainTable_1mb5j_119",fz="_label_1mb5j_111",pz="_val_1mb5j_138",gz="_sectionTitle_1mb5j_143",mz="_subLabel_1mb5j_154",vz="_textAreaBox_1mb5j_160",xz="_ghostInput_1mb5j_165",_z="_ghostTextarea_1mb5j_176",yz="_printableTable_1mb5j_187",bz="_noBorderTable_1mb5j_204",wz="_resultBox_1mb5j_209",Ez="_pageBreak_1mb5j_215",Az="_docsGrid_1mb5j_251",Sz="_docItem_1mb5j_258",Tz="_docImageContainer_1mb5j_262",Cz="_docImage_1mb5j_262",kz="_docLabel_1mb5j_274",Nz="_docFile_1mb5j_281",Rz="_docMeta_1mb5j_290",ge={container:Q9,toolbar:Z9,btn:ez,btnPrimary:tz,page:rz,header:az,companyName:sz,logoInfo:nz,ahorroBox:iz,ahorroBadge:oz,ahorroValue:lz,founding:cz,logoCircle:uz,labelBand:hz,mainTable:dz,label:fz,val:pz,sectionTitle:gz,subLabel:mz,textAreaBox:vz,ghostInput:xz,ghostTextarea:_z,printableTable:yz,noBorderTable:bz,resultBox:wz,pageBreak:Ez,docsGrid:Az,docItem:Sz,docImageContainer:Tz,docImage:Cz,docLabel:kz,docFile:Nz,docMeta:Rz};no.workerSrc=h2;const Oz=({url:r,name:e})=>{const[t,a]=Q.useState([]),[s,i]=Q.useState(!0);return Q.useEffect(()=>{r?(async()=>{try{const u=await ev(r).promise;if(!u)throw new Error("Could not load PDF");const d=document.createElement("canvas"),f=d.getContext("2d");if(!f)throw new Error("Could not get canvas context");const g=[];for(let v=1;v<=u.numPages;v++){const x=await u.getPage(v),y=x.getViewport({scale:1.5});d.height=y.height,d.width=y.width,await x.render({canvasContext:f,viewport:y,canvas:d}).promise,g.push(d.toDataURL("image/webp",.8))}a(g)}catch(c){console.error("Error rendering PDF:",c)}finally{i(!1)}})():i(!1)},[r]),r?s?m.jsxs("div",{style:{textAlign:"center",padding:"10px",color:"#666"},children:[" Procesando PDF ",e.split("_").slice(1).join("_"),"..."]}):t.length===0?m.jsxs("div",{style:{textAlign:"center",padding:"10px",color:"red"},children:[" Error al procesar PDF ",e]}):m.jsx(m.Fragment,{children:t.map((o,c)=>m.jsxs("div",{className:ge.docImageContainer,style:{marginBottom:"40px"},children:[m.jsx("img",{src:o,alt:`${e}-p${c+1}`,className:ge.docImage}),m.jsxs("div",{className:ge.docLabel,children:[e.split("_").slice(1).join("_")," - Pgina ",c+1]})]},c))}):null},Dz=()=>{const{id:r}=lm(),e=ho(),[t,a]=Q.useState(!0),[s,i]=Q.useState(null),[o,c]=Q.useState({}),[u,d]=Q.useState({suma:0,conv:0,ahor:0}),[f,g]=Q.useState([]);Q.useEffect(()=>{r&&v(r)},[r]);const v=async A=>{a(!0);try{const{data:T,error:S}=await qe.from("casos").select("*").eq("id",A).single();if(S)throw S;i(T),c(T.informe_desiste||T.informe||{});let N=0,R=0,O=0;if((T.tabla_daos||[]).forEach(C=>{let j=0;(C.items||[]).forEach(W=>j+=Number(W.montoConvenido||0));const I=Number(C.suma||0);N+=I,R+=j,O+=Math.max(0,I-j)}),d({suma:N,conv:R,ahor:O}),T.n_siniestro){const{data:C,error:j}=await qe.storage.from("documentos").list(`casos/${T.n_siniestro}`);if(!j&&C){const I=C.filter(H=>H.name!==".emptyFolderPlaceholder"),W=await Promise.all(I.map(async H=>{try{const{data:D,error:z}=await qe.storage.from("documentos").createSignedUrl(`casos/${T.n_siniestro}/${H.name}`,3600);return z?(console.error(`Error creating signed URL for ${H.name}:`,z),null):{...H,url:D?.signedUrl,mime:H.metadata?.mimetype||H.mimetype||""}}catch(D){return console.error(`Unexpected error processing file ${H.name}:`,D),null}}));g(W.filter(H=>H!==null))}}}catch(T){console.error("Error loading case:",T),e(-1)}finally{a(!1)}},x=async(A=!1)=>{try{const{error:T}=await qe.from("casos").update({informe_desiste:o}).eq("id",r);if(T)throw T;A||alert("Informe Desiste guardado.")}catch(T){alert("Error al guardar: "+T.message)}},y=async()=>{await x(!0),window.print()},_=(A,T)=>{c(S=>({...S,[A]:T}))},w=A=>A?.toLocaleString("es-AR",{minimumFractionDigits:2});return t?m.jsx("div",{className:ge.container,children:"Cargando..."}):s?m.jsxs("div",{className:ge.container,children:[m.jsxs("div",{className:ge.toolbar,children:[m.jsxs("button",{className:ge.btn,onClick:()=>e(-1),children:[m.jsx(Yw,{size:16})," Volver"]}),m.jsxs("button",{className:`${ge.btn} ${ge.btnPrimary}`,onClick:()=>x(!1),children:[m.jsx(Kw,{size:16})," Guardar"]}),m.jsxs("button",{className:`${ge.btn} ${ge.btnPrimary}`,onClick:y,children:[m.jsx(xm,{size:16})," Imprimir / PDF"]})]}),m.jsxs("div",{className:ge.page,children:[m.jsxs("div",{className:ge.header,children:[m.jsxs("div",{className:ge.logoInfo,children:[m.jsx("h2",{className:ge.companyName,children:"H.M.Gibert"}),m.jsxs("p",{children:["CONTADOR PUBLICO NACIONAL",m.jsx("br",{}),"ESTUDIO DE LIQUIDACIN DE SINIESTROS"]})]}),m.jsx("div",{className:ge.ahorroBox,children:m.jsxs("div",{className:ge.ahorroBadge,children:["*AHORRO GENERADO*",m.jsx("div",{className:ge.ahorroValue,children:w(u.ahor)})]})}),m.jsxs("div",{className:ge.founding,children:["Fundado en 1955",m.jsx("div",{className:ge.logoCircle,children:"G"})]})]}),m.jsxs("div",{className:ge.labelBand,children:["COMPAA: ",s.cia?.toUpperCase()]}),m.jsx("table",{className:ge.mainTable,children:m.jsxs("tbody",{children:[m.jsxs("tr",{children:[m.jsx("td",{className:ge.label,children:"SINIESTRO"}),m.jsx("td",{className:ge.label,children:"POLIZA"}),m.jsx("td",{className:ge.label,children:"ANALISTA"})]}),m.jsxs("tr",{children:[m.jsx("td",{className:ge.val,children:s.n_siniestro}),m.jsx("td",{className:ge.val,children:s.poliza}),m.jsx("td",{className:ge.val,children:s.analista})]})]})}),m.jsx("div",{className:ge.sectionTitle,children:"Datos personales del asegurado"}),m.jsx("table",{className:ge.mainTable,children:m.jsxs("tbody",{children:[m.jsxs("tr",{children:[m.jsx("td",{className:ge.label,style:{width:"70%"},children:"APELLIDO Y NOMBRE"}),m.jsx("td",{className:ge.label,children:"TIPO Y N DOCUMENTO"})]}),m.jsxs("tr",{children:[m.jsx("td",{className:ge.val,children:s.asegurado}),m.jsxs("td",{className:ge.val,children:["DNI ",s.dni]})]})]})}),m.jsx("div",{className:ge.sectionTitle,children:"Ubicacin del riesgo afectado"}),m.jsx("table",{className:ge.mainTable,children:m.jsxs("tbody",{children:[m.jsxs("tr",{children:[m.jsx("td",{className:ge.label,style:{width:"40%"},children:"CALLE"}),m.jsx("td",{className:ge.label,style:{width:"10%"},children:"N"}),m.jsx("td",{className:ge.label,style:{width:"10%"},children:"PISO"}),m.jsx("td",{className:ge.label,style:{width:"20%"},children:"LOCALIDAD"}),m.jsx("td",{className:ge.label,style:{width:"20%"},children:"PROVINCIA"})]}),m.jsxs("tr",{children:[m.jsx("td",{className:ge.val,children:s.calle_riesgo}),m.jsx("td",{className:ge.val,children:s.nro_r}),m.jsx("td",{className:ge.val,children:s.piso_r}),m.jsx("td",{className:ge.val,children:s.localidad_r}),m.jsx("td",{className:ge.val,children:s.provincia_r})]})]})}),m.jsx("div",{className:ge.sectionTitle,children:"Datos del siniestro"}),m.jsx("table",{className:ge.mainTable,children:m.jsxs("tbody",{children:[m.jsxs("tr",{children:[m.jsx("td",{className:ge.label,style:{width:"33%"},children:"FECHA DEL SINIESTRO"}),m.jsx("td",{className:ge.label,style:{width:"33%"},children:"HORA DEL SINIESTRO"}),m.jsx("td",{className:ge.label,style:{width:"33%"},children:"FECHA DE DENUNCIA"})]}),m.jsxs("tr",{children:[m.jsx("td",{className:ge.val,children:m.jsx("input",{className:ge.ghostInput,value:o.f_sin||s.fecha_siniestro||"",onChange:A=>_("f_sin",A.target.value)})}),m.jsx("td",{className:ge.val,children:m.jsx("input",{className:ge.ghostInput,value:o.h_sin||"",onChange:A=>_("h_sin",A.target.value)})}),m.jsx("td",{className:ge.val,children:m.jsx("input",{className:ge.ghostInput,value:o.f_den||s.fecha_denuncia||"",onChange:A=>_("f_den",A.target.value)})})]})]})}),m.jsx("div",{className:ge.subLabel,children:"DENUNCIADO COMO OCURRIDO:"}),m.jsx("div",{className:ge.textAreaBox,children:m.jsx("textarea",{className:ge.ghostTextarea,value:o.ocurrencia||"",onChange:A=>_("ocurrencia",A.target.value)})}),m.jsx("table",{className:ge.mainTable,style:{marginTop:"10px"},children:m.jsxs("tbody",{children:[m.jsxs("tr",{children:[m.jsx("td",{className:ge.label,colSpan:2,children:"VIGENCIA DE POLIZA"}),m.jsx("td",{className:ge.label,rowSpan:2,children:"FECHA DE CIERRE"})]}),m.jsxs("tr",{children:[m.jsx("td",{className:ge.label,children:"DESDE"}),m.jsx("td",{className:ge.label,children:"HASTA"})]}),m.jsxs("tr",{children:[m.jsx("td",{className:ge.val,children:m.jsx("input",{className:ge.ghostInput,value:o.vig_desde||s.fecha_contratacion||"",onChange:A=>_("vig_desde",A.target.value)})}),m.jsx("td",{className:ge.val,children:m.jsx("input",{className:ge.ghostInput,value:o.vig_hasta||s.vigencia_hasta||"",onChange:A=>_("vig_hasta",A.target.value)})}),m.jsx("td",{className:ge.val,children:m.jsx("input",{className:ge.ghostInput,value:o.f_cierre||"",onChange:A=>_("f_cierre",A.target.value)})})]})]})}),m.jsx("table",{className:ge.mainTable,style:{marginTop:"10px"},children:m.jsxs("tbody",{children:[m.jsxs("tr",{children:[m.jsx("td",{className:ge.label,style:{width:"50%"},children:"RAMO"}),m.jsx("td",{className:ge.label,style:{width:"50%"},children:"TIPO DE SINIESTRO"})]}),m.jsxs("tr",{children:[m.jsx("td",{className:ge.val,children:s.ramo}),m.jsx("td",{className:ge.val,children:s.causa})]})]})}),m.jsx("table",{className:ge.mainTable,style:{marginTop:"10px"},children:m.jsx("tbody",{children:m.jsxs("tr",{children:[m.jsx("td",{className:ge.label,children:"INTERVENCION POLICIAL"}),m.jsx("td",{className:ge.val,style:{width:"80px"},children:m.jsx("input",{className:ge.ghostInput,value:o.int_pol||"NO",onChange:A=>_("int_pol",A.target.value)})}),m.jsx("td",{className:ge.label,children:"INTERVENCION BOMBEROS"}),m.jsx("td",{className:ge.val,style:{width:"80px"},children:m.jsx("input",{className:ge.ghostInput,value:o.int_bom||"NO",onChange:A=>_("int_bom",A.target.value)})})]})})}),m.jsx("div",{className:ge.sectionTitle,children:"OTROS AFECTADOS O PROPIETARIO EN CASO DE RC"}),m.jsx("table",{className:ge.mainTable,children:m.jsxs("tbody",{children:[m.jsxs("tr",{children:[m.jsx("td",{className:ge.label,style:{width:"50%"},children:"DOMICILIO"}),m.jsx("td",{className:ge.label,style:{width:"25%"},children:"DNI"}),m.jsx("td",{className:ge.label,style:{width:"25%"},children:"TEL"})]}),m.jsxs("tr",{children:[m.jsx("td",{className:ge.val,children:m.jsx("input",{className:ge.ghostInput,value:o.rc_dom||"",onChange:A=>_("rc_dom",A.target.value)})}),m.jsx("td",{className:ge.val,children:m.jsx("input",{className:ge.ghostInput,value:o.rc_dni||"",onChange:A=>_("rc_dni",A.target.value)})}),m.jsx("td",{className:ge.val,children:m.jsx("input",{className:ge.ghostInput,value:o.rc_tel||"",onChange:A=>_("rc_tel",A.target.value)})})]})]})}),m.jsx("div",{className:ge.sectionTitle,children:"COBERTURAS AFECTADAS"}),m.jsxs("table",{className:ge.printableTable,children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{children:"COBERTURA"}),m.jsx("th",{children:"SUMA ASEGURADA"}),m.jsx("th",{children:"DAOS CONVALIDADOS"}),m.jsx("th",{children:"MONTO AHORRADO"})]})}),m.jsx("tbody",{children:(s.tabla_daos||[]).map((A,T)=>{let S=0;(A.items||[]).forEach(O=>S+=Number(O.montoConvenido||0));const N=Number(A.suma||0),R=Math.max(0,N-S);return m.jsxs("tr",{children:[m.jsx("td",{children:A.nombre}),m.jsx("td",{children:w(N)}),m.jsx("td",{children:w(S)}),m.jsx("td",{children:w(R)})]},T)})})]}),m.jsx("div",{className:ge.sectionTitle,children:"RESULTADO DE LA VERIFICACIN"}),m.jsx("table",{className:ge.noBorderTable,children:m.jsx("tbody",{children:m.jsxs("tr",{children:[m.jsx("td",{style:{width:"50%"},children:m.jsxs("div",{className:ge.resultBox,children:[m.jsx("div",{className:ge.label,children:"MONTO A LIQUIDAR"}),m.jsxs("div",{className:ge.val,style:{fontSize:"18px"},children:["$ ",w(u.conv)]})]})}),m.jsx("td",{style:{width:"50%",paddingLeft:"10px"},children:m.jsxs("div",{className:ge.resultBox,style:{border:"2px solid #ff0000"},children:[m.jsx("div",{className:ge.label,style:{color:"#ff0000"},children:"CAUSA DE RECHAZO / DESISTIMIENTO"}),m.jsx("textarea",{className:ge.ghostTextarea,style:{minHeight:"40px"},value:o.causa_rechazo||"",onChange:A=>_("causa_rechazo",A.target.value)})]})})]})})}),m.jsx("div",{className:ge.sectionTitle,children:"MOTIVO DE LA DERIVACION"}),m.jsx("div",{className:ge.textAreaBox,children:m.jsx("textarea",{className:ge.ghostTextarea,value:o.motivo_derivacion||s.motivo_derivacion||"",onChange:A=>_("motivo_derivacion",A.target.value)})}),m.jsx("div",{className:ge.pageBreak}),m.jsx("div",{className:ge.sectionTitle,children:"COMENTARIOS DE LOS HECHOS"}),m.jsx("div",{className:ge.textAreaBox,style:{minHeight:"300px"},children:m.jsx("textarea",{className:ge.ghostTextarea,style:{height:"300px"},value:o.hechos||s.entrevista||"",onChange:A=>_("hechos",A.target.value)})}),m.jsx("div",{className:ge.pageBreak}),m.jsx("div",{className:ge.sectionTitle,children:"ANTECEDENTES DEL ASEGURADO"}),m.jsx("div",{className:ge.textAreaBox,style:{minHeight:"150px"},children:m.jsx("textarea",{className:ge.ghostTextarea,style:{height:"150px"},value:o.antecedentes||"",onChange:A=>_("antecedentes",A.target.value)})}),m.jsxs("table",{className:ge.mainTable,style:{marginTop:"20px"},children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{className:ge.label,children:"CONCEPTO"}),m.jsx("th",{className:ge.label,children:"DETALLE"})]})}),m.jsxs("tbody",{children:[m.jsxs("tr",{children:[m.jsx("td",{className:ge.label,children:"ACONSEJA LA CONTINUIDAD DE LA COBERTURA?"}),m.jsx("td",{className:ge.val,children:m.jsx("input",{className:ge.ghostInput,value:o.continuidad||"",onChange:A=>_("continuidad",A.target.value)})})]}),m.jsxs("tr",{children:[m.jsx("td",{className:ge.label,children:"PERSONA ENTREVISTADA"}),m.jsx("td",{className:ge.val,children:m.jsx("input",{className:ge.ghostInput,value:o.entrevistado||"",onChange:A=>_("entrevistado",A.target.value)})})]}),m.jsxs("tr",{children:[m.jsx("td",{className:ge.label,children:"LUGAR DE LA ENTREVISTA"}),m.jsx("td",{className:ge.val,children:m.jsx("input",{className:ge.ghostInput,value:o.lugar_entrevista||"",onChange:A=>_("lugar_entrevista",A.target.value)})})]}),m.jsxs("tr",{children:[m.jsx("td",{className:ge.label,children:"INCONVENIENTES PARA REALIZAR LA ENTREVISTA"}),m.jsx("td",{className:ge.val,children:m.jsx("input",{className:ge.ghostInput,value:o.inconvenientes||"NINGUNO",onChange:A=>_("inconvenientes",A.target.value)})})]})]})]}),m.jsx("div",{className:ge.sectionTitle,children:"ANTECEDENTES SINIESTRALES"}),m.jsx("div",{className:ge.textAreaBox,style:{minHeight:"100px"},children:m.jsx("textarea",{className:ge.ghostTextarea,style:{height:"100px"},value:o.ant_siniestrales||"",onChange:A=>_("ant_siniestrales",A.target.value)})}),f.length>0&&m.jsxs(m.Fragment,{children:[m.jsx("div",{className:ge.pageBreak}),m.jsx("div",{className:ge.sectionTitle,children:"DOCUMENTACIN ADJUNTA"}),m.jsx("div",{className:ge.docsGrid,children:f.map((A,T)=>{if(!A||!A.url)return null;const S=(A.mime||"").toLowerCase(),N=(A.name||"").toLowerCase(),R=S.startsWith("image/")||/\.(jpg|jpeg|png|gif|webp)$/.test(N),O=S==="application/pdf"||N.endsWith(".pdf");return m.jsx("div",{className:ge.docItem,children:R?m.jsxs("div",{className:ge.docImageContainer,children:[m.jsx("img",{src:A.url,alt:A.name,className:ge.docImage}),m.jsx("div",{className:ge.docLabel,children:A.name.split("_").slice(1).join("_")})]}):O?m.jsx(Oz,{url:A.url,name:A.name}):m.jsxs("div",{className:ge.docFile,children:[m.jsx(Fs,{size:48}),m.jsx("div",{className:ge.docLabel,children:A.name.split("_").slice(1).join("_")}),m.jsxs("div",{className:ge.docMeta,children:["Archivo: ",A.mime||"Desconocido"]})]})},T)})})]})]})]}):m.jsx("div",{className:ge.container,children:"Caso no encontrado."})},ci=({children:r})=>{const{session:e,loading:t}=Pu();return t?m.jsx("div",{children:"Cargando..."}):e?r:m.jsx(Sw,{to:"/login"})};function Fz(){return m.jsx(BR,{children:m.jsx(KC,{children:m.jsxs(TC,{children:[m.jsx(Rs,{path:"/login",element:m.jsx(UR,{})}),m.jsx(Rs,{path:"/detalle/:id",element:m.jsx(ci,{children:m.jsx(YU,{})})}),m.jsx(Rs,{path:"/lista",element:m.jsx(ci,{children:m.jsx(y6,{})})}),m.jsx(Rs,{path:"/tareas",element:m.jsx(ci,{children:m.jsx(p7,{})})}),m.jsx(Rs,{path:"/facturacion",element:m.jsx(ci,{children:m.jsx(U7,{})})}),m.jsx(Rs,{path:"/reportes",element:m.jsx(ci,{children:m.jsx(d9,{})})}),m.jsx(Rs,{path:"/administracion",element:m.jsx(ci,{children:m.jsx(j9,{})})}),m.jsx(Rs,{path:"/informe/:id",element:m.jsx(ci,{children:m.jsx(J9,{})})}),m.jsx(Rs,{path:"/informe-desiste/:id",element:m.jsx(ci,{children:m.jsx(Dz,{})})}),m.jsx(Rs,{path:"/",element:m.jsx(Sw,{to:"/lista"})})]})})})}NT.createRoot(document.getElementById("root")).render(m.jsx(Q.StrictMode,{children:m.jsx(Fz,{})}));
